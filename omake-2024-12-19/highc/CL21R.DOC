*****************************************************************************
目次                                           Ｃライブラリ V2.1 リファレンス
*****************************************************************************
                                                                             
第1章　グラフィックライブラリ                                                
 1.　グラフィックライブラリについて                                          
 1.1　概要                                                                   
 1.2　描画演算の一覧                                                         
 1.3　パラメータ型の記号                                                     
 1.4　グラフィック画面                                                       
 1.5　ピクセルビット構成(デフォルト値)                                       
 2.　グラフィックライブラリ                                                  
 2.1　サンプルプログラム                                                     
 2.2　関数一覧                                                               
 2.2.1　セッティングオペレーション                                           
 2.2.2　リーディングオペレーション                                           
 2.2.3　ブロックオペレーション                                               
 2.2.4　グラフィックオペレーション                                           
 2.2.5　フォントオペレーション                                               
 2.3　各関数の解説                                                           
                                                                             
第2章　マウスライブラリ                                                      
 1.　マウスライブラリ                                                        
 1.1　サンプルプログラム                                                     
 1.2　フルカラー画面でのマウスカーソル表示の注意事項                         
 1.3　関数一覧                                                               
 1.4　各関数の解説                                                           
                                                                             
第3章　スプライトライブラリ                                                  
 1.　スプライトについて                                                      
 1.1　スプライトの機能                                                       
 1.2　スプライト機能の仕様概要                                               
 1.3　スプライトパターンメモリ                                               
 1.4　優先順位処理                                                           
 1.5　マスク処理                                                             
 2.　スプライトライブラリ                                                    
 2.1　サンプルプログラム                                                     
 2.2　関数一覧                                                               
 2.3　各関数の解説                                                           
                                                                             
第4章　フォントライブラリ                                                    
 1.　フォントライブラリ                                                      
 1.1　関数一覧                                                               
 1.2　各関数の解説                                                           
                                                                             
第5章　ＦＭ　Ｃ関数ライブラリ                                                
 1.　ＦＭ　Ｃ関数について                                                    
 1.1　アドレスのセット方法について                                           
 1.2　構造体の説明                                                           
 2.　サンプルプログラム                                                      
 3.　ｆｏｒＲＢＩＯＳインターフェース                                        
 3.1　forRBIOSについて                                                       
 3.2　forRBIOSインターフェース概要                                           
 3.3　forRBIOSによる割り込み処理                                             
 3.4　関数一覧                                                               
 3.5　各関数の解説                                                           
 4.　キーボードインターフェース                                              
 4.1　キーボードインターフェース概要                                         
 4.2　関数一覧                                                               
 4.3　各関数の解説                                                           
 5.　コンソール(文字ディスプレイ)インターフェース                            
 5.1　関数一覧                                                               
 5.2　各関数の解説                                                           
 6.　補助記憶装置サポート                                                    
 6.1　関数一覧                                                               
 6.2　各関数の解説                                                           
 7.　プリンタインターフェース                                                
 7.1　関数一覧                                                               
 7.2　各関数の解説                                                           
 8.　時計サポート                                                            
 8.1　関数一覧                                                               
 8.2　各関数の解説                                                           
 9.　RS-232Cインターフェース                                                 
 9.1　関数一覧                                                               
 9.2　各関数の解説                                                           
 10.　ブザー(BEEP音)インターフェース                                         
 10.1　関数一覧                                                              
 10.2　各関数の解説                                                          
                                                                             
第6章　ＣＤ-ＲＯＭライブラリ                                                 
 1.　処理手順例                                                              
 1.1　データリード実行例                                                     
 1.2　音楽演奏実行例                                                         
 2.　ヘッダファイルｃｄｒｆｒｂ.ｈについて                                   
 3.　ＣＤ-ＲＯＭエラー情報                                                   
 3.1　ＣＤ-ＲＯＭエラー内容と処理方法                                        
 4.　ＣＤ-ＲＯＭライブラリ                                                   
 4.1　サンプルプログラム                                                     
 4.2　関数一覧                                                               
 4.3　各関数の解説                                                           
                                                                             
第7章　サウンドライブラリ                                                    
 1.　サウンド機能について                                                    
 1.1　概要                                                                   
 2.　ＰＣＭについて                                                          
 2.1　楽器モードのデータ構造                                                 
 2.2　音声モードのデータ形式                                                 
 3.　ＦＭ音源                                                                
 4.　サウンドＢＩＯＳについて                                                
 4.1　電子ボリュームの使い方                                                 
 4.2　サンプリングについて                                                   
 5.　サウンドライブラリ                                                      
 5.1　サンプルプログラム                                                     
 5.2　関数一覧                                                               
 5.3　各関数の解説                                                           
                                                                             
第8章　ＥＵＰＨＯＮＹドライバライブラリ                                      
 1.　ＥＵＰＨＯＮＹドライバについて                                          
 1.1　概要                                                                   
 1.2　データ形式                                                             
 1.3　ＥＵＰファイル形式                                                     
 1.4　アセンブラからの使用方法                                               
 2.　ＥＵＰＨＯＮＹドライバライブラリ                                        
 2.1　関数一覧                                                               
 2.2　各関数の解説                                                           
 3.　アセンブラ言語のための関数                                              
 3.1　サンプルプログラム                                                     
 3.2　関数一覧                                                               
 3.3　各関数の解説                                                           
                                                                             
第9章　ハードコピーライブラリ                                                
 1.　ハードコピーライブラリについて                                          
 1.1　概要                                                                   
 2.　ハードコピーライブラリ                                                  
 2.1　サンプルプログラム                                                     
 2.2　関数一覧                                                               
 2.3　各関数の解説                                                           
                                                                             
付録Ａ　システムアイコン一覧表                                               
                                                                             
付録Ｂ　キーボード関連                                                       
                                                                             
索引                                                                         
                                                                             
*****************************************************************************
索引                                           Ｃライブラリ V2.1 リファレンス
*****************************************************************************
                                                                             
■数字                                                                       
                                                                             
1文字出力                                                                    
                                                                             
■英文                                                                       
                                                                             
●Ａ                                                                         
 ANK フォントのコピー                                                        
 ANK フォントの読み出し                                                      
                                                                             
●Ｂ                                                                         
 .BPB_fixon                                                                  
 .BPB_freeon                                                                 
 .BPB_freeon2                                                                
 .BPB_off                                                                    
 .BPB_on                                                                     
 .BPB_rdinf                                                                  
 .BPB_rdinf2                                                                 
                                                                             
●Ｃ                                                                         
 CD-ROMエラー情報                                                            
 CD-ROMエラー内容と処理方法                                                  
 CD-ROMドライブの回転停止時間の設定                                          
 CD-ROMライブラリ                                                            
 .cdr_cdinfo                                                                 
 .cdr_continue                                                               
 .cdr_mphase                                                                 
 .cdr_mstop                                                                  
 .cdr_mtplay                                                                 
 .cdr_mtrplay                                                                
 .cdr_pause                                                                  
 .cdr_rdrvmd                                                                 
 .cdr_read                                                                   
 .cdr_read2                                                                  
 .cdr_restore                                                                
 .cdr_rmtplay                                                                
 .cdr_sdrvmd                                                                 
 .cdr_seek                                                                   
 .cdr_status                                                                 
 .cdr_stptime                                                                
 .cdr_tread                                                                  
 .cdr_tread2                                                                 
 .cdr_tseek                                                                  
                                                                             
●Ｄ                                                                         
 .DKB_chksec                                                                 
 .DKB_chksec2                                                                
 .DKB_rdmode                                                                 
 .DKB_rdsecid                                                                
 .DKB_rdstatus                                                               
 .DKB_rdstatus2                                                              
 .DKB_read                                                                   
 .DKB_read2                                                                  
 .DKB_reset                                                                  
 .DKB_restore                                                                
 .DKB_seek                                                                   
 .DKB_setmode                                                                
 .DKB_write                                                                  
 .DKB_write2                                                                 
                                                                             
●Ｅ                                                                         
 .EGB_anychar                                                                
 .EGB_arc                                                                    
 .EGB_asciiString                                                            
 .EGB_bow                                                                    
 .EGB_circle                                                                 
 .EGB_clearScreen                                                            
 .EGB_closePaint                                                             
 .EGB_color                                                                  
 .EGB_colorIGRB                                                              
 .EGB_connect                                                                
 .EGB_connectAsciiString                                                     
 .EGB_connectJisString                                                       
 .EGB_connectSjisString                                                      
 .EGB_copy                                                                   
 .EGB_digitize                                                               
 .EGB_displayPage                                                            
 .EGB_displayStart                                                           
 .EGB_ellipse                                                                
 .EGB_ellipticArc                                                            
 .EGB_ellipticFan                                                            
 .EGB_fan                                                                    
 .EGB_fontStyle                                                              
 .EGB_getBlock                                                               
 .EGB_getBlockColor                                                          
 .EGB_getBlockZoom                                                           
 .EGB_getDisplayPage                                                         
 .EGB_getDisplayStart                                                        
 .EGB_getModeInfo                                                            
 .EGB_getPalette                                                             
 .EGB_getResolution                                                          
 .EGB_getTmenuPalette                                                        
 .EGB_getWritePage                                                           
 .EGB_graphicCursor                                                          
 .EGB_hatchingPattern                                                        
 .EGB_init                                                                   
 .EGB_jisString                                                              
 .EGB_linePattern                                                            
 .EGB_mask                                                                   
 .EGB_maskBit                                                                
 .EGB_maskData                                                               
 .EGB_maskRegion                                                             
 .EGB_paint                                                                  
 .EGB_paintMode                                                              
 .EGB_palette                                                                
 .EGB_partClearScreen                                                        
 .EGB_partScroll                                                             
 .EGB_pastel                                                                 
 .EGB_pen                                                                    
 .EGB_penSize                                                                
 .EGB_penStyle                                                               
 .EGB_point                                                                  
 .EGB_polygon                                                                
 .EGB_pset                                                                   
 .EGB_putBlock                                                               
 .EGB_putBlockColor                                                          
 .EGB_putBlockZoom                                                           
 .EGB_rectangle                                                              
 .EGB_region                                                                 
 .EGB_resolution                                                             
 .EGB_resolutionRam                                                          
 .EGB_resolve                                                                
 .EGB_rotate                                                                 
 .EGB_rotatePolygon                                                          
 .EGB_scroll                                                                 
 .EGB_semiBow                                                                
 .EGB_setTmenuPalette                                                        
 .EGB_sjisString                                                             
 .EGB_superImpose                                                            
 .EGB_textDirection                                                          
 .EGB_textDisplayDirection                                                   
 .EGB_textSpace                                                              
 .EGB_textZoom                                                               
 .EGB_tilePattern                                                            
 .EGB_tmenuPalette                                                           
 .EGB_tmenuPalette2                                                          
 .EGB_triangle                                                               
 .EGB_unConnect                                                              
 .EGB_viewport                                                               
 .EGB_writeMode                                                              
 .EGB_writePage                                                              
 EUPHONY ドライバについて                                                    
 EUPHONY ドライバの終了                                                      
 EUPHONY ドライバの初期化                                                    
 EUPHONY ドライバライブラリ                                                  
 EUP ファイル形式                                                            
                                                                             
                                                                             
●Ｆ                                                                         
 FM C関数について                                                            
 FM音源                                                                      
 FM音源ステータスの読み込み                                                  
 FM音源タイマＡ設定                                                          
 FM音源タイマＡの動作開始                                                    
 FM音源タイマＢ設定                                                          
 FM音源タイマＢの動作開始                                                    
 FM音源ハードウェアLFO の設定                                                
 FM音源バンクデータを読み込む                                                
 FM音源レジスタ書き込み                                                      
 FM音源保存レジスタ書き込み                                                  
 FM音源保存レジスタ読み込み                                                  
 .FNT_ankAddr                                                                
 .FNT_ankRead                                                                
 .FNT_jisToSjis                                                              
 .FNT_kanjiAddr                                                              
 .FNT_kanjiRead                                                              
 .FNT_sjisToJis                                                              
 forRBIOSインストール状態の取得                                              
 forRBIOSインタフェース                                                      
 forRBIOSインタフェース概要                                                  
 forRBIOSクライアント宣言(解除)                                              
 forRBIOSクライアント宣言(全解除)                                            
 forRBIOSクライアント宣言(登録)                                              
 forRBIOSクライアントメンバ取得                                              
 forRBIOS全クライアントメンバ一括登録                                        
 forRBIOSについて                                                            
 .FRB_change_stack                                                           
 .FRB_clrclient                                                              
 .FRB_getclient                                                              
 .FRB_getstatus                                                              
 .FRB_popclient                                                              
 .FRB_resetclient                                                            
 .FRB_setclient                                                              
                                                                             
●Ｈ                                                                         
 .HCP_setOutMode                                                             
 .HCP_setPrnStart                                                            
 .HCP_start                                                                  
 .HCP_stop                                                                   
                                                                             
●Ｊ                                                                         
 JIS からsjisへの変換                                                        
                                                                             
●Ｋ                                                                         
 .KYB_addstr                                                                 
 .KYB_asign                                                                  
 .KYB_clic                                                                   
 .KYB_clrbuf                                                                 
 .KYB_init                                                                   
 .KYB_inpchk                                                                 
 .KYB_lock                                                                   
 .KYB_matrix                                                                 
 .KYB_pfint                                                                  
 .KYB_rdasign                                                                
 .KYB_rdcode                                                                 
 .KYB_rdpfint                                                                
 .KYB_read                                                                   
 .KYB_rpfint                                                                 
 .KYB_setbuf                                                                 
 .KYB_setcode                                                                
 .KYB_shift                                                                  
                                                                             
●Ｍ                                                                         
 .MIDISYNC信号の出力ポート設定                                               
 .MIDIデータの読み込み                                                       
 .MIDIデータ列の出力                                                         
 .MIDI出力ルーチンの取得                                                     
 .MIDI出力ルーチンの登録                                                     
 .MOS_acceleration                                                           
 .MOS_btnXchg                                                                
 .MOS_color                                                                  
 .MOS_disp                                                                   
 .MOS_end                                                                    
 .MOS_entsub                                                                 
 .MOS_getAcceleration                                                        
 .MOS_getBtnXchg                                                             
 .MOS_getControl                                                             
 .MOS_getDisp                                                                
 .MOS_getEntsub                                                              
 .MOS_getEvent                                                               
 .MOS_getHorizon                                                             
 .MOS_getPulse                                                               
 .MOS_getResolution                                                          
 .MOS_getTime                                                                
 .MOS_getVertical                                                            
 .MOS_getWritePage                                                           
 .MOS_horizon                                                                
 .MOS_motion                                                                 
 .MOS_openCheck                                                              
 .MOS_pulse                                                                  
 .MOS_rdon                                                                   
 .MOS_rdopen                                                                 
 .MOS_rdpos                                                                  
 .MOS_resolution                                                             
 .MOS_setControl                                                             
 .MOS_setEvent                                                               
 .MOS_setpos                                                                 
 .MOS_start                                                                  
 .MOS_tilePattern                                                            
 .MOS_type                                                                   
 .MOS_typeRom                                                                
 .MOS_vertical                                                               
 .MOS_viewHorizon                                                            
 .MOS_viewVertical                                                           
 .MOS_writePage                                                              
                                                                             
●Ｐ                                                                         
 PCM ウェーブデータの転送                                                    
 PCM 音源の強制停止                                                          
 PCM 音源バンクデータを読み込む                                              
 PCM 音声モード再生アドレスの取得                                            
 PCM 音声モード再生開始                                                      
 PCM 音声モード再生の強制停止                                                
 PCM 音声モードシステムROM データ再生開始                                    
 PCM 音声モードチャンネル数の設定                                            
 PCM 音声モードチャンネル数の読み取り                                        
 PCM サウンドデータの削除                                                    
 PCM サウンドデータの登録                                                    
 PCM サウンドデータの読み取り                                                
 PCM について                                                                
 PCM 録音開始                                                                
 PCM 録音の強制停止                                                          
 PFキー割り込み処理ルーチンの登録                                            
 .PRB_chr                                                                    
 .PRB_remainbyte                                                             
 .PRB_status                                                                 
 .PRB_string                                                                 
                                                                             
●Ｒ                                                                         
 RS-232C インターフェース                                                    
 RS-MIDI ドライバの終了                                                      
 RS-MIDI ドライバの初期化                                                    
 .RSB_break                                                                  
 .RSB_chk                                                                    
 .RSB_close                                                                  
 .RSB_ctrl                                                                   
 .RSB_dtr                                                                    
 .RSB_initbuf                                                                
 .RSB_open                                                                   
 .RSB_rdint                                                                  
 .RSB_rdrpara                                                                
 .RSB_read                                                                   
 .RSB_receive                                                                
 .RSB_rsetpara                                                               
 .RSB_send                                                                   
 .RSB_setint                                                                 
 .RSB_setpara                                                                
 .RSB_status                                                                 
                                                                             
●Ｓ                                                                         
 sjisからJIS への変換                                                        
 .SND_elevol_all_mute                                                        
 .SND_elevol_init                                                            
 .SND_elevol_mute                                                            
 .SND_elevol_read                                                            
 .SND_elevol_set                                                             
 .SND_end                                                                    
 .SND_eup_bias_set                                                           
 .SND_eup_end                                                                
 .SND_eup_fixed_end                                                          
 .SND_eup_fixed_init                                                         
 .SND_eup_fixed_int                                                          
 .SND_eup_fixed_sub                                                          
 .SND_eup_init                                                               
 .SND_eup_int_set                                                            
 .SND_eup_loop_set                                                           
 .SND_eup_midi_ch_set                                                        
 .SND_eup_mute_set                                                           
 .SND_eup_play_int_get                                                       
 .SND_eup_play_int_set                                                       
 .SND_eup_play_pause                                                         
 .SND_eup_play_restart                                                       
 .SND_eup_play_start                                                         
 .SND_eup_play_stop                                                          
 .SND_eup_port_set                                                           
 .SND_eup_relative_tempo_get                                                 
 .SND_eup_relative_tempo_set                                                 
 .SND_eup_stat_clock                                                         
 .SND_eup_stat_flag                                                          
 .SND_eup_stat_meas                                                          
 .SND_eup_stat_ptr                                                           
 .SND_eup_stat_tempo                                                         
 .SND_eup_sync_out_set                                                       
 .SND_eup_tempo_set                                                          
 .SND_eup_transpose_set                                                      
 .SND_fm_bank_load                                                           
 .SND_fm_lfo_set                                                             
 .SND_fm_read_save_data                                                      
 .SND_fm_read_status                                                         
 .SND_fm_timer_a_set                                                         
 .SND_fm_timer_a_start                                                       
 .SND_fm_timer_b_set                                                         
 .SND_fm_timer_b_start                                                       
 .SND_fm_write_data                                                          
 .SND_fm_write_save_data                                                     
 .SND_get_elevol_mute                                                        
 .SND_get_elevol_set                                                         
 .SND_get_int_status                                                         
 .SND_init                                                                   
 .SND_inst_change                                                            
 .SND_inst_read                                                              
 .SND_inst_write                                                             
 .SND_int_timer_a_get                                                        
 .SND_int_timer_a_set                                                        
 .SND_int_timer_b_get                                                        
 .SND_int_timer_b_set                                                        
 .SND_int_timer_sub_get                                                      
 .SND_int_timer_sub_set                                                      
 .SND_joy_in_1                                                               
 .SND_joy_in_2                                                               
 .SND_joy_out                                                                
 .SND_key_abort                                                              
 .SND_key_off                                                                
 .SND_key_on                                                                 
 .SND_midi_ch_assign                                                         
 .SND_midi_read                                                              
 .SND_midi_write                                                             
 .SND_pan_set                                                                
 .SND_pcm_abort                                                              
 .SND_pcm_bank_load                                                          
 .SND_pcm_mode_get                                                           
 .SND_pcm_mode_set                                                           
 .SND_pcm_play                                                               
 .SND_pcm_play_rom                                                           
 .SND_pcm_play_stop                                                          
 .SND_pcm_play2                                                              
 .SND_pcm_rec                                                                
 .SND_pcm_rec_stop                                                           
 .SND_pcm_rec2                                                               
 .SND_pcm_sound_delete                                                       
 .SND_pcm_sound_get                                                          
 .SND_pcm_sound_ID_get                                                       
 .SND_pcm_sound_set                                                          
 .SND_pcm_status                                                             
 .SND_pcm_wave_set                                                           
 .SND_pitch_change                                                           
 .SND_rs_midi_end                                                            
 .SND_rs_midi_init                                                           
 .SND_status                                                                 
 .SND_volume_change                                                          
 .SPR_define                                                                 
 .SPR_display                                                                
 .SPR_init                                                                   
 .SPR_readAttribute                                                          
 .SPR_setAttribute                                                           
 .SPR_setMotion                                                              
 .SPR_setOffset                                                              
 .SPR_setPaletteBlock                                                        
 .SPR_setPosition                                                            
                                                                             
●Ｔ                                                                         
 .TIM_clrclock                                                               
 .TIM_clrtime                                                                
 .TIM_rdcalendar                                                             
 .TIM_rdtime                                                                 
 .TIM_setcalendar                                                            
 .TIM_setclock                                                               
 .TIM_settime                                                                
 TownsMENU V2.1メニュー色の書き込み                                          
 TownsMENU V2.1メニュー色の設定                                              
 TownsMENU V2.1メニュー色の設定2                                             
 TownsMENU V2.1メニュー色の読み取り                                          
                                                                             
●Ｖ                                                                         
 .VDB_areascroll                                                             
 .VDB_clrarea                                                                
 .VDB_cls                                                                    
 .VDB_cpyarea                                                                
 .VDB_init                                                                   
 .VDB_kind                                                                   
 .VDB_outchr                                                                 
 .VDB_outstr                                                                 
 .VDB_rdarea                                                                 
 .VDB_rdatr                                                                  
 .VDB_rdatrarea                                                              
 .VDB_rdbackground                                                           
 .VDB_rdchr                                                                  
 .VDB_rdcon                                                                  
 .VDB_rdcusmd                                                                
 .VDB_rdcustype                                                              
 .VDB_rddefatr                                                               
 .VDB_rdfont                                                                 
 .VDB_rdposcus                                                               
 .VDB_rdsize                                                                 
 .VDB_screensize                                                             
 .VDB_scroll                                                                 
 .VDB_setarea                                                                
 .VDB_setatr                                                                 
 .VDB_setchr                                                                 
 .VDB_setcon                                                                 
 .VDB_setcusmd                                                               
 .VDB_setcustype                                                             
 .VDB_setdefatr                                                              
 .VDB_setfont                                                                
 .VDB_setposcus                                                              
 .VDB_setsize                                                                
 .VDB_wtsysline                                                              
                                                                             
■和文                                                                       
                                                                             
●あ行                                                                       
 アセンブラからの使用方法                                                    
 アセンブラ言語のための関数                                                  
 アトリビュート機能範囲の読み取り                                            
 アトリビュートの設定                                                        
 アトリビュートの読み込み                                                    
 アトリビュートの読み取り                                                    
 アドレスのセット方法について                                                
 位置とボタンの読み取り                                                      
 位置の指定                                                                  
 位置の設定                                                                  
 移動距離の読み取り                                                          
 移動量の指定                                                                
 イベントルーチンの登録                                                      
 イベントルーチンの読み出し                                                  
 印刷開始位置の設定                                                          
 円                                                                          
 円弧                                                                        
 演奏アドレスの入手                                                          
 演奏一時停止                                                                
 演奏位置のクロック入手                                                      
 演奏位置の小節番号の入手                                                    
 .演奏開始                                                                   
 演奏再開                                                                    
 演奏状態の入手                                                              
 .演奏情報の取り出し                                                         
 演奏処理と同期して行う処理の取得                                            
 演奏処理と同期して行う処理の登録                                            
 .演奏停止                                                                   
 .演奏の一時停止                                                             
 .演奏の再開                                                                 
 扇形                                                                        
 オフセットの指定                                                            
 音楽演奏一時停止                                                            
 音楽演奏一時停止解除                                                        
 音楽演奏実行例                                                              
 音楽演奏状態の読み取り                                                      
 音楽演奏情報の読み取り (時間指定)                                           
 音楽演奏スタート (時間･回数指定)                                            
 音楽演奏スタート (時間指定)                                                 
 音楽演奏ストップ                                                            
 音源の定位の設定                                                            
 音源の発音開始                                                              
 音源の発音停止                                                              
 音源の発音の強制停止                                                        
 音声モード再生状態の入手                                                    
 音声モードのデータ形式                                                      
                                                                             
●か行                                                                       
 カーソル位置の指定                                                          
 カーソル位置の読み取り                                                      
 カーソル形状の設定                                                          
 カーソル形状の読み取り                                                      
 カーソル表示状態の設定                                                      
 カーソル表示状態の読み取り                                                  
 外字パターンの登録                                                          
 回線のオープン                                                              
 回線のクローズ                                                              
 回転多角形                                                                  
 書き込みページの指定                                                        
 書き込みページの読み取り                                                    
 各音源のMIDIチャンネル設定                                                  
 拡張DTR 信号の保持設定                                                      
 拡張割り込みの設定                                                          
 拡張割り込みの読み取り                                                      
 .各トラックのPLAY/MUTE設定                                                  
 .各トラックの出力MIDIチャンネルの設定                                       
 .各トラックの出力ポートの設定                                               
 .各トラックのトランスポーズの設定                                           
 各ポートからMIDIデータの入力                                                
 各ポートへのMIDIデータ列の出力                                              
 仮想画面の設定                                                              
 仮想画面の読み取り                                                          
 加速度検出機能の設定                                                        
 加速度検出機能の読み取り                                                    
 楽器モードのデータ構造                                                      
 画面の回転                                                                  
 画面の消去                                                                  
 画面の表示                                                                  
 画面の表示制御                                                              
 画面の複写                                                                  
 画面ぼかし                                                                  
 画面マスクの設定                                                            
 画面マスク領域の設定                                                        
 画面モードに関する情報の読み取り                                            
 漢字フォントのコピー                                                        
 漢字フォントの読み出し                                                      
 キーの割り当て                                                              
 キーの割り当て状態の読み取り                                                
 キーバイアスの設定                                                          
 キーボードインタフェース                                                    
 キーボードクリック音の制御                                                  
 キーボードロックの制御                                                      
 矩形                                                                        
 矩形域の消去                                                                
 矩形域の設定                                                                
 矩形域の複写                                                                
 矩形域の読み取り                                                            
 グラフィックオペレーション                                                  
 グラフィックカーソル                                                        
 グラフィック画面                                                            
 グラフィックライブラリ                                                      
 .繰り返しの設定                                                             
 クリップ枠                                                                  
 形状の設定                                                                  
 形状の設定(ｼｽﾃﾑｱｲｺﾝﾊﾟﾀｰﾝ)                                                   
 現在のテンポの入手                                                          
 構造体の説明                                                                
 コード系の設定                                                              
 コード系の読み取り                                                          
 .固定タイマモードのドライバの終了                                           
 .固定タイマモードのドライバの初期化                                         
 .固定タイマモードの割り込みエントリ                                         
 .固定タイマモードの割り出しエントリ                                         
 混色比率の設定                                                              
 コンソールインターフェース                                                  
 コンソール機能設定値の読み取り                                              
 コンソール機能の設定                                                        
 コントロールの取得                                                          
 コントロールの登録                                                          
 コンパクトディスク情報の読み取り                                            
                                                                             
●さ行                                                                       
 サウンドBIOSについて                                                        
 サウンド機能について                                                        
 サウンドライブラリ                                                          
 サブルーチンの登録                                                          
 サブルーチンの読み取り                                                      
 三角形                                                                      
 サンプリングについて                                                        
 シーク                                                                      
 システムアイコン一覧表                                                      
 システム行の書き込み                                                        
 字体の設定                                                                  
 指定位置へのシーク (時間指定)                                               
 指定位置へのシーク(論理セクタ指定)                                          
 指定時刻の割り込み処理の登録                                                
 指定時刻の割り込み処理の取り消し                                            
 シフトキー状態の読み取り                                                    
 受信バッファ内の有効データ数の読み取り                                      
 受信バッファの初期化                                                        
 出力MIDIチャンネルの設定                                                    
 出力ポートの設定                                                            
 出力モードの設定                                                            
 ジョイスティックポートの出力                                                
 ジョイスティックポートの読み込み                                            
 初期化                                                                      
 シリアルポートの検出                                                        
 シリアルポートの制御                                                        
 シリンダ0へのシーク                                                         
 垂直移動範囲指定                                                            
 垂直移動範囲読み取り                                                        
 垂直消去範囲の指定                                                          
 水平移動範囲指定                                                            
 水平移動範囲読み取り                                                        
 水平消去範囲の指定                                                          
 スーパーインポーズの設定                                                    
 ステータス情報の読み取り                                                    
 スプライト機能の仕様概要                                                    
 スプライトの機能                                                            
 スプライトの定義                                                            
 スプライトパターンメモリ                                                    
 スプライトライブラリ                                                        
 セクタIDの取り出し                                                          
 セクタの検査                                                                
 セッティングオペレーション                                                  
 全画面スクロール                                                            
 全画面の消去                                                                
 前景色                                                                      
 全サウンドIDの取得                                                          
 線分パターンの設定                                                          
 相対テンポの設定                                                            
 相対テンポの読み取り                                                        
                                                                             
●た行                                                                       
 タイマＡ割り込みの登録                                                      
 タイマＡ割り込みの読み込み                                                  
 タイマＢ割り込みの登録                                                      
 タイマＢ割り込みの読み込み                                                  
 タイマのカウント値の読み取り                                                
 .タイマの停止/始動                                                          
 タイマの登録                                                                
 タイマの取り消し                                                            
 タイマの読み込み                                                            
 タイマ割り出しの登録                                                        
 タイマ割り出しの読み込み                                                    
 タイルパターンの設定                                                        
 楕円                                                                        
 楕円弧                                                                      
 楕扇形                                                                      
 多角形                                                                      
 追加文字列                                                                  
 通信パラメータの設定                                                        
 ディジタイズ                                                                
 データ形式                                                                  
 データの書き込み                                                            
 データの受信                                                                
 データの送信                                                                
 データの読み出し                                                            
 データの読み取り (時間指定)                                                 
 データの読み取り(論理セクタ指定)                                            
 データリード実行例                                                          
 デフォルトアトリビュートの設定                                              
 デフォルトアトリビュートの読み取り                                          
 電子ボリューム全ミュート                                                    
 電子ボリュームの初期化                                                      
 電子ボリュームの設定                                                        
 電子ボリュームの設定状態読み込み                                            
 電子ボリュームの使い方                                                      
 電子ボリュームの読み込み                                                    
 電子ボリュームのミュート                                                    
 電子ボリュームのミュート状態の読み込み                                      
 .テンポの設定                                                               
 透過色                                                                      
 動作開始                                                                    
 動作終了                                                                    
 動作状態の読み取り                                                          
 時計サポート                                                                
 ドットデータ/ドットパターン                                                 
 ドットデータの書き込み                                                      
 ドットデータの読み込み                                                      
 .ドライバの終了                                                             
 .ドライバの初期化                                                           
 ドライブステータス情報の取り出し                                            
 ドライブステータス情報の読み取り                                            
 ドライブモードの設定                                                        
 ドライブモードの取り出し                                                    
 ドライブモードの読み取り                                                    
 トランスポーズの設定                                                        
                                                                             
●な行                                                                       
 .内蔵音源のMIDIチャンネル設定                                               
 入力のチェック                                                              
 入力文字列の追加                                                            
 任意文字表示                                                                
 音色の書き込み                                                              
 音色の変更                                                                  
 音色の読み込み                                                              
                                                                             
●は行                                                                       
 ハードコピーの開始                                                          
 ハードコピーの終了                                                          
 ハードコピーライブラリ                                                      
 ハードコピーライブラリについて                                              
 ハード座標空間                                                              
 ハード座標系                                                                
 ハードディスクコントローラのリセット                                        
 .バイアスの設定                                                             
 背景色                                                                      
 背景色の読み取り                                                            
 ハッチングパターンの設定                                                    
 バッファのクリア                                                            
 バッファリング機能の設定                                                    
 パラメータ型の記号                                                          
 バルス数/画素比の設定                                                       
 パルス数/画素比の読み取り                                                   
 パレットの読み取り                                                          
 パレットブロックの設定                                                      
 パレットレジスタ                                                            
 パレットレジスタの設定                                                      
 ピクセルビット構成                                                          
 日付/時刻の設定                                                             
 日付/時刻の読み取り                                                         
 ピッチベンド                                                                
 ビューポートの設定                                                          
 描画演算の一覧                                                              
 描画色の設定                                                                
 描画モードの設定                                                            
 表示/消去                                                                   
 表示/消去状態の読み取り                                                     
 表示開始位置の設定                                                          
 表示開始位置の読み取り                                                      
 表示画面サイズの設定                                                        
 表示画面サイズの読み取り                                                    
 表示画面サイズレパートリの読み取り                                          
 表示色の設定                                                                
 表示ページの指定                                                            
 表示ページの読み取り                                                        
 フォントオペレーション                                                      
 フォントパターンの取り出し                                                  
 フォントライブラリ                                                          
 ブザー　ＯＦＦ                                                              
 ブザー　ＯＮ                                                                
 ブザー (一定時間)ON                                                         
 ブザー (カウンタ数、指定時間)ON                                             
 ブザー (周波数、指定時間)ON                                                 
 ブザー(BEEP 音) インターフェース                                            
 ブザー情報の読み取り                                                        
 部分画面スクロール                                                          
 部分スクロール                                                              
 プリンタインターフェース                                                    
 プリンタ状態の読み取り                                                      
 ブレーク信号の送信                                                          
 不連続線分                                                                  
 ブロックオペレーション                                                      
 ペイント                                                                    
 ページとピクセル                                                            
 ヘッダファイルｃｄｒｆｒｂ.ｈについて                                       
 ペン形状の設定                                                              
 ペンの設定                                                                  
 ペンの太さの設定                                                            
 ポイント                                                                    
 ポイント識別                                                                
 補助記憶装置サポート                                                        
 ボタン左右入れ換え                                                          
 ボタン左右入れ換え状態の読み取り                                            
 ボタンの押下情報の読み取り                                                  
 ボタンの解放情報の読み取り                                                  
 ボリューム変更                                                              
                                                                             
●ま行                                                                       
 マウスとの併用時の注意                                                      
 マウスライブラリ                                                            
 マスク処理                                                                  
 マスクデータの書き込み                                                      
 マスクビットの設定                                                          
 マトリクス入力                                                              
 未印字バイト数の読み取り                                                    
 ミュートの設定                                                              
 面塗色                                                                      
 面塗りモードの設定                                                          
 文字拡大率の設定                                                            
 文字間空白の設定                                                            
 文字の出力                                                                  
 文字の設定                                                                  
 文字の読み込み                                                              
 文字の読み取り                                                              
 文字表示方向の設定                                                          
 文字方向の設定                                                              
 文字列                                                                      
 文字列の出力                                                                
                                                                             
●や行                                                                       
 ユーザー指定stack領域にstackをchangeさせ、指定関数を起動                    
 優先順位処理                                                                
 弓形                                                                        
                                                                             
●ら行                                                                       
 リアルPFキー割り込み処理ルーチンの登録                                      
 リアルPFキーの割り込み処理ルーチンの読み取り                                
 リアル通信パラメータの設定                                                  
 リアル通信パラメータの読み取り                                              
 リーディングオペレーション                                                  
 領域の設定                                                                  
 ループフラグの設定                                                          
 連続線分                                                                    
                                                                             
●わ行                                                                       
 割り込み処理登録状況の取得                                                  
 割り込み処理の許可/禁止                                                     
 .割り出し処理フラグの設定                                                   
                                                                             
*****************************************************************************
第1章　グラフィックライブラリ                                                
*****************************************************************************
                                                                             
 1.　グラフィックライブラリについて                                          
                                                                             
  1.1　概要                                                                  
                                                                             
  グラフィックライブラリは次の5つに分類されます。                            
   ･セッティングオペレーション                                               
   ･ブロックオペレーション                                                   
   ･グラフィックオペレーション                                               
   ･フォントオペレーション                                                   
   ･リーディングオペレーション                                               
  各オペレーションについて解説を行います。                                   
  また、グラフィックライブラリを使用したサンプルプログラムにより、実際の使用 
方法を紹介します。                                                           
                                                                             
  1.2　描画演算の一覧                                                        
                                                                             
┌───────┬────────────────────────────┐ 
│　演　算　名　│　　　　　　　　　内　　　　　　　　　容　　　　　　　　│ 
├───────┼────────────────────────────┤ 
│PSET　　　　　│描画図形の色識別番号が描画対象となります。　　　　　　　│ 
├───────┼────────────────────────────┤ 
│PRESET　　　　│背景色が描画対象となります。　　　　　　　　　　　　　　│ 
├───────┼────────────────────────────┤ 
│OR　　　　　　│描画図形の色識別番号とこれから描画しようとする位置の色識│ 
│　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　　│別番号と論理和を行った結果となります。　　　　　　　　　│ 
├───────┼────────────────────────────┤ 
│AND 　　　　　│描画図形の色識別番号とこれから描画しようとする位置の色識│ 
│　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　　│別番号と論理積を行った結果となります。　　　　　　　　　│ 
├───────┼────────────────────────────┤ 
│XOR 　　　　　│描画図形の色識別番号とこれから描画しようとする位置の色識│ 
│　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　　│別番号と排他的論理和を行った結果となります。　　　　　　│ 
├───────┼────────────────────────────┤ 
│NOT 　　　　　│描画図形のデータを反転したデータで描画します。　　　　　│ 
├───────┼────────────────────────────┤ 
│MATTE(ﾏｯﾄ)　　│描画図形のデータの中から透過色の色識別番号のデータを取り│ 
│　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　　│除いたデータで描画します。　　　　　　　　　　　　　　　│ 
├───────┼────────────────────────────┤ 
│PASTEL(ﾊﾟｽﾃﾙ) │描画図形の色識別番号とこれから描画しようとする位置の色識│ 
│　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　　│別番号と数値演算を行った結果となります。　　　　　　　　│ 
├───────┼────────────────────────────┤ 
│OPAQUE(ｵﾍﾟｲｸ) │描画図形のデータのbit"0"を背景色描画し、bit"1"をPSET描画│ 
│　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　　│します。　　　　　　　　　　　　　　　　　　　　　　　　│ 
├───────┼────────────────────────────┤ 
│IMPSET　　　　│スーパーインポーズビットを '1'に設定します。　　　　　　│ 
├───────┼────────────────────────────┤ 
│IMPRESET　　　│スーパーインポーズビットを '0'に設定します。　　　　　　│ 
├───────┼────────────────────────────┤ 
│IMPNOT　　　　│スーパーインポーズビットを反転します。　　　　　　　　　│ 
├───────┼────────────────────────────┤ 
│MASKSET 　　　│画面マスク領域のビットを '1'に設定します。　　　　　　　│ 
├───────┼────────────────────────────┤ 
│MASKRESET 　　│画面マスク領域のビットを '0'に設定します。　　　　　　　│ 
├───────┼────────────────────────────┤ 
│MASKNOT 　　　│画面マスク領域のビットを反転します。　　　　　　　　　　│ 
└───────┴────────────────────────────┘ 
                                                                             
  1.3　パラメータ型の記号                                                    
                                                                             
┌──┬────────────┬────────────────────┐ 
│記号│ 　　正　規　表　現　　 │　　　　　　　 意　　 　　味　　　　　　│ 
├──┼────────────┼────────────────────┤ 
│ Ｂ │　byte　　　　　　　　　│1バイト(8bit)データ　　　　　　　　　　 │ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　符号無し（0〜255 ）　　　　　　　 │ 
├──┼────────────┼────────────────────┤ 
│ Ｗ │　word　　　　　　　　　│2バイト(16bit) データ　　　　　　　　　 │ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　符号無し（0〜65,535）　　　　　　 │ 
├──┼────────────┼────────────────────┤ 
│ Ｄ │　double word 　　　　　│4バイト(32bit) データ　　　　　　　　　 │ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　符号無し（0〜4,294,967,296 ）　　 │ 
├──┼────────────┼────────────────────┤ 
│ SB │　signed byte 　　　　　│1バイト(8bit)データ　　　　　　　　　 　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　符号有り（-128〜127 ）　　　　　　│ 
├──┼────────────┼────────────────────┤ 
│ SW │　signed word 　　　　　│2バイト(16bit) データ　　　　　　　　 　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　符号有り（-32768〜32767 ）　　　　│ 
├──┼────────────┼────────────────────┤ 
│ SD │　signed double word　　│4バイト(32bit) データ　　　　　　　　 　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　符号有り（-2147483648 〜2147483647）│ 
├──┼────────────┼────────────────────┤ 
│ BA │　byte array　　　　　　│1バイト(8bit)データの配列　　　　　　 　│ 
├──┼────────────┼────────────────────┤ 
│ WA │　word array　　　　　　│2バイト(16bit) データの配列　　　　　 　│ 
├──┼────────────┼────────────────────┤ 
│ DA │　double word array 　　│4バイト(32bit) データの配列　　　　　 　│ 
├──┼────────────┼────────────────────┤ 
│ FI │　fixed point 　　　　　│4バイト(32bit) 固定小数点データ　　　 　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　符号有り（-32768.9〜32767.9)　　　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　 31 　　　　　　16 15 　　　　　　0 　│ 
│　　│　　　　　　　　　　　　│　┌────────┬───────┐　│ 
│　　│　　　　　　　　　　　　│　│　　　　　　　　　　　　　　　　│　│ 
│　　│　　　　　　　　　　　　│　│　　　 signed double word 　　　│　│ 
│　　│　　　　　　　　　　　　│　│　　　　　　　　　　　　　　　　│　│ 
│　　│　　　　　　　　　　　　│　└────────┴───────┘　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　↑　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　小数点位置　　　　　　│ 
│　　│　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　│ 
└──┴────────────┴────────────────────┘ 
                                                                             
(1) スタックサイズ                                                           
　EGBのグラフィック機能では、複雑な図形を処理するために、通常使用のスタック  
よりも大きなスタックを必要とする場合があります。スタックサイズの目安は、次の 
とおりです。                                                                 
                                                                             
  ･セッティングオペレーション、ブロックオペレーション、リーディングオペレー  
   ション:特に必要ありません。                                               
  ･グラフィックオペレーション、フォントオペレーション:仮想画面横ドット数÷8  
   ×仮想画面縦ドット数を必要とします。                                      
                                                                             
- 例 -                                                                       
画面モード番号3の場合                                                        
スタックサイズ=仮想画面横ドット数÷8×仮想画面縦ドット数                     
　　　　　　　=1024÷8×512                                                  
　　　　　　　=65536                                                         
                                                                             
  ただし、pset、presetの線･文字(文字飾り無し)描画でmask無効の場合は必要あり  
ません。以下の場合には、さらに増加します。                                   
　　paint 　……6KB加算                                                      
　　polygon ……5KB加算                                                      
                                                                             
(2) データ領域                                                               
　EGBで扱えるデータ領域は、セレクタ境界をまたぐような使用法はできません。    
またセレクタ境界も使用することができません。セレクタ境界から4byte            
(1double word) 以上離して設定してください。                                  
                                                                             
図CL21R-001                                                                  
                                                                             
  1.4　グラフィック画面                                                      
                                                                             
　ここでは、図形が表示(描画)される画面:グラフィック画面について、基本的な機  
能や用語を説明します。なお、以後の解説では、グラフィック画面を"画面"と略記   
します。                                                                     
                                                                             
■ハード座標系･ハード座標空間                                                
　EGBは、画素(画面上に表示している色の最小範囲の領域)の色を指定することによ  
り、図形を描画します。この画素の色を表すデータは色識別番号と呼び、1ダブル    
ワード(4バイト)のデータとして表現します。実際には、表示可能な色数がハードウ  
ェアの能力に依存するため、色識別番号に指定できる値は、後述のピクセルの持つ   
ビット数により決まります。なお、画面の縦･横方向の画素数を解像度と呼びます。  
この解像度も、ハードウェアにより異なります。                                 
　画面上の各画素の位置は、画面上の左上端の画素を原点(0 ,0)として、X軸の正方  
向が右向きで、Y軸の正方向が下向きの座標系で表現します。この座標系をハードウ  
ェア座標系と呼びます(以後の解説では、略記してハード座標系とします)。         
                                                                             
　　　　　　　┌────────────┐                                   
　原点(0,0) 　→■□□□□　□□□□□■←(Xmax-1,0)　　─→　Ｘ方向         
　　　　　　　│□□□□□　□□□□□□│                                   
　　　　　　　│□□□□□　□□□□□□│                                   
　　　　　　　│□□□□□　□□□□□□│                                   
　　　　　　　│□□□□□　□□□□□□│                                   
　　　　　　　〜　　　　　　　　　　　　〜                                   
　　　　　　　│□□□□□　□□□□□□│                                   
　　　　　　　│□□□□□　□□□□□□│                                   
　(0,Ymax-1)　→■□□□□　□□□□□■←(Xmax-1,Ymax-1) 　□、■:画素      
　　　　　　　└│───────────┘　　　　　　 　 Xmax:横方向の解像度
　　　　　　　　↓Ｙ方向　　　　　　　　　　　　　　　　　Ymax:縦方向の解度  
                                                                             
　EGBでは、画面外での領域(仮想空間)をサポートしています。扱える座標空間は、符
号付15ビット整数(内部16ビット)(-16384〜+16383)で表される範囲です。           
                                                                             
図CL21R-002                                                                  
                                                                             
■ページとピクセル                                                           
　画面の画素データ(色識別番号)は、通常プログラムやデータが格納されるメモリと 
は異なり、グラフィックVRAMと呼ばれる特殊なメモリに格納されます。EGBでは、解像
度に応じてグラフィックVRAMを分割して、解像度分のグラフィックVRAMをページと呼 
びます。各ページは、ページ番号を付けて管理します。                           
　ページは、ピクセルの集合です。1画素は1ピクセルに対応し、1ピクセルは色識別ビ
ットの集合であり、その組み合わせにより色識別番号を構成します。1ピクセルのビッ
ト数はハードウェアに依存し、ハードウェアに存在するビット数が下位のビットから 
有効になります。                                                             
              31                                                    0        
            ┌────────〜─────────────────┬─┐     
1ﾋﾞｯﾄﾋﾟｸｾﾙ  │    無効                                            │○│     
            └────────〜─────────────────┴─┘     
              31                              　  　4　  3　 2   1 　0       
            ┌────────〜───────────┬─┬─┬─┬─┐     
4ﾋﾞｯﾄﾋﾟｸｾﾙ  │    無効                            　　│○│○│○│○│     
            └────────〜───────────┴─┴─┴─┴─┘     
              31                  8　7　6　                　     1  0       
            ┌──────〜────┬─┬─┬──〜─────┬─┬─┐     
8ﾋﾞｯﾄﾋﾟｸｾﾙ  │    無効              │○│○│                │○│○│     
            └──────〜────┴─┴─┴──〜─────┴─┴─┘     
              31                  16　15　14　                　 1   0       
            ┌──────〜────┬─┬─┬──〜─────┬─┬─┐     
16ﾋﾞｯﾄﾋﾟｸｾﾙ │    無効              │○│○│                │○│○│     
            └──────〜────┴─┴─┴──〜─────┴─┴─┘     
              31            24  23  22　                      　 1   0       
            ┌───〜────┬─┬─┬─────〜─────┬─┬─┐     
24ﾋﾞｯﾄﾋﾟｸｾﾙ │    無効        │○│○│                      │○│○│     
            └───〜────┴─┴─┴─────〜─────┴─┴─┘     
              31            24  23  22　                      　 1   0       
            ┌───〜────┬─┬─┬─────〜─────┬─┬─┐     
32ﾋﾞｯﾄﾋﾟｸｾﾙ │    不定        │○│○│                      │○│○│     
            └───〜────┴─┴─┴─────〜─────┴─┴─┘     
                                      色識別番号                             
                                                                             
　EGBでは、ハードウェアが複数のページを持つ場合、ディスプレイに表示するページ
(表示ページ)と図形を描画するページ(書き込みページ)を独立に指定すること(別々の
ページあるいは同一のページに指定すること)ができます。ただし、書き込みページは
一度に1ページのみの指定となりますが、表示ページはハードウェアで表示可能な限り
の複数ページが指定可能です。                                                 
                                                                             
図CL21R-003                                                                  
                                                                             
■ドットデータ/ドットパターン                                                
　EGBでは、色に関係するデータをドットデータと呼びます。例えば、線や文字などの
描画位置を表すビット列も、ドットデータの1つです。特に、このドットデータは、模
様(パターン)を表すため、ドットパターンと呼びます。                           
                                                                             
   文字パターン                                                              
  □□□■■□□□               点線パターン                                
  □□■□□■□□            ■■■□■■■□■■■□■■■□               
  □■□□□□■□                                                           
  □■■■■■■□                                                           
  □■□□□□■□                                                           
  □■□□□□■□                                                           
  □■□□□□■□                                                           
  □□□□□□□□                                                           
                                                                             
                                                                             
■パレットレジスタ                                                           
　色識別番号は、ディスプレイに表示される色(白や黒など)を直接指定しているわけ 
ではなく、パレットレジスタと呼ばれるハードウェアに対応(ハードウェア依存)して 
います。パレットレジスタは、ディスプレイに表示する実際の色(赤や緑など)を保持 
します。このパレットレジスタのレジスタ番号は色識別番号と同一な値であり、画素 
の表示は色識別番号に対応するパレットレジスタの値(色)をディスプレイに表示する 
ことになります。EGBでは、IGRBの輝度＋3原色の階調を各々指定することにより、こ 
のパレットレジスタの機能をサポートしており、各原色に対して256階調までの指定が
可能です。                                                                   
                                                                             
■前景色･背景色･面塗色･透過色                                                
　EGBではドットパターンのビットが"1"になっているところは前景色で、ビットが"0"
になっているところは背景色で、描画を行います。前景色および背景色には、ベタ塗 
り･タイル塗り･ハッチング塗りの3種があり、以下の組み合わせにより、描画色を決定
します。                                                                     
                                                                             
　　･ベタ塗り                                                                
　　･タイル塗り                                                              
　　･ベタ塗り＋ハッチング塗り                                                
　　･タイル塗り＋ハッチング塗り                                              
                                                                             
　閉領域である図形は、境界と内部を別の色で塗り分けることができます。境界は前 
景色で、内部は面塗色で表すことができます。またEGBでは、matte(マット･透過)の描
画の機能があります。この時、パターンに存在しても、描画の対象とならない色を透 
過色としています。                                                           
                                                                             
■クリップ枠                                                                 
　EGBでは、描画範囲を限定するためのクリップ枠を設定する機能として、ビューポー
トとマスクがあります。ビューポートは矩形内の描画を対象とするためのクリップで 
あり、マスクは任意図形のクリップをするための機能です。クリップ枠は、すべての 
描画機能に対して有効です。                                                   
                                                                             
  1.5　ピクセルビット構成(デフォルト値)                                      
                                                                             
　　　　　　　　　　31　　　　　　　　　　　　　　　　　　　　　　0          
　　　　　　　　　┌──────────────────────┬─┐       
 1ビットピクセル　│　　　　無効  　　　　　　　　　　　　　　　│　│       
　　　　　　　　　└──────────────────────┴┬┘       
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│         
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　Intencity    
                                                                             
　　　　　　　　　　31　　　　　　　　　　　　　　　　 3　 2　 1　 0         
　　　　　　　　　┌────────────────┬─┬─┬─┬─┐       
 4ビットピクセル　│　　　　無効  　　　　　　　　　│　│　│　│　│       
　　　　　　　　　└────────────────┴┬┴┬┴┬┴┬┘       
（パレットによる変更可能）　　　　　　　　　　　　　　│　│　│　│         
　　　　　　　　　　　　　　　　　　　　　　　　　　　│　│　│　Blue       
　　　　　　　　　　　　　　　　　　　　　　　　　　　│　│　Red            
　　　　　　　　　　　　　　　　　　　　　　　　　　　│　Green              
　　　　　　　　　　　　　　　　　　　　　　　　　　 Intencity               
                                                                             
　　　　　　　　　　31　　　　　　　　　　　　　7 6 5 　4 3 2 　1  0         
　　　　　　　　　┌─────────────┬───┬───┬──┐       
 8ビットピクセル　│　無効  　　　　　　　　　│　　　│　　　│　　│       
　　　　　　　　　└─────────────┴┬┬┬┴┬┬┬┴┬┬┘       
（パレットによる変更可能）　　　　　　　　　　　│││　│││　││         
　　　　　　　　　　　　　　　　　　　　　　　　│││　│││　Blue 1･0     
　　　　　　　　　　　　　　　　　　　　　　　　│││　Red 2･1･0            
　　　　　　　　　　　　　　　　　　　　　　　 Green 2･1･0                   
                                                                             
　　　　　　　　　　31　　　　15　14　　　10　9 　　　 5　4 　　　0          
　　　　　　　　　┌────┬─┬─────┬─────┬─────┐       
16ビットピクセル　│　無効  │　│　　　　　│　　　　　│　　　　　│       
　　　　　　　　　└────┴┬┴┬┬┬┬┬┴┬┬┬┬┬┴┬┬┬┬┬┘       
　　　　　　　　　　　　　　　│　│││││　│││││　│││││         
　　　　　　　　　　　　　　　│　│││││　│││││　Blue 4･3･2･1･0     
　　　　　　　　　　　　　　　│　│││││　Red  4･3･2･1･0                 
　　　　　　　　　　　　　　　│ Green 4･3･2･1･0                             
　　　　　　　　　　　　　　 Super impose                                    


24ビットピクセル                                                             
　　 31　　 24  23          　16　15　　         8　7 　  　  　　 0         
　　┌────┬────────┬────────┬────────┐       
  　│　無効  │　              │　　　　　  　　│　　　　　　　　│       
　　└────┴┬┬┬┬┬┬┬┬┴┬┬┬┬┬┬┬┬┴┬┬┬┬┬┬┬┬┘       
　　　　　　　　││││││││　││││││││　││││││││         
　　　　　　　　││││││││　││││││││　Red 7･6･5･4･3･2･1･0      
　　　　　　　　││││││││　Green 7･6･5･4･3･2･1･0                      
　　　　　　　 Blue 7･6･5･4･3･2･1･0                             

32ビットピクセル                                                             
　　 31　　 24  23          　16　15　　         8　7 　  　  　　 0         
　　┌────┬────────┬────────┬────────┐       
  　│　不定  │　              │　　　　　  　　│　　　　　　　　│       
　　└────┴┬┬┬┬┬┬┬┬┴┬┬┬┬┬┬┬┬┴┬┬┬┬┬┬┬┬┘       
　　　　　　　　││││││││　││││││││　││││││││         
　　　　　　　　││││││││　││││││││　Red 7･6･5･4･3･2･1･0      
　　　　　　　　││││││││　Green 7･6･5･4･3･2･1･0                      
　　　　　　　 Blue 7･6･5･4･3･2･1･0                             

図CL21R-004                                                                  
                                                                             
 2.　グラフィックライブラリ                                                  
                                                                             
  2.1　サンプルプログラム                                                    
┌───────────────────────────────────┐   
│　グラフィックライブラリサンプルプログラム　1　　　　　　　　 　　　　│   
│　- 機能 -　画面描画を行い､矩形の移動を行います｡      　　　 　　　 　│   
└───────────────────────────────────┘   
                                                                             
#include <stdlib.h>
#include <string.h>
#include <msdos.cf>
#include <egb.h>
#include <mos.h>

#define PIXEL  8                                   //  ピクセル数
#define PAGE   1                                   //  総ページ数（１or２）
#define WPAGE  0                                   //  書き込みページ
#define XDOT   128                                 //  移動矩形サイズＸ
#define YDOT   128                                 //  移動矩形サイズＹ

char    egb_work[EgbWorkSize];                     //  ＥＧＢ作業領域
char    mos_work[MosWorkSizeFullColor];            //  ＭＯＳ作業領域

void main()
{
    RESOLUTION  buf[PAGE];
    char        para[16];
    char        pal[PAGE*8];
    char        *putbuf;
    int         i,b,r,g,tr,x,y,xx,yy,addx,addy;
    int         col,handle,length;

    if ( PIXEL == 4 )
        length = (XDOT+7)/8*PIXEL*YDOT;            //  16色モード専用処理
    else
        length = XDOT*PIXEL/8*YDOT;                //  その他の色モード
    if ( ( putbuf = malloc( length ) ) == 0 )      //  作業領域が確保できない
        exit( -1 );

    DWORD( para+0 ) = PAGE;                        //  総ページ数
    DWORD( para+4 ) = PIXEL;                       //  ページ０のピクセル数
    if ( PAGE == 2 )
        DWORD( para+8 ) = PIXEL;                   //  ページ１のピクセル数
    else
        DWORD( para+8 ) = 0;
    handle = EGB_getResolutionMax( 0,para,buf );   //  最大解像度の取得
    if ( handle == -1 )                            //  最大解像度が存在しない
        exit( -1 );
    MOS_start( mos_work,MosWorkSizeFullColor );    //  マウスＢＩＯＳ初期化
    EGB_resolutionHandle( egb_work,0,handle );     //  仮想画面の設定
    MOS_resolutionHandle( handle );                //  マウス仮想画面の設定
    EGB_displayPage( egb_work,WPAGE,WPAGE+1 );     //  表示ページの設定
    EGB_writePage( egb_work,WPAGE );               //  書き込みページの設定

    EGB_paintMode( egb_work,0x20 );                //  面塗をベタ塗りに指定
    EGB_colorIGRB( egb_work,1,0 );                 //  背景色設定
    EGB_clearScreen( egb_work );                   //  画面クリア

    memset( pal,0,PAGE*8 );                        //  取得用配列をクリア
    EGB_getActivePalette( handle,pal );            //  パレット有効ビット取得
    if ( pal[0] != 0 ){                            //  パレットが有効なら
        b = r = g = 0;                             //  階調初期化
        for ( i=0 ; i<=(int)pal[0] ; i++ ){
            DWORD( para+0  ) = 1;                  //  パレット設定個数
            DWORD( para+4  ) = i;                  //  色識別番号
             BYTE( para+8  ) = b;                  //  青の階調
             BYTE( para+9  ) = r;                  //  赤の階調
             BYTE( para+10 ) = g;                  //  緑の階調
             BYTE( para+11 ) = 0;
            EGB_palette( egb_work,0,para );        //  グレイ・スケールに
            b += (int)pal[4];                      //  青の最小値加算
            r += (int)pal[5];                      //  赤の最小値加算
            g += (int)pal[6];                      //  緑の最小値加算
            }
        }
    EGB_paintMode( egb_work,0x02 );                //  境界をベタ塗りに指定
    i = 0;                                         //  描画色初期化
    for ( y=0 ; y<YDOT ; y++ ){
        col = i;                                   //  描画色設定
        for ( x=0 ; x<XDOT ; x++ ){
            if ( pal[0] != 0 )                     //  パレットが有効なら
                EGB_color( egb_work,0,col );       //  色識別番号で前景色設定
            else                                   //  パレットが無効なら
                EGB_colorIGRB( egb_work,0,col );   //  ＩＧＲＢで前景色設定
            WORD( para+0 ) = 1;                    //  座標点数
            WORD( para+2 ) = x;                    //  Ｘ座標
            WORD( para+4 ) = y;                    //  Ｙ座標
            EGB_pset( egb_work,para );             //  ポイント
            col = ( col + 0x010101 ) & 0xffffff;   //  描画色加算
            }
        i = ( i + 0x010101 ) & 0xffffff;           //  １ライン毎に色をずらす
        }

    xx = yy = 0;                                   //  始点初期化
    addx = addy = 1;                               //  座標加算値初期化
    DWORD( para+0  ) = (unsigned int)putbuf;       //  データ格納領域アドレス
     WORD( para+4  ) = getds();                    //  データ格納領域セレクタ
     WORD( para+6  ) = xx;
     WORD( para+8  ) = yy;
     WORD( para+10 ) = xx+XDOT-1;
     WORD( para+12 ) = yy+YDOT-1;
    EGB_getBlock( egb_work,para );                 //  ドットデータの読み込み
    do {
        xx += addx;                                //  始点Ｘ加算
        yy += addy;                                //  始点Ｙ加算
        if ( xx >= buf[WPAGE].dx-XDOT+1 )          //  始点Ｘ>=表示画面Ｘ
            addx = -1;                             //  加算値を負の値に
        if ( yy >= buf[WPAGE].dy-YDOT+1 )          //  始点Ｙ>=表示画面Ｙ
            addy = -1;                             //  加算値を負の値に
        if ( xx <= 0 )                             //  始点Ｘ<=０
            addx = 1;                              //  加算値を正の値に
        if ( yy <= 0 )                             //  始点Ｙ<=０
            addy = 1;                              //  加算値を正の値に
        DWORD( para+0  ) = (unsigned int)putbuf;   //  データ格納領域アドレス
         WORD( para+4  ) = getds();                //  データ格納領域セレクタ
         WORD( para+6  ) = xx;
         WORD( para+8  ) = yy;
         WORD( para+10 ) = xx+XDOT-1;
         WORD( para+12 ) = yy+YDOT-1;
        EGB_putBlock( egb_work,0,para );           //  ドットデータの書き込み
        MOS_rdpos( &tr,&x,&y );                    //  位置とボタンの読み取り
        } while ( tr == 0x00 );                    //  左右ボタンをチェック

    free( putbuf );                                //  作業領域の開放
    MOS_end();                                     //  マウス動作終了
}
                                                                             
  2.2　関数一覧                                                              
                                                                             
   2.2.1　セッティングオペレーション                                         
┌─────────────┬─────────────────┐           
│　　　  関　数　名　　　　│　　　　機　　　　　能　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_init　　　　　　　　　│初期化　　　　　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_resolution　　　　　　│　　　　　　　　　　　　　　　　　│           
│　　　　　　　　　　　　　│仮想画面の設定　　　　　　　　　　│           
│EGB_resolutionRam 　　　　│　　　　　　　　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_displayStart　　　　　│表示開始位置の設定　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_viewport　　　　　　　│ビューポートの設定　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_palette 　　　　　　　│パレットレジスタの設定　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_writePage 　　　　　　│書き込みページの指定　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_displayPage 　　　　　│表示ページの指定　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_color 　　　　　　　　│描画色の設定　　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_colorIGRB 　　　　　　│描画色の設定1　　　　　　　　　 　│           
├─────────────┼─────────────────┤           
│EGB_pastel　　　　　　　　│混色比率の設定　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_writeMode 　　　　　　│描画モードの設定　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_linePattern 　　　　　│線分パターンの設定　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_paintMode 　　　　　　│面塗りモードの設定　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_hatchingPattern 　　　│ハッチングパターンの設定　　　　　│           
├─────────────┼─────────────────┤           
│EGB_tilePattern 　　　　　│タイルパターンの設定　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_maskRegion　　　　　　│画面マスク領域の設定　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_mask　　　　　　　　　│画面マスクの設定　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_pen 　　　　　　　　　│ペンの設定　　　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_penSize 　　　　　　　│ペンの太さの設定　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_penStyle　　　　　　　│ペン形状の設定　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_maskBit 　　　　　　　│マスクビットの設定　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_textDirection 　　　　│文字方向の設定　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_textDisplayDirection　│文字表示方向の設定　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_textSpace 　　　　　　│文字間空白の設定　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_textZoom　　　　　　　│文字拡大率の設定　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_fontStyle 　　　　　　│字体の設定　　　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_superImpose 　　　　　│スーパーインポーズの設定　　　　　│           
├─────────────┼─────────────────┤           
│EGB_digitize　　　　　　　│ディジタイズ　　　　　　　　　　　│           
├─────────────┼─────────────────┤           
│EGB_tmenuPalette　　　　　│TownsMENU V2.1メニュー色の設定　　│           
├─────────────┼─────────────────┤           
│EGB_tmenuPalette2 　　　　│TownsMENU V2.1メニュー色の設定2 　│           
├─────────────┼─────────────────┤           
│EGB_setTmenuPalette 　　　│TownsMENU V2.1メニュー色の書き込み│           
└─────────────┴─────────────────┘           
                                                                             
   2.2.2　リーディングオペレーション                                         
                                                                             
┌────────────┬──────────────────┐           
│　　　 関　数　名　　　 │　　　　　機　　　　　能　　　　　　│           
├────────────┼──────────────────┤           
│EGB_getResolution 　　　│仮想画面の読み取り　　　　　　　　　│           
├────────────┼──────────────────┤           
│EGB_getWritePage　　　　│書き込みページの読み取り　　　　　　│           
├────────────┼──────────────────┤           
│EGB_getDisplayPage　　　│表示ページの読み取り　　　　　　　　│           
├────────────┼──────────────────┤           
│EGB_getDisplayStart 　　│表示開始位置の読み取り　　　　　　　│           
├────────────┼──────────────────┤           
│EGB_getPalette　　　　　│パレットの読み取り　　　　　　　　　│           
├────────────┼──────────────────┤           
│EGB_getTmenuPalette 　　│TownsMENU V2.1メニュー色の読み取り　│           
├────────────┼──────────────────┤           
│EGB_getModeInfo 　　　　│画面モードに関する情報の読み取り　　│           
└────────────┴──────────────────┘           
                                                                             
   2.2.3　ブロックオペレーション                                             
                                                                             
┌────────────┬────────────────┐               
│　　　　関　数　名　　　│　　　　　機　　　　　能　　　　│               
├────────────┼────────────────┤               
│EGB_clearScreen 　　　　│全画面の消去　　　　　　　　　　│               
├────────────┼────────────────┤               
│EGB_partClearScreen 　　│画面の消去　　　　　　　　　　　│               
├────────────┼────────────────┤               
│EGB_getBlockColor 　　　│ドットデータの読み込み　　　　　│               
├────────────┼────────────────┤               
│EGB_putBlockColor 　　　│ドットデータの書き込み　　　　　│               
├────────────┼────────────────┤               
│EGB_getBlock　　　　　　│ドットデータの読み込み1　　　　 │               
├────────────┼────────────────┤               
│EGB_putBlock　　　　　　│ドットデータの書き込み1　　　　 │               
├────────────┼────────────────┤               
│EGB_getBlockZoom　　　　│ドットデータの読み込み2　　　　 │               
├────────────┼────────────────┤               
│EGB_putBlockZoom　　　　│ドットデータの書き込み2　　　　 │               
├────────────┼────────────────┤               
│EGB_graphicCursor 　　　│グラフィックカーソル　　　　　　│               
├────────────┼────────────────┤               
│EGB_maskData　　　　　　│マスクデータの書き込み　　　　　│               
├────────────┼────────────────┤               
│EGB_scroll　　　　　　　│全画面スクロール　　　　　　　　│               
├────────────┼────────────────┤               
│EGB_partScroll　　　　　│部分画面スクロール　　　　　　　│               
├────────────┼────────────────┤               
│EGB_region　　　　　　　│領域の設定　　　　　　　　　　　│               
├────────────┼────────────────┤               
│EGB_copy　　　　　　　　│画面の複写　　　　　　　　　　　│               
├────────────┼────────────────┤               
│EGB_rotate　　　　　　　│画面の回転　　　　　　　　　　　│               
├────────────┼────────────────┤               
│EGB_resolve 　　　　　　│画面ぼかし　　　　　　　　　　　│               
└────────────┴────────────────┘               
                                                                             
   2.2.4　グラフィックオペレーション                                         
                                                                             
┌─────────────┬───────────────┐               
│　　　　関　数　名　　　　│　　　　機　　　　　能　　　　│               
├─────────────┼───────────────┤               
│EGB_pset　　　　　　　　　│ポイント　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_connect 　　　　　　　│連続線分　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_unConnect 　　　　　　│不連続線分　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_polygon 　　　　　　　│多角形　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_rotatePolygon 　　　　│回転多角形　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_triangle　　　　　　　│三角形　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_rectangle 　　　　　　│矩形　　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_circle　　　　　　　　│円　　　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_arc 　　　　　　　　　│円弧　　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_fan 　　　　　　　　　│扇形　　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_ellipse 　　　　　　　│楕円　　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_ellipticArc 　　　　　│楕円弧　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_ellipticFan 　　　　　│楕扇形　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_paint 　　　　　　　　│ペイント1　　　　　　　　　　 │               
├─────────────┼───────────────┤               
│EGB_closePaint　　　　　　│ペイント2　　　　　　　　　　 │               
├─────────────┼───────────────┤               
│EGB_point 　　　　　　　　│ポイント識別　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_bow 　　　　　　　　　│弓形1　　　　　　　　　　　　 │               
├─────────────┼───────────────┤               
│EGB_semiBow 　　　　　　　│弓形2　　　　　　　　　　　　 │               
└─────────────┴───────────────┘               
                                                                             
   2.2.5　フォントオペレーション                                             
                                                                             
┌─────────────┬───────────────┐               
│　　　　関　数　名　　　　│　　　　機　　　　　能　　　　│               
├─────────────┼───────────────┤               
│EGB_sjisString　　　　　　│文字列　　　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_connectSjisString 　　│追加文字列　　　　　　　　　　│               
├─────────────┼───────────────┤               
│EGB_asciiString 　　　　　│文字列1　　　　　　　　　　　 │               
├─────────────┼───────────────┤               
│EGB_connectAsciiString　　│追加文字列1　　　　　　　　　 │               
├─────────────┼───────────────┤               
│EGB_jisString 　　　　　　│文字列2　　　　　　　　　　　 │               
├─────────────┼───────────────┤               
│EGB_connectJisString　　　│追加文字列2　　　　　　　　　 │               
├─────────────┼───────────────┤               
│EGB_anyChar 　　　　　　　│任意文字表示　　　　　　　　　│               
└─────────────┴───────────────┘               
                                                                             
  2.3　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.EGB_anyChar                                                                 
任意文字表示                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_anyChar( work, xsize, ysize, data );                             
char　　*work;　　　　　/*　作業域のアドレス　　　　　　　　　　*/           
int 　　xsize;　　　　　/*　横サイズ(8ドット単位,8,16,24,..)　  */           
int 　　ysize;　　　　　/*　縦サイズ　　　　　　　　　　　　　　*/           
char　　*data;　　　　　/*　データのアドレス　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　data[16/8*16];                                                       
int 　　ret;                                                                 
                                                                             
ret = EGB_anyChar( work, 16, 16, data );                                     
                                                                             
- 内容 -                                                                     
データに表される文字を字体や拡大率を考慮して描画します。                     
拡大率は漢字の拡大率を考慮します。                                           
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
データの形式                                                                 
　　　　　　　　　　　　　　　　　　　　　　　　左のパターンを16進数で       
　　　　　　　　　　　　　　　　　　　　　　　　登録します。                 
│　　　　　　　　│　　　　　　　　│　　　　　　　　↓                     
│←─　8 dot ─→│←─　8 dot ─→│　　　　　　┌───┬───┐         
├────────┼────────┤　　 data[0]│ 0 e　│ 0 0　│         
│□□□□■■■□│□□□□□□□□│　　　　　　├───┼───┤         
│□□□■■■■■│□□□□□□□□│　　 data[2]│ 1 f　│ 0 0　│         
│□□■■□□□■│■□□□□□□□│　　　　　　├───┼───┤         
│□□■□□□□□│■□□□□□□□│　　 data[4]│ 3 1　│ 8 0　│         
│□■■□□□□□│■■□□□□□□│　　　　　　├───┼───┤         
│□■■■■■■■│■■□□□□□□│　　 data[6]│ 2 0　│ 8 0　│         
│□■■□□□□□│■■□□□□□□│　　　　　　├───┼───┤         
│□■■□□□□□│■■□□□□□□│　　　　　　│　･　 │　･ 　│         
└────────┴────────┘　　　　　　│　･　 │　･ 　│         
                                                                             
-----------------------------------------------------------------------------
.EGB_arc                                                                     
円弧                                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_arc( work, para );                                               
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_arc( work, para );                                                 
                                                                             
- 内容 -                                                                     
円弧を描画します。                                                           
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
図CL21R-005                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_asciiString                                                             
文字列1                                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_asciiString( work, n, para );                                    
char　　*work;　　　　　/*　作業域のアドレス　　　　　　　　　 */            
int 　　n;　　　　　　　/*　0 or 1(0:8dot,　1:16dotフォント) 　*/            
char　　*para;　　　　　/*　パラメータのアドレス　　　　　　　 */            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_asciiString( work, 0, para );                                      
                                                                             
- 内容 -                                                                     
文字列(ASCIIコードのANK文字列)を描画します。                                 
グラフィック文字も表示します。                                               
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
　┌─┬──────────────┐                                       
 0│SW│描画開始Ｘ座標　　　　　　  │                                       
　├─┼──────────────┤                                       
 2│SW│描画開始Ｙ座標　　　　　　  │                                       
　├─┼──────────────┤                                       
 4│Ｗ│文字列の長さ　　　　　　　  │                                       
　├─┼──────────────┤                                       
 6│BA│文字列　　　　　　　　　　  │                                       
　〜　〜　　　　　　　　　　　　　　〜                                       
　└─┴──────────────┘                                       
                                                                             
-----------------------------------------------------------------------------
.EGB_bow                                                                     
弓形1                                                                        
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_bow( work, para );                                               
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_bow( work, para );                                                 
                                                                             
- 内容 -                                                                     
第1点、第2点、第3点を通る円弧を描きます。                                    
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
図CL21R-006                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_circle                                                                  
円                                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_circle( work, para );                                            
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_circle( work, para );                                              
                                                                             
- 内容 -                                                                     
円を描画します。                                                             
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
　┌─┬──────────────┐                                       
 0│SW│中心点Ｘ座標　　　　　　　　│                                       
　├─┼──────────────┤                                       
 2│SW│中心点Ｙ座標　　　　　　　　│                                       
　├─┼──────────────┤                                       
 4│Ｗ│半径　　　　　　　　　　　　│                                       
　└─┴──────────────┘                                       
                                                                             
図CL21R-007                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_clearScreen                                                             
全画面の消去                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_clearScreen( work );                                             
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_clearScreen( work );                                               
                                                                             
- 内容 -                                                                     
書き込みページの画面全体を背景色で塗り潰します。                             
ビューポートの影響を受けません。仮想画面の消去も行います｡                    
                                                                             
図CL21R-008                                                                  
                                                                             
32K色2画面合成をする場合には、レイヤ0側の背景色の設定時に、インポーズビットを
"1"にしてください。(例:EGB_color(work,1,0x8000);)                            
他のモードで2画面合成をする場合には、レイヤ0側の背景色の設定時に、色識別番号0
を設定してください。(例:EGB_color(work,1,0);)                                
                                                                             
-----------------------------------------------------------------------------
.EGB_closePaint                                                              
ペイント2                                                                    
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_closePaint( work, para );                                        
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了 　　                                                              
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;    　　                                                         
                                                                             
ret = EGB_closePaint( work, para );                                          
                                                                             
- 内容 -                                                                     
ペイント開始座標点の色(色識別番号)以外を境界色として、閉領域を塗り潰します。 
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
　┌─┬───────────────┐                                     
 0│SW│ペイント開始Ｘ座標　　　　　　│                                     
　├─┼───────────────┤                                     
 2│SW│ペイント開始Ｙ座標　　　　　　│                                     
　└─┴───────────────┘                                     
                                                                             
-----------------------------------------------------------------------------
.EGB_color                                                                   
描画色の設定                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_color( work, n, color );                                         
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　n;　　　　　　　　　/*　設定色　　　　　　　　　　　　*/             
int 　　color;　　　　　　　/*　色識別番号　　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_color( work, 0, 0x71ef );                                          
                                                                             
- 内容 -                                                                     
設定色(前景色、背景色、面塗り色、透過色)の色識別番号を設定します。           
色識別番号は、ピクセルの持つビット数によって有効ビット数が変わります。       
                                                                             
　　　　　　　　   31　　　　　　　　　　　　　0                             
　　　　　　　   ┌─────────────┬─┐　　　ｎ＝0:前景色   
1ビットピクセル  │　　　      無効　　　　　│1 │←┐                
　　　　　　　   └─────────────┴─┘　│　　　1:背景色     
　　　　   　　　　　　　　　　　　　　　　　　　　　│                   
　　　　　　　　   31　　　　　　　　　　　3　0　　  │　　　2:面塗り色   
　　　　　　　   ┌───────────┬───┐　│                   
4ビットピクセル  │　　　      無効　　　│　4　 │←┤　　　3:透過色  
　　　　　　　   └───────────┴───┘　│                   
　　　　　   　　　　　　　　　　　　　　　　　　　　│                   
　　　　　　　　   31　　　　　　　　　7　　　0　　  │       
　　　　　　　   ┌─────────┬─────┐　│                   
8ビットピクセル  │      無効　　　　│　　8　　 │←┤                
　　　　　　　   └─────────┴─────┘　│                   
　　　　　　　   　　　　　　　　　　　　　　　　　　├─有効ビット       
　　　　　　   　　31　　　　　　　15　　　　　0　　 │                   
　　　　　　　   ┌───────┬───────┐　│                   
16ビットピクセル │      無効　　│　　　16　　　│←┤                
　　　　　　　   └───────┴───────┘  │                   
　　　　　　   　　31　　　23　　　  　　　　　0　　 │                   
　　　　　　　   ┌───┬───────────┐　│                   
24ビットピクセル │ 無効 │ 　      24     　　　│←┤                
　　　　　　　   └───┴───────────┘  │                   
　　　　　　   　　31　　　23　　　  　　　　　0　　 │                   
　　　　　　　   ┌───┬───────────┐　│                   
32ビットピクセル │ 不定 │ 　      24     　　　│←┘                
　　　　　　　   └───┴───────────┘                       
                                                                             
-----------------------------------------------------------------------------
.EGB_colorIGRB                                                               
描画色の設定1                                                                
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_colorIGRB( work, n, color );                                     
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　n;　　　　　　　　　/*　設定色　　　　　　　　　　　　*/             
int 　　color;　　　　　　　/*　色識別番号　　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
int 　　n;                                                                   
n 　= 0;                                                                     
ret = EGB_colorIGRB( work, n, 0xffffffff );                                  
                                                                             
- 内容 -                                                                     
設定色(前景色、背景色、面塗り色、透過色)の色識別番号を設定します。           
色識別番号はIGRBで設定します。                                               
                                                                             
　　　　　　　┌───┬───┬───┬───┐　　　ｎ＝0:前景色           
　　　color:　│　Ｉ　│　Ｇ　│　Ｒ　│　Ｂ　│                             
　　　　　　　├───┼───┼───┴───┤　　　　　1:背景色           
　　　　　　　│　　　│　　　│　　　　　　　│                             
┌──────┘　┌─┘　　　└──┐　　　　│　　　　　2:面塗り色         
│　　　　　　　　│　　　　　　　　│　　　　│                             
├─┬─┬────┼─┬─┬────┼────┤　　　　　3:透過色           
│I7│I6│〜〜〜〜│G7│G6│〜〜〜〜│〜〜〜〜│                             
└┬┴─┴────┴─┴─┴────┴────┘                             
　│　　　ＩＧＲＢ各対応ビットは左詰                                         
　│                                                                         
　16色───輝度ビットに対応                                                 
                                                                             
　32K色───スーパーインポーズビットに対応                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_connect                                                                 
連続線分                                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_connect( work, para );                                           
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_connect( work, para );                                             
                                                                             
- 内容 -                                                                     
連続線分を描画します。                                                       
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
図CL21R-009                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_connectAsciiString                                                      
追加文字列1                                                                  
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_connectAsciiString( work, n, para );                             
char　　*work;　　　　　/*　作業域のアドレス　　　　　　　　　 */            
int 　　n;　　　　　　　/*　0 or 1(0:8dot,　1:16dotフォント) 　*/            
char　　*para;　　　　　/*　パラメータのアドレス　　　　　　　 */            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_connectAsciiString( work, 0, para );                               
                                                                             
- 内容 -                                                                     
文字列1に続く文字列(ASCIIコードのANK文字列)を描画します。                    
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
　┌─┬──────────────┐                                       
 0│Ｗ│文字列の長さ　　　　　　　　│                                       
　├─┼──────────────┤                                       
 2│BA│文字列　　　　　　　　　　　│                                       
　〜　〜　　　　　　　　　　　　　　〜                                       
　└─┴──────────────┘                                       
                                                                             
-----------------------------------------------------------------------------
.EGB_connectJisString                                                        
追加文字列2                                                                  
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_connectJisString( work, para );                                  
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_connectJisString( work, para );                                    
                                                                             
- 内容 -                                                                     
文字列2に続く文字列(JISコード文字列)を描画します。                           
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
　┌─┬──────────────┐                                       
 0│Ｗ│文字列の長さ　　　　　　　　│                                       
　├─┼──────────────┤                                       
 2│WA│文字列　　　　　　　　　　　│                                       
　〜　〜　　　　　　　　　　　　　　〜                                       
　└─┴──────────────┘                                       
                                                                             
-----------------------------------------------------------------------------
.EGB_connectSjisString                                                       
追加文字列                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_connectSjisString( work, para );                                 
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_connectSjisString( work, para );                                   
                                                                             
- 内容 -                                                                     
文字列に続く文字列(ASCIIコードのANK文字列、またはシフトjisコードの文字列)を描
画します。                                                                   
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
　┌─┬──────────────┐                                       
 0│Ｗ│文字列の長さ　　　　　　　　│                                       
　├─┼──────────────┤                                       
 2│BA│文字列　　　　　　　　　　　│                                       
　〜　〜　　　　　　　　　　　　　　〜                                       
　└─┴──────────────┘                                       
                                                                             
図CL21R-010                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_copy                                                                    
画面の複写                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_copy( work, n, cpara, wsize );                                   
char　　*work;　　　　　　　　/*　作業域のアドレス　　　*/                   
int 　　n;　　　　　　　　　　/*　機能設定(下図参照)　  */                   
char　　*cpara; 　　　　　　　/*　パラメータのアドレス　*/                   
char　　*wsize; 　　　　　　　/*　ワークのアドレス　　　*/                   
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　cpara[64];                                                           
char　　worksize[256*1024];                                                  
int 　　ret;                                                                 
                                                                             
ret = EGB_copy( work, 0, cpara, worksize );                                  
                                                                             
- 内容 -                                                                     
矩形域内のドットデータを他の位置に複写します。                               
移動の領域は、領域の設定(EGB_region) で行います。領域の設定で使ったparaと違う
名前(cparaなど)でパラメータを設定してください。                              
                                                                             
　　　7　6　5　4　3　2　1　0　　　　　　　　　　　　　                       
　　┌─┬─┬─┬─┬─┬─┬─┬─┐　　　　　　　　　　　　               
ｎ: │　│　│　│　│　│　│　│　│　　　　　　　　　　　　               
　　└┬┴─┴─┴─┴─┴─┴─┴┬┘　　　　　　　　　　　　               
　　　│　　　　　　　　　　　　　│　　　　　　　　　　　　　               
　　　└0:ワーク領域への複写を行う└──0:背景色描画を行わない               
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　               
　　　　1:ワーク領域への複写を行わない　1:背景色描画を行う　　               
                                                                             
- パラメータの形式 -                                                         
　┌─┬──────────────┐                                       
 0│Ｂ│複写先ページ　　　　　　　　│                                       
　├─┼──────────────┤                                       
 1│Ｂ│0　　　　　　　　　　　　　 │                                       
　├─┼──────────────┤                                       
 2│SW│相対Ｘ座標　　　　　　　　　│                                       
　├─┼──────────────┤                                       
 4│SW│相対Ｙ座標　　　　　　　　　│                                       
　└─┴──────────────┘                                       
                                                                             
図CL21R-011                                                                  
                                                                             
                                                                             
-----------------------------------------------------------------------------
.EGB_digitize                                                                
ディジタイズ                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_digitize( work, n );                                             
char　　*work;　　　　　　　　　/*　作業域のアドレス　　　　　　  */         
int 　　n;　　　　　　　　　　　/*　0:OFF or 1:ON　　　　　　     */         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_digitize( work, 1 );　/*　EGBで設定されている書き込みページの */   
                                /*  ディジタイズをONに指定　            */   
                                                                             
- 内容 -                                                                     
画面のディジタイズのＯＮ(開始)･ＯＦＦ(終了)を指定します。                    
書き込みページで指定されるページに設定されます。未表示の画面にもディジタイズ 
する事が可能です。                                                           
 ｎ=0:ＯＦＦ(終了)                                                           
　　1:ＯＮ(開始)                                                             
                                                                             
図CL21R-012                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_displayPage                                                             
表示ページの指定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_displayPage( work, pri, display );                               
char　　*work;　　　　　　/*　作業域のアドレス　　　　　　　*/               
int 　　pri;　　　　　　　/*　プライオリティ(0:ページ0を前)                  
　　　　　　　　　　　　　　　　　　　　　　(1:ページ1を前) */               
int 　　display;　　　　　/*　0:未表示                                       
　　　　　　　　　　　　　　　1:ページ0表示                                  
　　　　　　　　　　　　　　　2:ページ1表示                                  
　　　　　　　　　　　　　　　3:ページ0，ページ1表示　　　  */               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_displayPage( work, 0, 1 );                                         
                                                                             
- 内容 -                                                                     
ハードウェアで表示可能なページとそのプライオリティを指定します。             
                                                                             
　　　　　31　30　　　　　　　 3　 2　 1　 0　　　　　　　　　　　　         
　　　　┌─┬─┬──〜──┬─┬─┬─┬─┐　　　　　　　　　　　         
display:│ 0│ 0│　　　　　│ 0│ 0│　│　│　　　　　　　　　　　         
　　　　└─┴─┴──〜──┴─┴─┴┬┴┬┘　　　　　　　　　　　         
　　　　　　　　　　　　　　　　　　　│　│　　　　　　　　　　　　         
　　　　　　　　　　　　　　　　　　　│　ページ0　┌"1"表示　┐             
　　　　　　　　　　　　　　　　　　　│　　　　　 │　　　　 │             
　　　　　　　　　　　　　　　　　　　ページ1　　　└"0"非表示┘             
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　         
　　　　　┌────────────┐　･レイヤ1　　　　　　　　　           
　　　　　│　　　　　　　　　　　●┼─┘　　　　　　　　　　　　　         
　　　　　│　┌──────────┼─┬──･レイヤ0　　　　　　           
　　　　　│　│　　　　　　　　　　│●┼──┘　　　　　　　　　　         
　　　　　│　│　　　　　　　　　　│　│　　　　　　　　　　　　　         
　　　　　│　│　　　　　　　　　　│　│表示画面の縦サイズ　　　　         
　　　　　└─┼──────────┘　│　　　　　　　　　　　　　         
　　　　　　　│　　　　　　　　　　　　│　　　　　　　　　　　　　         
　　　　　　　├────────────┼──　　　　　　　　　　　         
　　　　　　　│　表示画面の横サイズ　　│　　　　　　　　　　　　　         
　　　　　　　│　　　　　　　　　　　　│　　　　　　　　　　　　　         
                                                                             
(1) レイヤ0が16色の場合                                                      
レイヤ0側のピクセルの色識別番号が0である時、透明色になります。レイヤ1が表示指
定されている時は、レイヤ1のピクセルが表示されます。(2) レイヤ0が32K色の場合ピ
クセルの色識別番号のbit15が‘1’の時、透明色になります。レイヤ1が表示指定され
ている時は、レイヤ1のピクセルが表示されます。                                
                                                                             
- 参考 -                                                                     
EGB_displayPage(work,0,3);                                                   
　　　　　　　　　　　　　　　･レイヤ1　　                                   
　　　　　　　　　　　　　　　│　　　　　　                                 
　　　┌─────────┐←┘　･レイヤ0                                   
      │    ページ1       │      │                                         
　　　│　┌─────────┐←┘　　　　                                 
　　　│　│　　ページ0 　　　│　　　　　　                                 
　　　│　│　　　　　　　　　│　　　　　　                                 
　　　│　│　　　　　　　　　│　　　　　　                                 
　　　│　│　　　　　　　　　│　　　　　　                                 
　　　└─│　　　　　　　　　│　　　　　　                                 
　　　　　└─────────┘　　　　　　                                 
　　　　　　　　表示画面　　　　　　　　　　                                 
　　　　　　　　　　　　　　　　　　　　　　                                 
EGB_displayPage(work,1,3);                                                   
　　　　　　　　　　　　　　　･レイヤ1　　                                   
　　　　　　　　　　　　　　　│　　　　　　                                 
　　　┌─────────┐←┘　･レイヤ0                                   
      │    ページ0       │      │                                         
　　　│　┌─────────┐←┘　　　　                                 
　　　│　│　　ページ1　 　　│　　　　　　                                 
　　　│　│　　　　　　　　　│　　　　　　                                 
　　　│　│　　　　　　　　　│　　　　　　                                 
　　　│　│　　　　　　　　　│　　　　　　                                 
　　　└─│　　　　　　　　　│　　　　　　                                 
　　　　　└─────────┘　　　　　　                                 
　　　　　　　　表示画面　　　　　　　　　　                                 
                                                                             
-----------------------------------------------------------------------------
.EGB_displayStart                                                            
表示開始位置の設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_displayStart( work, mode, xstart, ystart );                      
char　　*work;　　　/*　作業域のアドレス　　　　　　　　　　　　　　*/       
int 　　mode; 　　　/*　モード(bit6=1ではVSYNC待ちなしで設定します) */       
int 　　xstart; 　　/*　横方向パラメータ　　　　　　　　　　　　　　*/       
int 　　ystart; 　　/*　縦方向パラメータ　　　　　　　　　　　　　　*/       
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
/*　画面モードNo:10の320×240,32K色高解像を全画面に表示する設定　*/          
ret = EGB_displayStart( work, 3, 0, 0 );                                     
ret = EGB_displayStart( work, 2, 2, 2 );                                     
ret = EGB_displayStart( work, 0, 0, 0 );                                     
ret = EGB_displayStart( work, 1, 0, 0 );                                     
ret = EGB_displayStart( work, 3, 320, 240 );                                 
                                                                             
- 内容 -                                                                     
仮想画面中の表示開始位置を設定します。                                       
モード　　0:画面の表示開始位置の設定                                         
　　　　　1:仮想画面中の移動                                                 
　　　　　2:画面の拡大                                                       
　　　　　3:表示画面の大きさ                                                 
                                                                             
モードのbit6を1にした場合は、VSYNC待ちをせずに表示開始位置を設定します。ただ 
し、必ずプログラムがVSYNC非表示期間を意識して設定する必要があります。意識せず
に設定した場合は、表示回路がハングアップすることがあります。                 
                                                                             
●画面の表示開始位置の設定                                                   
　　　　画面枠　　　　　　　　　　　　　　　　　　　　　　　　　　　　　     
┌────┬────┐　　　　　　　　　　　　　　　　　　　　　　　　　     
│　　　┌┼───┐│　　　　　　　　　　　　　　　　　　　　　　　　　     
│　　　││→　　││　･表示画面が画面枠より小さい場合に設定可能です。      
│表示画面│　　　││　･表示画面が画面枠を越える設定はできません。　　      
├───┼┘　　　││　･仮想画面の移動位置が(0, 0) に設定されます。　       
│　↓　└────┘│　　　　　　　　　　　　　　　　　　　　　　　　　     
└─────────┘　　　　　　　　　　　　　　　　　　　　　　　　　     
                                                                             
●仮想画面中の移動                                                           
　　　　画面枠　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 
┌─────────┬──┐　　　　　　　　　　　　　　　　　　　　　　　　 
│┌────────┼┐　│　･仮想画面が画面枠より大きい場合に設定可能です。
││　　　　　　　　││　│　･円筒スクロール可能の場合、縦方向に仮想画面を越
││　　　　　　　　│→　│　　えた設定が可能です。　　　　　　　　　　　　 
││　　　　　　　　││　│　･球面スクロール可能の場合、縦横方向に仮想画面を
││　　　　　　　　││　│　　越えた設定が可能です。　　　　　　　　　　　 
├┼────────┘│　│　　　　　　　　　　　　　　　　　　　　　　　　 
│└───↓─────┘　│　　　　　　　　　　　　　　　　　　　　　　　　 
└────────────┘　　　　　　　　　　　　　　　　　　　　　　　　 
　　　仮想画面                                                               
                                                                             
●画面の拡大                                                                 
　　　　画面枠　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　   
┌─────────┐　　　　　　　　　　　　　　　　　　　　　　　　　　   
│　　　　　　　　　│　･全ての画面モードで設定可能です。　　　　　　　　    
│　　あ→　　　　　│　･最大倍率は16倍です。　　　　　　　　　　　　　　    
│　　　　　　　　　│　･初期倍率より小さい値を設定することはできません。    
│　　↓　　　　　　│　･初期倍率は画面モードにより異なります。　　　　　    
│　　　　　　　　　│　･仮想画面の移動位置が(0, 0) に設定されます。　　     
└─────────┘　　　　　　　　　　　　　　　　　　　　　　　　　　   
                                                                             
●表示画面の大きさ                                                           
　　　　画面枠                                                               
┌────┬────┐　　　　　　　　　　　　　　　　　　　　　　　　　　　 
│　　　　│　　　　│　･表示画面が画面枠より小さい場合に設定可能です。　　　
│　　　　│→　　　│　･初期画面より小さい値を設定することはできません。　　
│表示画面│　　　　│　･設定パラメータは倍率を考慮したドット単位で指定　　　
├────┘　　　　│　　します。　　　　　　　　　　　　　　　　　　　　　 
│　↓　　　　　　　│　･設定パラメータ値が画面枠を越した場合、画面枠で設定し
└─────────┘　　ます。　　　　　　　　　　　　　　　　　　　　　　 
                                                                             
モードの初期値一覧表                                                         
                                                                             
┌─┬─────┬─────┬─────┬──────┬───────┐     
│　│　　　　　│　　　　　│表示開始　│仮想画面中　│　　　　　　　│     
│No│ 仮想画面 │ 表示画面 │　　　　　│　　　　　　│初期倍率　x ,y│     
│　│　　　　　│　　　　　│位置の設定│　　　の移動│　　　　　　　│     
├─┼─────┼─────┼─────┼──────┼───────┤     
│ 1│ 640×819 │ 640×400 │　　×　　│　　 ×　　 │　（1，1）  　│     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│ 2│　　　　　│ 640×200 │　　×　　│　　 ×　　 │　（1，2）　  │     
├─┼─────┼─────┼─────┼──────┼───────┤     
│ 3│1024×512 │ 640×480 │　　×　　│　　 ○　　 │　（1，1）　  │     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│ 4│　　　　　│ 640×400 │　　×　　│　　 ○　　 │　（1，1）　  │     
├─┼─────┼─────┼─────┼──────┼───────┤     
│ 5│ 256×512 │ 256×256 │　　○　　│　　 ○　　 │　（1，1）  　│     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│ 6│　　　　　│ 256×256 │　　○　　│　　 ○　　 │　（1，1）　  │     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│ 7│　　　　　│ 256×240 │　　○　　│　　 ○　　 │　（4，1）　  │     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│ 8│　　　　　│ 256×240 │　　○　　│　　 ○　　 │　（4，1）  　│     
├─┼─────┼─────┼─────┼──────┼───────┤     
│ 9│ 512×256 │ 360×240 │　　×　　│　　 ○　　 │　（4，1）  　│     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│10│　　　　　│ 320×240 │　　○　　│　　 ○　　 │　（1，1）  　│     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│11│　　　　　│ 320×240 │　　×　　│　　 ○　　 │　（4，1）  　│     
├─┼─────┼─────┼─────┼──────┼───────┤     
│12│1024×512 │ 640×480 │　　×　　│　　 ○　　 │　（1，1）  　│     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│13│　　　　　│ 640×400 │　　×　　│　　 ○　　 │　（1，1）  　│     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│14│　　　　　│ 720×480 │　　×　　│　　 ○　　 │　（2，1）  　│     
├─┼─────┼─────┼─────┼──────┼───────┤     
│15│ 512×512 │ 320×480 │　　×　　│　　 ○　　 │　（2，1）  　│     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│16│　　　　　│ 320×480 │　　×　　│　　 ○　　 │　（4，1）  　│     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│17│　　　　　│ 512×480 │　　×　　│　　 ○　　 │　（1，1）　  │     
├─┤　　　　　├─────┼─────┼──────┼───────┤     
│18│　　　　　│ 512×480 │　　×　　│　　 ○　　 │　（2，1）　  │     
└─┴─────┴─────┴─────┴──────┴───────┘     
                                                                             
-----------------------------------------------------------------------------
.EGB_ellipse                                                                 
楕円                                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_ellipse( work, para );                                           
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_ellipse( work, para );                                             
                                                                             
- 内容 -                                                                     
楕円を描画します。                                                           
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
図CL21R-013                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_ellipticArc                                                             
楕円弧                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_ellipticArc( work, para );                                       
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_ellipticArc( work, para );                                         
                                                                             
- 内容 -                                                                     
楕円弧を描画します。                                                         
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬───────────────┐                                     
  │ 0│SW│中心点Ｘ座標　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 2│SW│中心点Ｙ座標　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 4│SW│第1軸Ｘ成分　　　　　　　 │                                     
  ├─┼───────────────┤                                     
  │ 6│SW│第2軸Ｙ成分　　　　　　　 │                                     
  ├─┼───────────────┤                                     
  │ 8│FI│開始角　（ラジアン）─┐　│　　　31　　　16 15 　　　0          
  ├─┼─────────────┼─┤　　　┌────┬────┐         
  │12│FI│終了角　（ラジアン）─┤　│　　　│　　　　│　　　　│         
  └─┴─────────────┼─┘　　　└────┴────┘         
  　　　　　　　　　　　　　　　  │　　　　　　　　　　↑                   
  　　　　　　　　　　　　　　　  │　　　　　　　　小数点位置               
   　　　　　　　　　　　　　 固定小数点　　　　π＝3.243F (16進)            
図CL21R-014                                                                  
                                                                             
開始角と終了角は、X軸正方向からY軸正方向にまわる向きの角度をラジアン(32ビット
固定小数点数)で指定します(円弧 (EGB_arc)の開始軸、終了軸で指定する方法と異な 
ることに注意)。下記の表に標準的な角度を固定小数点で表現した値を示します。    
                                                                             
┌────────┬──────────────────────┐           
│　　角　　度　　│　　　　　固定小数点数（2ワード）　　　　　 │           
├────────┼──────────────────────┤           
│  　π/6( 30゜) │0000　86Ｂ0Ｈ（約　0.52360）　              │           
│　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　│           
│  　π/4( 45゜) │0000　Ｃ910Ｈ（約　0.78540）　              │           
│　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　│           
│  　π/3( 60゜) │0001　0Ｃ15Ｈ（約　1.04720）　              │           
│　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　│           
│  　π/2( 90゜) │0001　9220Ｈ（約　1.57080）　               │           
│　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　│           
│   2π/3(120゜）│0002　182ＢＨ（約　2.09440）　              │           
│　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　│           
│　　π　(180゜）│0003　243ＦＨ（約　3.14159）　              │           
│　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　│           
│   4π/3(240゜）│0004　3055Ｈ（約　4.18879）　               │           
│　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　│           
│   3π/2(270゜）│0004　Ｂ65ＦＨ（約　4.71239）　             │           
│　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　│           
│ 　2π　(360゜）│0006　487ＦＨ（約　6.28319）　              │           
└────────┴──────────────────────┘           
                                                                             
楕円弧の開始点、終了点を求めるsin関数やcos関数の値は、上の表の2πの値を基準に
して計算します。すなわち、2πを越える角度や負の角度の場合、0〜2πの範囲に納ま
る角度を求めた後(2πによる剰余を計算する)、sin関数やcos関数の値を求めます。  
                                                                             
-----------------------------------------------------------------------------
.EGB_ellipticFan                                                             
楕扇形                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_ellipticFan( work, para );                                       
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　　　　*/       
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　　　　*/       
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_ellipticFan( work, para );                                         
                                                                             
- 内容 -                                                                     
楕扇形を描画します。                                                         
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬───────────────┐                                     
  │ 0│SW│中心点Ｘ座標　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 2│SW│中心点Ｙ座標　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 4│SW│第1軸Ｘ成分　　　　　　　 │                                     
  ├─┼───────────────┤                                     
  │ 6│SW│第2軸Ｙ成分　　　　　　　 │                                     
  ├─┼───────────────┤                                     
  │ 8│FI│開始角　　　（ラジアン）　│                                     
  ├─┼───────────────┤                                     
  │12│FI│終了角　　　（ラジアン）　│                                     
  └─┴───────────────┘                                     
図CL21R-015                                                                  
                                                                             
開始角･終了角の設定は、前出の楕円弧(EGB_ellipticArc)を参照してください。     
                                                                             
-----------------------------------------------------------------------------
.EGB_fan                                                                     
扇形                                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_fan( work, para );                                               
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
ret = EGB_fan( work, para );                                                 
                                                                             
- 内容 -                                                                     
扇形を描画します。                                                           
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
図CL21R-016                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_fontStyle                                                               
字体の設定                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include<EGB.H>                                                              
int 　　EGB_fontStyle( work, style );                                        
char　　*work;　　　　　　　　　　　　/*　作業域のアドレス　　　　　　*/     
int 　　style;　　　　　　　　　　　　/*　字体　　　　　　　　　　　　*/     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_fontStyle( work, 0x01 );　　/*　太文字　　　　　　　　　　　*/     
                                                                             
- 内容 -                                                                     
文字表示で使用される字体を設定します。                                       
影付、縁取りは背景色で描かれます。字体に何も飾りをつけないときは、styleを0に 
します。                                                                     
                                                                             
　　　　15　　　　　　　7　6　5　4　3　2　1　0                               
　　　┌─┬─〜───┬─┬─┬─┬─┬─┬─┬─┬─┐                     
style:│ 0│　　　　　│ 0│　│　│　│　│　│　│　│                     
　　　└─┴─〜───┴─┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                     
　　　　　　　　　　　　　　│　│　│　│　│　│　└─太文字               
　　　　　　　　　　　　　　│　│　│　│　│　│                           
　　　　　　　　　　　　　　│　│　│　│　│　└─斜体                     
　　　　　　　　　　　　　　│　│　│　│　│                               
　　　　　　　　　　　　　　│　│　│　│　└─影付                         
　　　　　　　　　　　　　　│　│　│　│                                   
　　　　　　　　　　　　　　│　│　│　└─縁取り                           
　　　　　　　　　　　　　　│　│　│                                       
　　　　　　　　　　　　　　│　│　└─アンダーライン　┌"1"設定　┐        
　　　　　　　　　　　　　　│　│　　　　　　　　　　　│　　　　 │        
　　　　　　　　　　　　　　│　└─オーバーライン　　　└"0"非設定┘        
　　　　　　　　　　　　　　│                                               
　　　　　　　　　　　　　　└─消し線                                       
                                                                             
●　太文字は右に1ドット太くなります。                                        
●　斜体は右ななめに傾きます。                                               
●　影付は右斜め下に影を付けます。                                           
●　縁取りは文字に縁を付けます。                                             
●　アンダーラインは文字の最下部に線を引きます。                             
●　オーバーラインは文字の最上部に線を引きます。                             
●　消し線は文字の中心に線を引きます。                                       
                                                                             
●標準体　　　　　　　●太文字　　　　　　　●斜体                           
                                                                             
　　・・・■■・・・　　　・・・■■■・・　　　・・・・・・■■・・・       
　　・・■・・■・・　　　・・■■・■■・　　　・・・・・■・・■・・       
　　・■・・・・■・　　　・■■・・・■■　　　・・・■・・・・■・・       
　　・■■■■■■・　　　・■■■■■■■　　　・・・■■■■■■・・       
　　・■・・・・■・　　　・■■・・・■■　　　・・■・・・・■・・・       
　　・■・・・・■・　　　・■■・・・■■　　　・・■・・・・■・・・       
　　・■・・・・■・　　　・■■・・・■■　　　・■・・・・■・・・・       
　　・・・・・・・・　　　・・・・・・・・　　　・・・・・・・・・・・       
                                                                             
●影付　　　　　　　　●縁取                                                 
                                                                             
　　　　　　　　　　　　　　　□□□□　　　　　┏━━━━━━━━━┓       
　　・・・■■・・・　　　・□□■■□□・　　　┃★文字色★　　　　┃       
　　・・■□□■・・　　　□□■□□■□□　　　┃　　　　　　　　　┃       
　　・■□・・・■・　　　□■□□□□■□　　　┃・　─　空白　　　┃       
　　・■■■■■■□　　　□■■■■■■□　　　┃　　　　　　　　　┃       
　　・■□□□□■□　　　□■□□□□■□　　　┃■　─　前景色塗り┃       
　　・■□・・・■□　　　□■□・・□■□　　　┃　　　　　　　　　┃       
　　・■□・・・■□　　　□■□・・□■□　　　┃□　─　背景色塗り┃       
　　・・□・・・・□　　　□□□・・□□□　　　┃　　　　　　　　　┃       
　　　　　　　　　　　　　　　　　　　　　　　　┗━━━━━━━━━┛       
                                                                             
●アンダーライン　　　●オーバーライン　　　　●消し線                       
                                                                             
　　・・・■■・・・　　　■■■■■■■■　　　　・・・■■・・・           
　　・・■・・■・・　　　・・■・・■・・　　　　・・■・・■・・           
　　・■・・・・■・　　　・■・・・・■・　　　　・■・・・・■・           
　　・■■■■■■・　　　・■■■■■■・　　　　■■■■■■■■           
　　・■・・・・■・　　　・■・・・・■・　　　　・■・・・・■・           
　　・■・・・・■・　　　・■・・・・■・　　　　・■・・・・■・           
　　・■・・・・■・　　　・■・・・・■・　　　　・■・・・・■・           
　　■■■■■■■■　　　・・・・・・・・　　　　・・・・・・・・           
                                                                             
-----------------------------------------------------------------------------
.EGB_getBlock                                                                
ドットデータの読み込み1                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_getBlock( work, para );                                          
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
char　　*para;　　　　　　　/*　パラメータのアドレス　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_getBlock( work, para );                                            
                                                                             
- 内容 -                                                                     
指定した矩形域内のドットデータを読み込みます。                               
クリップ枠(=ビューポート枠) は仮想画面枠に設定され、画面外は、"0"が読み込まれ
ます。                                                                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬─────────────┐                                         
  │ 0│Ｄ│データ格納領域アドレス│                                         
  ├─┼─────────────┤                                         
  │ 4│Ｗ│データ格納領域セレクタ│                                         
  ├─┼─────────────┤                                         
  │ 6│SW│第1点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │ 8│SW│第1点Ｙ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │10│SW│第2点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │12│SW│第2点Ｙ座標　　　　　 │                                         
  └─┴─────────────┘                                         
                                                                             
データ格納領域のデータ格納形式(4バイト単位のデータ列を用意する必要があります)
┌─┬───────────┐                                               
│BA│ 1/4/8/16 bit pixel 　│                                               
〜　〜　　　データ列　　　　〜                                               
└─┴───────────┘                                               
                                                                             
データ領域の大きさは以下の式に基づいて求めます。(整数型で計算)               
 ●　2色モード時　　　　　　(横の大きさ＋7)/8×(縦の大きさ)    
 ● 16色モード時　　　　　　(横の大きさ＋7)/8×4×(縦の大きさ) 
 ●256色モード時　　　　　　(横の大きさ)×(縦の大きさ)         
 ●32K色モード時　　　　　　(横の大きさ)×2×(縦の大きさ)      
 ●16M色モード時(24ビット)　(横の大きさ)×3×(縦の大きさ)      
 ●16M色モード時(32ビット)　(横の大きさ)×4×(縦の大きさ)      
                                                                             
-----------------------------------------------------------------------------
.EGB_getBlockColor                                                           
ドットデータの読み込み                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_getBlockColor( work, para );                                     
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
char　　*para;　　　　　　　/*　パラメータのアドレス　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_getBlockColor( work, para );                                       
                                                                             
- 内容 -                                                                     
指定した矩形域内のドットデータをモノクロで読み込みます。                     
クリップ枠(=ビューポート枠)は画面枠に設定され、画面外は黒とみなされます。    
                                                                             
- パラメータの形式 -                                                         
  ┌─┬─────────────┐                                         
  │ 0│Ｄ│データ格納領域アドレス│                                         
  ├─┼─────────────┤                                         
  │ 4│Ｗ│データ格納領域セレクタ│                                         
  ├─┼─────────────┤                                         
  │ 6│SW│第1点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │ 8│SW│第1点Ｙ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │10│SW│第2点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │12│SW│第2点Ｙ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │14│Ｗ│読み込み色数　　　　　│                                         
  ├─┼─────────────┤┐                                       
  │16│Ｄ│色識別番号1　　　　　 ││                                       
  ├─┼─────────────┤│                                       
  │20│Ｄ│色識別番号2　　　　　 ││                                       
  ├─┼─────────────┤├─読み込み色数分                       
  │24│Ｄ│色識別番号3　　　　　 ││                                       
  ├─┼─────────────┤│                                       
  〜　〜　　　　　　　　　　　    〜│                                       
  └─┴─────────────┘┘                                       
                                                                             
データ格納領域のデータ格納形式(4バイト単位のデータ列を用意する必要があります)
┌─┬───────────┐                                               
│BA│1 bit pixel 　データ列│                                               
〜　〜　　　　　　　　　　　〜                                               
└─┴───────────┘                                               
データ格納領域の大きさは以下の式に基づいて求めます。(整数型で計算)           
データ格納領域の大きさ=(横の大きさ＋7)/8×(縦の大きさ)                       
                                                                             
-----------------------------------------------------------------------------
.EGB_getBlockZoom                                                            
ドットデータの読み込み2                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_getBlockZoom( work, para );                                      
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
char　　*para;　　　　　　　/*　パラメータのアドレス　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_getBlockZoom( work, para );                                        
                                                                             
- 内容 -                                                                     
指定した矩形域内のドットデータを拡大･縮小して読み込みます。                  
クリップ枠(=ビューポート枠)は画面枠に設定され、画面外は"0"が読み込まれます。 
                                                                             
- パラメータの形式 -                                                         
  ┌─┬─────────────┐                                         
  │ 0│Ｄ│データ格納領域アドレス│                                         
  ├─┼─────────────┤                                         
  │ 4│Ｗ│データ格納領域セレクタ│                                         
  ├─┼─────────────┤                                         
  │ 6│SW│第1点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │ 8│SW│第1点Ｙ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │10│SW│第2点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │12│SW│第2点Ｙ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │14│Ｗ│Ｘの大きさ　　　　　　│                                         
  ├─┼─────────────┤                                         
  │16│Ｗ│Ｙの大きさ　　　　　　│                                         
  └─┴─────────────┘                                         
                                                                             
データ格納領域のデータ格納形式(4バイト単位のデータ列を用意する必要があります)
┌─┬───────────┐                                               
│BA│n bit pixel 　データ列│                                               
〜　〜　　　　　　　　　　　〜                                               
└─┴───────────┘                                               
                                                                             
ＸＸ:読み込む元絵のＸの大きさ┐                                              
 　　　　　　　　　　　　　　│としますと                                    
ＹＹ:読み込む元絵のＹの大きさ┘                                              
データ領域の大きさは以下の式に基づいて求めます。(整数型で計算)               
                                                                             
 ●　2色モード時　　　　　　(ＸＸ＋7)/8×(ＹＹ)       
 ● 16色モード時　　　　　　(ＸＸ＋7)/8×4×(ＹＹ)    
 ●256色モード時　　　　　　(ＸＸ)×(ＹＹ)            
 ●32K色モード時　　　　　　(ＸＸ)×2×(ＹＹ)         
 ●16M色モード時(24ビット)　(ＸＸ)×4×(ＹＹ)  
 ●16M色モード時(32ビット)　(ＸＸ)×4×(ＹＹ)         
                                                                             
-----------------------------------------------------------------------------
.EGB_getDisplayPage                                                          
表示ページの読み取り                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_getDisplayPage( Priority, Display );                             
int 　　*Priority;　　 /* 　優先度の高いページ番号　　　 */                  
int 　　*Display ;　　 /* 　表示ページ　　　　　　　　　 */                  
                                                                             
- 戻り値 -                                                                   
表示ページと優先順位を以下の形式で返します。                                 
                                                                             
　　　31　　　　　10　 9　 8　7　　　　　　　  　　0                         
　　┌──〜〜───┬─┬─┬───────────┐                       
　　│　　　　　　　│　│　│　　　　　　　　　　　│                       
　　└──〜〜───┴┬┴┬┴────┬──────┘                       
   0:ページ1非表示──┘　│　　　　　└─　優先度の高いページ番号           
   1:ページ1表示　　　　　│                                                 
   0:ページ0非表示────┘                                                 
   1:ページ0表示                                                             
                                                                             
                                                                             
- 例 -                                                                       
int 　　priority;                                                            
int 　　display;                                                             
int 　　ret;                                                                 
ret = EGB_getDisplayPage(&priority, &display);                               
                                                                             
- 内容 -                                                                     
現在の表示ページと優先順位を読み取ります。                                   
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.EGB_getDisplayStart                                                         
表示開始位置の読み取り                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_getDisplayStart( page, mode, x, y);                              
int 　　page; 　　　　　　　/*　ページ番号　　　　　　　　　　 */            
int 　　mode; 　　　　　　　/*　モード　　　　　　　　　　　　 */            
int 　　*x; 　　　　　　　　/*　横方向パラメータ　　　　　　　 */            
int 　　*y; 　　　　　　　　/*　縦方向パラメータ　　　　　　　 */            
                                                                             
- 戻り値 -                                                                   
画面の表示開始位置を以下の形式で返します。                                   
                                                                             
　　　31　　　　　　　16　15　　　　　　　0                                  
　　┌─────────┬─────────┐                               
　　│　　　　　　　　　│　　　　　　　　　│                               
　　└──────┬──┴───┬─────┘                               
縦方向パラメータ─┘　　　　　　│                                           
　　　　　　　　　　　　　　　　│                                           
横方向パラメータ────────┘                                           
                                                                             
- 例 -                                                                       
int 　　page;                                                                
int 　　mode;                                                                
int 　　ret;                                                                 
int 　　x,y;                                                                 
page = 0;                                                                    
mode = 1;                                                                    
                                                                             
ret = EGB_getDisplayStart(page, mode, &x, &y);                               
                                                                             
- 内容 -                                                                     
画面の表示開始位置を読み取ります。                                           
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.EGB_getModeInfo                                                             
画面モードに関する情報の読み取り                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_getModeInfo( mode, vx, vy, dx, dy, col );                        
int 　　mode; /*　画面モード　　　　　　　　*/                               
int 　　*vx;　/*　仮想画面水平方向ドット数　*/                               
int 　　*vy;　/*　仮想画面垂直方向ドット数　*/                               
int 　　*dx;　/*　表示画面水平方向ドット数　*/                               
int 　　*dy;　/*　表示画面垂直方向ドット数　*/                               
int 　　*col; /*　同時表示色数　　　　　　　*/                               
                                                                             
- 戻り値 -                                                                   
 0:正常終了                                                                  
-1:指定した番号の画面モードは存在しない
                                                                             
- 例 -                                                                       
int 　　mode, vx, vy, dx, dy, col;                                           
int 　　ret;                                                                 
                                                                             
ret = EGB_getModeInfo( mode, &vx, &vy, &dx, &dy, &col );                     
                                                                             
- 内容 -                                                                     
指定した画面モードでの仮想画面と表示画面の大きさ、同時発色数を読み込みます。 
変数のポインタにNULLを代入した場合、その変数に対して情報を返しません。       
                                                                             
-----------------------------------------------------------------------------
.EGB_getPalette                                                              
パレットの読み取り                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_getPalette( page, pal_);                                         
int 　　page; 　　　　　　　　/*　ページ番号　　　　　　　　　 */            
char　　*pal_; 　　　　　　 　/*　パレットの内容　　　　　　　 */            
                                                                             
- 戻り値 -                                                                   
 0:正常終了                                                                  
-1:パレットが存在しない画面モードを指定した。あるいは存在しないページのパレッ
   トを取得しようとした。                                                    
                                                                             
- 例 -                                                                       
char　　pal_[4+8*16];                                                        
int 　　page;                                                                
int 　　ret;                                                                 
page = 0;                                                                    
                                                                             
ret = EGB_getPallette(page, pal_);                                           
                                                                             
- 内容 -                                                                     
現在のパレット状態を読み取ります。                                           
                                                                             
パレット状態のデータ形式                                                     
  ┌─┬──────────────┐                                       
  │ 0│Ｄ│読み取ったパレットの総数│                                       
  ├─┼──────────────┤┐                                     
  │ 4│Ｄ│色識別番号（通し番号）　││                                     
  ├─┼──────────────┤│                                     
  │ 8│Ｂ│青の階調　　（0〜 255） ││                                     
  ├─┼──────────────┤│                                     
  │ 9│Ｂ│赤の階調　　（0〜 255） │├※                                   
  ├─┼──────────────┤│                                     
  │10│Ｂ│緑の階調　　（0〜 255） ││                                     
  ├─┼──────────────┤│                                     
  │11│Ｂ│　0　　　　　　　　　　 ││                                     
  ├─┼──────────────┤┘                                     
  〜　〜　　　※の繰り返し　　　　　〜                                       
  └─┴──────────────┘                                       
                                                                             
 各色の階調は以下のような意味を持ちます。                                    
                                                                             
　　　　　　　b07 b06 b05 b04 b03 b02 b01 b00                                
　　　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                               
　16色モード│パレットデータ│　　不　定　　│                               
　　　　　　└─┴─┴─┴─┴─┴─┴─┴─┘                               
                                                                             
　　　　　　　b07 b06 b05 b04 b03 b02 b01 b00                                
　　　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                               
 256色モード│　　　　パレットデータ　　　　│                               
　　　　　　└─┴─┴─┴─┴─┴─┴─┴─┘                               
                                                                             
-----------------------------------------------------------------------------
.EGB_getResolution                                                           
仮想画面の読み取り                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　 EGB_getResolution( Page0, Page1);                                     
int 　　*Page0; 　　　　 /* 　ページ0の画面モード */                         
int 　　*Page1; 　　　　 /* 　ページ1の画面モード */                         
                                                                             
- 戻り値 -                                                                   
現在の画面モードを以下の形式で返します。                                     
                                                                             
　31　16　15　　　　　8　7　　　　   　0                                     
┌─〜─┬───────┬───────┐                                   
│　　　│　　　　　　　│　　　　　　　│                                   
└─〜─┴───┬───┴───┬───┘                                   
　　　　　　　　│　　　　　　　└────Page0 の画面ﾓｰﾄﾞ                   
　　　　　　　　└────────────Page1 の画面ﾓｰﾄﾞ                   
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
int 　　page0, page1;                                                        
                                                                             
ret =  EGB_getResolution(&page0, &page1);                                    
                                                                             
- 内容 -                                                                     
現在の画面モードを読み取ります。                                             
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.EGB_getTmenuPalette                                                         
TownsMENU V2.1メニュー色の読み取り                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_getTmenuPalette( buff );                                         
char　　*buff;　　/*　　パラメータのアドレス　 */                            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　buff[8*16+4];                                                        
int 　　ret;                                                                 
                                                                             
ret = EGB_getTmenuPalette( buff );                                           
                                                                             
- 内容 -                                                                     
システム情報領域から、TownsMENU V2.1のメニュー色を読み取ります。             
EGB_tmenuPalette2もしくはEGB_setTmenuPaletteによって設定されたシステム情報を 
読み取ります。                                                               
サイドワークアプリケーションの｢メニュー色設定｣で、                           
 1.｢系列設定｣でメニュー色を設定している場合                                  
 2.｢詳細設定｣でメニュー色を設定している場合                                  
   詳細設定色の6色(色識別番号1, 6, 7, 8, 9, 15番)のメニュー色を読み取ります。
 3.｢全パレット設定｣でメニュー色を設定している場合                            
   全パレット色(色識別番号0〜15)のメニュー色を読み取ります。                 
                                                                             
- パラメータのデータ形式 -                                                   
  ┌─┬────────────────┐                                   
  │ 0│Ｄ│読み取ったメニュー色の総数　│                                   
  ├─┼────────────────┤┐                                 
  │ 4│Ｄ│色識別番号（通し番号）　　　││                                 
  ├─┼────────────────┤│                                 
  │ 8│Ｂ│青の階調（0〜255）　　　    ││                                 
  ├─┼────────────────┤│                                 
  │ 9│Ｂ│赤の階調（0〜255）　　　    │├※                               
  ├─┼────────────────┤│                                 
  │10│Ｂ│緑の階調（0〜255）　　    　││                                 
  ├─┼────────────────┤│                                 
  │11│Ｂ│　　　　　0　　　　　　　 　││                                 
  ├─┼────────────────┤┘                                 
  〜　〜　※の繰り返し　　　　　　　    〜                                   
  └─┴────────────────┘                                   
                                                                             
各色の階調は以下の様な意味を持ちます。                                       
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　　　　パレットデータ　　　　│                                           
└─┴─┴─┴─┴─┴─┴─┴─┘                                           
                                                                             
-----------------------------------------------------------------------------
.EGB_getWritePage                                                            
書き込みページの読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　 EGB_getWritePage( egb_work, egb_sel );                              
char　　 *egb_work　　　　　　/*　EGB 作業域アドレス　　　　 */              
unsigned short egb_sel;　　　 /*  EGB 作業域セレクタ　　　　 */              
                                                                             
- 戻り値 -                                                                   
書き込みページを返します。                                                   
                                                                             
- 例 -                                                                       
char　　 work[1536];                                                         
int 　　 page,hpage;                                                         
unsigned short egb_sel;                                                      
egb_sel = getds();　　　　　　/*　データ格納領域セレクタを得る　 */          
                                                                             
page =　EGB_getWritePage( work, egb_sel );                                   
/*　ハードウェア的に設定した書き込みページを得る　*/                         
hpage = EGB_getWritePage(0,0);                                               
                                                                             
- 内容 -                                                                     
指定されたワーク中の書き込みページを読み取ります。                           
EGB作業域のセレクタの内容を0にした場合は、EGBがハードウェア的に設定した書き込
みページを読み取ります。                                                     
なお、例中のgetds関数を用いるには、MSDOS.CFをインクルードする必要があります。
                                                                             
-----------------------------------------------------------------------------
.EGB_graphicCursor                                                           
グラフィックカーソル                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_graphicCursor( work, clip, para );                               
char　　*work;　　　　　/*　作業域のアドレス　　　　　　　　　*/             
int 　　clip; 　　　　　/*　クリップ枠                                       
　　　　　　　　　　　　　(=ビューポート枠)の扱いの指定　　*/                
char　　*para;　　　　　/*　パラメータのアドレス　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_graphicCursor( work, 0, para );                                    
                                                                             
- 内容 -                                                                     
矩形域内のグラフィックカーソルドットデータを書き込みます。                   
グラフィックカーソルドットデータは、ピクセル構成と同じになります。           
データ格納領域の横方向ドット数は、横ドット数(8,16,24,32)/8を設定します。     
                                                                             
　　　　　　　　　　　　　　　 1　 0                                         
　　　　┌─────────┬─┬─┐                                       
 clip:　│　　　　　　　　　│　│　│                                       
　　　　└─────────┴┬┴┬┘                                       
　　　　　　　　　　　　　　　│　└view port 0:無効(画面枠に設定)           
　　　　　　　　　　　　　　　│　　　　　　　1:有効                         
　　　　　　　　　　　　　　　└─mask　0:無効                               
　　　　　　　　　　　　　　　　　　　　1:有効(画面マスク有効時に有効)       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬──────────────────┐                               
  │ 0│Ｄ│データ格納領域アドレス　　　　　│                               
  ├─┼──────────────────┤                               
  │ 4│Ｗ│データ格納領域セレクタ　　　　　│                               
  ├─┼──────────────────┤                               
  │ 6│SW│描画Ｘ座標　　　　　　　　　　　│                               
  ├─┼──────────────────┤                               
  │ 8│SW│描画Ｙ座標　　　　　　　　　　　│                               
  └─┴──────────────────┘                               
                                                                             
データ格納領域のデータ格納形式                                               
  ┌─┬──────────────────┐                               
  │ 0│Ｂ│横方向ドット数:8n(1≦n≦4)　　　│                               
  ├─┼──────────────────┤                               
  │ 1│Ｂ│縦方向ドット数:1〜32　　　　　　│                               
  ├─┼──────────────────┤                               
  │ 2│BA│グラフィックカーソルドットデータ│                               
  〜　〜　　　　　　　　　　　　　　　    　〜                               
  ├─┼──────────────────┤                               
  │BA│ＡＮＤデータ　　　　　　　　　　    │                               
  〜　〜　　　　　　　　　　　　　　　　    〜                               
  └─┴──────────────────┘                               
                                                                             
-----------------------------------------------------------------------------
.EGB_hatchingPattern                                                         
ハッチングパターンの設定                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_hatchingPattern( work, c, n, d, data );                          
char　　*work;　　　/*　作業域のアドレス　　　　　　　　　　　*/             
int 　　c;　　　　　/*　(0:前景、1:背景、2:面塗り)　　*/                     
int 　　n;　　　　　/*　横方向ドット数:8n(1≦n≦4),nを指定　 */              
int 　　d;　　　　　/*　縦方向ドット数:1〜32　　　　　　　　*/               
char　　*data;　　　/*　ハッチングパターンデータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　*hatching;                                                           
int 　　ret;                                                                 
ret = EGB_hatchingPattern( work, 0, 1, 8, hatching );                        
                                                                             
- 内容 -                                                                     
ハッチングパターンを設定します。                                             
ハッチングパターンの横方向ドット数nは、設定したい横方向ドット数(8,16,24,32)/8
で求めます。                                                                 
　　　┌─┬─┬─┬─┬─┬─┬─┬─┬─〜─┐                             
data: │ 0│ 1│ 0│ 1│ 0│ 1│ 0│ 1│　〜　│                             
　　　└─┴─┴─┴─┴─┴─┴─┴─┴─〜─┘                             
　　　　　　0:演算しません                                                   
　　　　　　1:論理演算して描画します                                         
                                                                             
- 参考 -                                                                     
      　16×16ドットのハッチングデータ                                       
　　　　■■■■■■■■■■■■■■■■                                     
　　　　□□□■■□□□□□□□□□□□                                     
　　　　□□□■■□□□□□□□□□□□                                     
　　　　□□□■■□□□□□□□□□□□　　　■　論理演算して描画           
　　　　■■■■■■■■■■■■■■■■　　　□　未描画(元の画面)           
　　　　□□□□□□□□□□□■■□□□                                     
　　　　□□□□□□□□□□□■■□□□                                     
　　　　□□□□□□□□□□□■■□□□                                     
　　　　■■■■■■■■■■■■■■■■                                     
　　　　□□□■■□□□□□□□□□□□                                     
　　　　□□□■■□□□□□□□□□□□                                     
　　　　□□□■■□□□□□□□□□□□                                     
　　　　■■■■■■■■■■■■■■■■                                     
　　　　□□□□□□□□□□□■■□□□                                     
　　　　□□□□□□□□□□□■■□□□                                     
　　　　□□□□□□□□□□□■■□□□                                     
                                                                             
-----------------------------------------------------------------------------
.EGB_init                                                                    
初期化                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_init( work, size );                                              
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　 */            
int 　　size; 　　　　　　　/*　作業域の大きさ　　　　　　　　 */            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_init( work, 1536 );                                                
                                                                             
- 内容 -                                                                     
作業域を以下の内容に初期化し、画面(全ページ)を色識別番号0で消去します。      
作業域の大きさは、1536byte固定です。                                         
                                                                             
解像度　　　　　　　　　　　　:640×480×16色×2画面                         
書き込みページ　　　　　　　　:ページ0                                       
表示ページ　　　　　　　　　　:ハードウェア依存                              
前景色　　　　　　　　　　　　:最大色識別番号(白)                            
背景色　　　　　　　　　　　　:色識別番号0(黒)                               
繰抜色　　　　　　　　　　　　:色識別番号0(黒)                               
混色比率　　　　　　　　　　　:128 (平均)                                    
パレットレジスタ　　　　　　　:16色初期値                                    
ビューポート　　　　　　　　　:画面枠                                        
文字間の空白　　　　　　　　　:0                                             
文字の方向　　　　　　　　　　:右                                            
文字の並び　　　　　　　　　　:右方向                                        
文字描画Ｘ座標　　　　　　　　:0                                             
文字描画Ｙ座標　　　　　　　　:0                                             
面塗りモード　　　　　　　　　:境界ベタ                                      
面塗り色　　　　　　　　　　　:色識別番号0(黒)                               
描画モード　　　　　　　　　　:PSET                                          
スーパーインポーズ　　　　　　:OFF                                           
インポーズ領域　　　　　　　　:なし                                          
インポーズ輝度　　　　　　　　:高輝度                                        
ペンの太さ　　　　　　　　　　:1                                             
マスクビット　　　　　　　　　:全描画                                        
字体　　　　　　　　　　　　　:標準                                          
線分パターン　　　　　　　　　:直線                                          
ハッチングパターン　　　　　　:未登録                                        
タイルパターン　　　　　　　　:未登録                                        
                                                                             
-----------------------------------------------------------------------------
.EGB_jisString                                                               
文字列2                                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_jisString( work, para );                                         
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_jisString( work, para );                                           
                                                                             
- 内容 -                                                                     
文字列(JISコード文字列)を描画します。                                        
EGB_sjisString, EGB_asciiStringとは異なり、文字列の長さは漢字を1文字と数えま 
す。                                                                         
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬────────────────┐                                   
  │ 0│SW│描画開始Ｘ座標　　　　　　　│                                   
  ├─┼────────────────┤                                   
  │ 2│SW│描画開始Ｙ座標　　　　　　　│                                   
  ├─┼────────────────┤                                   
  │ 4│Ｗ│文字列の長さ　　　　　　　　│                                   
  ├─┼────────────────┤                                   
  │ 6│WA│文字列　　　　　　　　　　　│                                   
  〜　〜　　　　　　　　　　　　    　　〜                                   
  └─┴────────────────┘                                   
                                                                             
-----------------------------------------------------------------------------
.EGB_linePattern                                                             
線分パターンの設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_linePattern( work, mode, l_pattern );                            
char　　*work;　　　　　/*　作業域のアドレス　　　　　　　　*/               
int 　　mode; 　　　　　/*　0:角点スタート、1:連続　　　　　*/               
int 　　l_pattern;　　　/*　線分パターン　　　　　　　　　　*/               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_linePattern( work, 0, 0x55555555 );                                
                                                                             
- 内容 -                                                                     
線分パターンを設定します。                                                   
                                                                             
　　　　　　 31 　　　　　　　　　　　　　　　　　　0                        
　　　　　　┌────┬────┬────┬────┐                       
 1_pattern: │　　　　│　　　　│　　　　│　　　　│                       
　　　　　　├────┼────┴────┴────┘                       
　　　　　　│　　　　└─────┐                                         
　　　　　　│31　30　　　　　　　└────┐　　 0                         
　　　　　　├─┬─┬─┬─┬─┬─┬─┬─┼─〜─┐                       
　　　　　　│ 0│ 1│ 0│ 1│ 0│ 1│ 0│ 1│　〜　│                       
　　　　　　└─┴─┴─┴─┴─┴─┴─┴─┴─〜─┘                       
                                                                             
　　　　　　　　　0:描画モードがOPAQUEの場合のみ背景色で描画します。         
                                                                             
　　　　　　　　　1:描画モードに応じて論理演算して描画します。               
                                                                             
                                                                             
                                                                             
 mode ＝　0　　　　　　　　　　　　　 mode ＝　1                             
┌─────────────┐　　　　┌─────────────┐         
├──　───　───　─┐←ﾊﾟﾀｰﾝを ├──　───　───　─┐←ﾊﾟﾀｰﾝを  
│　　　　　　　　　　　　││　　　　│　　　　　　　　　　　　││         
│　　　　　　　　　　　　││　開始　│　　　　　　　　　　　　　│　連続   
│　　　　　　　　　　　　　│　　　　│　　　　　　　　　　　　││         
│　　　　　　　　　　　　││　　　　│　　　　　　　　　　　　││         
└────────────┴┘　　　　└────────────┴┘         
                                                                             
-----------------------------------------------------------------------------
.EGB_mask                                                                    
画面マスクの設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_mask( work, m );                                                 
char　　*work 　　　　　　　　　/*　作業域のアドレス　　　　　　　*/         
int 　　m;　　　　　　　　　　　/*　マスク機能　　　　　　　　　　*/         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_mask( work, 0x80 ); 　/*　マスク有効、閉領域にマスク　　*/         
                                                                             
- 内容 -                                                                     
画面マスク機能を設定します。                                                 
マスク有効の場合には、全ての描画がマスク領域と演算を行った結果が描画されま   
す。                                                                         
閉領域にマスクの場合は、マスク領域の値が"0"の部分は描画の対象となります。また
開領域にマスクの場合は"1"の部分が描画の対象となります。                      
マスク領域のクリアのビットが"1"の場合、指定されたマスク領域が"0"でクリアされ 
ます。                                                                       
                                                                             
　　　7　6　5　4　3　2　1　0                                                 
　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                       
 ｍ:│　│　│　│　│　│　│　│　│                                       
　　└┬┴─┴─┴─┴─┴─┴┬┴┬┘                                       
　　　│　　　　　　　　　　　│　│                                         
　　　│　　　　　　　　　　　│　└─0:閉領域にマスク                       
　　　│　　　　　　　　　　　│                                             
　　　│　　　　　　　　　　　│　　　1:開領域にマスク                       
　　　└─0:マスク無効　　　  │                                             
　　　　　　　　　　　　　　　└─0:マスク領域をクリアしない                 
　　　　　1:マスク有効                                                       
　　　　　　　　　　　　　　　　　1:マスク領域をクリアする                   
                                                                             
-----------------------------------------------------------------------------
.EGB_maskBit                                                                 
マスクビットの設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_maskBit( work, bit );                                            
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　bit;　　　　　　　　/*　マスクビット　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_maskBit( work, 0xffffffff );                                       
                                                                             
- 内容 -                                                                     
マスクビットを設定します。                                                   
ビットが"0"の部分は描画されません。この機能はハードウェアにより行います。    
VRAMのみ有効となります。wipeやresolve等を高速に行うときに有効です。          
                                                                             
　　　　　　　┌─┬─┬─┬─┬─┬─┬─┬─┬──〜──┐                 
描画データ　　│ 1│ 1│ 1│ 1│ 1│ 1│ 1│ 1│　　　　　│                 
　　　　　　　└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┴──〜──┘                 
　　　　　　　　↓　↓　↓　↓　↓　↓　↓　↓                               
　　　　　　　┌─┬─┬─┬─┬─┬─┬─┬─┬──〜──┐                 
マスクビット　│ 1│ 0│ 1│ 0│ 1│ 0│ 1│ 0│　　　　　│                 
　　　　　　　└┬┴─┴┬┴─┴┬┴─┴┬┴─┴──〜──┘                 
　　　　　　　　↓　　　↓　　　↓　　　↓                                   
　　　　　　　┌─┬─┬─┬─┬─┬─┬─┬─┬──〜──┐                 
描画後　　　　│ 1│ 0│ 1│ 0│ 1│ 0│ 1│ 0│　　　　　│                 
　　　　　　　└─┴─┴─┴─┴─┴─┴─┴─┴──〜──┘                 
                                                                             
                                                                             
-----------------------------------------------------------------------------
.EGB_maskData                                                                
マスクデータの書き込み                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_maskData( work, clip, para );                                    
char　　*work;　　　　　　/*　作業域のアドレス　　　　　　　　*/             
int 　　clip; 　　　　　　/*　クリップ枠(=ビューポート枠)　*/                
char　　*para;　　　　　　/*　パラメータのアドレス　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_maskData( work, 0, para );                                         
                                                                             
- 内容 -                                                                     
矩形域内のドットデータをマスクを考慮して書き込みます。                       
マスクデータは、モノクロデータを用意します。                                 
                                                                             
　　　　　　　　　　　　　　1　0                                             
　　　┌─────────┬─┬─┐                                         
 clip:│　　　　　　　　　│　│　│                                         
　　　└─────────┴┬┴┬┘                                         
　　　　　　　　　　　　　　│　└view port 0:無効                           
　　　　　　　　　　　　　　│　　　　　　　1:有効                           
　　　　　　　　　　　　　　└─mask　0:無効                                 
　　　　　　　　　　　　　　　　　　　1:有効                                 
                                                                             
- パラメータの形式 -                                                         
  ┌─┬───────────────┐                                     
  │ 0│Ｄ│データ格納領域アドレス　　│                                     
  ├─┼───────────────┤                                     
  │ 4│Ｗ│データ格納領域セレクタ　　│                                     
  ├─┼───────────────┤                                     
  │ 6│SW│第1点Ｘ座標　　　　　　　 │                                     
  ├─┼───────────────┤                                     
  │ 8│SW│第1点Ｙ座標　　　　　　　 │                                     
  ├─┼───────────────┤                                     
  │10│SW│第2点Ｘ座標　　　　　　　 │                                     
  ├─┼───────────────┤                                     
  │12│SW│第2点Ｙ座標　　　　　　　 │                                     
  └─┴───────────────┘                                     
                                                                             
データ格納領域のデータ格納形式                                               
┌─┬─────────────┐                                           
│BA│ドットデータ　　　　　　　│                                           
〜　〜　　　　　　　　　　　　　〜                                           
├─┼─────────────┤                                           
│BA│マスクデータ　　　　　　　│                                           
〜　〜　　　　　　　　　　　　　〜                                           
└─┴─────────────┘                                           
                                                                             
-----------------------------------------------------------------------------
.EGB_maskRegion                                                              
画面マスク領域の設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_maskRegion( work, m_region );                                    
char　　*work;　　　　　　/*　作業域のアドレス　　　　　　　*/               
char　　*m_region; 　　　 /*　画面マスク領域の先頭アドレス　*/               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　m_region[64*1024];                                                   
int 　　ret;                                                                 
                                                                             
ret = EGB_maskRegion( work, m_region );                                      
                                                                             
- 内容 -                                                                     
画面マスク領域を設定します。                                                 
画面マスク領域は、仮想画面に応じて、以下の画面マスク領域のメモリが必要です。 
画面マスクは、不定型のクリッピングを行います。                               
                                                                             
メモリ =((仮想画面横サイズ+7)/8)×仮想画面縦サイズ                           
                                                                             
- 参考 -                                                                     
マスク有効画面に矩形を描画した場合                                           
図CL21R-017                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_paint                                                                   
ペイント1                                                                    
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_paint( work, para );                                             
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_paint( work, para );                                               
                                                                             
- 内容 -                                                                     
境界色を境界として塗り潰します。                                             
境界色数が0のときは、処理を行いません。                                      
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬───────────────┐                                     
  │ 0│SW│ペイント開始Ｘ座標　　　　│                                     
  ├─┼───────────────┤                                     
  │ 2│SW│ペイント開始Ｙ座標　　　　│                                     
  ├─┼───────────────┤                                     
  │ 4│Ｗ│境界色数　　　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 6│Ｗ│0　　　　　　　　　　　　 │                                     
  ├─┼───────────────┤┐                                   
  │ 8│DA│色識別番号1　　　　　　　 ││                                   
  ├─┼───────────────┤│                                   
  │12│DA│色識別番号2　　　　　　　 ││                                   
  ├─┼───────────────┤├境界色数分                         
  │16│DA│色識別番号3　　　　　　　 ││                                   
  ├─┼───────────────┤│                                   
  〜　〜　　　　　　　　　　　　　　　〜│                                   
  └─┴───────────────┘┘                                   
                                                                             
-----------------------------------------------------------------------------
.EGB_paintMode                                                               
面塗りモードの設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_paintMode( work, p_mode );                                       
char　　*work;　　　　　　　　　/*　作業域のアドレス　　　　　　　*/         
int 　　p_mode; 　　　　　　　　/*　面塗りモード　　　　　　　　　*/         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_paintMode( work, 0x22 );                                           
                                                                             
- 内容 -                                                                     
以下のように面塗りモードを指定します。                                       
線画、文字描画にも有効です。p_mode=0とすると描画されません。                 
前景色と面塗り色が同じで以下の条件を満たすときは、面塗りモードを0x22ではなく 
0x20に設定することにより、同じ描画結果でより速く描画できます。               
                                                                             
前景色　:描画モード───PSET,PRESET 　　　線分パターン──0xffffffff        
　　　　　面塗りモード──ベタ塗りのみ　　　ペン設定────システムペン     
　　　　　マスク─────なし　　　　　　　ペン太さ────1                
面塗り色:描画モード───PSET,PRESET                                         
　　　　　面塗りモード──ベタ塗りのみ                                       
　　　　　マスク─────なし                                               
                                                                             
図CL21R-018                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_palette                                                                 
パレットレジスタの設定                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_palette( work, vsync, para );                                    
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　vsync;　　　　　　　/*　0:vsyncを待たずに設定                        
　　　　　　　　　　　　　　　　1:vsyncを待って設定　　　　 */               
char　　*para;　　　　　　　/*　パラメータのアドレス　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
DWORD(para + 0) = 1;                                                         
DWORD(para + 4) = 7;                                                         
BYTE(para + 8) = 128;                                                        
BYTE(para + 9) = 128;                                                        
BYTE(para + 10) = 128;                                                       
BYTE(para + 11) = 0;                                                         
ret = EGB_palette( work, 1, para );                                          
                                                                             
- 内容 -                                                                     
色識別番号に対応する色(三原色:青、赤、緑の階調)を設定します。                
書き込みページに対して有効です。VSYNC待ち有り、設定パレット数"0"とするとVSYNC
のみを取ることができます。                                                   
16色2画面表示の場合、レイヤ0側の色識別番号0のパレットは変更できません。      
                                                                             
- パラメータの形式 -                                                         
  ┌─┬──────────────┐                                       
  │ 0│Ｄ│設定パレット数　　　　　│                                       
  ├─┼──────────────┤┐                                     
  │ 4│Ｄ│色識別番号（通し番号）　││                                     
  ├─┼──────────────┤│                                     
  │ 8│Ｂ│青の階調　　（0〜 255） ││                                     
  ├─┼──────────────┤│                                     
  │ 9│Ｂ│赤の階調　　（0〜 255） │├※                                   
  ├─┼──────────────┤│                                     
  │10│Ｂ│緑の階調　　（0〜 255） ││                                     
  ├─┼──────────────┤│                                     
  │11│Ｂ│　0　　　　　　　　　　 ││                                     
  ├─┼──────────────┤┘                                     
  〜　〜　　　※の繰り返し　　　　　〜                                       
  └─┴──────────────┘                                       
                                                                             
各色の階調は以下のような意味を持ちます。                                     
                                                                             
　　　　　　　b07 b06 b05 b04 b03 b02 b01 b00                                
　　　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                               
　16色モード│パレットデータ│　　不　定　　│                               
　　　　　　└─┴─┴─┴─┴─┴─┴─┴─┘                               
                                                                             
　　　　　　　b07 b06 b05 b04 b03 b02 b01 b00                                
　　　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                               
 256色モード│　　　　パレットデータ　　　　│                               
　　　　　　└─┴─┴─┴─┴─┴─┴─┴─┘                               
                                                                             
-----------------------------------------------------------------------------
.EGB_partClearScreen                                                         
画面の消去                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_partClearScreen( work );                                         
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_partClearScreen( work );                                           
                                                                             
- 内容 -                                                                     
ビューポート内の画面を背景色で塗り潰します。                                 
                                                                             
図CL21R-019                                                                  
                                                                             
32K色2画面合成をする場合には、レイヤ0側の背景色の設定時に、インポーズビットを
"1"にしてください。(例:EGB_color(work,1,0x8000);)                            
他のモードで2画面合成をする場合には、レイヤ0側の背景色の設定時に、色識別番号0
を設定してください。(例:EGB_color(work,1,0);)                                
                                                                             
-----------------------------------------------------------------------------
.EGB_partScroll                                                              
部分画面スクロール                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_partScroll( work, n, xdot, ydot, para );                         
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　n;　　　　　　　　　/*　背景色描画の指定                             
　　　　　　　　　　　　　　　　（0:行わない、1:行う) 　　*/                 
int 　　xdot; 　　　　　　　/*　横方向に移動するドット数　　　*/             
int 　　ydot; 　　　　　　　/*　縦方向に移動するドット数　　　*/             
char　　*para;　　　　　　　/*　パラメータのアドレス　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
WORD(para + 0) = 100;                                                        
WORD(para + 2) = 100;                                                        
WORD(para + 4) = 250;                                                        
WORD(para + 6) = 250;                                                        
ret = EGB_partScroll( work, 1, -24, -24, para );                             
                                                                             
- 内容 -                                                                     
部分画面スクロールは書き込みページの対角2点で示される部分画面の中を上下左右に
移動します。                                                                 
ビューポートの影響を受けます。                                               
                                                                             
n=0:背景色描画を行わない                                                     
  1:背景色描画を行う                                                         
                                                                             
- パラメータの形式 -                                                         
  ┌─┬───────────┐                                             
  │ 0│SW│第1点Ｘ座標　　　 │                                             
  ├─┼───────────┤                                             
  │ 2│SW│第1点Ｙ座標　　　 │                                             
  ├─┼───────────┤                                             
  │ 4│SW│第2点Ｘ座標　　　 │                                             
  ├─┼───────────┤                                             
  │ 6│SW│第2点Ｙ座標　　　 │                                             
  └─┴───────────┘                                             
                                                                             
図CL21R-020                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_pastel                                                                  
混色比率の設定                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_pastel( work, ratio );                                           
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　ratio;　　　　　　　/*　描画色の強調度　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_pastel( work, 34 );                                                
                                                                             
- 内容 -                                                                     
描画色と描画位置色の混色比率を設定します。                                   
透明感ある描画を行う際に設定します。                                         
                                                                             
　　0←──────── ratio────────→ 256                          
　　┌──────────────────────┐                         
　　│　　　　　　　　　　　　　　　　　　　　　　│                         
　　└──────────────────────┘                         
描画位置色←──────強調度────────→描画色                       
                                                                             
- 参考 -                                                                     
 ratio＝128                                                                  
                                                                             
　　　　　　描画指定色　　　　　白色                                         
　　　　　　描画位置色　　　　　黒色                                         
　　　　　──────────────                                       
　　　　　　描画色　　　　　　　灰色                                         
                                                                             
 ratio=0 　:　描画しません。                                                 
 ratio=256 :　描画色のみ(PSET)の描画となります。                             
                                                                             
-----------------------------------------------------------------------------
.EGB_pen                                                                     
ペンの設定                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_pen( work, n );                                                  
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　n;　　　　　　　　　/*　ペンモード　　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_pen( work, 0 ); 　/*　システムペン、丸ペン　　　　　*/             
                                                                             
- 内容 -                                                                     
線描画に使用されるペンを設定します。                                         
ペン形状を変えるためには、ペンの設定をした後、EGB_penSizeを設定する必要があり
ます。                                                                       
                                                                             
　　　7　6　5　4　3　2　1　0                                                 
　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                       
 ｎ:│　│ 0│ 0│ 0│ 0│ 0│ 0│　│                                       
　　└┬┴─┴─┴─┴─┴─┴─┴┬┘                                       
　　　│　　　　　　　　　　　　　└0:丸ペン                                 
　　　│　　　　　　　　　　　　　　1:四角ペン                               
　　　└─0:システムペン                                                     
　　　　　1:ユーザペン                                                       
　　　　　　　　　　　　(ユーザペンはシステム形状で、くり抜かれた形          
　　　　　　　　　　　　　となります。)                                      
                                                                             
-----------------------------------------------------------------------------
.EGB_penSize                                                                 
ペンの太さの設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_penSize( work, n );                                              
char　　*work;　　　　　　　　　/*　作業域のアドレス　　　　　　　　*/       
int 　　n;　　　　　　　　　　　/*　ペンの太さ (0≦n≦32) 　　　　 */        
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_penSize( work, 5 ); 　/*　ペンの太さ　5　　　　　　　　　*/        
                                                                             
- 内容 -                                                                     
線描画に使用されるペンの太さを指定します。                                   
n = 0の場合は描画しません。ペンの中心点は(15,15)ドットの位置にあり、ペンの太 
さが偶数の時には右下に太くなります。                                         
                                                                             
- 参考 -                                                                     
   ペンの太さ16の場合                                                        
 　0　　　8 　　　　　　15　　　　　　　23　　　31                           
 0┌─〜─┬──────┬───────┬─〜─┐                           
　〜　　　│　　　　　　│　　　　　　　│　　　〜                           
 8├───┼────■■●■■■────┼───┤                           
　│　　　│　　　■■■●■■■■　　　│　　　│                           
　│　　　│　■■■■■●■■■■■■　│　　　│                           
　│　　　│　■■■■■●■■■■■■　│　　　│                           
　│　　　│■■■■■■●■■■■■■■│　　　│                           
　│　　　■■■■■■■●■■■■■■■■　　　│                           
　│　　　■■■■■■■●■■■■■■■■　　　│                           
15├───●●●●●●●●●●●●●●●●───┤                           
　│　　　■■■■■■■●■■■■■■■■　　　│                           
　│　　　■■■■■■■●■■■■■■■■　　　│                           
　│　　　■■■■■■■●■■■■■■■■　　　│                           
　│　　　│■■■■■■●■■■■■■■│　　　│                           
　│　　　│　■■■■■●■■■■■■　│　　　│                           
　│　　　│　■■■■■●■■■■■■　│　　　│                           
　│　　　│　　　■■■●■■■■　　　│　　　│                           
23├───┼────■■●■■■────┼───┤                           
　〜　　　│　　　　　　│　　　　　　　│　　　〜                           
31└─〜─┴──────┴───────┴─〜─┘                           
                                                                             
-----------------------------------------------------------------------------
.EGB_penStyle                                                                
ペン形状の設定                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_penStyle( work, penpattern );                                    
char　　*work;　　　　　　/*　作業域のアドレス　　　　　　　　*/             
char　　*penpattern;　　　/*　ペンパターンデータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　penpattern[128];                                                     
int 　　ret;                                                                 
                                                                             
ret = EGB_penStyle( work, penpattern );                                      
                                                                             
- 内容 -                                                                     
ペンの形状を指定します。                                                     
設定の方法は、ハッチングパターンと同じです。                                 
ペン形状を変えるためには、ペン形状の設定をした後、EGB_penSizeを設定する必要が
あります。                                                                   
ペンパターンデータは、128バイト必要です。                                    
                                                                             
ペンパターンデータ                                                           
図CL21R-021                                                                  
                                                                             
Bit=0:演算しません。                                                         
　　1:論理演算して描画します。                                               
                                                                             
-----------------------------------------------------------------------------
.EGB_point                                                                   
ポイント識別                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_point( work, n, x, y, ncolor );                                  
char　　*work;　　　　　　　　/*　作業域のアドレス　　　　　　　　*/         
int 　　n;　　　　　　　　　　/*　0 or 1(0:通し番号、1:IGRB) 　 */           
int 　　x;　　　　　　　　　　/*　Ｘ座標　　　　　　　　　　　　　*/         
int 　　y;　　　　　　　　　　/*　Ｙ座標　　　　　　　　　　　　　*/         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
int 　　*ncolor;　　　　　　　/*　色識別番号　　　　　　　　　　　*/         
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　a;                                                                   
int 　　ret;                                                                 
                                                                             
ret = EGB_point( work, 0, 100, 100, &a );                                    
                                                                             
- 内容 -                                                                     
座標値で示される点の色識別番号を返します。                                   
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
ｎ＝0:通し番号                                                               
　　1:ＩＧＲＢ                                                               
                                                                             
　　　　　　　　　　┌───────────────┐                       
 ｎ＝0　　　ncolor: │　　　　通　し　番　号　　　　│                       
　　　　　　　　　　└───────────────┘                       
                                                                             
　　　　　　　　　　 31 　24　23　16 15 　 8　7 　　0                        
　　　　　　　　　　┌───┬───┬───┬───┐                       
 ｎ＝1　　　ncolor: │　Ｉ　│　Ｇ　│　Ｒ　│　Ｂ　│                       
　　　　　　　　　　└───┴───┴───┴───┘                       
                                                                             
-----------------------------------------------------------------------------
.EGB_polygon                                                                 
多角形                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_polygon( work, para );                                           
chcr　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_polygon( work, para );                                             
                                                                             
- 内容 -                                                                     
多角形を描画します。                                                         
座標点数が3点未満の時は、描画されません。面塗りを行った時には、アルゴリズムの
違いにより境界線と重ならない場合があります。                                 
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
図CL21R-022                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_pset                                                                    
ポイント                                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_pset( work, para );                                              
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_pset( work, para );                                                
                                                                             
- 内容 -                                                                     
ポイントを描画します。                                                       
ラインスタイルの影響は受けません。                                           
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬──────────┐                                               
  │ 0│Ｗ│座標点数　　　　│　　　　　第1点　　　　第3点                   
  ├─┼──────────┤┐　　　　　･　　　　　　･　　　　第5点        
  │ 2│SW│第1点Ｘ座標　　 ││　　　　　　　　　　　　　　　　　･          
  ├─┼──────────┤├※                                           
  │ 4│SW│第1点Ｙ座標　　 ││　　　　　　　　･　　　　　　･               
  ├─┼──────────┤┘　　　　　　　第2点　　　　第4点             
  〜　〜　　※の繰り返し　　〜                                               
  └─┴──────────┘                                               
                                                                             
-----------------------------------------------------------------------------
.EGB_putBlock                                                                
ドットデータの書き込み1                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_putBlock( work, clip, para );                                    
char　　*work;　　　　　　/*　作業域のアドレス　　　　　　　　*/             
int 　　clip; 　　　　　　/*　クリップ枠(=ビューポート枠)　*/                
char　　*para;　　　　　　/*　パラメータのアドレス　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_putBlock( work, 0, para );                                         
                                                                             
- 内容 -                                                                     
矩形域内のドットデータを書き込みます。                                       
                                                                             
　　　　　　　　　　　　　　1　0                                             
　　　　┌────────┬─┬─┐                                         
 clip:　│　　　　　　　　│　│　│                                         
　　　　└────────┴┬┴┬┘                                         
　　　　　　　　　　　　　　│　└view port 0:無効（仮想画面枠に設定）       
　　　　　　　　　　　　　　│　　　　　　　1:有効                           
　　　　　　　　　　　　　　└─mask　0:無効                                 
　　　　　　　　　　　　　　　　　　　1:有効（画面マスク有効時に有効）       
- パラメータの形式 -                                                         
  ┌─┬─────────────┐                                         
  │ 0│Ｄ│データ格納領域アドレス│                                         
  ├─┼─────────────┤                                         
  │ 4│Ｗ│データ格納領域セレクタ│                                         
  ├─┼─────────────┤                                         
  │ 6│SW│第1点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │ 8│SW│第1点Ｙ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │10│SW│第2点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │12│SW│第2点Ｙ座標　　　　　 │                                         
  └─┴─────────────┘                                         
                                                                             
データ格納領域のデータ格納形式(4バイト単位のデータ列を用意する必要があります)
┌─┬───────────┐                                               
│BA│ 1/4/8/16 bit pixel 　│                                               
〜　〜　　　データ列　　　　〜                                               
└─┴───────────┘                                               
                                                                             
-----------------------------------------------------------------------------
.EGB_putBlockColor                                                           
ドットデータの書き込み                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_putBlockColor( work, clip, para );                               
char　　*work;　　　　　　/*　作業域のアドレス　　　　　　　　*/             
int 　　clip; 　　　　　　/*　クリップ枠(=ビューポート枠)　*/                
char　　*para;　　　　　　/*　パラメータのアドレス　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_putBlockColor( work, 0, para );                                    
                                                                             
- 内容 -                                                                     
矩形域内のドットデータを前景色で書き込みます。                               
                                                                             
　　　　　　　　　　　　　　1　0                                             
　　　┌─────────┬─┬─┐                                         
 clip:│　　　　　　　　　│　│　│                                         
　　　└─────────┴┬┴┬┘                                         
　　　　　　　　　　　　　　│　└view port 0:無効（仮想画面枠に設定）       
　　　　　　　　　　　　　　│　　　　　　　1:有効                           
　　　　　　　　　　　　　　└─mask　0:無効                                 
　　　　　　　　　　　　　　　　　　　1:有効（画面マスク有効時に有効）       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬─────────────┐                                         
  │ 0│Ｄ│データ格納領域アドレス│                                         
  ├─┼─────────────┤                                         
  │ 4│Ｗ│データ格納領域セレクタ│                                         
  ├─┼─────────────┤                                         
  │ 6│SW│第1点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │ 8│SW│第1点Ｙ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │10│SW│第2点Ｘ座標　　　　　 │                                         
  ├─┼─────────────┤                                         
  │12│SW│第2点Ｙ座標　　　　　 │                                         
  └─┴─────────────┘                                         
                                                                             
データ格納領域のデータ格納形式(4バイト単位のデータ列を用意する必要があります)
┌─┬───────────┐                                               
│BA│1 bit pixel 　データ列│                                               
〜　〜　　　　　　　　　　　〜                                               
└─┴───────────┘                                               
                                                                             
-----------------------------------------------------------------------------
.EGB_putBlockZoom                                                            
ドットデータの書き込み2                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_putBlockZoom( work, clip, para );                                
char　　*work;　　　　/*　作業域のアドレス　　　　　　　　　　　　　　*/     
int 　　clip; 　　　　/*　クリップ枠(=ビューポート枠)の扱いの設定　*/        
char　　*para;　　　　/*　パラメータのアドレス　　　　　　　　　　　　*/     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_putBlockZoom( work, 0, para );                                     
                                                                             
- 内容 -                                                                     
矩形域内のドットデータを拡大･縮小して書き込みます。                          
                                                                             
　　　　　　　　　　　　　　1　0                                             
　　　┌─────────┬─┬─┐                                         
 clip:│　　　　　　　　　│　│　│                                         
　　　└─────────┴┬┴┬┘                                         
　　　　　　　　　　　　　　│　└view port 0:無効 (仮想画面枠に設定)        
　　　　　　　　　　　　　　│　　　　　　　1:有効                           
　　　　　　　　　　　　　　└─mask　0:無効                                 
　　　　　　　　　　　　　　　　　　　1:有効 (画面マスク有効時に有効)        
                                                                             
- パラメータの形式 -                                                         
  ┌─┬───────────────────┐                             
  │ 0│Ｄ│データ格納領域アドレス　　　　　　│                             
  ├─┼───────────────────┤                             
  │ 4│Ｗ│データ格納領域セレクタ　　　　　　│                             
  ├─┼───────────────────┤                             
  │ 6│SW│第1点Ｘ座標　　　　　　　　　　　 │                             
  ├─┼───────────────────┤                             
  │ 8│SW│第1点Ｙ座標　　　　　　　　　　　 │                             
  ├─┼───────────────────┤                             
  │10│SW│第2点Ｘ座標　　　　　　　　　　　 │                             
  ├─┼───────────────────┤                             
  │12│SW│第2点Ｙ座標　　　　　　　　　　　 │                             
  ├─┼───────────────────┤                             
  │14│Ｗ│データ格納領域のデータのＸの大きさ│                             
  ├─┼───────────────────┤                             
  │16│Ｗ│データ格納領域のデータのＹの大きさ│                             
  └─┴───────────────────┘                             
                                                                             
データ格納領域のデータ格納形式(4バイト単位のデータ列を用意する必要があります)
┌─┬─────────────────┐                                   
│BA│n bit pixel 　データ列　　　　　　│                                   
〜　〜　　　　　　　　　　　　　　　　　〜                                   
└─┴─────────────────┘                                   
                                                                             
-----------------------------------------------------------------------------
.EGB_rectangle                                                               
矩形                                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_rectangle( work, para );                                         
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_rectangle( work, para );                                           
                                                                             
- 内容 -                                                                     
矩形を描画します。                                                           
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬─────────┐　　第1点                                        
  │ 0│SW│第1点Ｘ座標　 │　　　┌──────────────┐           
  ├─┼─────────┤　　　│　　　　　　　　　　　　　　│           
  │ 2│SW│第1点Ｙ座標　 │　　　│　　　　　　　　　　　　　　│           
  ├─┼─────────┤　　　│　　　　　　　　　　　　　　│           
  │ 4│SW│第2点Ｘ座標　 │　　　│　　　　　　　　　　　　　　│           
  ├─┼─────────┤　　　│　　　　　　　　　　　　　　│           
  │ 6│SW│第2点Ｙ座標　 │　　　│　　　　　　　　　　　　　　│           
  └─┴─────────┘　　　└──────────────┘　第2点    
                                                                             
                                                                             
-----------------------------------------------------------------------------
.EGB_region                                                                  
領域の設定                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_region( work, n, size, x1, y1, x2, y2, para);                    
char　　*work;　/*　作業域のアドレス　　　　　　　　　　　　　　　*/         
int 　　*n; 　　/*　0:内点判断する, 0x80:内点判断しない                      
　　　　　　　　　　(内点判断しない時は外接四角形も返さない) 　　*/          
int 　　*x1;　　/*　座標点Ｘ　　　　　　　　　　　　　　　　　　　*/         
int 　　*y1;　　/*　座標点Ｙ　　　　　　　　　　　　　　　　　　　*/         
char　　*para;　/*　パラメータのアドレス(多角形)　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
int 　　*n; 　　/*　0 :外点, 1 :内点　　　　　　　　　　　　　　*/           
int 　　*size;　/*　ワーク領域の大きさ　　　　　　　　　　　　　　*/         
int 　　*x1;　　/*　Ｘ座標点1 　　　　　　　　　　　　　　　　　　*/         
int 　　*y1;　　/*　Ｙ座標点1 　　　　　　　　　　　　　　　　　　*/         
int 　　*x2;　　/*　Ｘ座標点2 　　　　　　　　　　　　　　　　　　*/         
int 　　*y2;　　/*　Ｙ座標点2 　　　　　　　　　　　　　　　　　　*/         
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　n=0, worksize, a=100, b=100, c, d;                                   
int 　　ret;                                                                 
                                                                             
WORD(para + 0) = 4;                                                          
WORD(para + 2) = 100;                                                        
WORD(para + 4) = 100;                                                        
WORD(para + 6) = 250;                                                        
WORD(para + 8) = 100;                                                        
WORD(para + 10) = 250;                                                       
WORD(para + 12) = 250;                                                       
WORD(para + 14) = 100;                                                       
WORD(para + 16) = 250;                                                       
ret = EGB_region( work, &n, &worksize, &a, &b, &c, &d, para );               
                                                                             
- 内容 -                                                                     
複写･回転･画面マスクで使用される領域を設定します。                           
リターンコードには、複写･回転で使用するために必要なワーク領域の大きさと領域を
内接する矩形の大きさを返します。また座標点が多角形の内点か外点かの判別をしま 
す。                                                                         
パラメータのアドレスには、複写･回転･ぼかしを行う領域の座標総数と領域のX座標と
Y座標を設定します。                                                          
                                                                             
図CL21R-023                                                                  
                                                                             
-----------------------------------------------------------------------------
(1) .EGB_resolution                                                          
(2) .EGB_resolutionRam                                                       
仮想画面の設定                                                               
-----------------------------------------------------------------------------
                                                                             
 (1) 仮想画面モードを設定します。作業域の初期化をします。                    
     画面は消去されません。                                                  
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_resolution( work, page, mode );                                  
char　　*work;　　　/*　作業域のアドレス　　　　　　　　　　　　*/           
int 　　page; 　　　/*　ページ　0or1　　　　　　　　　　　　　*/             
int 　　mode; 　　　/*　番号(bit6="1"ではcrtc操作をしません) */              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_resolution( work, 0, 3 );                                          
ret = EGB_resolution( work, 1, 3 );                                          
                                                                             
 (2) ユーザＲＡＭ領域に仮想画面を設定します。作業域の初期化をします。        
                                                                             
- 定義 -                                                                     
int 　　EGB_resolutionRam( work, page, picsel, xsize, ysize, ram );          
char　　*work;　　　　　/*　作業域のアドレス　　　　　　　　　　*/           
int 　　page; 　　　　　/*　0x80 <= page <= 0x83　　　　　　　　*/           
int 　　picsel; 　　　　/*　ピクセル(1,4,8,16,24,32)　　　　　　*/           
int 　　xsize;　　　　　/*　仮想画面の横サイズ(32ドット単位) 　 */           
int 　　ysize;　　　　　/*　仮想画面の縦サイズ　　　　　　　　　*/           
char　　*ram; 　　　　　/*　ＲＡＭ領域　　　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　ram[256*1024];                                                       
int 　　ret;                                                                 
                                                                             
ret = EGB_resolutionRam( work, 0x80, 4, 1024, 512, ram );                    
                                                                             
作業域は以下の内容に初期化されます。                                         
                                                                             
前景色　　　　　　　　:最大色識別番号                                        
背景色　　　　　　　　:色識別番号0                                           
繰抜色　　　　　　　　:色識別番号0                                           
混色比率　　　　　　　:128 (平均)                                            
ビューポート　　　　　:画面域                                                
文字間の空白　　　　　:0                                                     
文字の方向　　　　　　:右                                                    
文字の並び　　　　　　:右方向                                                
文字描画Ｘ座標　　　　:0                                                     
文字描画Ｙ座標　　　　:0                                                     
面塗りモード　　　　　:境界ベタ                                              
面塗り色　　　　　　　:色識別番号0                                           
描画モード　　　　　　:PSET                                                  
スーパーインポーズ　　:OFF                                                   
インポーズ領域　　　　:なし                                                  
インポーズ輝度　　　　:高輝度                                                
ペンの太さ　　　　　　:1                                                     
字体　　　　　　　　　:標準                                                  
線分パターン　　　　　:直線                                                  
ハッチングパターン　　:未登録                                                
タイルパターン　　　　:未登録                                                
                                                                             
EGB_resolutionのみ以下の操作が行われます。                                   
                                                                             
設定された仮想画面モードが16色モード、もしくは256色モードの時のみパレットデー
タが初期化されます。                                                         
                                                                             
- 内容 -                                                                     
ハードウェアで設定可能な解像度のうち、使用したい解像度の設定を行います。     
画面は消去されません。                                                       
書き込みページは0に指定されます。                                            
ページが80H以上のときはユーザRAMに設定します。                               
ピクセル数は、以下のような画面モードに対応してします｡
 1ピクセル　→　  2色                                                        
 4ピクセル　→　 16色                                                        
 8ピクセル　→　256色                                                        
16ピクセル　→　32K色                                                        
24ピクセル　→　16M色                                                        
32ピクセル　→　16M色                                                        
                                                                             
ピクセルビット構成(デフォルト値)                                             
　　　　　　　　　　31　　　　　　　　　　　　　　　　　　　　　　 0         
　　　　　　　　　┌──────────────────────┬─┐       
 1ビットピクセル　│　　　　無　効　　　　　　　　　　　　　　　│　│       
　　　　　　　　　└──────────────────────┴┬┘       
（2色）　　　　　　　　　　　　　　　　　　　　　　　　　　　　Intensity     
                                                                             
　　　　　　　　　　31　　　　　　　　　　　　　　　　3　2　1　0             
　　　　　　　　　┌────────────────┬─┬─┬─┬─┐       
 4ビットピクセル　│　　　　無　効　　　　　　　　　│　│　│　│　│       
　　　　　　　　　└────────────────┴┬┴┬┴┬┴┬┘       
（パレットによる変更可能）　　　　　　　　　　　　　　│　│　│　Blue       
（16色）　　　　　　　　　　　　　　　　　　　　　　　│　│　Red            
　　　　　　　　　　　　　　　　　　　　　　　　　　　│　Green              
　　　　　　　　　　　　　　　　　　　　　　　　　　 Intensity               
                                                                             
　　　　　　　　　　31　　　　　　　　　　　　　7 6 5 　4 3 2 　1 0          
　　　　　　　　　┌─────────────┬───┬───┬──┐       
 8ビットピクセル　│　無　効　　　　　　　　　│　　　│　　　│　　│       
　　　　　　　　　└─────────────┴┬┬┬┴┬┬┬┴┬┬┘       
（パレットによる変更可能）　　　　　　　　　　　│││　│││　Blue 1･0     
　　　　（256色） 　　　　　　　　　　　　　　　│││　Red 2･1･0            
　　　　　　　　　　　　　　　　　　　　　　　Green 2･1･0                    
                                                                             
　　　　　　　　　　31　　　　15　14　　　10　9 　　　 5　4 　　　 0         
　　　　　　　　　┌────┬─┬─────┬─────┬─────┐       
16ビットピクセル　│ 無　効 │　│　　　　　│　　　　　│　　　　　│       
　　　　　　　　　└────┴┬┴┬┬┬┬┬┴┬┬┬┬┬┴┬┬┬┬┬┘       
　　　　（32K色） 　　　　　　│　│││││　│││││　Blue 4･3･2･1･0     
　　　　　　　　　　　　　　　│　│││││　Red 4･3･2･1･0                  
　　　　　　　　　　　　　　　│　Green 4･3･2･1･0                            
　　　　　　　　　　　　　　 Super impose                                    
                                                                             
24ビットピクセル(16M色)                                              
　　 31　　 24  23          　16　15　　         8　7 　  　  　　 0         
　　┌────┬────────┬────────┬────────┐       
  　│　無効  │　              │　　　　　  　　│　　　　　　　　│       
　　└────┴┬┬┬┬┬┬┬┬┴┬┬┬┬┬┬┬┬┴┬┬┬┬┬┬┬┬┘       
　　　　　　　　││││││││　││││││││　││││││││         
　　　　　　　　││││││││　││││││││　Red 7･6･5･4･3･2･1･0      
　　　　　　　　││││││││　Green 7･6･5･4･3･2･1･0                      
　　　　　　　 Blue 7･6･5･4･3･2･1･0                             

32ビットピクセル(32M色)                                                      
　　 31　　 24  23          　16　15　　         8　7 　  　  　　 0         
　　┌────┬────────┬────────┬────────┐       
  　│　不定  │　              │　　　　　  　　│　　　　　　　　│       
　　└────┴┬┬┬┬┬┬┬┬┴┬┬┬┬┬┬┬┬┴┬┬┬┬┬┬┬┬┘       
　　　　　　　　││││││││　││││││││　││││││││         
　　　　　　　　││││││││　││││││││　Red 7･6･5･4･3･2･1･0      
　　　　　　　　││││││││　Green 7･6･5･4･3･2･1･0                      
　　　　　　　 Blue 7･6･5･4･3･2･1･0                             
1.2画面モード                                                                
　　　　　　　　　│　　　　　　　　│                                       
　　　　VRAM先頭→├────────┤                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　ＰＡＧＥ0　　 │                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　├────────┤                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　ＰＡＧＥ1　　 │                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　└────────┘                                       
                                                                             
2.1画面モード                                                                
　　　　　　　　　│　　　　　　　　│                                       
　　　　VRAM先頭→├────────┤                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　ＰＡＧＥ0　　 │                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　│　　　　　　　　│                                       
　　　　　　　　　└────────┘                                       
                                                                             
画面構成                                                                     
                                                                             
●2画面合成(中解像度)                                                        
図CL21R-024                                                                  
                                                                             
画面構成                                                                     
                                                                             
図CL21R-025                                                                  
                                                                             
モードの種類一覧表(NoはPage単位に設定可能)                                   
図CL21R-026                                                                  
注) 網かけの部分は、NTSC準拠のビデオ出力が可能です。(要ビデオカード)         
                                                                             
仮想画面とハードウェアサポート                                               
                                                                             
■640×819                                                                   
　　　　　 640                                                               
　　┌───────┐                                                       
　　│　　 640　　　│　　　　･表示画面の移動無し                            
　　│　　　　　　　│　　　　･仮想画面の移動無し                            
　　│400(or200)　　│                                                       
　　│　　　　　表示│                                                       
　　├───────┤                                                       
 819│　　　　　　　│                                                       
　　│　　　　　　　│                                                       
　　│　　　　　　　│                                                       
　　│　　　　　　　│                                                       
　　└───────┘                                                       
                                                                             
■1024×512                                                                  
　　　　　　　1024                                                           
　　┌─────────┬────┐                                         
　　│　　　640(or720)　│　　　　│　　･表示画面の移動無し                  
　　│　　　　　　　　　│　　　　│　　･仮想画面の移動有り                  
　　│480 　　　　　　　│→　　　│　　　（円筒スクロール可能）             
 512│　　　　　　　　　│　　　　│                                         
　　│　　　　　　　表示│　　　　│                                         
　　├─────────┘　　　　│                                         
　　│　　　　↓　　　　　　　　　│                                         
　　└──────────────┘                                         
                                                                             
■512×512                                                                   
　　　　　　 512                                                             
　　┌────────┬──┐                                               
　　│　　　320 　　　│　　│　　　･表示画面の移動無し                      
　　│　　　　　　　　│　　│　　　･仮想画面の移動有り                      
 512│480 　　　　　　│→　│　　　　（円筒スクロール可能）                 
　　│　　　　　　表示│　　│                                               
　　├────────┘　　│                                               
　　│　　　↓　　　　　　　│                                               
　　└───────────┘                                               
                                                                             
■512×256                                                                   
　　　　　　　　 512                                                         
　　┌─────────┬────┐                                         
　　│　　　320(or360)　│　　　　│　　･表示画面の移動有り                  
　　│　　　　　　　　　│　　　　│　　　（中解像度のみ）                   
　　│240 　　　　　　　│→　　　│　　･仮想画面の移動有り                  
 256│　　　　　　　　　│　　　　│　　　（球面スクロール可能）             
　　│　　　　　　　表示│　　　　│                                         
　　├─────────┘　　　　│                                         
　　│　　　　↓　　　　　　　　　│                                         
　　└──────────────┘                                         
                                                                             
■256×512                                                                   
　　　　　 256                                                               
　　┌───────┐                                                       
　　│　　 256　　　│　　　･表示画面の移動有り                              
　　│　　　　　　　│　　　･仮想画面の移動有り                              
　　│256(or240)　　│　　　　（円筒スクロール可能）                         
　　│　　　　　表示│                                                       
　　├───────┤                                                       
 512│　　　↓　　　│                                                       
　　│　　　　　　　│                                                       
　　│　　　　　　　│                                                       
　　│　　　　　　　│                                                       
　　└───────┘                                                       
                                                                             
■512×512                                                                   
　　　　　　 512                                                             
　　┌──────────────┐                                         
　　│　　　 512　　　　　　　　　│･表示画面の移動無し                      
　　│　　　　　　　　　　　　　　│･仮想画面の移動有り                      
 512│480 　　　　　　　　　　　　│　（円筒スクロール可能）                 
　　│　　　　　　　　　　　　　　│                                         
　　│　　　　　　　　　　　　　　│                                         
　　│　　　　　　表示　　　　　　│                                         
　　├──────────────┤                                         
　　│　　　↓　　　　　　　　　　│                                         
　　└──────────────┘                                         
                                                                             
-----------------------------------------------------------------------------
.EGB_resolve                                                                 
画面ぼかし                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_resolve( work, wsize );                                          
char　　*work;　　　　　　　　/*　作業域のアドレス　　　　　　*/             
char　　*wsize; 　　　　　　　/*　ワークのアドレス　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　worksize[256*1024];                                                  
int 　　ret;                                                                 
                                                                             
ret = EGB_resolve( work, worksize );                                         
                                                                             
- 内容 -                                                                     
画面のぼかしを行います。                                                     
ぼかしの領域の設定は領域の設定(EGB_region) で行います。                      
画面モードが、256色、32K色、16M色の時有効です。ぼかし時の混色比率は中心ドット
に対して以下の比率で計算します。                                             
                                                                             
図CL21R-027                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_rotate                                                                  
画面の回転                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_rotate( work, n, rpara, wsize );                                 
char　　*work;　　　　　　　　/*　作業域のアドレス　　　　　　*/             
int 　　n;　　　　　　　　　　/*　機能設定 (下図参照) 　　　　*/             
char　　*rpara; 　　　　　　　/*　パラメータのアドレス　　　　*/             
char　　*wsize; 　　　　　　　/*　ワークのアドレス　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　rpara[64];                                                           
char　　worksize[256*1024];                                                  
int 　　ret;                                                                 
                                                                             
ret = EGB_rotate( work, 0, rpara, worksize );                                
                                                                             
- 内容 -                                                                     
回転中心座標を基に角度に応じて回転します。                                   
回転の領域は、領域の設定(EGB_region) で行います。領域の設定で使ったparaと違う
名前(rparaなど)でパラメータを設定してください。                              
                                                                             
　　　7　6　5　4　3　2　1　0                                                 
　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                       
ｎ: │　│　│　│　│　│　│　│　│                                       
　　└┬┴─┴─┴─┴─┴─┴─┴┬┘                                       
　　　│　　　　　　　　　　　　　│                                         
　　　└0:ワーク領域への複写を行う└───0:背景色描画を行わない             
                                                                             
　　　　1:ワーク領域への複写を行わない　　1:背景色描画を行う                 
                                                                             
- パラメータの形式 -                                                         
  ┌─┬──────────────┐                                       
  │ 0│Ｂ│複写先ページ　　　　　　│                                       
  ├─┼──────────────┤                                       
  │ 1│Ｂ│0　　　　　　　　　　　 │                                       
  ├─┼──────────────┤                                       
  │ 2│SW│回転中心Ｘ座標　　　　　│                                       
  ├─┼──────────────┤                                       
  │ 4│SW│回転中心Ｙ座標　　　　　│                                       
  ├─┼──────────────┤                                       
  │ 6│Ｗ│回転角度（0 〜359°）　 │                                       
  └─┴──────────────┘                                       
                                                                             
-----------------------------------------------------------------------------
.EGB_rotatePolygon                                                           
回転多角形                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_rotatePolygon( work, para );                                     
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_rotatePolygon( work, para );                                       
                                                                             
- 内容 -                                                                     
回転された多角形を描画します。                                               
座標点数が3点未満のときは、描画されません。面塗りを行った時には、アルゴリズム
の違いにより境界線と重ならない場合があります。                               
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬───────────────┐                                     
  │ 0│SW│中心点Ｘ座標　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 2│SW│中心点Ｙ座標　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 4│Ｗ│回転角度　　　　(0〜359°)│                                     
  ├─┼───────────────┤                                     
  │ 6│Ｗ│座標点数　　　　(3〜256)　│                                     
  ├─┼───────────────┤┐                                   
  │ 8│SW│第1点Ｘ座標　　　　　　　 ││                                   
  ├─┼───────────────┤├※                                 
  │10│SW│第1点Ｙ座標　　　　　　　 ││                                   
  ├─┼───────────────┤┘                                   
  │　│※の繰り返し（最大256点まで） │                                     
  〜　〜　　　　　　　　　　　　　　　〜                                     
  └─┴───────────────┘                                     
                                                                             
-----------------------------------------------------------------------------
.EGB_scroll                                                                  
全画面スクロール                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_scroll( work, n, xdot, ydot );                                   
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　n;　　　　　　　　　/*　0:背景色描画を行わない                       
　　　　　　　　　　　　　　　　1:背景色描画を行う　　　　　*/               
int 　　xdot; 　　　　　　　/*　横方向に移動するドット数　　　*/             
int 　　ydot; 　　　　　　　/*　縦方向に移動するドット数　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_scroll( work, 1, -24, -24 );                                       
                                                                             
- 内容 -                                                                     
スクロールは書き込みページの全画面を上下左右に移動します。                   
クリップ枠は、画面枠となります。                                             
                                                                             
n=0:背景色描画を行わない                                                     
  1:背景色描画を行う                                                         
                                                                             
図CL21R-028                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_semiBow                                                                 
弓形2                                                                        
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_semiBow( work, para );                                           
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_semiBow( work, para );                                             
                                                                             
- 内容 -                                                                     
第1点、第2点を結ぶ線分を半径とし、第3点を終了軸とする扇形を描きます。        
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
  ┌─┬───────────────┐                                     
  │ 0│SW│中心点Ｘ座標（第1点）　　 │                                     
  ├─┼───────────────┤                                     
  │ 2│SW│中心点Ｙ座標　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 4│SW│半径Ｘ座標（第2点）　　　 │                                     
  ├─┼───────────────┤                                     
  │ 6│SW│半径Ｙ座標　　　　　　　　│                                     
  ├─┼───────────────┤                                     
  │ 8│SW│Ｘ軸座標（第3点）　　　　 │                                     
  ├─┼───────────────┤                                     
  │10│SW│Ｙ軸座標　　　　　　　　　│                                     
  └─┴───────────────┘                                     
                                                                             
図CL21R-029                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_setTmenuPalette                                                         
TownsMENU V2.1メニュー色の書き込み                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_setTmenuPalette( para );                                         
char　　*para;　　　　 /* パラメータのアドレス */                            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　para[8*16+4];                                                        
int 　　ret;                                                                 
ret = EGB_setTmenuPalette( para );                                           
                                                                             
- 内容 -                                                                     
TownsMENU V2.1のメニュー色をシステム情報領域に書き込みます。                 
                                                                             
パラメータのデータ形式                                                       
  ┌─┬─────────────┐                                         
  │ 0│Ｄ│設定パレット数（6，16)│                                         
  ├─┼─────────────┤　┐                                     
  │ 4│Ｄ│色識別番号（0〜15）　 │　│                                     
  ├─┼─────────────┤　│                                     
  │ 8│Ｂ│青の階調（0〜255）　　│　│                                     
  ├─┼─────────────┤　│                                     
  │ 9│Ｂ│赤の階調（0〜255）　　│　├※                                   
  ├─┼─────────────┤　│                                     
  │10│Ｂ│緑の階調（0〜255）　　│　│                                     
  ├─┼─────────────┤　│                                     
  │11│Ｂ│　　　　　0　　　　　 │　│                                     
  ├─┼─────────────┤　┘                                     
  〜　〜　　※の繰り返し　　　　　〜                                         
  └─┴─────────────┘                                         
                                                                             
各色の階調は以下の様な意味を持ちます                                         
                                                                             
　　 7　 6　 5　 4　 3　 2　 1　 0                                           
　┌─┬─┬─┬─┬─┬─┬─┬─┐                                         
　│　　　　　　　　　　　　　　　│                                         
　│　　　　パレットデータ　　　　│                                         
　│　　　　　　　　　　　　　　　│                                         
　└─┴─┴─┴─┴─┴─┴─┴─┘                                         
                                                                             
-----------------------------------------------------------------------------
.EGB_sjisString                                                              
文字列                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_sjisString( work, para );                                        
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_sjisString( work, para );                                          
                                                                             
- 内容 -                                                                     
文字列(ASCIIコードのANK文字列、またはシフトjisコードの文字列)を描画します。  
文字表示開始位置は、文字の左下を示します。                                   
文字列の長さの数え方は、ANKを1文字、漢字を2文字と数えます。                  
コントロールおよびエスケープシーケンス動作はしません。制御文字が表示されま   
す。                                                                         
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
- パラメータの形式 -                                                         
　┌─┬──────────────┐                                       
  │ 0│SW│描画開始Ｘ座標　　　　　│　　　Ａｂｃｄ                         
　├─┼──────────────┤　　　￣￣￣￣￣￣￣￣                 
  │ 2│SW│描画開始Ｙ座標　　　　　│　　↑　↑                             
　├─┼──────────────┤　　│文字列描画基準線                 
  │ 4│Ｗ│文字列の長さ　　　　　　│　　│                                 
　├─┼──────────────┤　　│                                 
  │ 6│BA│文字列　　　　　　　　　│　　└─描画開始点                     
　〜　〜　　　　　　　　　　　　　　〜                                       
　└─┴──────────────┘                                       
                                                                             
-----------------------------------------------------------------------------
.EGB_superImpose                                                             
スーパーインポーズの設定                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_superImpose( work, n );                                          
char　　*work;　　　　　　　　　　　/*　作業域のアドレス　　　　　　　*/     
int 　　n;　　　　　　　　　　　　　/*　スーパーインポーズデータ　　　*/     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_superImpose( work, 1 ); 　/*　スーパーインポーズ無効、高輝度*/     
                                                                             
- 内容 -                                                                     
スーパーインポーズの有効･無効を設定します。                                  
無効にした場合、スーパーインポーズビットを立てても、スーパーインポーズされま 
せん。書き込みページで示されるページに設定を行います。輝度の指定は、書き込み 
ページに関係なく設定されます。                                               
                                                                             
　　　7　6　5　4　3　2　2　1                                                 
　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                       
 ｎ:│　│　│　│　│　│　│　│　│                                       
　　└┬┴─┴─┴─┴─┴─┴─┴┬┘                                       
　　　│　　　　　　　　　　　　　│                                         
　　　└0:無効　　　　　　　　　  └0:低輝度                                 
                                                                             
　　　　1:有効　　　　　　　　　　  1:高輝度                                 
                                                                             
-----------------------------------------------------------------------------
.EGB_textDirection                                                           
文字方向の設定                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_textDirection( work, direction );                                
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　direction;　　　　　/*　文字方向　　　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
ret = EGB_textDirection( work, 3 );                                          
                                                                             
- 内容 -                                                                     
文字方向を設定します。                                                       
                                                                             
文字方向＝0:右                                                               
　　　　　1:上                                                               
　　　　　2:左                                                               
　　　　　3:下                                                               
                                                                             
図CL21R-030                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_textDisplayDirection                                                    
文字表示方向の設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_textDisplayDirection( work, direction );                         
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　direction;　　　　　/*　文字方向　　　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_textDisplayDirection( work, 1 );                                   
                                                                             
- 内容 -                                                                     
文字表示方向を設定します。                                                   
文字方向＝0:右                                                               
　　　　　1:上                                                               
　　　　　2:左                                                               
　　　　　3:下                                                               
                                                                             
右）　　　　　　　　　　　　上）                                             
　　　　　　　　　　　　　　　　↑                                           
　　ＡＡ→→　　　　　　　　　　↑                                           
　　　　　　　　　　　　　　　　Ａ                                           
　　　　　　　　　　　　　　　　Ａ                                           
                                                                             
左）　　　　　　　　　　　　下）                                             
　　　　　　　　　　　　　　　　Ａ                                           
　　←←ＡＡ　　　　　　　　　　Ａ                                           
　　　　　　　　　　　　　　　　↓                                           
　　　　　　　　　　　　　　　　↓                                           
                                                                             
-----------------------------------------------------------------------------
.EGB_textSpace                                                               
文字間空白の設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_textSpace( work, space );                                        
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　space;　　　　　　　/*　文字間空白(ドット指定)　　　*/               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_textSpace( work, 24 );                                             
                                                                             
- 内容 -                                                                     
文字間空白を設定します。                                                     
ドット指定で行います。ANKと漢字の区別は有りません。文字間空白に負の値を設定す
ることにより、重ね描きや後退描きをする事ができます。                         
                                                                             
                                                                             
Ａ│　　│Ａ│　　│Ａ│　　│Ａ                                             
　└──┘　└──┘　└──┘                                               
　　↑　　　　↑　　　　　↑                                                 
　　└────┼─────┘                                                 
　　　　　　　│                                                             
　　　　　文字間空白                                                         
                                                                             
-----------------------------------------------------------------------------
.EGB_textZoom                                                                
文字拡大率の設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_textZoom( work, n, xsize, ysize );                               
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
int 　　n;　　　　　　　　　/*　0:ANK、1:漢字　　　　　　 */                 
int 　　xsize;　　　　　　　/*　文字横ドット数　　　　　　　　*/             
int 　　ysize;　　　　　　　/*　文字縦ドット数　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
/*　ANK文字を横24*縦32(dot)に設定する　*/                                    
ret = EGB_textZoom( work, 0, 24, 32 );                                       
/*　漢字を横48*縦48(dot)に設定する　　　*/                                   
ret = EGB_textZoom( work, 1, 48, 48 );                                       
                                                                             
- 内容 -                                                                     
文字表示の横･縦ドット数を設定します。                                        
ANKと漢字を別々に設定することができます。                                    
                                                                             
図CL21R-031                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_tilePattern                                                             
タイルパターンの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_tilePattern( work, c, n, d, data );                              
char　　*work;　　　/*　作業域のアドレス　　　　　　　　　　　*/             
int 　　c;　　　　　/*　(0:前景，1:背景，2:面塗り)　　*/                     
int 　　n;　　　　　/*　横方向ドット数:8n(1≦n≦4),nを指定　 */              
int 　　d;　　　　　/*　縦方向ドット数:1〜32　　　　　　　　 */              
char　　*data;　　　/*　タイルパターンデータのアドレス　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　*tile;                                                               
int 　　ret;                                                                 
ret = EGB_tilePattern( work, 0, 1, 8, tile );                                
                                                                             
- 内容 -                                                                     
タイルパターンを設定します。                                                 
パターンデータはピクセル構成と同じになります。横方向ドットnは、設定したい横方
向ドット数(8,16,24,32)÷8で求めます。                                        
                                                                             
　　　　　　　　　　┌─┬─┬─┬─┬─┬─┬─────〜───────┐
 1ﾋﾞｯﾄ ﾋﾟｸｾﾙ　　　　│1bit　│　│　│　│　│　　　　　　　　　　　　　│
　　　　　　　　　　└─┴─┴─┴─┴─┴─┴─────〜───────┘
　　　　　　　　　　┌──┬──┬──┬──┬─────〜───────┐
 4ﾋﾞｯﾄ ﾋﾟｸｾﾙ　　　　│4bit│4bit│4bit│4bit│　　　　　　　　　　　　　│
　　　　　　　　　　└──┴──┴──┴──┴─────〜───────┘
　　　　　　　　　　┌─────┬─────┬─────〜───────┐
 8ﾋﾞｯﾄ ﾋﾟｸｾﾙ　　　　│　 8bit 　│　 8bit 　│　　　　　　　　　　　　　│
　　　　　　　　　　└─────┴─────┴─────〜───────┘
　　　　　　　　　　┌───────────┬─────〜───────┐
16ﾋﾞｯﾄ ﾋﾟｸｾﾙ　　　　│　　　　16bit 　　　　│　　　　　　　　　　　　　│
　　　　　　　　　　└───────────┴─────〜───────┘
　　　　　　　　　　┌────────────────┬────〜───┐
24ﾋﾞｯﾄ ﾋﾟｸｾﾙ　　　　│　 　　　　　　24bit    　　　　│　　　　　　　　│
　　　　　　　　　　└────────────────┴────〜───┘
　　　　　　　　　　┌──────────────────────┬──┐
32ﾋﾞｯﾄ ﾋﾟｸｾﾙ　　　　│　　　　　　　　　　32bit 　　　　　　　　　│　　│
　　　　　　　　　　└──────────────────────┴〜─┘
                                                                             
-----------------------------------------------------------------------------
.EGB_tmenuPalette                                                            
TownsMENU V2.1メニュー色の設定                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
void　　EGB_tmenuPalette( work );                                            
char　　*work;　　　　　　/*　作業域のアドレス */                            
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
EGB_tmenuPalette( work );                                                    
                                                                             
- 内容 -                                                                     
TownsMENU V2.1のメニュー色を設定します。                                     
EGB_tmenuPalette2もしくはEGB_setTmenuPaletteによって設定したメニュー色はシス 
テム情報として残されます。                                                   
EGB_tmenuPaletteはそのシステム情報を参照してメニュー色を設定します。         
システム情報が存在しない場合はTownsMENU V2.1の｢メニュー色設定｣での｢系列設定  
での青系列色に設定されます。                                                 
                                                                             
-----------------------------------------------------------------------------
.EGB_tmenuPalette2                                                           
TownsMENU V2.1メニュー色の設定2                                              
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
void　　EGB_tmenuPalette2( work );                                           
char　　*work;　　　　　　/*　作業域のアドレス */                            
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
char　　　work[1536]                                                         
EGB_tmenuPalette2( work );                                                   
                                                                             
- 内容 -                                                                     
TownsMENU V2.1のメニュー色を設定します。                                     
サイドワークアプリケーションの｢メニュー色設定｣で、                           
 1.　｢系列設定｣でメニュー色を設定している場合                                
    選択した系列色でメニュー色が設定されます。                               
 2.　｢詳細設定｣でメニュー色を設定している場合                                
    情報ファイル(TMENU. PAL)を読み込み、詳細設定色の6色(色識別番号1, 6, 7, 8,
     9, 15番)が設定されます。                                                
 3.　｢全パレット設定｣でパレットを設定している場合                            
    情報ファイルを読み込み、全パレット設定色の16色(色識別番号0〜15)が設定され
    ます。                                                                   
                                                                             
情報ファイルが読み込めない、或いは情報ファイルのデータ形式に異常がある場合   
は、青系列色で設定されます。                                                 
                                                                             
情報ファイルの内容とシステム情報との内容が一致しない場合(システム情報が｢詳細 
設定｣で情報ファイルの内容が16色データの場合など)は、情報ファイルの内容が優先 
されます。                                                                   
                                                                             
通常、情報ファイルはシステム起動ドライブから読み込みますが、情報ディスクが設 
定されている場合は、情報ディスクから情報ファイルを読み込みます。             
                                                                             
この関数は、情報ファイルの読み込みと解析のため、4Kバイト強の作業領域をスタッ 
クから確保します。                                                           
                                                                             
情報ファイルのデータ形式は以下の様になっています。                           
                                                                             
┌────────────────────────────────────┐ 
│ 16 　　　　　　　　　　←　総設定色数。6または16です。　　　　　　　   │ 
│　0, 0, 0, 0　　　　　　←　色番号，青の輝度，赤の輝度，緑の輝度です。  │ 
│　1,10, 6, 1　　　　　　←　色番号と輝度は0〜15までの値となります。　   │ 
│　2, 4,12, 6 ; 暗い肌色 ←　左のようにコメントが書けます。　　　　　　  │ 
│　　　ﾟ　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　  │ 
│　　　ﾟ　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　  │ 
│ 15,13,13,13　　　　　　←　設定する色データ数は必ず総設定色数と一致さ  │ 
│　　　　　　　　　　　　　　せてください。( 異なるとエラーになります。) │ 
└────────────────────────────────────┘ 
                                                                             
｢系列設定｣もしくは｢詳細設定｣でメニュー色を設定した場合、10色を以下の色に設定 
します。                                                                     
                                                                             
┌─────┬────┬────┬────┬──────┐                   
│色識別番号│青の輝度│赤の輝度│緑の輝度│　色の名称　│                   
├─────┼────┼────┼────┼──────┤                   
│　　　 0　│ 　　0　│　　 0　│　　 0　│黒（透明色）│                   
│　　　 2　│ 　　4　│　  12　│　　 6　│暗い肌色　　│                   
│　　　 3　│  　10　│　  15　│　  12　│明るい肌色　│                   
│　　　 4　│　 　9　│　　 9　│　 　9　│明るい灰色　│                   
│　　　 5　│　 　7　│　　 0　│  　12　│緑色　　　　│                   
│　　  10　│　 　0　│　  13　│　 　0　│赤色　　　　│                   
│　　  11　│ 　 10　│　　 0　│　 　0　│青色　　　　│                   
│　　  12　│　　 5　│　　 5　│　 　5　│暗い灰色　　│                   
│　　  13　│ 　 15　│　　 0　│　  15　│水色　　　　│                   
│　　  14　│　 　0　│　  15　│　  13　│黄色　　　　│                   
└─────┴────┴────┴────┴──────┘                   
                                                                             
-----------------------------------------------------------------------------
.EGB_triangle                                                                
三角形                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_triangle( work, para );                                          
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_triangle( work, para );                                            
                                                                             
- 内容 -                                                                     
三角形を描画します。                                                         
面塗りを行った時には、アルゴリズムの違いにより境界線と重ならない場合がありま 
す。                                                                         
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
図CL21R-032                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_unConnect                                                               
不連続線分                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_unConnect( work, para );                                         
char　　*work;　　　　　　　　　　/*　作業域のアドレス　　　　*/             
char　　*para;　　　　　　　　　　/*　パラメータのアドレス　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_unConnect( work, para );                                           
                                                                             
- 内容 -                                                                     
不連続線分を描画します。                                                     
この関数を使用する際に、通常より大きなスタックを必要とする場合があります。   
詳しくは、｢1.3 (1) スタックサイズ｣を参照してください。                       
                                                                             
図CL21R-033                                                                  
                                                                             
-----------------------------------------------------------------------------
.EGB_viewport                                                                
ビューポートの設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_viewport( work, para );                                          
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　*/             
char　　*para;　　　　　　　/*　パラメータのアドレス　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
char　　para[64];                                                            
int 　　ret;                                                                 
                                                                             
ret = EGB_viewport( work, para );                                            
                                                                             
- 内容 -                                                                     
ビューポートを設定します。                                                   
仮想画面領域への設定も可能です。座標値が仮想画面の大きさを越えた場合、仮想画 
面の大きさにビューポートが設定されます。                                     
                                                                             
- パラメータの形式 -                                                         
　┌─┬──────────┐                                               
  │ 0│SW│第1点Ｘ座標　　 │                                               
　├─┼──────────┤                                               
  │ 2│SW│第1点Ｙ座標　　 │                                               
　├─┼──────────┤                                               
  │ 4│SW│第2点Ｘ座標　　 │                                               
　├─┼──────────┤                                               
  │ 6│SW│第2点Ｙ座標　　 │                                               
　└─┴──────────┘                                               
                                                                             
ビューポートを通過する直線を描画した場合、以下の図のようになります。         
                                                                             
┌─────────────────┐                                       
│（第1点Ｘ座標，第1点Ｙ座標）　　  │                                       
│　　　　　　　　　　　　　　　　　│                                       
│　　●─────────┐　　　　│                                       
│- - ┼─────────┼ - - - -│                                       
│　　│　↑　　　　　　　│　↑　　│                                       
│　　│描画　　　　　　　│非描画　│                                       
│　　│　　　ビューポート│　　　　│                                       
│　　└─────────●　　　　│                                       
│　　　　　　　　　　　　　　　　　│                                       
│　　（第2点Ｘ座標，第2点Ｙ座標）  │                                       
│　　　　　　　　　　　　　　　　　│                                       
│　　　　　　　　　　　　　　画面　│                                       
└─────────────────┘                                       
                                                                             
-----------------------------------------------------------------------------
.EGB_writeMode                                                               
描画モードの設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_writeMode( work, w_mode );                                       
char　　*work;　　　　　　　/*　　作業域のアドレス　　　　　　*/             
int 　　w_mode; 　　　　　　/*　　描画モード　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
                                                                             
ret = EGB_writeMode( work, 0 );                                              
                                                                             
- 内容 -                                                                     
描画モードを設定します。                                                     
描画モード13〜15(MASK関係)を設定した場合、マスクが有効に設定されていても実際 
の描画時にマスクは無効となります。                                           
                                                                             
┌─────────┬───────────────────────┐       
│　　描画モード　　│　　　　　　　　　　　　　　　　　　　　　　　│       
├───┬─────┤　　　　　　　　　内　　　容　　　　　　　　　│       
│　値　│　名　称　│　　　　　　　　　　　　　　　　　　　　　　　│       
├───┼─────┼───────────────────────┤       
│　 0　│PSET　　　│　　　　　　　　　　　　　　　　　　　　　　　│       
│　 1　│PRESET　　│　　　　　　　　　　　　　　　　　　　　　　　│       
│　 2　│OR　　　　│　　　　　　　　　　　　　　　　　　　　　　　│       
│　 3　│AND 　　　│　　　　　　　　　　　　　　　　　　　　　　　│       
│　 4　│XOR 　　　│　　　　　　　　　　　　　　　　　　　　　　　│       
│　 5　│NOT 　　　│　データを反転する　─┐　　　　　　　　　　　│       
│　 6　│MATTE(ﾏｯﾄ)│　透過色を描画しない　│　　　　　　　　　　　│       
│　 7　│PASTEL(ﾊﾟｽﾃﾙ) 描画位置色との混合　├─（PSET）　　　　　　│       
│　 8　│　　　　　│　　　　　　　　　　　│　　　　　　　　　　　│       
│　 9　│OPAQUE(ｵﾍﾟｲｸ) bit"0"を背景色描画─┘　　　　　　　　　　　│       
│　10　│IMPSET　　│─┐　　　　　　　　　インポーズビットを"1"   │       
│　11　│IMPRESET　│　├─インポーズ用　　インポーズビットを"0"   │       
│　12　│IMPNOT　　│─┘　　　　　　　　　インポーズビットを反転　│       
│　13　│MASKSET 　│─┐　　　　　　　　　画面マスクをセット　　　│       
│　14　│MASKRESET │　├─画面マスク用　　画面マスクをリセット　　│       
│　15　│MASKNOT 　│─┘　　　　　　　　　画面マスクを反転　　　　│       
└───┴─────┴───────────────────────┘       
                                                                             
- 参考 -                                                                     
グラフィックデータの書き込みでMATTEモードを指定した場合。                    
                                                                             
図CL21R-034                                                                  
                                                                             
     文字あるいは線をOPAQUEで描画                                            
                                                                             
  □□□■■□□□               点線パターン                                
  □□■□□■□□            ■■■□■■■□■■■□■■■□               
  □■□□□□■□                                                           
  □■■■■■■□                                                           
  □■□□□□■□                   ■:前景色描画                           
  □■□□□□■□                   □:背景色描画                           
  □■□□□□■□                                                           
  □□□□□□□□                                                           
                                                                             
-----------------------------------------------------------------------------
.EGB_writePage                                                               
書き込みページの指定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <EGB.H>                                                             
int 　　EGB_writePage( work, npage );                                        
char　　*work;　　　　　　　/*　作業域のアドレス　　　　　　　　　　　　*/   
int 　　npage;　　　　　　　/*　書き込みページのページ番号bit6="1"で         
　　　　　　　　　　　　　　　　パレットの有効ページの操作を行いません。     
　　　　　　　　　　　　　　　　0x80〜0x83はユーザRAM 　　　　　　　　　*/   
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[1536];                                                          
int 　　ret;                                                                 
ret = EGB_writePage( work, 0 );                                              
                                                                             
- 内容 -                                                                     
書き込みページを指定します。                                                 
16色パレット使用時は、パレットの有効ページも切り換えます。指定されたページが 
前回のページのサイズと異なる時は、ビューポートを仮想画面枠とします。         
                                                                             
〔書き込みページ"1"、表示ページ"0"(ページ0のみ表示)の場合〕                  
                                                                             
ＰＲＩＮＴ　"ＡＡＡ"                                                         
┌─────────┐                                                       
│┌───────┐│　　┌───────┐                                 
││　　　　　　　││　　│ＡＡＡ　　　　│                                 
││　　　　　　　││　　│　　　　　　　│                                 
││　　　 ページ0││　　│　　　 ページ1│                                 
│└───────┘│　　└───────┘                                 
└─────────┘                                                       
　ディスプレイ　　　　　　　　書き込みページ                                 
                                                                             
*****************************************************************************
第2章　マウスライブラリ                                                      
*****************************************************************************
                                                                             
 1.　マウスライブラリ                                                        
                                                                             
　本章ではマウスを使用するときに必要なマウスライブラリについて解説していま   
す。                                                                         
                                                                             
  1.1　サンプルプログラム                                                    
┌───────────────────────────────────┐   
│　マウスライブラリサンプルプログラム　　　　　　　　　　　　　　　　  │   
│　- 機能 -　マウスカーソルを表示します。　　　　　　　　　　　　　　  │　 
└───────────────────────────────────┘   
                                                                             
#include <egb.h>                                                             
#include <mos.h>                                                             
                                                                             
char    work[EgbWorkSize];                                                   
char    mwork[MosWorkSize];                                                  
int     ch, x, y;                                                            
                                                                             
void main()                                                                  
{                                                                            
      EGB_init( work, EgbWorkSize );    /*  グラフィック初期化          　*/ 
　　　EGB_displayPage( work, 0, 1 );　　/*  グラフィック画面の表示ページ　*/ 
　　  MOS_start( mwork, MosWorkSize );　/*  マウス動作開始の設定        　*/ 
　    MOS_disp( 1 );                　  /*  マウスカーソルの表示の設定  　*/ 
                                                                             
      do {                                                                   
              MOS_rdpos( &ch, &x, &y ); /*  位置とボタンの読み取り　　　　*/ 
　    } while ( ch != 0x03 );           /*  左右のボタンが押されたか? 　　*/ 
      MOS_end();                        /*  マウス動作終了の設定        　*/ 
}                                                                            
                                                                             
  1.2　フルカラー画面でのマウスカーソル表示の注意事項                        
　　　マウスドライバへ渡す作業域は､主にマウスカーソル描画座標の画面退避領域と
    して使用しています｡フルカラー画面は1トッドのデータ量が大きく､従来の作業域
    の大きさ(4095バイド)だけでは画面退避領域が不足し､作業域の後ろの領域を破壊
    します｡                                                                  
　　　したがってフルカラー画面でマウスカーソルを表示する際は､2Kバイト多い6144
    バイトの作業域を用意する必要があります｡                                  
                                                                             
  1.3　関数一覧                                                              
                                                                             
┌───────────┬────────────────┐                 
│　　　関　数　名　　　│　　　　　機　　　  能　　　　　│                 
├───────────┼────────────────┤                 
│MOS_start 　　　　　　│動作開始　    　　　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_end 　　　　　　　│動作終了　    　　　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_disp　　　　　　　│表示/消去　    　　　　　　　　 │                 
├───────────┼────────────────┤                 
│MOS_getDisp 　　　　　│表示/消去状態の読み取り　　　　 │                 
├───────────┼────────────────┤                 
│MOS_rdpos 　　　　　　│位置とボタンの読み取り　　　　　│                 
├───────────┼────────────────┤                 
│MOS_setpos　　　　　　│位置の設定　    　　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_rdon　　　　　　　│ボタンの押下情報の読み取り　　　│                 
├───────────┼────────────────┤                 
│MOS_rdopen　　　　　　│ボタンの開放情報の読み取り　　　│                 
├───────────┼────────────────┤                 
│MOS_horizon 　　　　　│水平移動範囲指定　    　　　　　│                 
├───────────┼────────────────┤                 
│MOS_getHorizon　　　　│水平移動範囲読み取り　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_vertical　　　　　│垂直移動範囲指定　    　　　　　│                 
├───────────┼────────────────┤                 
│MOS_getVertical 　　　│垂直移動範囲読み取り　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_type　　　　　　　│形状の設定　    　　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_motion　　　　　　│移動距離の読み取り　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_entsub　　　　　　│サブルーチンの登録　    　  　　│                 
├───────────┼────────────────┤                 
│MOS_getEntsub 　　　　│サブルーチンの読み取り　　　　　│                 
├───────────┼────────────────┤                 
│MOS_pulse 　　　　　　│パルス数/画素比の設定        　 │                 
├───────────┼────────────────┤                 
│MOS_getPulse　　　　　│パルス数/画素比の読み取り　　　 │                 
├───────────┼────────────────┤                 
│MOS_resolution　　　　│仮想画面の設定    　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_getResolution 　　│仮想画面の読み取り　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_writePage 　　　　│書き込みページの指定    　　　　│                 
├───────────┼────────────────┤                 
│MOS_getWritePage　　　│書き込みページの読み取り　　　　│                 
├───────────┼────────────────┤                 
│MOS_color 　　　　　　│表示色の設定    　　　　  　  　│                 
├───────────┼────────────────┤                 
│MOS_tilePattern 　　　│タイルパターンの設定　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_getTime   　　　　│タイマの読み込み　　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_setEvent  　　　　│イベントルーチンの登録      　　│                 
├───────────┼────────────────┤                 
│MOS_getEvent　　　　　│イベントルーチンの読み出し　　　│                 
├───────────┼────────────────┤                 
│MOS_setControl　　　　│コントロールの登録　    　　　　│                 
├───────────┼────────────────┤                 
│MOS_getControl　　　　│コントロールの取得　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_viewHorizon 　　　│水平消去範囲の指定　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_viewVertical　　　│垂直消去範囲の指定　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_btnXchg 　　　　　│ボタン左右入れ換え　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_getBtnXchg　　　　│ボタン左右入れ換え状態の読み取り│                 
├───────────┼────────────────┤                 
│MOS_acceleration    　│加速度検出機能の設定　　  　　　│                 
├───────────┼────────────────┤                 
│MOS_getAcceleration 　│加速度検出機能の読み取り　　　　│                 
├───────────┼────────────────┤                 
│MOS_openCheck 　　　　│動作状態の読み取り　　　　　　　│                 
├───────────┼────────────────┤                 
│MOS_typeRom 　　　　　│形状の設定 (ｼｽﾃﾑｱｲｺﾝﾊﾟﾀｰﾝ) 　　 │                 
└───────────┴────────────────┘                 
                                                                             
  1.4　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.MOS_acceleration                                                            
加速度検出機能の設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int    MOS_acceleration( sw );                                               
int    sw;                      /*  加速度検出機能フラグ  　　　*/           
　　　　　　　　　　　　　　　　/*　0:無効　　　　　　　　　　*/             
　　　　　　　　　　　　　　　　/*　1:有効　　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    sw;                                                                   
int    ret;                                                                  
                                                                             
sw = 0;                                                                      
ret = MOS_acceleration( sw );                                                
                                                                             
- 内容 -                                                                     
マウスの加速度検出機能の有効/無効を設定します。                              
初期状態では1(加速度検出有効)が設定されています。                            
                                                                             
-----------------------------------------------------------------------------
.MOS_btnXchg                                                                 
ボタン左右入れ換え                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int    MOS_btnXchg( sw );                                                    
int    sw;                       /*   入れ換えスイッチ                       
　　　　　　　　　　　　　　　　　　　0:  入れ換えなし                       
　　　　　　　　　　　　　　　　　　　1:  入れ換えあり　　　　 */            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    sw;                                                                   
int    ret;                                                                  
                                                                             
sw  = 1;                                                                     
ret = MOS_btnXchg( sw );                                                     
                                                                             
- 内容 -                                                                     
現在のマウスボタンの左右入れ換え状態を設定します。                           
初期状態では0(入れ換えなし)が設定されています。                              
                                                                             
-----------------------------------------------------------------------------
.MOS_color                                                                   
表示色の設定                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_color( mode, color );                                            
int     mode;            /*   設定モード(0:通し番号、1:IGRB)     */          
int     color;           /*   設定色　                            */         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int   ret;                                                                   
                                                                             
ret = MOS_color( 0, 1 );                                                     
                                                                             
- 内容 -                                                                     
システム･単色カーソルの場合のマウスカーソルの表示色を設定します。            
                                                                             
システム形状                                                                 
                                                                             
□□□□□□□□□□□・・・・・　　　　　　　　　　　　　                   
□■■■■■■■■■□・・・・・　　　　■　指定色識別番号                   
□■■■■■■■■□・・・・・・　　　　□　色識別番号0　                    
□■■■■■■■□・・・・・・・　　　　・　未描画　　　　                   
□■■■■■■□・・・・・・・・　　　　　　　　　　　　　                   
□■■■■■■■□・・・・・・・　　　　　　　　　　　　　                   
□■■■■■■■■□・・・・・・　　　　　　　　　　　　　                   
□■■■□■■■■■□・・・・・　　　　　　　　　　　　　                   
□■■□・□■■■■■□・・・・　　　　　　　　　　　　　                   
□■□・・・□■■■■■□・・・　　　　　　　　　　　　　                   
□□・・・・・□■■■■■□・・　　　　　　　　　　　　　                   
・・・・・・・・□■■■■■□・　　　　　　　　　　　　　                   
・・・・・・・・・□■■■■■□　　　　　　　　　　　　　                   
・・・・・・・・・・□■■■□・　　　　　　　　　　　　　                   
・・・・・・・・・・・□■□・・　　　　　　　　　　　　　                   
・・・・・・・・・・・・□・・・　　　　　　　　　　　　　                   
                                                                             
-----------------------------------------------------------------------------
.MOS_disp                                                                    
表示/消去                                                                    
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_disp( n );                                                       
int     n;             /*   0:消去 or 1:表示  　　　　　　　　*/             
　　　　　　　　　　　 /*   2:マウス表示レベルのデクリメント　　*/           
　　　　　　　　       /*   3:マウス表示レベルのインクリメント　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_disp( 1 );                                                         
                                                                             
- 内容 -                                                                     
マウスカーソルの表示/消去を指定します。                                      
マウスカーソルの表示を指定すると、マウスカーソルが表示され、マウスの移動に   
従って画面上を移動します。未表示の場合でもマウスカーソルは移動します。       
nの値が0〜3以外のときは、何も処理を行いません。                              
                                                                             
マウス表示レベル                                                             
0〜65535の値をとり、マウスが表示されたときにレベルが1に、マウスが消去されたと
きにレベルが0に設定されます。インクリメントで0から1に変化した場合に、マウスが
表示され、デクリメントで1から0の変化で、マウスが消去されます。               
                                                                             
-----------------------------------------------------------------------------
.MOS_end                                                                     
動作終了                                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_end( void );                                                     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_end();                                                             
                                                                             
- 内容 -                                                                     
マウスドライバの動作を終了します。                                           
これに伴い、マウスの移動を調べるマウスセンスルーチンの動作を停止します。     
マウスカーソルを表示中であれば消去します。                                   
                                                                             
-----------------------------------------------------------------------------
.MOS_entsub                                                                  
サブルーチンの登録                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_entsub( term, sub );                                             
int     term;           　　　　/*  呼び出し条件　            　*/           
void    (*sub)();   　　　      /*  サブルーチンの先頭アドレス　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int     term;                                                                
extern void func(void);/* アセンブラ記述サブルーチン(FARリターン) */         
int     ret;                                                                 
                                                                             
term = 0x0001;                                                               
ret = MOS_entsub(term, func);                                                
                                                                             
- 内容 -                                                                     
ユーザ定義のサブルーチンの登録を行います。                                   
指定された条件が成立したとき、ユーザ定義のサブルーチンを呼び出します。       
呼び出し条件には、ユーザ定義のサブルーチンを呼び出す条件を指定します。       
条件は、termの各ビットに対応しており、条件が1つでも成立すると、サブルーチンの
呼び出しを行います。                                                         
　　　　15　　　　5　4　3　2　1　0　　　　　　　　　　　　　　　　           
　　　┌─┬〜─┬─┬─┬─┬─┬─┬─┐  　　　　　　　　　　　　　　     
term: │　│　　│ 0│　│　│　│　│　│　　　　　　　　　　　　　　　     
　　　└┬┴〜─┴┬┴┬┴┬┴┬┴┬┴┬┘　　　　　　　　　　　　　　　     
　　　　└─┬──┘　│　│　│　│　└─位置が変わった時　　　　　　　     
　　　　　　│　　　　│　│　│　│　　　　　　　　　　　　　　　　　　     
　　　　　　│　　　　│　│　│　└─ボタン0が押された時　　　　　　　      
　　　　　　│　　　　│　│　│　　　　　　　　　　　　　　　　　　　　     
　　　　　　│　　　　│　│　└─ボタン0が放された時　┌"1"登録　┐         
　　　　　　│　　　　│　│　　　　　　　　　　　　　 │　　　　 │         
　　　　　未定義　　　│　└─ボタン1が押された時　　　└"0"未登録┘         
　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　     
　　　　　　　　　　　└─ボタン1が放された時　　　　　　　　　　　　　      
                                                                             
サブルーチンの先頭アドレスは、ユーザ定義サブルーチンのエントリアドレスを設定 
します。                                                                     
                                                                             
ユーザ定義のサブルーチンを呼び出すとき、セグメント間コール(FAR CALL)で行いま 
すので、処理を終了したときは、セグメント間リターン(FAR RET)を行ってください。
ユーザ定義のサブルーチンはアセンブラで記述する必要があります。サブルーチンに 
制御が移ったとき、次に示すレジスタに情報が入ります。                         
AX:呼び出しの原因となった条件                                                
CH:ボタンの状態　　　　　　                                                  
BX:マウスカーソルの水平位置                                                  
DX:マウスカーソルの垂直位置                                                  
                                                                             
呼び出しの原因となった条件                                                   
　　　　15　　　　5　4　3　2　1　0　　　　　　　　　　　　　　　　           
　　　┌─┬〜─┬─┬─┬─┬─┬─┬─┐　　　　　　　　　　　　　　　     
ＡＸ: │ 0│　　│ 0│　│　│　│　│　│　　　　　　　　　　　　　　　     
　　　└┬┴〜─┴┬┴┬┴┬┴┬┴┬┴┬┘　　　　　　　　　　　　　　　     
　　　　└─┬──┘　│　│　│　│　└─位置が変わった時　　　　　　　     
　　　　　　│　　　　│　│　│　│　　　　　　　　　　　　　　　　　　     
　　　　　　│　　　　│　│　│　└─ボタン0が押された時　　　　　　　      
　　　　　　│　　　　│　│　│　　　　　　　　　　　　　　　　　　　　     
　　　　　未定義　　　│　│　└─ボタン0が放された時　　　　　　　　　      
　　　　　　　　　　　│　│　　　　　　　　　　　　　　　　　　　　　　     
　　　　　　　　　　　│　└─ボタン1が押された時　┌"1"起因条件　┐         
　　　　　　　　　　　│　　　　　　　　　　　　　 │　　　　　　 │         
　　　　　　　　　　　└─ボタン1が放された時　　　└"0"非起因条件┘         
                                                                             
ボタンの状態                                                                 
　　　　 7　 6　 5　 4　 3　 2　 1　 0　　　　　　　　　　　　　             
　　　┌─┬─┬─┬─┬─┬─┬─┬─┐　　　　　　　　　　　　             
ＣＨ: │ 0│ 0│ 0│ 0│ 0│ 0│　│　│　　　　　　　　　　　　             
　　　└─┴─┴─┴─┴─┴─┴┬┴┬┘　　　　　　　　　　　　             
　　　　　　　　　　　　　　　　│　└─ボタン0（左）0:開放中                
　　　　　　　　　　　　　　　　│　　　　　　　　　　　　　　　             
　　　　　　　　　　　　　　　　│　　　　　　　     1:押下中                
　　　　　　　　　　　　　　　　│　　　　　　　　　　　　　　　             
　　　　　　　　　　　　　　　　└───ボタン1（右）0:開放中                
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　             
　　　　　　　　　　　　　　　　　　　　　　　　　　 1:押下中                
                                                                             
-----------------------------------------------------------------------------
.MOS_getAcceleration                                                         
加速度検出機能の読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getAcceleration( sw );                                           
int     *sw;                   /*   加速度検出状態                           
　　　　　　　　　　　　　　　　　　0:無効                                   
　　　　　　　　　　　　　　　　　　1:有効　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
マウスの加速度検出状態を以下の形式で返します。                               
                                                                             
　31  　　　　　　         1   0　                                           
┌───〜〜────────┬─┐                                           
│　　　　　　　　　　　　　│　│                                           
└───〜〜────────┴┬┘                                           
　　　　　　　　　　　　　　　└0:加速度検出無効                             
                                                                             
　　　　　　　　　　　　　　　　1:加速度検出有効                             
- 例 -                                                                       
int    sw;                                                                   
int    ret;                                                                  
                                                                             
ret = MOS_getAcceleration( &sw );                                            
                                                                             
- 内容 -                                                                     
現在のマウスの加速度検出状態を読み取ります。                                 
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.MOS_getBtnXchg                                                              
ボタン左右入れ換え状態の読み取り                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getBtnXchg( sw );                                                
int   *sw;                  /*  ボタン左右入れ換えフラグ                     
　　　　　　　                  0:通常                                       
　　　　　　　                  1:入れ換え状態　    　　　　*/               
                                                                             
- 戻り値 -                                                                   
マウスボタンの左右入れ換え状態を以下の形式で返します。                       
                                                                             
　31  　　　　　　         1   0                                             
┌───〜〜────────┬─┐                                           
│　　　　　　　　　　　　　│　│                                           
└───〜〜────────┴┬┘                                           
　　　　　　　　　　　　　　　└0:通常                                       
                                                                             
　　　　　　　　　　　　　　　　1:入れ換え状態                               
                                                                             
- 例 -                                                                       
int    sw;                                                                   
int    ret;                                                                  
                                                                             
ret = MOS_getBtnXchg( &sw );                                                 
                                                                             
- 内容 -                                                                     
現在のマウスボタンの左右入れ換え状態を読み取ります。                         
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.MOS_getControl                                                              
コントロールの取得                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getControl( void );                                              
                                                                             
- 戻り値 -                                                                   
コントロールマスクの状態を返します。                                         
                                                                             
　　　　　31　　　 6　 5　 4　 3　 2　 1　 0                                 
　　　　┌─┬〜┬─┬─┬─┬─┬─┬─┬─┐                               
control:│ 0│　│　│　│　│　│　│　│　│                               
　　　　└─┴〜┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                               
　　　　　　　　　│　│　│　│　│　│　└─0: MOS_disp無効                
　　　　　　　　　│　│　│　│　│　│　　　1: MOS_disp有効                
　　　　　　　　　│　│　│　│　│　└─0: MOS_setpos無効                  
　　　　　　　　　│　│　│　│　│　　　1: MOS_setpos有効                  
　　　　　　　　　│　│　│　│　└─0: MOS_horizon無効                     
　　　　　　　　　│　│　│　│　　　1: MOS_horizon有効                     
　　　　　　　　　│　│　│　└─0: MOS_vertical無効                        
　　　　　　　　　│　│　│　　　1: MOS_vertical有効                        
　　　　　　　　　│　│　└─0: MOS_type無効                                
　　　　　　　　　│　│　　　1: MOS_type有効                                
　　　　　　　　　│　└─0: MOS_viewHorizon無効                             
　　　　　　　　　│　　　1: MOS_viewHorizon有効                             
　　　　　　　　　└─0: MOS_veiwVertical無効                                
　　　　　　　　　　　1: MOS_veiwVertical有効                                
                                                                             
- 例 -                                                                       
int    control;                                                              
                                                                             
control = MOS_getControl();                                                  
                                                                             
- 内容 -                                                                     
マウス関数のコントロールの状態を取得します。                                 
MOS_setControlと併用して使用することにより、マウス関数をコントロールすること 
ができます。                                                                 
                                                                             
●MOS_dispを無効とする例                                                     
                                                                             
int   control;                                                               
control = MOS_getControl();               /*  コントロールマスクの取得*/     
MOS_setControl( control & 0xfffffffe ); 　/*  MOS_dispを無効    　　　*/     
〜〜〜　アプリケーション関数群　〜〜〜〜〜                                   
MOS_setControl( control );                /*  コントロールマスクを再現*/     
                                                                             
-----------------------------------------------------------------------------
.MOS_getDisp                                                                 
表示/消去状態の読み取り                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getDisp( n, level);                                              
int     *n;             　　　　/*  表示状態フラグ          　  */           
int     *level;         　　　　/*  マウス表示レベル    　    　*/           
                                                                             
- 戻り値 -                                                                   
マウス表示レベルと表示状態フラグを以下の形式で返します。                     
                                                                             
　　　　　　　  31          16  15   8  7    0                               
　　　　　　　┌───────┬───┬───┐                             
　　　　　　　│　　　　　　　│　　　│　　　│                             
　　　　　　　└───┬───┴───┴┬──┘                             
マウス表示レベル───┘　　　　　　　　│                                   
　　　　　　　　　　　　　　　　　　　　│                                   
表示状態フラグ─────────────┘                                   
                                                                             
- 例 -                                                                       
int     disp;                                                                
int     level;                                                               
int     ret;                                                                 
                                                                             
ret = MOS_getDisp( &disp, &level);                                           
                                                                             
- 内容 -                                                                     
現在のマウス表示状態とマウス表示レベルを読み取ります。                       
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.MOS_getEntsub                                                               
サブルーチンの読み取り                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getEntsub( term, sub_offset, sub_seg);                           
int    *term;             /*  呼び出し条件                　    */           
void   (*sub_offset)();   /*  サブルーチンの先頭アドレス        */           
int    *sub_seg;          /*  サブルーチンのセレクタ値  　      */           
                                                                             
- 戻り値 -                                                                   
ユーザ定義サブルーチンの呼び出し条件を返します。                             
                                                                             
- 例 -                                                                       
int    term;                                                                 
void   (*sub_offset)();                                                      
int    sub_seg;                                                              
                                                                             
ret = MOS_getEntsub( &term, &sub_offset, &sub_seg);                          
                                                                             
- 内容 -                                                                     
ユーザ定義サブルーチンのアドレスと呼び出し条件を読み取ります。               
呼び出し条件については、『サブルーチンの登録:MOS_entsub』を参照してください。
                                                                             
-----------------------------------------------------------------------------
.MOS_getEvent                                                                
イベントルーチンの読み出し                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
void    *MOS_getEvent( void );                                               
                                                                             
- 戻り値 -                                                                   
マウスイベントルーチンのアドレスを返します。                                 
                                                                             
- 例 -                                                                       
void    (*ret)();                                                            
                                                                             
ret = (void(*)())MOS_getEvent();    /*   イベントルーチンのアドレス　*/      
                                                                             
- 内容 -                                                                     
登録されているマウスイベントルーチンのアドレスを返します。                   
これを利用することにより、マウスイベントルーチンの退避及び接続を行うことがで 
きます。                                                                     
                                                                             
-----------------------------------------------------------------------------
.MOS_getHorizon                                                              
水平移動範囲読み取り                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getHorizon( xmin, xmax);                                         
int    *xmin;   　　/*  最小水平位置(ﾊｰﾄﾞ座標系の値)          */             
int    *xmax;   　　/*  最大水平位置(ﾊｰﾄﾞ座標系の値)          */             
                                                                             
- 戻り値 -                                                                   
最大水平位置と最小水平位置を以下の形式で返します。                           
                                                                             
　　　　　　31  　　　　16　15      　   0                                   
　　　　　┌───────┬───────┐                                 
　　　    │　　　　　　　│　　　　　　　│                                 
　　　　　└────┬──┴───┬───┘                                 
最大水平位置────┘　　　　　　│                                         
　　　　　　　　　　　　　　　　　│                                         
最小水平位置───────────┘                                         
                                                                             
- 例 -                                                                       
int    xmin;                                                                 
int    xmax;                                                                 
int    ret;                                                                  
                                                                             
ret = MOS_getHorizon( &xmin, &xmax );                                        
                                                                             
- 内容 -                                                                     
現在のマウスの最小水平位置と最大水平位置を読み取ります。                     
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.MOS_getPulse                                                                
パルス数/画素比の読み取り                                                    
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getPulse( x, y );                                                
int    *x;      　　　　　　　　　/*  水平値(1〜255)  　　　　　*/           
int    *y;      　　　　　　　　　/*  垂直値(1〜255)  　　　　　*/           
                                                                             
- 戻り値 -                                                                   
パルス当たりの移動量を以下の形式で返します。                                 
                                                                             
　　　　31  　　　　16　15      　   0                                       
　　　┌───────┬───────┐                                     
　　　│　　　　　　　│　　　　　　　│                                     
　　　└───┬───┴───┬───┘                                     
垂直値　───┘　　　　　　　│                                             
　　　　　　　　　　　　　　　│                                             
水平値　───────────┘                                             
                                                                             
- 例 -                                                                       
int    x;                                                                    
int    y;                                                                    
int    ret;                                                                  
                                                                             
ret = MOS_getPulse( &x, &y );                                                
                                                                             
- 内容 -                                                                     
現在のパルス当たりの移動量を読み取ります。                                   
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.MOS_getResolution                                                           
仮想画面の読み取り                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getResolution( page0, page1 );                                   
int    *page0;  　　　　　　　　　/*  ページ0の画面モード番号　　　*/        
int    *page1;  　　　　　　　　　/*  ページ1の画面モード番号　　　*/        
                                                                             
- 戻り値 -                                                                   
マウス画面モードを以下の形式で返します。                                     
                                                                             
　　　　　　　　　31  　　　　16　15   8  7　  0                             
　　　　　　　　┌───────┬───┬───┐                           
　　　　　　　　│　　　　　　　│　　　│　　　│                           
　　　　　　　　└───────┴─┬─┴─┬─┘                           
 ページ1の画面モード番号　─────┘　　　│　                             
　　　　　　　　　　　　　　　　　　　　　　│　                             
 ページ0の画面モード番号　─────────┘　                             
                                                                             
- 例 -                                                                       
int    page0, page1;                                                         
int    ret;                                                                  
                                                                             
ret = MOS_getResolution( &page0, &page1 );                                   
                                                                             
- 内容 -                                                                     
現在のマウスの画面モードを読み取ります。                                     
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.MOS_getTime                                                                 
タイマの読み込み                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
unsigned int　  MOS_getTime( void );                                         
                                                                             
- 戻り値 -                                                                   
MOS_start が呼ばれてからのタイマ値(約20msに1カウントアップ)を返します。      
                                                                             
- 例 -                                                                       
unsigned int    time;                                                        
                                                                             
time = MOS_getTime();                                                        
                                                                             
●ダブルクリックの検出の例                                                   
                                                                             
befTime = MOS_getTime();          　　　 /*   開始時間の取得    　　 */      
for (;;)                                                                     
{                                                                            
   MOS_rdpos( &ch, &x, &y );         　  /*   ボタン押下の検出  　　 */      
　 if (ch)                                                                   
　{                                                                          
       aftTime = MOS_getTime();      　  /*   ボタン押下時の時間  　 */      
　     if ((aftTime - befTime) < 50 ) 　 /*   一定時間内なら　    　 */      
　         break;                   　   /*   ダブルクリックとみなす */      
　     befTime = aftTime;           　   /*   開始時間の設定      　 */      
  }                                                                          
}                                                                            
                                                                             
- 内容 -                                                                     
マウスの動作開始からのタイマ値(割り込み回数)を返します。                     
この関数を利用することにより、マウスのダブルクリックの検出などを行うことがで 
きます。マウスの割り込みは以下の周期で発生します。                           
MOS単体での初期化時は約23.04ms                                               
SND初期化後のMOS初期化時は約20.13ms                                          
                                                                             
-----------------------------------------------------------------------------
.MOS_getVertical                                                             
垂直移動範囲読み取り                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getVertical( ymin, ymax );                                       
int    *ymin;   　　/*  最小垂直位置(ﾊｰﾄﾞ座標系の値)　　　　　*/             
int    *ymax;   　　/*  最大垂直位置(ﾊｰﾄﾞ座標系の値)　　　　　*/             
                                                                             
- 戻り値 -                                                                   
最大垂直位置と最小垂直位置を以下の形式で返します。                           
                                                                             
　　　　　　31  　　　　16　15           0                                   
　　　　　┌───────┬───────┐                                 
　　　    │　　　　　　　│　　　　　　　│                                 
　　　　　└───┬───┴───┬───┘                                 
最大垂直位置───┘　　　　　　　│　　　　                                 
　　　　　　　　　　　　　　　　　│　　　　                                 
最小垂直位置───────────┘　　　　                                 
                                                                             
- 例 -                                                                       
int    ymin;                                                                 
int    ymax;                                                                 
int    ret;                                                                  
                                                                             
ret = MOS_getVertical( &ymin, &ymax );                                       
                                                                             
- 内容 -                                                                     
現在のマウスの最小垂直位置と最大垂直位置を読み取ります。                     
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.MOS_getWritePage                                                            
書き込みページの読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_getWritePage( void );                                            
                                                                             
- 戻り値 -                                                                   
マウスの書き込みページ番号を返します。                                       
                                                                             
- 例 -                                                                       
int    page;                                                                 
                                                                             
page = MOS_getWritePage();                                                   
                                                                             
- 内容 -                                                                     
現在のマウスの書き込みページ番号を読み取ります。                             
                                                                             
-----------------------------------------------------------------------------
.MOS_horizon                                                                 
水平移動範囲指定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_horizon( Xmin, Xmax );                                           
int     Xmin;              /*   最小水平位置(ハード座標系の値)　*/           
int     Xmax;              /*   最大水平位置(ハード座標系の値)　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_horizon( 50, 640 );                                                
                                                                             
- 内容 -                                                                     
マウスカーソルの水平方向(X軸)の移動範囲を指定します。                        
マウスカーソルの移動は、この範囲に限定されます。この関数を呼び出したとき、   
マウスカーソルが範囲外にあった場合は、範囲内に移動されます。最小/最大水平位置
には、マウスカーソルの移動できるX座標の範囲を指定します。                    
                                                                             
図CL21R-035                                                                  
                                                                             
-----------------------------------------------------------------------------
.MOS_motion                                                                  
移動距離の読み取り                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_motion( xpals, ypals );                                          
int     *xpals;                      /*   水平パルスカウンタの値　*/         
int     *ypals;                      /*   垂直パルスカウンタの値　*/         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
int    a, b;                                                                 
                                                                             
ret = MOS_motion( &a, &b );                                                  
                                                                             
- 内容 -                                                                     
マウスの実際の移動量を示すマウスモーションカウンタの値を読み取ります。       
この関数の呼び出し後、マウスモーションカウンタ値は0になります。              
図CL21R-036                                                                  
                                                                             
-----------------------------------------------------------------------------
.MOS_openCheck                                                               
動作状態の読み取り                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_openCheck( sw );                                                 
int    *sw;             　　　　　　　　　/*  動作状態    　　　*/           
                                                                             
- 戻り値 -                                                                   
マウスの動作状態を以下の形式で返します。                                     
                                                                             
　31　　　　　     3   2   1   0                                             
┌───〜〜────┬─┬─┬─┐                                           
│　　　　　　　　　│　│　│　│                                           
└───〜〜────┴┬┴┬┴┬┘                                           
　　　　　　　　　　　│　│　└マウスBIOSフラグ                             
　　　　　　　　　　　│　│　　（1:動作中、0:非動作中)                      
　　　　　　　　　　　│　│                                                 
　　　　　　　　　　　│　└──マウス割り出し処理フラグ　　                 
　　　　　　　　　　　│　　　　（1:動作中、0:非動作中)                      
　　　　　　　　　　　│                                                     
　　　　　　　　　　　└────マウスカーソル描画中フラグ                   
　　　　　　　　　　　　　　　　（1:描画中、0:非描画中)                      
                                                                             
- 例 -                                                                       
int    sw;                                                                   
int    ret;                                                                  
                                                                             
ret = MOS_openCheck( &sw );                                                  
                                                                             
- 内容 -                                                                     
現在のマウスの動作状態を読み取ります。                                       
変数のポインタがNULLの場合、変数に対して値を返しません。                     
                                                                             
-----------------------------------------------------------------------------
.MOS_pulse                                                                   
パルス数/画素比の設定                                                        
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_pulse( x, y );                                                   
int     x;                             /*   水平値(1〜255)  　　*/           
int     y;                             /*   垂直値(1〜255)  　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_pulse( 10, 10 );                                                   
                                                                             
- 内容 -                                                                     
マウスの移動による、マウスカーソルの画面上の移動量を設定します。             
マウスからの移動量は、パルス数にて通知されますが、水平/垂直値でマウスカーソル
を水平/垂直方向にそれぞれ1ドット移動するのに必要な値を別々に設定します。     
マウスドライバの初期設定(MOS_start) を行ったとき、水平/垂直パルス数は8に設定 
されます。これは、マウスからの移動量が8パルス発生するごとに、1ドットマウス   
カーソルが移動する値です。水平/垂直値を1に設定すると、マウスからの移動量が1  
パルス発生するごとに、1ドットマウスカーソルが移動します。                    
                                                                             
-----------------------------------------------------------------------------
.MOS_rdon                                                                    
ボタンの押下情報の読み取り                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_rdon( n, button, bcount, x, y );                                 
int     n;                /*  ボタン番号(0〜1)            　*/               
int    *button;       　　/*  ボタンの状態　                  　*/           
int    *bcount;       　　/*  ボタンの押下回数　              　*/           
int    *x;            　  /*  マウスカーソルの水平位置(X座標) 　*/           
int    *y;            　  /*  マウスカーソルの垂直位置(Y座標) 　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    button, bcount, x, y;                                                 
int    ret;                                                                  
                                                                             
ret = MOS_rdon( 1, &button, &bcount, &x, &y );                               
                                                                             
- 内容 -                                                                     
指定したマウスボタンが押されたときの、ボタンの状態、マウスカーソルの指定して 
いた画面座標を読み取ります。ボタン番号は、情報を得たいボタンの番号を指定しま 
す。                                                                         
                                                                             
ボタンの状態                                                                 
　　　　　 7　 6　 5　 4　 3　 2　 1　 0　                                   
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
 button:│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                   
　　　　└─┴─┴─┴─┴─┴─┴┬┴┬┘                                   
　　　　　　　　　　　　　　　　　│　└─ボタン0(左) 0:開放中               
　　　　　　　　　　　　　　　　　│　　　　　　　　　1:押下中               
　　　　　　　　　　　　　　　　　└───ボタン1(右) 0:開放中               
　　　　　　　　　　　　　　　　　　　　　　　　　　　1:押下中               
                                                                             
この関数が呼び出された後、ボタンの押下回数はクリアされます。                 
マウスカーソルの水平/垂直位置には、ボタンが最後に押されたときのマウスカーソル
の座標が通知されます。                                                       
                                                                             
-----------------------------------------------------------------------------
.MOS_rdopen                                                                  
ボタンの開放情報の読み取り                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int    MOS_rdopen( n, button, bcount, x, y );                                
int    n;                 /*  ボタン番号(0〜1)            　*/               
int    *button;       　　/*  ボタンの状態　              　    */           
int    *bcount;       　　/*  ボタンの開放回数            　    */           
int    *x;            　  /*  マウスカーソルの水平位置(X座標) 　*/           
int    *y;            　  /*  マウスカーソルの垂直位置(Y座標) 　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    button, bcount, x, y;                                                 
int    ret;                                                                  
                                                                             
ret = MOS_rdopen( 1, &button, &bcount, &x, &y );                             
                                                                             
- 内容 -                                                                     
指定したマウスボタンが離されたときの、ボタンの状態、マウスカーソルの指定して 
いた画面座標を読み取ります。ボタン番号は、情報を得たいボタンの番号を指定しま 
す。                                                                         
                                                                             
ボタンの状態                                                                 
　　　　　 7　 6　 5　 4　 3　 2　 1　 0　                                   
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
 button:│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                   
　　　　└─┴─┴─┴─┴─┴─┴┬┴┬┘                                   
　　　　　　　　　　　　　　　　　│　└─ボタン0(左) 0:開放中               
　　　　　　　　　　　　　　　　　│　　　　　　　　　1:押下中               
　　　　　　　　　　　　　　　　　└───ボタン1(右) 0:開放中               
　　　　　　　　　　　　　　　　　　　　　　　　　　　1:押下中               
                                                                             
この関数が呼び出された後、ボタンの開放回数はクリアされます。                 
マウスカーソルの水平/垂直位置には、ボタンが最後に離されたときのマウスカーソル
の座標が通知されます。                                                       
                                                                             
-----------------------------------------------------------------------------
.MOS_rdpos                                                                   
位置とボタンの読み取り                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_rdpos( button, x, y );                                           
int     *button;                   /*   ボタンの状態              */         
int     *x;                        /*   マウスカーソルの水平位置  */         
int     *y;                        /*   マウスカーソルの垂直位置  */         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    button, x, y;                                                         
int    ret;                                                                  
                                                                             
ret = MOS_rdpos( &button, &x, &y );                                          
                                                                             
- 内容 -                                                                     
現在、マウスカーソルが指している画面座標と、マウスのボタンの状態を読み取りま 
す。                                                                         
                                                                             
ボタンの状態                                                                 
　　　　　 7　 6　 5　 4　 3　 2　 1　 0　                                   
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
 button:│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                   
　　　　└─┴─┴─┴─┴─┴─┴┬┴┬┘                                   
　　　　　　　　　　　　　　　　　│　└ボタン0(左) 0:開放中                 
　　　　　　　　　　　　　　　　　│　　　　　　　　1:押下中                 
　　　　　　　　　　　　　　　　　└──ボタン1(右) 0:開放中                 
　　　　　　　　　　　　　　　　　　　　　　　　　　1:押下中                 
                                                                             
-----------------------------------------------------------------------------
.MOS_resolution                                                              
仮想画面の設定                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_resolution( page, n );                                           
int     page;                          /*   ページ　　　　　　　*/           
int     n;                             /*   番号　　　　　　　  */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_resolution( 0, 3 );                                                
                                                                             
- 内容 -                                                                     
ハードウェアで設定可能な解像度のうち、使用したい解像度の設定を行います。     
ただし、画面の表示制御は行いません。画面の表示制御はEGBで行ってください。    
                                                                             
仮想画面の設定時に以下のように設定します。                                   
                                                                             
┌───────────┬──────┐                                     
│マウスカーソル位置　　│画面中央　　│                                     
│マウスカーソル形状　　│システム形状│                                     
│マウスカーソル移動範囲│画面全体　　│                                     
└───────────┴──────┘                                     
                                                                             
-----------------------------------------------------------------------------
.MOS_setControl                                                              
コントロールの登録                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_setControl( control );                                           
int     control;                         /*   コントロールマスク　*/         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_setControl( 0x01 );                                                
                                                                             
- 内容 -                                                                     
マウス関数のコントロールを行います。                                         
例えば、MOS_dispのコントロールを行うことにより、各関数でのマウスの表示制御を 
無効とすることができます。                                                   
　　　　　31　　　 6　 5　 4　 3　 2　 1　 0                                 
　　　　┌─┬〜┬─┬─┬─┬─┬─┬─┬─┐                               
control:│ 0│　│　│　│　│　│　│　│　│                               
　　　　└─┴〜┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                               
　　　　　　　　　│　│　│　│　│　│　└─0: MOS_dispを無効とします。    
　　　　　　　　　│　│　│　│　│　│                                     
　　　　　　　　　│　│　│　│　│　│　　　1: MOS_dispを有効とします。    
　　　　　　　　　│　│　│　│　│　│                                     
　　　　　　　　　│　│　│　│　│　└─0: MOS_setposを無効とします。      
　　　　　　　　　│　│　│　│　│                                         
　　　　　　　　　│　│　│　│　│　　　1: MOS_setposを有効とします。      
　　　　　　　　　│　│　│　│　│                                         
　　　　　　　　　│　│　│　│　└─0: MOS_horizonを無効とします。         
　　　　　　　　　│　│　│　│                                             
　　　　　　　　　│　│　│　│　　　1: MOS_horizonを有効とします。         
　　　　　　　　　│　│　│　│                                             
　　　　　　　　　│　│　│　└─0: MOS_verticalを無効とします。            
　　　　　　　　　│　│　│                                                 
　　　　　　　　　│　│　│　　　1: MOS_verticalを有効とします。            
　　　　　　　　　│　│　│                                                 
　　　　　　　　　│　│　└─0: MOS_typeを無効とします。                    
　　　　　　　　　│　│                                                     
　　　　　　　　　│　│　　　1: MOS_typeを有効とします。                    
　　　　　　　　　│　│                                                     
　　　　　　　　　│　└─0: MOS_viewHorizonを無効とします。                 
　　　　　　　　　│                                                         
　　　　　　　　　│　　　1: MOS_viewHorizonを有効とします。                 
　　　　　　　　　│                                                         
　　　　　　　　　└─0: MOS_viewVerticalを無効とします。                    
                                                                             
　　　　　　　　　　　1: MOS_viewVerticalを有効とします。                    
                                                                             
                                                                             
-----------------------------------------------------------------------------
.MOS_setEvent                                                                
イベントルーチンの登録                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_setEvent( func );                                                
void    *func();              /*  イベントルーチンへのポインタ  */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int     ret;　                                                               
extern void mouseEvent();                                                    
                                                                             
ret = MOS_setEvent( mouseEvent );                                            
                                                                             
void    mouseEvent()                                                         
{                                                                            
  〜〜〜〜                                                                   
}                                                                            
                                                                             
- 内容 -                                                                     
マウスの割り込みが発生した場合に、イベントルーチンを呼び出します。           
ユーザ定義ルーチンとは異なり、全てのマウスの割り込み時に実行されます。       
マウスの割り込みは約20msごとに発生します。イベント検出を行う場合には、この割 
り込みを分周して60ms以上毎にイベントを積むようにすると、システムに負担をかけ 
ずに済みます。イベントルーチンへのポインタがNULLの場合、イベントルーチンは呼 
び出されません。                                                             
マウスの初期設定時には、イベントルーチンは未登録(NULL)となっています。       
マウスの割り込みは以下の周期で発生します。                                   
                                                                             
MOS単体での初期化時は約23.04ms                                               
SND初期化後のMOS初期化時は約20.16ms                                          
                                                                             
-----------------------------------------------------------------------------
.MOS_setpos                                                                  
位置の設定                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_setpos( x, y );                                                  
int     x;                 /*   マウスカーソルの水平位置　　　　*/           
　　　　　　　　　　　　　　　　(ハード座標系の値)                           
int     y;                 /*   マウスカーソルの垂直位置　　　　*/           
　　　　　　　　　　　　　　　　(ハード座標系の値)                           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    x = 320, y = 200;                                                     
int    ret;                                                                  
                                                                             
ret = MOS_setpos( x, y );                                                    
                                                                             
- 内容 -                                                                     
マウスカーソルが表示状態の場合、指定した位置へマウスカーソルを移動して表示し 
ます。                                                                       
消去状態の場合でも、マウスカーソルの位置は設定されます。                     
マウスカーソルの移動範囲を指定(MOS_horizon,MOS_vertical) されている場合には、
その範囲内に入るように設定されます。                                         
                                                                             
-----------------------------------------------------------------------------
.MOS_start                                                                   
動作開始                                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_start( mwork, wsize );                                           
char    *mwork;         　　　　　　　/*  作業域のアドレス  　*/             
int     wsize;          　　　　　　　/*  作業域の大きさ　  　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char    mwork[4096];                                                         
int     ret;                                                                 
                                                                             
ret = MOS_start( mwork, 4096 );                                              
                                                                             
- 内容 -                                                                     
マウスドライバの初期設定を行い、マウスを使用可能にします。                   
これに伴い、マウスの移動を調べるマウスセンスルーチンの動作を開始します。     
フルカラー画面でマウスカーソルを表示する際は､作業域を多く確保する必要がありま
す｡詳しくは｢1.2　フルカラー画面でのマウスカーソル表示の注意事項｣を参照してく
ださい｡
初期設定により、次のようになります。                                         
                                                                             
･マウスカーソル表示　　　　　:しない                                         
･マウス書き込みページ　　　　:0                                              
･マウスの仮想画面　　　　　　:ページ0、1ともに3番                            
･マウスカーソル位置　　　　　:画面中心                                       
･マウスカーソル形状　　　　　:左上向き矢印(システム形状)                     
･マウスカーソルの色識別番号　:最大色識別番号                                 
･マウスカーソル中心点　　　　:(0，0)                                         
･マウスカーソル移動範囲　　　:画面全体                                       
･パルス数/画素ブランク比　 　:コントロールパネルの設定値に依存。             
　　　　　　　　　　　　　　　　(初期設定値は、水平、垂直値ともに8)          
･ユーザ定義サブルーチン　　　:未登録                                         
･加速度検出機能　　　　　　　:有効                                           
･マウスボタン入れ換え　　　　:コントロールパネルの設定状態に依存。           
　　　　　　　　　　　　　　　　(初期状態は、入れ換えなし)                   
                                                                             
マウスの割り込み間隔時間は、初期設定により、次のようになります。             
ＭＯＳ単体での初期化時　　　　　→　約23.04ms                                
ＳＮＤ初期化後のＭＯＳ初期化時　→　約20.16ms                                
                                                                             
-----------------------------------------------------------------------------
.MOS_tilePattern                                                             
タイルパターンの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_tilePattern( x, y, data );                                       
int     x;              　　　　　/*  水平値(8ｎ、1≦ｎ≦4)　　　*/          
int     y;              　　　　　/*  垂直値(1〜32)          　　　*/        
char    *data;          　　　　　/*  タイルパターンデータのアドレス  */     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char    data[8*8*2] ={〜};                                                   
int     ret;                                                                 
                                                                             
ret = MOS_tilePattern( 1, 8, data );                                         
                                                                             
- 内容 -                                                                     
マウスカーソルのタイルパターンを設定します。                                 
システム･単色カーソルの場合のみ有効です。                                    
                                                                             
システム形状                                                                 
                                                                             
□□□□□□□□□□□・・・・・                                             
□■■■■■■■■■□・・・・・　　　　■　指定タイルパターン               
□■■■■■■■■□・・・・・・　　　　□　色識別番号0                      
□■■■■■■■□・・・・・・・　　　　・　未描画                           
□■■■■■■□・・・・・・・・                                             
□■■■■■■■□・・・・・・・                                             
□■■■■■■■■□・・・・・・                                             
□■■■□■■■■■□・・・・・                                             
□■■□・□■■■■■□・・・・                                             
□■□・・・□■■■■■□・・・                                             
□□・・・・・□■■■■■□・・                                             
・・・・・・・・□■■■■■□・                                             
・・・・・・・・・□■■■■■□                                             
・・・・・・・・・・□■■■□・                                             
・・・・・・・・・・・□■□・・                                             
・・・・・・・・・・・・□・・・                                             
                                                                             
参考)タイルパターン(設定16×16dot)                                           
例えば、次のタイルパターンを設定すると、システムカーソルは、以下の形状で表示 
されます。                                                                   
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ 
◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇ 
◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇ 
◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇ 
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ 
◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇ 
◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇ 
◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇ 
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ 
◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇ 
◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇ 
◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇ 
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ 
◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇ 
◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇ 
◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇◇■■◇◇◇◇◇◇◇◇◇◇◇ 
                                                                             
　　　　　　　↓　　　　　　　　　　　　　　　　　　　　　　　↓             
                                                                             
□□□□□□□□□□□・・・・・　　　　　　□□□□□□□□□□□・・・・・ 
□◇◇■■◇◇◇◇◇□・・・・・　　　　　　□◇◇◇◇◇◇◇◇◇□・・・・・ 
□◇◇■■◇◇◇◇□・・・・・・　　　　　　□◇◇◇◇◇◇◇◇□・・・・・・ 
□◇◇■■◇◇◇□・・・・・・・　　　　　　□◇◇◇◇◇◇◇□・・・・・・・ 
□■■■■■■□・・・・・・・・　　　　　　□■■■■■■□・・・・・・・・ 
□◇◇◇◇◇◇◇□・・・・・・・　　　　　　□◇◇■■◇◇◇□・・・・・・・ 
□◇◇◇◇◇◇◇◇□・・・・・・　　　　　　□◇◇■■◇◇◇◇□・・・・・・ 
□◇◇◇□◇◇◇◇◇□・・・・・　　　　　　□◇◇■□◇◇◇◇◇□・・・・・ 
□■■□・□■■■■■□・・・・　　　　　　□■■□・□■■■■■□・・・・ 
□◇□・・・□◇◇◇◇◇□・・・　　　　　　□◇□・・・□◇◇◇◇■□・・・ 
□□・・・・・□◇◇◇◇◇□・・　　　　　　□□・・・・・□◇◇◇■■□・・ 
・・・・・・・・□◇◇◇◇◇□・　　　　　　・・・・・・・・□◇◇■■◇□・ 
・・・・・・・・・□■■■■■□　　　　　　・・・・・・・・・□■■■■■□ 
・・・・・・・・・・□■■◇□・　　　　　　・・・・・・・・・・□◇◇◇□・ 
・・・・・・・・・・・□■□・・　　　　　　・・・・・・・・・・・□◇□・・ 
・・・・・・・・・・・・□・・・　　　　　　・・・・・・・・・・・・□・・・ 
                                                                             
-----------------------------------------------------------------------------
.MOS_type                                                                    
形状の設定                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include<MOS.H>                                                              
int     MOS_type( n, x, y, pattern );                                        
int     n;        /*  設定モード(0:システム,1:単色、2:カラー)   */           
int     x;        /*  カーソル中心点の水平位置(-128〜127)       */           
int     y;        /*  カーソル中心点の垂直位置(-128〜127)       */           
char    *pattern; /*  カーソル形状パターン領域の先頭アドレス     */          
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char    cursor[2+128+128];                                                   
int     ret;                                                                 
                                                                             
ret = MOS_type( 1, 0, 0, cursor );                                           
                                                                             
- 内容 -                                                                     
マウスカーソルの形状を設定します。                                           
システムカーソルとは、システムが持つデフォルトのカーソルで、ユーザが形状を変 
更できないことを除いて、単色カーソルと同じ扱いを受けます。                   
カーソル中心点の水平/垂直位置は、マウスカーソルの中心点、つまり座標の読み取り
位置を指定します。カーソル形状パターン領域は、マウスカーソルの形状を定義する 
ためのビットパターンが格納されたメモリ領域です。                             
                                                                             
  ┌─┬───────────┐                                             
  │ 0│Ｂ│　横ドット数/8　─┼→ 横ドット数(8,16,24,32)                    
  ├─┼───────────┤                                             
  │ 1│Ｂ│　縦ドット数　　─┼→ (1〜32)                                   
  ├─┼───────────┤                                             
  │ 2│　│　マウスカーソル　│                                             
　│　│　　　　　　　　　　  │                                             
  │　│　ドットパターン　　  │                                             
　│BA├───────────┤                                             
　│　│　マウスカーソル　　  │                                             
　│　│　　　　　　　　　　  │                                             
　│　│　ＡＮＤパターン　　  │                                             
　└─┴───────────┘                                             
                                                                             
●単色時                  　　●カラー時                                     
                                                                             
ドットパターンバイト数＝　　　ドットパターンバイト数＝                       
　　　横×縦（ドット数）/8　　ピクセル数×横×縦（ドット数）/8               
                                                                             
ＡＮＤパターンバイト数＝　　　　ＡＮＤパターンバイト数＝                     
　　　横×縦（ドット数）/8　　　　　横×縦（ドット数）/8                     
                                                                             
マウスカーソル形状の設定における注意事項を次に示します。                     
 1.　横ドット数/縦ドット数                                                   
  マウスカーソルの横ドット数と縦ドット数には、次のような制限があり、これ以外 
  を設定すると何も処理を行いません。                                         
　横ドット数:8,16, 24, 32(1, 2, 3, 4と設定)                                  
　縦ドット数:1〜32                                                           
                                                                             
 2.　カーソル中心点                                                          
  カーソル中心点の水平/垂直位置の設定は、横/縦ドット数に関係なく、カーソルの 
  左上を(0 , 0)として、水平、垂直ともに-128 〜127 (0x80〜0x7f) の間で設定し  
  ます。                                                                     
                                                                             
 3.マウスカーソルのドット/ＡＮＤパターン                                     
  後述のマウスカーソルの定義例を参照してください。                           
                                                                             
システム形状                                                                 
                                                                             
□□□□□□□□□□□・・・・・                                             
□■■■■■■■■■□・・・・・　　　　■　指定色識別番号                   
□■■■■■■■■□・・・・・・                                             
□■■■■■■■□・・・・・・・　　　　□　色識別番号0                      
□■■■■■■□・・・・・・・・                                             
□■■■■■■■□・・・・・・・　　　　・　未描画                           
□■■■■■■■■□・・・・・・                                             
□■■■□■■■■■□・・・・・                                             
□■■□・□■■■■■□・・・・                                             
□■□・・・□■■■■■□・・・                                             
□□・・・・・□■■■■■□・・                                             
・・・・・・・・□■■■■■□・                                             
・・・・・・・・・□■■■■■□                                             
・・・・・・・・・・□■■■□・                                             
・・・・・・・・・・・□■□・・                                             
・・・・・・・・・・・・□・・・                                             
                                                                             
-----------------------------------------------------------------------------
.MOS_typeRom                                                                 
形状の設定 (ｼｽﾃﾑｱｲｺﾝﾊﾟﾀｰﾝ)                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include<MOS.H>                                                              
int    MOS_typeRom( num, x, y, adr );                                        
int    num; 　　　　　　 /* システムアイコン番号(1〜128)        */           
int    x; 　　　　　　　 /* カーソル中心点水平位置              */           
int    y; 　　　　　　　 /* カーソル中心点垂直位置              */           
char   *adr 　　　　　　 /* パターン作業領域のアドレス(258byte) */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
int    num;                                                                  
int    x,y;                                                                  
char   pat_work[258];                                                        
                                                                             
num = 87;                                                                    
x 　= 0;                                                                     
y 　= 0;                                                                     
                                                                             
ret = MOS_typeRom( num, x, y, pat_work );                                    
                                                                             
- 内容 -                                                                     
システムアイコンのパターンでマウス形状を設定します。                         
マウスは単色マウスで設定されます。                                           
システムアイコン番号は、付録Ａの｢システムアイコン一覧表｣を参照してください。 
                                                                             
-----------------------------------------------------------------------------
.MOS_vertical                                                                
垂直移動範囲指定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_vertical( Ymin, Ymax );                                          
int     Ymin;              /*   最小垂直位置(ハード座標系の値)  */           
int     Ymax;              /*   最大垂直位置(ハード座標系の値)  */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_vertical( 0, 400 );                                                
                                                                             
- 内容 -                                                                     
マウスカーソルの垂直方向(Y軸)の移動範囲を指定します。                        
マウスカーソルの移動は、この範囲に限定されます。この関数を呼び出したとき、   
マウスカーソルが範囲外にあった場合は、範囲内に移動されます。                 
最小/最大垂直位置には、マウスカーソルの移動できるY座標の範囲を指定します。   
                                                                             
図CL21R-037                                                                  
                                                                             
-----------------------------------------------------------------------------
.MOS_viewHorizon                                                             
水平消去範囲の指定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_viewHorizon( n, Xmin, Xmax );                                    
int     n;                 /*   0:マウス消去範囲の解除          */           
　　　　　　　　　　　　　 /*   1:マウス消去範囲の設定　　　　　*/           
int     Xmin;              /*   最小水平位置(ハード座標系の値)　*/           
int     Xmax;              /*   最大水平位置(ハード座標系の値)　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_viewHorizon( 1, 50, 640 );                                         
                                                                             
- 内容 -                                                                     
マウスカーソルの水平方向(X軸)の消去範囲を指定します。                        
マウスカーソルの消去は、この範囲に限定されます。この関数を呼び出したとき、   
マウスカーソルが範囲内にあった場合には、マウスの表示、非表示にかかわらず     
マウスカーソルを消去します。                                                 
                                                                             
図CL21R-038                                                                  
                                                                             
-----------------------------------------------------------------------------
.MOS_viewVertical                                                            
垂直消去範囲の指定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int    MOS_viewVertical( n, Ymin, Ymax );                                    
int    n;                 /*  0:マウス消去範囲の解除　　　　  */             
　　　　　　　　　　　　　/*  1:マウス消去範囲の設定　　　　  */             
int    Ymin;              /*  最小垂直位置(ハード座標系の値)  */             
int    Ymax;              /*  最大垂直位置(ハード座標系の値)  */             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_viewVertical( 1, 0, 400 );                                         
                                                                             
- 内容 -                                                                     
マウスカーソルの垂直方向(Y軸)の消去範囲を指定します。                        
マウスカーソルの消去は、この範囲に限定されます。この関数を呼び出したとき、   
マウスカーソルが範囲内にあった場合には、マウスの表示、非表示にかかわらず     
マウスカーソルを消去します。                                                 
                                                                             
図CL21R-039                                                                  
                                                                             
-----------------------------------------------------------------------------
.MOS_writePage                                                               
書き込みページの指定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <MOS.H>                                                             
int     MOS_writePage( page );                                               
int     page;                          /*   ページ  　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = MOS_writePage( 1 );                                                    
                                                                             
- 内容 -                                                                     
書き込みページを指定します。                                                 
マウスカーソルは、書き込みページに対して描画します。EGBにより書き込みページが
表示されていなければ、マウスカーソルは表示されません。                       
                                                                             
図CL21R-040                                                                  
                                                                             
書き込みページが変更された時に、変更前のページの画面モードと変更後のページの 
画面モードが異なる場合は、以下のように設定します。                           
┌────────────┬─────┐                                     
│マウスカーソル位置　　　│画面中央　│                                     
│マウスカーソル移動範囲　│画面全体　│                                     
└────────────┴─────┘                                     
                                                                             
*****************************************************************************
第3章　スプライトライブラリ                                                  
*****************************************************************************
                                                                             
 1.　スプライトについて                                                      
                                                                             
  1.1　スプライトの機能                                                      
                                                                             
  本節では、スプライトが表示(描画)される画面:スプライト画面(以後の解説では、"
画面"と略記します。)について、基本的な機能や用語を説明します。               
                                                                             
   (1) スプライト座標空間                                                    
                                                                             
　スプライトは、スプライトパターン(16×16dot 32k色のドットパターン)と座標を指
定すると、ハードウェアの機能で、そのパターンをVRAMに転送(描画)します。スプラ 
イトの転送可能な空間をスプライト座標空間と呼び、特に表示可能な空間をスプライ 
ト表示空間と呼びます。                                                       
                                                                             
図CL21R-041                                                                  
                                                                             
   (2) スプライト表示                                                        
                                                                             
   (3) ラップラウンド                                                        
                                                                             
図CL21R-042                                                                  
                                                                             
  1.2　スプライト機能の仕様概要                                              
                                                                             
　スプライト機能の仕様概要を以下に示します。                                 
┌──────────────┬─────────────────────┐ 
│スプライトサイズ      　　　│16×16ドット (基本)               　　　　│ 
├──────────────┼─────────────────────┤ 
│定義可能インデックス数    　│1024個（8Kバイト）　　　　　　　　　　　　│ 
├──────────────┼─────────────────────┤ 
│最大パターン数    　　　　　│896 個（112Kバイト）                      │ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　                │（16色、基本サイズ換算, 表示上の制限なし) │ 
├──────────────┼─────────────────────┤ 
│パターンの重なり    　　　　│優先順位処理可　　　　　　　　　　　　　　│ 
├──────────────┼─────────────────────┤ 
│表示色　    　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│    1.32K色スプライト    　 │32768色（ピクセル単位）　　　　　　　　　 │ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│    2.32K色中16色スプライト │32768色中16色（ピクセル単位）　　　　　　 │ 
├──────────────┼─────────────────────┤ 
│色テーブル　    　　　　　　│32K色中16色の色テーブルを256個定義可能　　│ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　　　　　　　　　│（8Kバイト）　　　　　　　　　　　　　　　│ 
├──────────────┼─────────────────────┤ 
│スプライトインデックス毎の　│　　　　    　　　　　　　　　　　　　　　│ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│アトリビュート　　　　　　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　･パターン（正像）回転　　 │0°，90°，180°，270°　　　　　　　　　 │ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　･パターン（鏡像）回転　　 │0°，90°，180°，270°　　　　　　　　　 │ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　･パターンの縮小　　　　　 │水平、垂直独立に1、1/2 倍を指定　　　　　 │ 
│　　　　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　･オフセットアドレス　　　 │全パターンに共通なオフセットアドレスの参照│ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│  　参照フラグ　　　　　　  │を行うか否かのフラグ（参照のときは、パター│ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　　                      　│ン単位で定義されるＸ、Ｙアドレスとオフセッ│ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　　　　　　　　　　　　　　│トの加算値が、表示の対象となります）。　　│ 
│　　　　　　            　　│　　　　　　　　　　　　　　　　　　　　　│ 
│　･色テーブル番号　　　　　 │32K色中16色スプライトの場合に有効　　　　 │ 
└──────────────┴─────────────────────┘ 
                                                                             
  1.3　スプライトパターンメモリ                                              
                                                                             
  スプライトパターンメモリは128KB(256×256×16ビット)の容量をもち、インデック
ス格納部と色テーブル格納部とパターン格納部の3ブロックに分かれます(下図参照)。
                                                                             
図CL21R-043                                                                  
                                                                             
  (1) パターン格納部                                                         
　スプライトパターンの基本サイズは、16×16ドットです。パターン格納部は、この 
スプライトパターンを配列状に格納しています。                                 
　パターン格納部は 32K色中16色スプライトパターンの2つの形式を混在して、格納で
きます。この二つの形式は、スプライト毎に指定できます。                       
                                                                             
  (2) 32K色スプライト(色テーブルを参照しない場合)                            
  ●スプライト1個あたりのメモリ消費量                                        
　32K色スプライトパターンは、1パターンに512バイト(16×16ドット×16ビット)使用
します。したがって、この形式では最大224個のパターンが扱えます。              
                                                                             
  ●パターン番号の範囲                                                       
　パターン番号は32〜255の範囲で指定します(0〜31は使用禁止)。                 
                                                                             
  ●パターンメモリの先頭番地                                                 
　パターン番号nのメモリ先頭番地は、次の式で計算されます。                    
  　　メモリ先頭番地=n×512バイト                                            
  このメモリ先頭番地から512バイトが、そのパターン番号のパターンメモリとなりま
す。                                                                         
                                                                             
  ●パターンメモリの構成                                                     
                                                                             
図CL21R-044                                                                  
                                                                             
  ●パターン番号nの画面上の表示(回転パラメータがすべて0のとき)               
                                                                             
(0,0)                                              (511,0)                   
┌─────────────────────────┐                       
│　　パターン番号ｎ　　　　　　　　　　　　　　　　│                       
│　　　16ﾄﾞｯﾄ　　　　　　　　　　　　　　　　　　　│                       
│　　┌─────┐　奥行き方向の16ビットは15ビッ　│                       
│　　│　　 1　　│　トが色情報、1ビットがマスク　 │                       
│　　├─────┤　情報として使われます。　    　│                       
│　　│　　 2　　│　　　　　　　　　　　　　　　　│                       
│　　├─────┤　　　　　　　　　　　　　　　　│                       
│　　│　　 3　　│　　　　　　　　　　　　　　　　│                       
│　16├─────┤　　　　　　　　　　　　　　　　│                       
│　　〜　　　　　〜　　　　　　　　　　　　　　　　│                       
│　　│　　　　　│　　　　　　　　　　　　　　　　│                       
│　　├─────┤　　　　　　　　　　　　　　　　│                       
│　　│　　16　　│　　　　　　　　　　　　　　　　│                       
│　　└─────┘　　　　　　　　　　　　　　　　│                       
〜　　　　　　　　　　　　　　　　　　　　　　　　　〜                       
│　　　　　　　　　　　　　　　　　　　　　　　　　│                       
└─────────────────────────┘                       
(0,511)                                           (511,511)                  
                                                                             
  (3) 32K色中16色スプライト (色テーブルを参照する場合)                       
  ●スプライト1個あたりのメモリ消費量                                        
　32K色中16色スプライトパターンは、1パターンに128バイト(16×16ドット×4ビット
)使用します。したがって、この形式では最大896個のパターンが扱えます。         
                                                                             
  ●パターン番号の範囲                                                       
　パターン番号は128〜1023の範囲で指定します(0〜127は使用禁止)。              
                                                                             
  ●パターンメモリの先頭番地                                                 
　パターン番号nのメモリ先頭番地は、次の式で計算されます。                    
                                                                             
　　　メモリ先頭番地=n×128バイト                                            
  このメモリ先頭番地から128バイトが、そのパターン番号のパターンメモリとなりま
す。                                                                         
                                                                             
  ●パターンメモリの構成                                                     
                                                                             
図CL21R-045                                                                  
                                                                             
  ●パターン番号nの画面上の表示(回転パラメータがすべて0のとき)               
　画面上の色は、スプライトINDEX中の色テーブル番号で指定された色テーブルに設定
された32K色中16色になります。                                                
                                                                             
(0,0) 　　　　　　　　　　　　　　　　　　　　　　 (511,0)                   
　┌─────────────────────────┐                     
　│　　パターン番号ｎ　　　　　　　　　　　　　　　　│                     
　│　　　    16　　　　　　　　　　　　　　　　　　　│                     
　│　　┌─────┐　奥行き方向の16ビットは15ビッ　│                     
　│　　│　　 1　　│　トが色情報として使われます。　│                     
　│　　├─────┤　　　　　　　                　│                     
　│　　│　　 2　　│　　　　　　　　　　　　　　　　│                     
　│　　├─────┤　　　　　　　　　　　　　　　　│                     
　│　　│　　 3　　│　　　　　　　　　　　　　　　　│                     
　│　16├─────┤　　　　　　　　　　　　　　　　│                     
　│　　〜　　　　　〜　　　　　　　　　　　　　　　　│                     
　│　　│　　　　　│　　　　　　　　　　　　　　　　│                     
　│　　├─────┤　　　　　　　　　　　　　　　　│                     
　│　　│　　16　　│　　　　　　　　　　　　　　　　│                     
　│　　└─────┘　　　　　　　　　　　　　　　　│                     
　〜　　　　　　　　　　　　　　　　　　　　　　　　　〜                     
　│　　　　　　　　　　　　　　　　　　　　　　　　　│                     
　└─────────────────────────┘                     
 (0,511)　　　　　　　　　　　　　　　　　　　　　 (511,511)                 
                                                                             
  (4) 32K色スプライトと 32K色中16色スプライトの個数設定                      
　32K色スプライトと32K色中16色スプライトパターンは混在できます。             
                                                                             
  ●スプライトパターンの個数の計算式を以下に示します。                       
                                                                             
 32K色スプライトパターン個数      :N1                                        
 32K色中16色スプライトパターン個数:N2                                        
                                                                             
 N1 =(114688-N2×128)÷512                                                   
 N2 =(114688-N1×512)÷128                                                   
                                                                             
  ●スプライトパターンの個数の代表例を以下に示します。                       
                                                                             
┌─┬──────┬──────┬──────┐                             
│組│ 32K色　    │ 32K色中16色│スプライト　│                             
│　│　　　　　　│　　　　　　│　　　　　　│                             
│合│スプライト　│スプライト　│パターン個数│                             
│　│　　　　　　│　　　　　　│　　　　　　│                             
│せ│パターン個数│パターン個数│　　合計　　│                             
│　│　　　　　　│　　　　　　│　　　　　　│                             
│例│　　 N1 　　│     N2 　　│　 N1+N2    │                             
├─┼──────┼──────┼──────┤                             
│ 1│　 224　　　│　   0　　　│　 224　　　│                             
├─┼──────┼──────┼──────┤                             
│ 2│   192    　│   128    　│   320      │                             
├─┼──────┼──────┼──────┤                             
│ 3│   160    　│   256    　│   416    　│                             
├─┼──────┼──────┼──────┤                             
│ 4│   128    　│   384    　│   512    　│                             
├─┼──────┼──────┼──────┤                             
│ 5│    96　　　│   512    　│   608    　│                             
├─┼──────┼──────┼──────┤                             
│ 6│    64      │   640    　│   704    　│                             
├─┼──────┼──────┼──────┤                             
│ 7│     0　　　│   896    　│   896    　│                             
└─┴──────┴──────┴──────┘                             
                                                                             
  (5) 色テーブル格納部                                                       
　色テーブル部は32K色中16色スプライトの場合に参照されます。1つの色テーブルは3
2バイト(16ビット×16個)で構成されています。したがって、色テーブル格納部全体で
は、256個の色テーブルを格納しています。                                      
                                                                             
  ●32K色中16色スプライトパターンと一つの色テーブル格納部の関係              
                                                                             
図CL21R-046                                                                  
                                                                             
  ●色テーブル番号の範囲  →　256〜511である                                 
  ●色テーブル番号nの先頭アドレスの計算                                      
        色テーブルの先頭アドレス=n×32バイト                                 
                                                                             
  (6) インデックス格納部                                                     
　スプライトパターンメモリ内の先頭の8KBを、スプライトインデックス格納部として
割り当てます。                                                               
　1インデックスは64ビットで構成され、1024個存在します。                      
                                                                             
　　　　　ワード 0　　　　　　　　1 　　　　　　　2 　　　　　　　3          
INDEX NO. ┌───────┬───────┬───────┬───────┐ 
　　　　　│　Ｘアドレス　│　Ｙアドレス　│アトリビュート│色テーブル番号│ 
　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│ 
　　 #0 　│ （16ビット） │ （16ビット） │ （16ビット） │ （16ビット） │ 
　　　　　├───────┼───────┼───────┼───────┤ 
　　　　　│　Ｘアドレス　│　Ｙアドレス　│アトリビュート│色テーブル番号│ 
　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│ 
　　 #1 　│ （16ビット） │ （16ビット） │ （16ビット） │ （16ビット） │ 
　　　　　├───────┼───────┼───────┼───────┤ 
　　　　　│　Ｘアドレス　│　Ｙアドレス　│アトリビュート│色テーブル番号│ 
　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│ 
　　 #2 　│ （16ビット） │ （16ビット） │ （16ビット） │ （16ビット） │ 
　　　　　├───────┼───────┼───────┼───────┤ 
　　　　　〜              〜              〜              〜              〜 
　　　　　├───────┼───────┼───────┼───────┤ 
　　　　　│　Ｘアドレス  │　Ｙアドレス　│アトリビュート│色テーブル番号│ 
　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│ 
　　 #1022│ （16ビット） │ （16ビット） │ （16ビット） │ （16ビット） │ 
　　　　　├───────┼───────┼───────┼───────┤ 
　　　　　│　Ｘアドレス　│　Ｙアドレス　│アトリビュート│色テーブル番号│ 
　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│　　　　　　　│ 
　　 #1023│ （16ビット） │ （16ビット） │ （16ビット） │ （16ビット） │ 
　　　　　└───────┴───────┴───────┴───────┘ 
                                                                             
  ●Xアドレス:スプライト座標空間でのスプライトパターンのX座標。              
　　　　　　（パターンの左上隅アドレス）                                     
　15  14  13  12  11  10  9   8   7   6   5   4   3   2   1   0              
┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
│　│　│　│　│　│　│　│S │S │S │S │S │S │S │S │S │           
│＊│＊│＊│＊│＊│＊│＊│P │P │P │P │P │P │P │P │P │           
│　│　│　│　│　│　│　│X │X │X │X │X │X │X │X │X │           
│　│　│　│　│　│　│　│8 │7 │6 │5 │4 │3 │2 │1 │0 │           
└─┴─┴─┴─┴─┴─┴─┴┬┴─┴─┴─┴─┴─┴─┴─┴┬┘           
　　　　　　　　　　　　　　　└─┬─────────────┘             
　　　　　　　　　　　　　　　　　└─Ｘアドレス0 〜511                      
                                                                             
  ●Yアドレス:スプライト座標空間でのスプライトパターンのY座標。              
　　　　　　（パターンの左上隅アドレス）                                     
　15  14  13  12  11  10  9   8   7   6   5   4   3   2   1   0              
┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
│　│　│　│　│　│　│　│S │S │S │S │S │S │S │S │S │           
│＊│＊│＊│＊│＊│＊│＊│P │P │P │P │P │P │P │P │P │           
│　│　│　│　│　│　│　│Y │Y │Y │Y │Y │Y │Y │Y │Y │           
│　│　│　│　│　│　│　│8 │7 │6 │5 │4 │3 │2 │1 │0 │           
└─┴─┴─┴─┴─┴─┴─┴┬┴─┴─┴─┴─┴─┴─┴─┴┬┘           
　　　　　　　　　　　　　　　└─┬─────────────┘             
　　　　　　　　　　　　　　　　　└─Ｙアドレス0 〜511                      
                                                                             
  ●アトリビュート                                                           
アトリビュートの詳細                                                         
                                                                             
図CL21R-047                                                                  
                                                                             
  ●色テーブル番号                                                           
                                                                             
　15  14  13  12  11  10  9   8   7   6   5   4   3   2   1   0              
┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
│C │S │D │　│C │C │C │C │C │C │C │C │C │C │C │C │           
│T │P │I │＊│O │O │O │O │O │O │O │O │O │O │O │O │           
│E │Y │S │　│L │L │L │L │L │L │L │L │L │L │L │L │           
│N │S │P │　│11│10│9 │8 │7 │6 │5 │4 │3 │2 │1 │0 │           
└┬┴┬┴┬┴─┴┬┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴┬┘           
　│　│　│　　　└──┬──────────────────┘             
　│　│　│　　　　　　└─色テーブル番号256〜511(その他は指定禁止)         
　│　│　└────────スプライト非表示フラグ                           
　│　│　　　　　　　　　　　　 0: 表示                                     
　│　│　　　　　　　　　　　　 1: 非表示                                   
　│　└──────────スプライトスーパーインポーズビット               
　│　　　　　　　　　　　　　　 0: 通常表示                                 
　│　　　　　　　　　　　　　　 1: スーパーインポーズ                       
　└────────────色テーブル参照                                   
　　　　　　　　　　　　　　　　 0: 参照しない                               
　　　　　　　　　　　　　　　　 1: 参照                                     
                                                                             
  1.4　優先順位処理                                                          
                                                                             
　ハードウエアは、インデックスレジスタの番号値(昇順)にパターンの処理を行いま 
す。したがって、低位の優先度をもつパターンは番号の若いインデックスに、高位の 
優先度を持つパターンは番号の大きいインデックスに割りつけることで、優先処理が 
可能です。以下に例を示します。                                               
                                                                             
　　　　　　　　　　　　　　　　　　　　　　　　　　　パターン番号(Pno.)＝10 
インデックス　　　　　　　　　　　　　　　　　　　　　　┌────────   
　　　　　　　　　　　　　　　　　　　　　　　　　　　　│　　　●●●       
　　　　　┌────┬────┬────┬────┐　　│　　●　　　●     
番号Ｎ　　│XA=20 　│YA=20 　│Pno.=10 │　　　　│　　│　●　　　　　●   
　　　　　└────┴────┴────┴────┘　　│●●●●　●●●● 
　　　　　　　　　　　　　　　　　　　　　　　　　　　　│　　　●　●       
　　　　　　　　　　　　　　　　　　　　　　　　　　　　│　　　●●●       
　　　　　　　　　　　　　　　　　　　　　　　　　　　　│                   
                                                                             
　　　　　　　　　　　　　　　　　　　　　　　　　　　パターン番号(Pno.)＝11 
　　　　　　　　　　　　　　　　　　　　　　　　　　　　┌────────   
　　　　　　　　　　　　　　　　　　　　　　　　　　　　│○　　　　　　○   
　　　　　┌────┬────┬────┬────┐　　│　○　　　　○     
 番号Ｎ＋1│XA=24 　│YA=24 　│Pno.=11 │　　　　│　　│　　○　　○       
　　　　　└────┴────┴────┴────┘　　│　　　○○         
　　　　　　　　　　　　　　　　　　　　　　　　　　　　│　　　○○         
　　　　　　図に示すように、番号10のパターン上に　　　　│　　○　　○       
　          番号11のパターンが重ね書きされます。  　　　│　○　　　　○     
　　　　　　　　┌───────────────　　　　│                   
　　　　　　　　│　　　●●●　　　　　　　　　　　　　│                   
　　　　　　　　│　　●　　　●                                             
　　　　　　　　│　●　　　　　●                                           
　　　　　　　　│●●●●　●●●●                                         
　　　　　　　　│　　　●○●　　　　　○                                   
　　　　　　　　│　　　●●○　　　　○                                     
　　　　　　　　│　　　　　　○　　○                                       
　　　　　　　　│　　　　　　　○○                                         
　　　　　　　　│　　　　　　　○○                                         
　　　　　　　　│　　　　　　○　　○                                       
　　　　　　　　│　　　　　○　　　　○                                     
　　　　　　　　│                                                           
                                                                             
  1.5　マスク処理                                                            
                                                                             
   (1) 32K色スプライトのマスク処理                                           
　パターンの1ピクセルは16ビットで構成されますが、その内の15ビットは色情報とし
て使用され、残る1ビットはマスク用として使用されます。                        
　マスクビットがオンのピクセルは、表示の対象としません。この機能を使用する   
とにより、優先順位の高いパターンでもそのパターンの任意のピクセルの表示をマス 
クし、優先順位の低いパターンの該当ピクセルを表示することができます。         
                                                                             
   (2) 32K色中16色スプライトのマスク処理                                     
　パターンの1ピクセルは、4ビットで構成されます。この場合、4ビットのビットパタ
ーンがすべて0のピクセルを使うことによって、優先順位の高いパターン中でもそのパ
ターンの任意のピクセルの表示をマスクし、先順位の低いパターンの該当ピクセルを 
表示することができます。                                                     
                                                                             
座標系                                                                       
                                                                             
図CL21R-048                                                                  
                                                                             
  2.　スプライトライブラリ                                                   
                                                                             
  2.1　サンプルプログラム                                                    
┌───────────────────────────────────┐   
│　スプライトライブラリサンプルプログラム　　　　　　　　　　　　　　　│   
│　- 機能 -　複数の楕円を表示し、ランダムに移動させる。　 　　　　　　 │   
└───────────────────────────────────┘   
                                                                             
#include    <stdlib.h>                                                       
#include    <msdos.cf>                                                       
#include    <egb.h>                                                          
#include    <mos.h>                                                          
#include    <spr.h>                                                          
                                                                             
#define TAMA  16                                                             
#define sizeX 2                                                              
#define sizeY 2                                                              
#define enALL 5                                                              
                                                                             
void    sprset() ;                                                           
                                                                             
int     color[enALL]       = { 0x4e73 , 0x5ad6 , 0x6318 , 0x6f7b , 0x7fff }; 
int     circle_x[enALL]    = {     15 ,     14 ,     13 ,     12 ,     11 }; 
int     circle_y[enALL]    = {     15 ,     13 ,     12 ,     11 ,     10 }; 
int     circle_size[enALL] = {     15 ,     12 ,      9 ,      8 ,      5 }; 
                                                                             
char    mwork[MosWorkSize] ;                                                 
char    work[EgbWorkSize] ;                                                  
char    para[64] ;                                                           
char    get_buf[512] ;                                                       
                                                                             
void main()                                                                  
{                                                                            
    int vector_x[TAMA] ;                                                     
    int vector_y[TAMA] ;                                                     
    int x[TAMA],y[TAMA] ;                                                    
    int ch,dx,bx ;                                                           
    int i ;                                                                  
    EGB_init(work,EgbWorkSize) ;        /*  グラフィック初期化            */ 
    EGB_resolution(work,0,11) ;         /*  グラフィック仮想画面の設定    */ 
    EGB_resolution(work,1,8) ;          /*  グラフィック仮想画面の設定    */ 
    EGB_displayPage(work,1,3) ;         /*  グラフィック表示ページの指定  */ 
    SPR_init() ;                        /*  スプライト初期化              */ 
    sprset(work) ;        　            /*  スプライト定義                */ 
                                                                             
    EGB_color(work,1,0x043f) ;          /*  グラフィック背景色の設定      */ 
    EGB_clearScreen(work) ;             /*  背景を青く塗りつぶす          */ 
    EGB_writePage(work,1) ;             /*  グラフィック書き込みページ    */ 
    EGB_displayStart(work,2,5,1) ;      /*  グラフィック画面の拡大        */ 
    EGB_displayStart(work,3,256,240) ;  /*  グラフィック表示画面の大きさ  */ 
    MOS_start(mwork,MosWorkSize) ;      /*  マウス動作開始の設定          */ 
                                                                             
    /*  乱数による動作開始位置と移動量の設定  */                             
    for (i = 0 ; i < TAMA ; i++){                                            
        x[i] = (rand() & 0x7f) ;                                             
        y[i] = (rand() & 0x7f) ;                                             
        ch = (rand() & 3) + 1 ;                                              
        vector_x[i] = (rand() & 1) ? ch : -ch ;                              
        vector_y[i] = (rand() & 1) ? ch : -ch ;                              
        }                                                                    
                                                                             
    /*  スプライト位置の設定  スプライトアトリビュートの設定  */             
    for (i = 0 ; i < TAMA ; i++){                                            
        SPR_setPosition(0,1024-(sizeX*sizeY)*(i+1),sizeX,sizeY,x[i],y[i]) ;  
        SPR_setAttribute(1024-(sizeX*sizeY)*(i+1),sizeX,sizeY,128,0) ;       
        }                                                                    
                                                                             
    /*  スプライト動作開始  */                                               
    SPR_display(1,sizeX*sizeY*TAMA) ;                                        
                                                                             
    do {                                                                     
        for (i = 0 ; i < TAMA ; i++){                                        
            /*  スプライト座標計算  */                                       
            x[i] += vector_x[i] ;                                            
            y[i] += vector_y[i] ;                                            
            /*  スプライトＸ座標範囲チェック  */                             
            if ((x[i] < 2) || ((x[i] + sizeX*16) > 256)){                    
                vector_x[i] *= -1 ;                                          
                x[i] += vector_x[i] ;                                        
                }                                                            
            /*  スプライトＹ座標範囲チェック  */                             
            if ((y[i] < 0) || ((y[i] + sizeY*16) > 239)){                    
                vector_y[i] *= -1 ;                                          
                y[i] += vector_y[i] ;                                        
                }                                                            
            }                                                                
        /*  スプライトＲＥＡＤＹを待つ  */                                   
        SPR_display(2,sizeX*sizeY*TAMA) ;                                    
        /*  スプライト位置の設定  */                                         
        for (i = 0 ; i < TAMA ; i++)                                         
           SPR_setPosition(0,1024-(sizeX*sizeY)*(i+1),sizeX,sizeY,x[i],y[i]);
        MOS_rdpos(&ch,&dx,&bx) ;        /*  マウス位置とボタンの読み取り  */ 
        } while (ch != 3) ;            /*　左右ボタンが押されている？    */  
    SPR_display(0,sizeX*sizeY*TAMA) ;   /*  スプライト動作停止            */ 
    MOS_end() ;                         /*  マウス動作終了の設定          *  
}                                                                            
                                                                             
void sprset(work)                                                            
char *work;                                                                  
{                                                                            
    int i,x,y ;                                                              
    EGB_writeMode(work,0) ;             /*  グラフィック描画モードの設定   */
    EGB_paintMode(work,0x22) ;          /*  グラフィック面塗りモードの設定 */
    EGB_color(work,1,0x8000) ;          /*  グラフィック背景色の設定       */
    EGB_clearScreen(work) ;             /*  スーパーインポーズビットを設定 */
    for (i=0 ; i<enALL ; i++){                                               
        EGB_color(work,0,color[i]) ;    /*  グラフィック前景色の設定    　 */
        EGB_color(work,2,color[i]) ;    /*  グラフィック面塗り色の設定  　 */
        WORD(para+0) = circle_x[i] ;                                         
        WORD(para+2) = circle_y[i] ;                                         
        WORD(para+4) = circle_size[i] ;                                      
        EGB_circle(work,para) ;         /*  円の設定                    　 */
        }                                                                    
                                                                             
    i = 0 ;                                                                  
    DWORD(para+0) = (unsigned int)get_buf ;                                  
    WORD(para+4)  = getds() ;                                                
    for (y=0 ; y<sizeY ; y++){                                               
        for (x=0 ; x<sizeX ; x++){                                           
            WORD(para+6)  = 16*x ;                                           
            WORD(para+8)  = 16*y ;                                           
            WORD(para+10) = 16*x + 15 ;                                      
            WORD(para+12) = 16*y + 15 ;                                      
            /*  グラフィックドットデータの読み込み1  */                      
            EGB_getBlock(work,para) ;                                        
            /*  スプライトの定義  */                                         
            SPR_define(1,128+i,1,1,get_buf) ;                                
            i += 4 ;                                                         
            }                                                                
        }                                                                    
}                                                                            
                                                                             
- 注意 -                                                                     
このサンプルプログラムは、ＥＧＢのグラフィックオペレーションを使用しているた 
め通常より大きなスタックを必要とします。このプログラムで必要なスタックは     
スタックサイズ = グラフィックオペレーション用スタック＋プログラム動作用スタッ
ク                                                                           
　　　　　　　 = (512÷8×256) + 8192(プログラム構造により増減あり)          
　　　　　　　 = 16384 + 8192                                                
               = 24576                                                       
リンク時には必ず -stack 24576 以上を指定してください。                       
                                                                             
  2.2　関数一覧                                                              
                                                                             
┌───────────┬─────────────┐                       
│　　　関　数　名　　　│　　　機      　  能　　　│                       
├───────────┼─────────────┤                       
│SPR_init      　　　　│初期化　　　　　　　　　　│                       
├───────────┼─────────────┤                       
│SPR_display         　│画面の表示　　　　　　　　│                       
├───────────┼─────────────┤                       
│SPR_define          　│スプライトの定義　　　　　│                       
├───────────┼─────────────┤                       
│SPR_setPaletteBlock 　│パレットブロックの設定　　│                       
├───────────┼─────────────┤                       
│SPR_setPosition     　│位置の指定　　　　　　　　│                       
├───────────┼─────────────┤                       
│SPR_setAttribute    　│アトリビュートの設定　　　│                       
├───────────┼─────────────┤                       
│SPR_setMotion       　│移動量の指定　　　　　　　│                       
├───────────┼─────────────┤                       
│SPR_setOffset       　│オフセットの指定　　　　　│                       
├───────────┼─────────────┤                       
│SPR_readAttribute   　│アトリビュートの読み込み　│                       
└───────────┴─────────────┘                       
                                                                             
  2.3　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.SPR_define                                                                  
スプライトの定義                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int     SPR_define( n, nsprite, xsprite, ysprite, pattern );                 
int     n;              　　/*  0:16色、1:32K色          　　　   */         
int   　nsprite;        　　/*  先頭パターン番号　　　　　　　　　　　*/     
int     xsprite;        　　/*  横のスプライト数　　　　　　　　　　　*/     
int     ysprite;        　　/*  縦のスプライト数　　　　　　　　　　　*/     
char    *pattern        　　/*  パターンデータ格納先頭アドレス　　　　*/     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char    pattern[256*1024];                                                   
int     ret;                                                                 
ret = SPR_define( 0, 128, 3, 2, pattern );                                   
                    /*  16色で、横スプライト数3、縦スプライト数が2、         
                    　　番号128〜133番のスプライトを定義する　　　　　*/     
                                                                             
- 内容 -                                                                     
指定したスプライトに、パターンデータを登録します。                           
16色のスプライトでは、1パターン当たり128byte、32K色のスプライトでは、1パター 
ン当たり、512byte必要とします。32K色の場合は先頭パターン番号が4の倍数でないと
定義されません。                                                             
スプライトパターンの定義順番は、｢参考)｣の番号順に定義されます。              
                                                                             
- 参考 -                                                                     
      　 　16dot 　　　　　16dot 　　　　　16dot                             
　　　　┌───────┬───────┬───────┐                   
　16dot │　　　 0　　　│　　　 1　　　│　　　 2　　　│                   
　　　　├───────┼───────┼───────┤                   
　16dot │　　　 3　　　│　　　 4　　　│　　　 5　　　│                   
　　　　└───────┴───────┴───────┘                   
                                                                             
枠内に表記してある数字は、パターンデータの登録順です。また、この例の場合、横 
のスプライト数は3、縦のスプライト数は2となっています。                       
                                                                             
･先頭パターン番号                                                            
スプライトパターン登録の、先頭のパターン番号を示します。                     
                                                                             
･パターンデータ格納先頭アドレス                                              
　16色のとき、1スプライト(16dot×16dot)×4bit=128byte                        
　32K色のとき、1スプライト=(16dot×16dot)×1word=512byte                     
                                                                             
　16色のとき、1dot=4bit、32K色のとき、1dot=1word=16bitで色表現します。       
　色の設定の方法は、｢パレットブロックの設定｣を参照してください。             
                                                                             
パターンデータ                                                               
32K色中16色時(4bit pixel )                                                   
                                                                             
   7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┬─〜─┐                                   
│　│　│　│　│　│　│　│　│　　　│                                   
├─┴─┴─┴─┼─┴─┴─┴─┼─〜─┘                                   
│　奇数dot 　　│　偶数dot 　　│                                           
                                                                             
･4bitとも"0"がスルー表示。                                                   
･4bitで示される16段階が、カラーテーブルを経由して32K色に変換されて表示されま 
 す。                                                                        
                                                                             
32K色時 ( 16bit pixel )                                                      
                                                                             
　15　14　13　12　11　10　 9　 8　 7　 6　 5　 4　 3　 2　 1　 0             
┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─〜─┐   
│　│　│　│　│　│　│　│　│　│　│　│　│　│　│　│　│　　　│   
├─┼─┴─┴─┴─┴─┼─┴─┴─┴─┴─┼─┴─┴─┴─┴─┼───┘   
│↑│　 green bit　　　│　　red bit 　　　│　　blue bit　　　│           
スルーbit                                                                    
　0 : 通常表示                                                               
　1 : スルー表示                                                             
　･スルーbit は"1"がスルー表示。                                             
                                                                             
-----------------------------------------------------------------------------
.SPR_display                                                                 
画面の表示                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int     SPR_display( n, nsprite );                                           
int     n;                   /*   ＣＲＴ制御    　　　　　　　　*/           
int     nsprite;             /*   スプライトの個数(1〜1024) 　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = SPR_display( 1, 10 ); /*スプライト動作する、スプライト数10個*/         
                                                                             
- 内容 -                                                                     
スプライトの動作を開始します。                                               
リセット状態ではスプライトの動作はしていません。                             
スプライトの個数で示される数のスプライトが動作の対象となります。             
スプライトは1表示期間を基準として動作します。スプライトの転送が1表示期間中に 
終了しない場合、次の表示期間も残りのスプライトの転送を継続します。           
スプライトの個数は1〜1024です。0個の場合はエラーを返します。                 
                                                                             
n 　＝　0 :スプライト動作しない                                              
　  　  1 :スプライト動作する                                                
　  　  2 :スプライトREADYを待つ                                             
                                                                             
　　　　　　　　　　　　│　　　　　　　　　　　  　　　　　　　　│         
 　　←ｽﾌﾟﾗｲﾄ表示1期間→│←ｽﾌﾟﾗｲﾄ表示1期間──────────→ │         
　　　　　　　　　　　　│　 　　   │　　　　　　　　　　　　　　│         
　　　　　　　　　　　　│← 32μs→│←75μs/個────→│      │         
───────┐　　　　├─────┼──────────┤　　　├──     
　　　　　　　│　　　　│ｽﾌﾟﾗｲﾄ　  │ｽﾌﾟﾗｲﾄ　　　　　　　│　　　│         
　　　　　　　│　　　　│画面消去  │転送開始　　　　　　│　　　│         
───────◎────●─────┼──────────◎─　─●──     
　　　　　　　↑　　　　↑　　　　  │　　　　　　　　　　↑                 
　　　　　　　ｽﾌﾟﾗｲﾄ　　　VSYNC 終了　　　　　　　　　　ｽﾌﾟﾗｲﾄ               
　　　　　　　転送終了　　　　　　　　　　　　　　　　　転送終了             
　　　　　　 (スプライトREADY)　                       (スプライトREADY)     
                                                                             
-----------------------------------------------------------------------------
.SPR_init                                                                    
初期化                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int     SPR_init( void );                                                    
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = SPR_init();                                                            
                                                                             
- 内容 -                                                                     
ハードウェアを初期化します。                                                 
スプライト画面を色識別番号08000hで塗り潰します。これにより2画面合成を行ってい
る場合には、裏の画面が見えるようになります。この関数は、表示制御は行いませ   
ん。                                                                         
EGBで表示制御を行ってください。スプライト画面の上2ラインは画面消去用のデータ 
が入ります。従って、この2ラインのデータを設定すると、任意の色でスプライト画面
の背景を塗り潰す事ができます。                                               
                                                                             
図CL21R-049                                                                  
                                                                             
-----------------------------------------------------------------------------
.SPR_readAttribute                                                           
アトリビュートの読み込み                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int     SPR_readAttribute( nsprite, xsprite, ysprite, attribute );           
int     nsprite;        　　/*  先頭スプライト番号　            */           
int     xsprite;        　　/*  横のスプライト数　              */           
int     ysprite;        　　/*  縦のスプライト数　              */           
char    *attribute;     　　/*  アトリビュート格納先頭アドレス  */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int     ret;                                                                 
char    attribute[1000];                                                     
                                                                             
ret = SPR_readAttribute( 1018, 3, 2, attribute );                            
                                                                             
- 内容 -                                                                     
指定したスプライトのアトリビュートを読み込みます。                           
                                                                             
アトリビュートの形式                                                         
  ┌─┬───────────┐                                             
  │ 0│Ｗ│　　Ｘ座標　　　　│                                             
　├─┼───────────┤                                             
  │ 2│Ｗ│　　Ｙ座標　　　　│                                             
　├─┼───────────┤                                             
  │ 4│Ｗ│　　アトリビュート│                                             
　├─┼───────────┤                                             
  │ 6│Ｗ│　　色テーブル番号│                                             
　├─┼───────────┤                                             
　〜　〜　　　　　　　　　　　〜                                             
　└─┴───────────┘                                             
                                                                             
-----------------------------------------------------------------------------
.SPR_setAttribute                                                            
アトリビュートの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int    SPR_setAttribute( nsprite, xsprite, ysprite,                          
　　　　　　　　　　　　　　　　               attribute, color );           
int    nsprite;         /*  先頭スプライト番号　　　　　　　　　*/           
int    xsprite;         /*  横のスプライト数　　　　　　　　　  */           
int    ysprite;         /*  縦のスプライト数　　　　　　　　　  */           
int    attribute;       /*  アトリビュート(パターン番号は自動的              
　　　　　　　　　　　　　　　　　　　　　　にカウントされます)*/            
int    color;           /*  色テーブル番号　　　　　　　　　    */           
　　　　　　　　　　　　　　(｢パレットブロックの設定｣の先頭パ                
　　　　　　　　　　　　　　　レットブロックに相当します)                    
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = SPR_setAttribute( 1018, 3, 2, 0x2100, 256 );                           
                                                                             
- 内容 -                                                                     
指定したスプライトのアトリビュートを設定します。                             
                                                                             
■色テーブル番号                                                             
                                                                             
　15　14　13　12　11　10　 9　 8　 7　 6　 5　 4　 3　 2　 1　 0             
┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
│　│　│　│ 0│　│　│　│　│　│　│　│　│　│　│　│　│           
└┬┴┬┴┬┴─┴┬┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴┬┘           
　│　│　│　　　└─┬───────────────────┘             
　│　│　│　　　　　└─色テーブル番号　256〜511                           
　│　│　│　　　　　　　　　　　（その他は指定禁止）                       
　│　│　└───スプライト非表示フラグ                                     
　│　│　　　　　　　　　　0:表示                                           
　│　│　　　　　　　　　　1:非表示                                         
　│　└──スプライトスーパインポーズビット                                 
　│　　　　　　　　　0:通常表示                                             
　│　　　　　　　　　1:スーパーインポーズ                                   
　└─色テーブル参照                                                         
　　　　　　0:参照しない(32K色)                                              
　　　　　　1:参照　　　(16色)                                               
                                                                             
色テーブルを参照する場合は16色モードに、色テーブルを参照しない場合は　32K色モ
ードになります。                                                             
図CL21R-050                                                                  
                                                                             
-----------------------------------------------------------------------------
.SPR_setMotion                                                               
移動量の指定                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int    SPR_setMotion( nsprite, xsprtie, ysprite, xm, ym );                   
int    nsprite;         　　/*  先頭スプライト番号　　　　　　  */           
int    xsprite;         　　/*  横のスプライト数　  　　　　　  */           
int    ysprite;         　　/*  縦のスプライト数　  　　　　　  */           
int    xm;              　　/*  移動量(ドット単位)　　　　　  */             
int    ym;              　　/*  移動量(ドット単位)　　　　　  */             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = SPR_setMotion( 1018, 3, 2, 20, 15 );                                   
　　                    /*  1018番のスプライトを、Ｘ軸方向に20               
　　　　　　　　　　　　　　ドット、Ｙ軸方向に15ドット移動する  */           
                                                                             
- 内容 -                                                                     
指定したスプライトを、指定した移動量だけ移動します。                         
スプライト座標空間を越えた場合には、ラップラウンドして設定されます。         
                                                                             
図CL21R-051                                                                  
                                                                             
-----------------------------------------------------------------------------
.SPR_setOffset                                                               
オフセットの指定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int    SPR_setOffset( xm, ym  );                                             
int    xm;    　      　　　/*  移動量(ドット単位)　　　　　　*/             
int    ym;            　　　/*  移動量(ドット単位)　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = SPR_setOffset( 15, 20 );                                               
　　　　　　　　/*  オフセット参照のスプライトをすべて、Ｘ軸方向             
    　　　　　　　　に15ドット、Ｙ軸方向に20ドット移動する　　　*/           
                                                                             
- 内容 -                                                                     
オフセット参照のスプライトをすべて、指定した移動量だけ移動します。           
　　　　│                                                                   
　　　　└SPR_setAttributeを参照してください。                               
                                                                             
図CL21R-052                                                                  
                                                                             
-----------------------------------------------------------------------------
.SPR_setPaletteBlock                                                         
パレットブロックの設定                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int     SPR_setPaletteBlock( pblock, nblock, palette );                      
int     pblock;       　　/*  先頭パレットブロック(256〜511)                 
　　　　　　　　　　　　　　　(｢アトリビュート設定｣の色テーブ                
　　　　　　　　　　　　　　　　ル番号に相当します。)　　　　 */             
int     nblock;       　　/*  ブロック数　                     */            
char    *palette;     　　/*  パレットデータ格納先頭アドレス　 */            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char    data[256*1024];                                                      
int     ret;                                                                 
                                                                             
ret = SPR_setPaletteBlock( 256, 3, data );                                   
　　　　　　　　     /*  256番から3ブロック分の色の設定を行う */             
                                                                             
- 内容 -                                                                     
指定したパレットブロックに、カラーデータを登録します。                       
                                                                             
図CL21R-053                                                                  
                                                                             
-----------------------------------------------------------------------------
.SPR_setPosition                                                             
位置の指定                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SPR.H>                                                             
int    SPR_setPosition( ssize, nsprite, xsprite, ysprite,                    
                                              　      dot, ydot );           
int    ssize;       　　    /*  スプライトサイズ　      　　　　*/           
int    nsprite;     　　    /*  先頭スプライト番号      　　　　*/           
int    xsprite;     　　    /*  横のスプライト数　      　　　　*/           
int    ysprite;     　　    /*  縦のスプライト数　      　　　　*/           
int    xdot;        　　┌─/*　表示横位置(ドット単位)　　　　*/             
int    ydot;        　　├─/*　表示縦位置(ドット単位)　　　　*/             
　　　　　　　　　　　　└→座標は自動的にカウントされます                   
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = SPR_setPosition( 2, 1018, 3, 2, 100, 100 );                            
　　　/*  Ｘ等倍、Ｙ1/2倍で、1018番からのスプライトを                        
 　　　　　　　　　　　　　　　　　　　　　　　(100,100) に置く  */          
                                                                             
- 内容 -                                                                     
SPR_defineで定義したスプライトのうち、指定したスプライトを、指定した座標に置 
きます。                                                                     
スプライト座標空間を越えた場合には、ラップラウンドして設定されます。         
                                                                             
　　　　7　6　5　4　3　2　1　0                                               
　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                     
ssize:│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                     
　　　└─┴─┴─┴─┴─┴─┴┬┴┬┘                                     
　　　　　　　　　　　　　　　　│　└─0:Ｘ　等倍                           
　　　　　　　　　　　　　　　　│                                           
　　　　　　　　　　　　　　　　│　　　1:Ｘ　1/2倍                          
　　　　　　　　　　　　　　　　│                                           
　　　　　　　　　　　　　　　　└───0:Ｙ　等倍                           
                                                                             
　　　　　　　　　　　　　　　　　　　　1:Ｙ　1/2倍                          
                                                                             
　　　　　　　　┌─Ｘ  等倍 , Ｙ　等倍 :0 ─┐                              
　　　　　　　　│　Ｘ  等倍 , Ｙ　1/2倍 :2　│                              
 ssizeの指定は、│　Ｘ  1/2倍 ,Ｙ　等倍 :1 　│　となります。                
　　　　　　　　└─Ｘ  1/2倍 ,Ｙ　1/2倍 :3─┘                              
                                                                             
*****************************************************************************
第4章　フォントライブラリ                                                    
*****************************************************************************
                                                                             
 1.　フォントライブラリ                                                      
                                                                             
本章ではフォントライブラリについて解説しています。                           
                                                                             
  1.1　関数一覧                                                              
                                                                             
┌──────────┬─────────────────┐                 
│　　　関　数　名　　│　　　　　機        　能　　　　　│                 
├──────────┼─────────────────┤                 
│FNT_ankAddr 　　　　│ANKフォントの読み出し　　　　　　 │                 
├──────────┼─────────────────┤                 
│FNT_ankRead 　　　　│ANKフォントのコピー　　　　　　　 │                 
├──────────┼─────────────────┤                 
│FNT_kanjiAddr     　│漢字フォントの読み出し 　　　　　 │                 
├──────────┼─────────────────┤                 
│FNT_kanjiRead 　　　│漢字フォントのコピー 　　　　　　 │                 
├──────────┼─────────────────┤                 
│FNT_sjisToJis 　　　│sjisからJISへの変換　　　  　  　 │                 
├──────────┼─────────────────┤                 
│FNT_jisToSjis 　　　│JISからsjisへの変換　　　  　  　 │                 
└──────────┴─────────────────┘                 
                                                                             
  1.2　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.FNT_ankAddr                                                                 
ANKフォントの読み出し                                                        
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FNT.H>                                                             
int    FNT_ankAddr( sizeX, sizeY, ank, seg, off );                           
int    sizeX;           　　/*  横ドット数 (8)        　　　　　*/           
int    sizeY;           　　/*  縦ドット数(8 or 16)  　　　　　*/            
int    ank;             　　/*  ANKフォント番号　    　　　　 　*/           
int    *seg;　　　      　  /*  フォントデータのセレクタ  　　  */           
int    *off;            　  /*  フォントデータのアドレス  　　  */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    seg;                                                                  
int    off;                                                                  
int    ret;                                                                  
ret = FNT_ankAddr( 8, 16, 100, &seg, &off );                                 
                                                                             
- 内容 -                                                                     
ANKフォントのアドレスを返します。                                            
ANKのサイズは、横8ドット、縦8または16ドットです。                            
                                                                             
-----------------------------------------------------------------------------
.FNT_ankRead                                                                 
ANKフォントのコピー                                                          
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FNT.H>                                                             
int     FNT_ankRead( sizeX, sizeY, ank, seg, off );                          
int     sizeX;          /*  横ドット数 (8)      　　　　　  　　*/           
int     sizeY;          /*  縦ドット数 (8 or 16)　　　　　  　　*/           
int     ank;            /*  ANKフォント番号　  　　　　　  　　 */           
int     seg;            /*  フォントデータ格納領域のセレクタ　　*/           
char    *off;         　/*  フォントデータ格納領域のアドレス  　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int     seg = getds();                                                       
char    off[16];                                                             
int     ret;                                                                 
                                                                             
ret = FNT_ankRead( 8, 16, 100, seg, off );                                   
                                                                             
- 内容 -                                                                     
ANKフォントのデータを返します。                                              
ANKのサイズは、横8ドット、縦8または16ドットです。                            
                                                                             
　　フォントパターン　　　　　　　　　　　　パターン領域  　                 
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　                 
　　7　　　　　　  0　　　　　　　　　　　　　　　　　n 　　                 
　┌────────┐　　　　　　　　　　　　　　┌──┐　                 
 0│　　　　　　　　│　　　　　　　　　  off[ 0] │0x00│　                 
 1│　　　■■　　　│　　　　　　　　　  off[ 1] │0x18│　                 
 2│　　■　　■　　│　　　　　　　　　  off[ 2] │0x24│　                 
 3│　■　　　　■　│　　　　　　　　　  off[ 3] │0x42│　                 
 4│　■　　　　■　│　　　　　　　　　  off[ 4] │0x42│　                 
 5│　■　　　　■　│　　　　　　　　　  off[ 5] │0x42│　                 
 6│　■　　　　■　│　　　　　　　　　  off[ 6] │0x42│　                 
 7│　■　　　　■　│　　　　　　　　　  off[ 7] │0x42│　                 
 8│　■■■■■■　│　　　　　　　　　  off[ 8] │0x7e│　                 
 9│　■　　　　■　│　　　　　　　　　  off[ 9] │0x42│　                 
10│　■　　　　■　│　　　　　　　　　  off[10] │0x42│　                 
11│　■　　　　■　│　　　　　　　　　  off[11] │0x42│　                 
12│　■　　　　■　│　　　　　　　　　  off[12] │0x42│　                 
13│　■　　　　■　│　　　　　　　　　  off[13] │0x42│　                 
14│　　　　　　　　│　　　　　　　　　  off[14] │0x00│　                 
15│　　　　　　　　│　　　　　　　　　  off[15] │0x00│　                 
　└────────┘　　　　　　　　　　　　　　└──┘　                 
( パターンサイズ8×16の場合:パターン格納領域サイズ16byte)                    
                                                                             
-----------------------------------------------------------------------------
.FNT_jisToSjis                                                               
JISからsjisへの変換                                                          
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FNT.H>                                                             
int    FNT_jisToSjis( code );                                                
int    code;            　　　　　/*  JISコード　　　          */            
                                                                             
- 戻り値 -                                                                   
sjisコードを返します。                                                       
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = FNT_jisToSjis(0x3026);  　　/*  '愛'のJISコード変換      */            
                                                                             
- 内容 -                                                                     
JISコードをsjisコードに変換して返します。                                    
                                                                             
-----------------------------------------------------------------------------
.FNT_kanjiAddr                                                               
漢字フォントの読み出し                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FNT.H>                                                             
int    FNT_kanjiAddr( sizeX, sizeY, kanji, seg, off );                       
int    sizeX;           　　/*  横ドット数(16)　      　　　　  */           
int    sizeY;           　　/*  縦ドット数(16)        　　　　  */           
int    kanji;           　　/*  漢字フォント(JIS)番号　　 　　  */           
int    *seg;　            　/*  フォントデータのセレクタ  　　  */           
int    *off;　            　/*  フォントデータのアドレス  　　  */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int    seg;                                                                  
int    off;                                                                  
int    ret;                                                                  
                                                                             
ret = FNT_kanjiAddr( 16, 16, 0x3026, &seg, &off );                           
                                                                             
- 内容 -                                                                     
漢字フォントのアドレスを返します。                                           
漢字のサイズは、横16ドット、縦16ドットです。                                 
                                                                             
-----------------------------------------------------------------------------
.FNT_kanjiRead                                                               
漢字フォントのコピー                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FNT.H>                                                             
int     FNT_kanjiRead( sizeX, sizeY, kanji, seg, off );                      
int     sizeX;          /*  横ドット数(16)        　　　　　　  */           
int     sizeY;          /*  縦ドット数(16)        　　　　　　  */           
int     kanji;          /*  漢字フォント(JIS)番号　　　　　　 　*/           
int     seg;            /*  フォントデータ格納領域のセレクタ　　*/           
char    *off;       　　/*  フォントデータ格納領域のアドレス  　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int seg = getds();                                                           
char    off[32];                                                             
int     ret;                                                                 
                                                                             
ret = FNT_kanjiRead( 16, 16, 0x3026, seg, off );                             
                                                                             
- 内容 -                                                                     
漢字フォントのデータを返します。                                             
漢字のサイズは、横16ドット、縦16ドットです。                                 
                                                                             
          フォントパターン　　　　                パターン領域　　　         
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　         
 　 15 　　　　　  8 7　　　　 　  0　  　　　　　　　　   n 　n+1 　　      
　┌────────────────┐　　　　　　　　┌──┬──┐         
 0│　　　　　　　■　　　　　　　　│　　　  off[ 0] │0x01│0x00│         
 1│■■■■■■■■■■■■■■■　│　　　  off[ 2] │0xff│0xfe│         
 2│■　　　　　　　　　　　　　■　│　　　  off[ 4] │0x80│0x02│         
 3│■　■■■■■■■■■■■　■　│　　　  off[ 6] │0xbf│0xfa│         
 4│　　　　　　　　　　　　　　　　│　　　  off[ 8] │0x00│0x00│         
 5│　　　■■■■■■■■■　　　　│　　　  off[10] │0x1f│0xf0│         
 6│　　　■　　　　　　　■　　　　│　　　  off[12] │0x10│0x10│         
 7│　　　■■■■■■■■■　　　　│　　　  off[14] │0x1f│0xf0│         
 8│　　　　　　　　　　　　　　　　│　　　  off[16] │0x00│0x00│         
 9│　■■■■■■■■■■■■■　　│　　　  off[18] │0x3f│0xfc│         
10│　■　　　　　■　　　　　■　　│　　　  off[20] │0x41│0x04│         
11│　■　　　　　■　　　　　■　　│　　　  off[22] │0x41│0x04│         
12│　■■■■■■■■■■■■■　　│　　　  off[24] │0x3f│0xfc│         
13│　■　　　　　■　　　　　■　　│　　　  off[26] │0x41│0x04│         
14│　■　　　　　■　　　　　■　　│　　　  off[28] │0x41│0x04│         
15│　■■■■■■■■■■■■■　　│　　    off[30] │0x3f│0xfc│         
　└────────────────┘　　　　　　　　└──┴──┘         
                                                                             
　　　( パターンサイズ16×16の場合:パターン格納領域サイズ32byte)             
                                                                             
-----------------------------------------------------------------------------
.FNT_sjisToJis                                                               
sjisからJISへの変換                                                          
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FNT.H>                                                             
int    FNT_sjisToJis( code );                                                
int    code;                　　　/*  sjisコード　　            */           
                                                                             
- 戻り値 -                                                                   
JISコードを返します。                                                        
                                                                             
- 例 -                                                                       
int    ret;                                                                  
                                                                             
ret = FNT_sjisToJis(0x88a4);    　/*  '愛'のsjisコード変換  　  */           
                                                                             
- 内容 -                                                                     
sjisコードをJISコードに変換して返します。                                    
                                                                             
*****************************************************************************
第5章　ＦＭ　Ｃ関数ライブラリ                                                
*****************************************************************************
                                                                             
 1.　ＦＭ　Ｃ関数について                                                    
                                                                             
  1.1　アドレスのセット方法について                                          
                                                                             
　アドレスのセットについては、以下の2つのルーチンが用意されています。        
                                                                             
　これらのルーチンをコールする時はアドレスセット用のバッファを4バイト準備して
ください。以下のように、アドレスがセットされます。                           
                                                                             
ddadr →┌─┬─┬──────────┐　　　                               
      　│ R│ D│オフセット　　　　　│　　　                               
　　　　└─┴─┴──────────┘　　　                               
　　　　　　　　　　　　　　　　　　　　　　　                               
┌────────────┬────────┐                               
│データのアドレスセット　│BSETDATAADR 　　│                               
├────────────┼────────┤                               
│コードのアドレスセット　│BSETCODEADR 　　│                               
└────────────┴────────┘                               
                                                                             
- 注意 -                                                                     
アセンブラで記述した割り込み処理ルーチンのアドレスをセットするときは、Ｃルー 
チンのメモリモデルと同じ記述方法でなければなりません。                       
使用上の注意                                                                 
  本ライブラリは、forRBIOS(Native modeからReal mode BIOSを使用可能にするｲﾝﾀﾌｪ
ｰｽ)を使用して動作するライブラリです。forRBIOSが常駐していない場合は、完全な動
作をしません。                                                               
                                                                             
〔使用例〕                                                                   
-----------------------------------------------------------------------------
.BSETCODEADR                                                                 
コードのアドレスセット                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void   BSETCODEADR( ddadr, func );                                           
char   *ddadr;        　　　 /*   セットすべき場所 (4byte)      */           
int    (*(func))();   　　　 /*   セットすべきルーチン          */           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 注意 -                                                                     
関数のポインタの表し方は、｢High C(R) Compiler V1.7 ユーザーズマニュアル｣を   
参考にしてください。                                                         
                                                                             
- 例 -                                                                       
int    func();                                                               
char   ddadr[4];                                                             
                                                                             
.BSETCODEADR( ddadr, func );                                                 
                                                                             
- 内容 -                                                                     
指定されたルーチンのオフセットアドレスを設定します。                         
                                                                             
〔使用例〕                                                                   
-----------------------------------------------------------------------------
.BSETDATAADR                                                                 
データのアドレスセット                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　  BSETDATAADR( ddadr, data );                                          
char    *ddadr;         　　/*  セットすべき場所 (4byte)　　　  */           
char    *data;          　　/*  セットすべきデータのアドレス　　*/           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
char    data;                                                                
char    ddadr[4];                                                            
                                                                             
BSETDATAADR( ddadr, &data );                                                 
                                                                             
- 内容 -                                                                     
指定されたデータのオフセットアドレスを設定します。                           
                                                                             
  1.2　構造体の説明                                                          
                                                                             
これらの構造体は、全て｢FMCFRB.H｣に含まれています。                           
                                                                             
構造体一覧                                                                   
                                                                             
1. typedef struct _VDB_ATR {                                                 
        unsigned char   charatr;        /*  文字属性                       */
        unsigned char   dispatr;        /*  表示属性                    　 */
        unsigned short int  color;      /*  最大色識別番号、又は色識別番号 */
　  } VDB_ATR;                                                               
                                                                             
2. typedef struct _DKB_SEC {                                                 
        unsigned char   trakno; 　　　　/*　トラック番号　　　　　　　　　 */
        unsigned char   hedno;  　　　　/*  ヘッド番号  　　　　　　　　　 */
        unsigned char   secno;  　　　　/*  セクタ番号  　　　　　　　　　 */
        unsigned char   seccnt; 　　　　/*　セクタ長    　　　　　　　　　 */
        unsigned char   crc1;                                                
        unsigned char   crc2;                                                
　　} DKB_SEC;                                                               
                                                                             
3. typedef struct _DKB_PARA {                                                
        unsigned char   comcode;        /*  コマンドコード                 */
        unsigned char   compara[9];     /*  コマンドパラメータ             */
        unsigned long   transadr;       /*  データ番号アドレス             */
 　     unsigned short  transadr_seg;   /*  データ番号セグメント           */
        unsigned long   statusadr;      /*  リザルトステータスアドレス     */
 　　   unsigned short  statusadr_seg;  /*　リザルトステータスセグメント   */
　　} DKB_PARA;                                                              
                                                                             
4. typedef struct _TIM_CALEN {                                               
　      short int       year;           /*  年　(1980-2079) 　　　　　　   */
　      char            month;          /*　月　(1-12)      　　　　　　   */
　      char            day;            /*　日　(1-31)      　　　　　　   */
　      char            what_day;       /*  曜日(0- 6)                     */
　      char            hour;           /*　時　(0-23)      　　　　　　   */
　      char            minute;         /*　分　(0-59)      　　　　　　   */
　      char            sec;            /*　秒　(0-59)      　　　　　　   */
　      char            msec;           /*  1/100秒(0-99)                  */
        char            ext;            /*　0               　　　　　　   */
　　} TIM_CALEN;                                                             
                                                                             
5. typedef struct _TIM_TIME {                                                
        unsigned char   　  mode;       /*  タイマー割り込みモード         */
        unsigned char       inf;        /*  0                              */
        unsigned long       adr;        /*  タイマー割り込み処理アドレス   */
　　　　unsigned short  　  adr_seg;    /*  タイマー割り込み処理セグメント */
        unsigned short int  hcycle;     /*  タイマー周期(HIGH)             */
        unsigned short int  lcycle;     /*  タイマー周期(LOW)              */
　　} TIM_TIME;                                                              
                                                                             
6. typedef struct _TIM_CLOCK {                                               
        unsigned char   flg;            /*  設定フラグ                  　*/ 
        unsigned char   ext1;           /*  0                           　*/ 
        unsigned long   adr;            /*  時計管理割り込み処理アドレス　*/ 
        unsigned short  adr_seg;        /*  時計管理割り込み処理セグメント*/ 
        short int       cycle;          /*  割り込み周期                　*/ 
        short int       ext2;                                                
        short int       year;           /*  年　(1980-2079) 　　　　　　　*/ 
        char            month;          /*　月　(1-12)      　　　　　　　*/ 
        char            day;            /*　日　(1-31)      　　　　　　　*/ 
        char            what_day;       /*  曜日(0-6)                     */ 
        char            hour;           /*　時　(0-23)      　　　　　　　*/ 
        char            minute;         /*　分　(0-59)      　　　　　　　*/ 
        char            sec;            /*　秒　(0-59)      　　　　　　　*/ 
　　} TIM_CLOCK;                                                             
                                                                             
7. typedef struct _RSB_PARA {                                                
        unsigned char   　　mode;       　 /*   通信モード            　　*/ 
        unsigned char   　　baud;       　 /*   ボーレート　          　　*/ 
        unsigned long   　　rbuf;       　 /*   受信バッファアドレス  　　*/ 
        unsigned short  　　rbuf_seg;  　  /*   受信バッファセグメント　  */ 
        unsigned short int　stime;      　 /*   送信タイムアウト    　　　*/ 
        unsigned short int　rtime;      　 /*   受信タイムアウト    　　　*/ 
        unsigned long   　　rinfbuf;       /*   受信通知アドレス    　　　*/ 
　　　　unsigned short  　　rinfbuf_seg;   /*   受信通知セグメント　      */ 
        unsigned char   　　extmode;    　 /*   拡張モード            　　*/ 
        unsigned char   　　xon;        　 /*   XONコード            　   */ 
        unsigned char   　　xoff;       　 /*   XOFFコード            　　*/ 
　　　　unsigned long   　　obuf;       　 /*   送信バッファアドレス　　　*/ 
　　　　unsigned short  　　obuf_seg;  　  /*  送信バッファセグメント　　 */ 
　　} RSB_PARA;                                                              
                                                                             
8. typedef struct _RSB_INT {                                                 
        unsigned char   flg;             /*  割り込みフラグ　             */ 
        unsigned long   cs_adr;          /*  CS信号割り込みアドレス       */ 
　　　　unsigned short  cs_adr_seg;      /*  CS信号割り込みセグメント     */ 
        unsigned long   ci_adr;          /*  CI信号割り込みアドレス       */ 
　　　　unsigned short  ci_adr_seg;      /*  CI信号割り込みセグメント     */ 
　　} RSB_INT;                                                               
                                                                             
 2.　サンプルプログラム                                                      
                                                                             
┌────────────────────────────────────┐ 
│  ＦＭ  Ｃ関数ライブラリサンプルブログラム1　　　　　　　　　　　　　　 │ 
│  　- 機能 -　マトリクス入力により、どのキーが押されたかを表示します。  │ 
└────────────────────────────────────┘ 
                                                                             
#include <stdio.h>                                                           
#include <stdlib.h>                                                          
#include <string.h>                                                          
#include <fmcfrb.h>                                                          
                                                                             
static char *keytable[] = {                                                  
"","esc","1","2","3","4","5","6",       　　　　　　　　　　　　/* 00〜07 */ 
"7","8","9","0","-","＾","\\","後退",    　　　　　　　　       /* 08〜0F */ 
"ﾀﾌﾞ","Q","W","E","R","T","Y","U",        　　　　　　　　　    /* 10〜17 */ 
"I","O","P","","[","ﾘﾀｰﾝ ","A","S",       　　　　　　　　　　　/* 18〜1F */ 
"D","F","G","H","J","K","L",";",          　　　　　　　　　　　/* 20〜27 */ 
":","]","Z","X","C","V","B","N",          　　　　　　　　　　　/* 28〜2F */ 
"M",",",".","/","｀","ｽﾍﾟｰｽ","T*","T/",  　　　　　　　　       /* 30〜37 */ 
"T+","T-","T7","T8","T9","T=","T4","T5",  　　　　　　　　　    /* 38〜3F */ 
"T6","","T1","T2","T3","Tﾘﾀｰﾝ","T0","T.",　　　　　　　　       /* 40〜47 */ 
"挿入","","T000","削除","","↑","HOME",  "←",　　　　　        /* 48〜4F */ 
"↓","→","CTRL","SHIFT","","","","無変換",　　　      　       /* 50〜57 */ 
"変換","かな漢字","","PF12","","PF1","PF2","PF3",   　　　      /* 58〜5F */ 
"PF4","PF5","PF6","PF7","PF8","PF9","PF10","シフト左",　　　　　/* 60〜67 */ 
"シフト右","PF11","英大","漢字辞書","単語抹消","単語登録","前行","英小",     
      　　　　　　　　　　　　　　　　　　　　　　　　　　      /* 68〜6F */ 
"次行","半全角","取消","実行","PF13","PF14","PF15","PF16 ",     /* 70〜77 */ 
"PF17","PF18","PF19","PF20","BREAK","COPY","",""            　  /* 78〜7F */ 
};                                                                           
                                                                             
void main()                                                                  
{                                                                            
    static char     matrix[16];                                              
    static char     matrixa[16];                                             
    int             i;                                                       
    int             bit;                                                     
  　printf("何かキーを押してください。押されたキーを表示します。\n");        
  　printf("ESCキーを押すと終了します。\n");                                 
    memset(matrixa, 0, 16);                                                  
    do{                                                                      
        KYB_matrix(matrix);                                                  
        for (i = 0 ; i < 16 ; i++ ){                                         
            matrixa[i] ＾= matrix[i];                                        
            for (bit = 0 ; bit < 8 ; bit++){                                 
                if (matrixa[i] & (0x01 << bit)){                             
                    if (matrix[i] & (0x01 << bit)){                          
                        printf(" %s が押された\n",keytable[i*8 + bit]);      
                    }else{                                                   
                        printf(" %s が離された\n",keytable[i*8 + bit]);      
                    }                                                        
                }                                                            
            }                                                                
            matrixa[i] = matrix[i];                                          
        }                                                                    
    } while((matrix[0] & 0x02) == 0);  /* エスケープキーが押されたら終わり*/ 
    KYB_clrbuf();                                                            
}                                                                            
                                                                             
┌────────────────────────────────────┐ 
│　ＦＭ　Ｃ関数ライブラリサンプルプログラム2　 　　　　　　　　　　　　　│ 
│　　- 機能 -　　タイマー割り込みによりEGBを使用したグラフィックを出力   │ 
└────────────────────────────────────┘ 
                                                                             
#include    "dos.h"                                                          
#include    "egb.h"                                                          
#include    "fmcfrb.h"                                                       
                                                                             
char    work1[1536];  　　　　  /* main()関数用 EGBデータ領域        */      
char    para1[64];                                                           
char    work2[1536];  　　　　  /* 割り込みハンドラ用 EGBデータ領域  */      
char    para2[64];                                                           
int     color=0;                                                             
unsigned char   handler_stack[80*1024]; /*割り込みハンドラ用 stack領域     */
unsigned long   u_stack_off;      　　  /*割り込みハンドラ用 stack offset  */
unsigned int    u_stack_sel;      　　  /*割り込みハンドラ用 stack selector*/
                                                                             
void    timer_handler2()                                                     
 {                                                                           
        EGB_color(work2,2,color);                                            
        WORD(para2+0)=340;                                                   
        WORD(para2+2)=300;                                                   
        WORD(para2+4)=540;                                                   
        WORD(para2+6)=420;                                                   
        EGB_rectangle(work2,para2);                                          
}                                                                            
                                                                             
void    timer_handler()                                                      
 {                                                                           
       FRB_change_stack(u_stack_off,u_stack_sel,(int (*)())timer_handler2,0);
}                                                                            
                                                                             
int     main()                                                               
 {     int     i,timeno;                                                     
unsigned int    encode;                                                      
TIM_TIME    　  timer;                                                       
struct _SREGS 　sregs;                                                       
                                                                             
        _segread(&sregs);                                                    
        u_stack_sel = sregs.ds;                                              
        u_stack_off = (unsigned long)&handler_stack[sizeof(handler_stack)];  
                                                                             
        EGB_init(work1,sizeof(work1));                                       
        EGB_displayPage(work1,0,1);                                          
        EGB_color(work1,0,13);                                               
        EGB_color(work1,2,11);                                               
        EGB_writeMode(work1,0);                                              
        EGB_paintMode(work1,0x22);                                           
        EGB_init(work2,sizeof(work2));                                       
        EGB_displayPage(work2,0,1);                                          
        EGB_color(work2,0,13);                                               
        EGB_color(work2,2,11);                                               
        EGB_writeMode(work2,0);                                              
        EGB_paintMode(work2,0x22);                                           
                                                                             
        timer.mode = 0 ;                /*　タイマー割り込みモード       */  
        timer.inf = 0 ;                 /*　0                            */  
        timer.hcycle = 0 ;              /*　タイマー周期(HIGH)           */  
        timer.lcycle = 100 ;            /*　タイマー周期(LOW) 1秒後      */  
        BSETCODEADR((char *)&timer.adr,(int (*)())timer_handler);            
                              　        /*　タイマー割り込み処理アドレス */  
        TIM_settime(&timer,&timeno);                                         
        for(; KYB_read(1,&encode) != 0x1b;)                                  
       {   for(i=1;i<16;i++)                                                 
           {   color=i;                                                      
                EGB_color(work1,2,color);                                    
                WORD(para1+0)=100;                                           
                WORD(para1+2)=60;                                            
                WORD(para1+4)=300;                                           
                WORD(para1+6)=180;                                           
                EGB_rectangle(work1,para1);                                  
          　}                                                                
        }                                                                    
        TIM_clrtime(timeno);                                                 
return(0);                                                                   
}                                                                            
                                                                             
 3.　ｆｏｒＲＢＩＯＳインターフェース                                        
                                                                             
  3.1　forRBIOSについて                                                      
                                                                             
  従来のシステムでは、ネイティブモードのアプリケーションからリアルBIOS(リアル
モードで動作するFMRシリーズと互換のBIOS)を利用する場合、バッファなどのアドレ 
スをインターフェースとする機能に限っては直接利用できず、リアルモードとネイテ 
ィブモードとの間で、共有バッファ(LOWメモリに確保される)を用いて、インターフェ
ースをとる必要がありました。  しかし、SIDEWORK等により起動されるプログラム   
は、原則としてHighメモリに展開されるため、共有バッファを持てません。  V2.1シ 
ステムでは、リアルBIOSの呼び出し機能をforRBIOSによりサポートしています。     
　この機能により、アプリケーションは自身でリアルコードを含まずに、ネイティブ 
モードからネイティブモードのバッファを指定して、リアルBIOSを利用することが可 
能です。　ただし、forRBIOSの使用にあたっては、クライアント宣言等の処理が必要 
です。                                                                       
                                                                             
  　　　　┌─────┬─────┬────┬────┬─────           
　　　　　│キーボード│コンソール│ディスク│プリンタ│････　               
　　　　　└─────┴─────┴────┴────┴─────           
┌────┐　　　　　┌───────────────┐　　　　　           
│ LOWﾒﾓﾘ │　　　　　│　　　　リアルＢＩＯＳ　　　　│　　　　　           
└────┘　　　　　└───────────────┘　　　　　           
　　　　　　　　　　　　　　　↑　　　　　　↓　　　　　　　　　　           
　　　　　　　　　　　　　　　↑ 2　　　　　↓ 3　　　　　　　　　           
　　┌─────────────────────────────────┐　 
　　│　　　　　　　　　　　　　　ＣＯＣＯ　　　　　　　　　　　　　　　│　 
　─┼─────────────────────────────────┼─ 
　　│　　　　　　　　　　　　ｆｏｒＲＢＩＯＳ　　　　　　　　　　　　　│　 
　　└─────────────────────────────────┘　 
┌────┐　　　　　　　　　↑ 1　　　　　↓ 4　　　                       
│HIGHﾒﾓﾘ │　　　　　　　　　↑　　　　　　↓　　　　                       
└────┘　　　　　　┌─────────────┐                       
　　　　　　　　　　　　│　ユーザアプリケーション　│                       
　　　　　　　　　　　　└─────────────┘                       
                                                                             
  3.2　forRBIOSインターフェース概要                                          
                                                                             
  本ライブラリは、forRBIOS(Native modeからReal mode BIOSを使用可能にするｲﾝﾀｰﾌ
ｪｰｽ)を使用して動作するライブラリです。forRBIOSが常駐していない場合は、完全な 
動作をしないので注意してください。                                           
本ライブラリは、必要に応じて、ライブラリ内部でforRBIOS本体に対して、処理の開 
始･終了等を要求するファンクションを発行しています。そのため、ユーザはforRBIOS
のクライアント処理をする必要はありません。また、他のアプリケーションの動作環 
境を破壊することもありません。                                               
  しかし、アプリケーション作成時に本ライブラリ以外でforRBIOS本体に処理を要求 
したい場合は、FRB_xxxxを使用してforRBIOS本体に処理等を要求するファンクション 
を発行することができます。                                                   
  forRBIOSでは、その使用に先立って、forRBIOS本体に、アプリケーションプログラ 
ムのコードセレクタを登録(クライアント宣言)しなければなりません。forRBIOS本体 
にクライアント宣言が受付られると、forRBIOSはそのアプリケーションに対してサー 
ビスを開始します。アプリケーション中のforRBIOSに処理を要求する場所の前で、ク 
ライアント宣言(登録)を行ってください。また、アプリケーション終了時までには、 
クライアント宣言(解除)を行ってください。                                     
  ただし、このとき次の事項に下記の事項に十分注意してください。               
  forRBIOS本体は、クライアント宣言(登録/解除)をアプリケーションのセレクタで管
理しています。そのため、あるアプリケーションが自己の動作環境のみを考えて、自 
己のコードセレクタの登録→解除という処理のみを行うと、たまたまそのアプリケー 
ションと同一のコードセレクタをもち、かつforRBIOS本体に処理を要求していた他の 
アプリケーションの動作環境も一緒に解除してしまう可能性があります。           
　クライアント処理で他のアプリケーションの動作環境を破壊しないために、クライ 
アントの登 録状況の取得等の関数を使用し、自アプリケーションの動作終了後は必ず
元の動作環境に戻してください。                                               
                                                                             
  3.3　forRBIOSによる割り込み処理                                            
                                                                             
　forRBIOSでは、キーボード割り込み、タイマー割り込み、RS-232C割り込み等の割り
込みハンドラを使用することができます。(詳細は後述)                           
　しかしながら、多少の注意があります。                                       
                                                                             
　割り込みハンドラ内では、割り込みの禁止や許可を行ってはなりません。         
　アセンブリ言語によって、CLI, STI命令の発行や、C言語で                      
          #define     CLI     _inline(OxFA);                                 
　　　　　#define     STI     _inline(OxFB);                                 
等のように定義しこれを発行してはいけません。                                 
                                                                             
  割り込みハンドラ内では、TownsのハードウェアであるPIC(割り込みコントローラ) 
を操作してはいけません。                                                     
  割り込みハンドラは、全体的に見た処理の低下を招く危険性がありますので、極力 
ユーザプログラム内部のフラグを操作する程度の軽い処理にしてください。  複雑な 
処理を割り込みハンドラ内で行った場合、例えばマウスの移動が遅いとかRS-232C で 
の受信データが抜けてしまう等といったことが発生するかもしれません。           
  割り込みハンドラを使用する場合、割り込み処理用のstackについて考える必要があ
ります。stackは、関数へのパラメータ、関数の呼び出し、関数内のauto変数等、気付
かないところで使用されています。一般に、割り込みハンドラは自身でstackを確保し
、割り込み処理を行う場合、自身のstackへstack changeを行います。  これは、シス
テム全体のなかで各割り込みハンドラがどれだけのstackを使用するのか予測がつかな
いからです。FMC関数ライブラリでは、このstack changeを行う為のFRB_change_stack
() 関数を用意しています。例文や関数仕様書を参照してください。                
                                                                             
  3.4　関数一覧                                                              
                                                                             
┌──────────┬─────────────────────┐         
│　　関　数　名　　　│　　　　　　機        　能　　　　　　　　│         
├──────────┼─────────────────────┤         
│FRB_getstatus 　　　│forRBIOSインストール状態の取得　　　　　　│         
├──────────┼─────────────────────┤         
│FRB_setclient 　　　│forRBIOSクライアント宣言（登録）　　　　　│         
├──────────┼─────────────────────┤         
│FRB_resetclient 　　│forRBIOSクライアント宣言（解除）　　　　　│         
├──────────┼─────────────────────┤         
│FRB_clrclient 　　　│forRBIOSクライアント宣言（全解除）　　　　│         
├──────────┼─────────────────────┤         
│FRB_getclient 　　　│forRBIOSクライアントメンバ取得　　　　　　│         
├──────────┼─────────────────────┤         
│FRB_popclient 　　　│forRBIOS全クライアントメンバ一括登録　　　│         
├──────────┼─────────────────────┤         
│　　　　　　　　　　│ユーザ指定stack領域にstackをchangeさせ、　│         
│FRB_change_stack 　 │　　　　　　　　　　　　　　　　　　　　  │         
│　　　　　　　　　　│指定関数を起動　　　　　　　　　　　　　　│         
└──────────┴─────────────────────┘         
                                                                             
  3.5　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.FRB_change_stack                                                            
ユーザ指定stack領域にstackをchangeさせ、指定関数を起動                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int     FRB_change_stack(u_stack_off,u_stack_sel,u_func,u_param_cnt,         
                u_params);                                                   
                                                                             
unsigned long   u_stack_off;    /* 新stack領域 offset address    */          
unsigned int    u_stack_sel;    /* 新stack領域 selector address  */          
int             (*())u_func;    /* stack change後、呼び出す関数  */          
int             u_param_cnt;    /* u_func() へのパラメータ数     */          
(自由型)        u_params;       /* u_func() へのパラメータ       */          
                                                                             
- 戻り値 -                                                                   
u_func() の戻り値                                                            
                                                                             
- 例 -                                                                       
#include <FMCFRB.H>                                                          
#include <DOS.H>                                                             
#include <stdio.h>                                                           
unsigned char   u_stack[4*1024];      /* stack領域               */          
int     u_func(unsigned int *rc_s,int value)                                 
{      *rc_s = value*3;                                                      
return(value*2);                                                             
}                                                                            
int     main()                                                               
{struct_SREGS sregs;                                                         
        int     rc;                                                          
unsigned int    rc_s;                                                        
        _segread(&sregs);                                                    
        rc = FRB_change_stack((unsigned long)&u_stack[sizeof(u_stack)],      
                sregs.ds,u_func,2,&rc_s,5);                                  
        printf("rc = %d, rc_s = %d\n",rc,rc_s);                              
return(0);                                                                   
}                                                                            
                                                                             
- 内容 -                                                                     
u_func()へのパラメータは、printf()関数のように自由な型が可能です。           
但し､ u_param_cntによってパラメータ数を指定しなければなりません。            
関数へのパラメータは､ stack上に格納されますが､ FRB_change_stack()関数は、    
stackをchangeする機能をもったものなので、stackをchangeした後に、改めて       
u_func()へパラメータをstack上に格納しなければなりません。従ってu_param_cntに 
よってパラメータ数を指定する必要があるのです。                               
実際には､ u_param_cntで指定するパラメータ数は､ stack上のDWORD(4byte)の数を指 
定してください｡ char, char *, char_far *,等、型には様々ありますので、High Cの
言語仕様を御確認ください。                                                   
u_func()では、SS, ESP, EBPレジスタを破壊してはなりません。                   
一般的に、C言語によってu_func()関数を作成した場合､ SS, ESP, EBPは破壊されない
ようです。                                                                   
                                                                             
FRB_change_stack()関数を呼び出した時のEAX, EBX, ECX, EDX, ESI, EDI, DS, ES,  
FS, GS, flagレジスタがそのままu_func()関数に渡され､ 又同様にu_func()関数実行 
後のEAX, EBX, ECX, EDX, ESI, EDI, DS, ES, FS, GS, flagレジスタが             
FRB_change_stack()関数を呼び出した関数に渡されます。但し､ u_func()関数に     
flagレジスタを渡す際に､ ディレクションフラグはクリアして渡します。これは、   
一般的C言語関数では、ディレクションフラグはクリアされている前提で動作する為  
です｡ u_func()を呼び出し、FRB_change_stack()呼び出し側に制御が戻ってきた時の 
flagレジスタのディレクションフラグは､ u_func()関数で変更しない限りクリアされ 
た値が返ります。u_func()とFRB_change_stack()の呼び出し元関数との間でのパラメ 
ータの授受には､ stack上によって渡されるu_paramsとEAX, EBX等のレジスタが使用で
きるので､ 各々の関数の開発言語にはC言語等の高級言語やアセンブリ言語の使用が可
能です。u_stack_off, u_stack_sel で指定されるstack領域を4の倍数値のアドレスに
変換して使用するので、常に高速なstackとして使用できます。                    
                                                                             
-----------------------------------------------------------------------------
.FRB_clrclient                                                               
forRBIOSクライアント宣言(全解除)                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int  FRB_clrclient( void );                                                  
                                                                             
- 戻り値 -                                                                   
0    :クライアント全削除完了                                                 
1    :forRBIOSはシステムに組み込まれていない                                 
                                                                             
- 例 -                                                                       
int  ret;                                                                    
                                                                             
ret = FRB_clrclient();                                                       
                                                                             
- 内容 -                                                                     
forRBIOSに登録されている全てのクライアントの解除を行います。                 
本関数を使用すると、forRBIOSに処理を要求していた全てのアプリケーションについ 
てクライアント登録が解除され、処理が行われなくなります。本関数の使用にあたっ 
ては、十分に注意してください。                                               
ＦＭ　Ｃ関数ライブラリの関数のみでforRBIOSに処理を要求する場合は、本関数を使 
用する必要はありません。                                                     
                                                                             
-----------------------------------------------------------------------------
.FRB_getclient                                                               
forRBIOSクライアントメンバ取得                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int  FRB_getclient( unsigned short *bufs);                                   
unsigned short *bufs；　　　　/*　登録クライアントメンバ用のバッファ　*/     
                                                                             
- 戻り値 -                                                                   
0    :正常終了                                                               
1    :forRBIOSはシステムに組み込まれていない                                 
                                                                             
- 例 -                                                                       
int  ret;                                                                    
unsigned short  bufs[20]                                                     
                                                                             
ret = FRB_getclient( bufs );                                                 
                                                                             
- 内容 -                                                                     
登録されているクライアントを指定されたバッファ(20*2byteの領域が必要)に通知し 
ます。                                                                       
ユーザバッファに返される内容は、登録されているクライアントのセレクタ値です。 
0セレクタは未登録を意味します。                                              
『クライアント宣言(登録):FRB_setclient 』を使用する場合は、予め本関数で自アプ
リケーションの動作前のforRBIOSのクライアント設定状態を保存し、『クライアント 
宣言(解除):FRB_resetclient』を使用せず、アプリ終了前に『全クライアントメンバ 
一括登録: FRB_popclient』を用いて元に戻してください。                        
                                                                             
-----------------------------------------------------------------------------
.FRB_getstatus                                                               
forRBIOSインストール状態の取得                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int  FRB_getstatus( void );                                                  
                                                                             
- 戻り値 -                                                                   
0 :forRBIOSはシステムに組み込まれている                                      
1 :forRBIOSはシステムに組み込まれていない                                    
                                                                             
- 例 -                                                                       
int ret;                                                                     
                                                                             
ret = FRB_getstatus();                                                       
                                                                             
- 内容 -                                                                     
forRBIOSがシステムに組み込まれているか否かを判別します。                     
本ＦＭ　Ｃ関数ライブラリは、forRBIOS必須です。forRBIOSが組み込まれていない場 
合は、完全に動作することができません。                                       
                                                                             
-----------------------------------------------------------------------------
.FRB_popclient                                                               
forRBIOS全クライアントメンバ一括登録                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int  FRB_popclient( unsigned short *bufs);                                   
unsigned short *bufs; 　　　/*　登録クライアントメンバ用バッファ　　*/       
                                                                             
- 戻り値 -                                                                   
0    :正常終了                                                               
1    :forRBIOSはシステムに組み込まれていない                                 
                                                                             
- 例 -                                                                       
int  ret;                                                                    
unsigned short  bufs[20]                                                     
                                                                             
ret = FRB_popclient( bufs );                                                 
                                                                             
- 内容 -                                                                     
指定されたバッファ(20*2byteの領域)の内容をクライアントとして一括登録します。 
0セレクタは未登録を意味します。                                              
『クライアント宣言(登録):FRB_setclient 』を使用する場合は、『FRB_resetclient 
(解除)』を使用せず、予め『クライアントメンバ取得:FRB_getclient』で自アプリ   
ケーションの動作前のforRBIOSのクライアント設定状態を保存し、動作終了前に本関 
数を用いて元に戻してください。                                               
                                                                             
-----------------------------------------------------------------------------
.FRB_resetclient                                                             
forRBIOSクライアント宣言(解除)                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int  FRB_resetclient( void );                                                
                                                                             
- 戻り値 -                                                                   
0    :クライアント削除完了                                                   
1    :forRBIOSはシステムに組み込まれていない                                 
0xa5 :登録されていないクライアントを指定した                                 
                                                                             
- 例 -                                                                       
int  ret;                                                                    
                                                                             
ret = FRB_resetclient();                                                     
                                                                             
- 内容 -                                                                     
forRBIOSに対してユーザアプリケーションプログラムのクライアント解除を行いま   
す。                                                                         
forRBIOS本体はクライアントをコードセレクタにより管理しているため、本関数を用 
いてクライアントの解除を行うと、たまたま同一のコードセレクタを持つ他のアプリ 
ケーションのクライアント登録も同時に解除されてしまいます。使用にあたっては、 
十分に注意してください。                                                     
ＦＭ　Ｃ関数ライブラリの関数のみforRBIOSに処理を要求する場合は、本関数を使用 
する必要はありません。                                                       
                                                                             
-----------------------------------------------------------------------------
.FRB_setclient                                                               
forRBIOSクライアント宣言(登録)                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int  FRB_setclient( void );                                                  
                                                                             
- 戻り値 -                                                                   
0    :クライアント登録完了                                                   
1    :forRBIOSはシステムに組み込まれていない                                 
0xa5 :登録されているクライアント数が多すぎて､登録が出来なかった              
                                                                             
- 例 -                                                                       
int ret;                                                                     
                                                                             
ret = FRB_setclient();                                                       
                                                                             
- 内容 -                                                                     
forRBIOSに対してユーザアプリケーションプログラムのクライアント登録を行いま   
す。                                                                         
本関数を使用する場合は、予め『クライアントメンバ取得:FRB_getclient』で、自ア 
プリューションの動作前のクライアント設定状態を保持し、アプリケーション終了前 
に、『forRBIOS全クライアントメンバ一括登録:FRB_popclient』を用いて元に戻して 
ください。ＦＭ　Ｃ関数ライブラリの関数のみでforRBIOSに処理を要求する場合は、 
本関数を使用する必要はありません。                                           
                                                                             
 4.　キーボードインターフェース                                              
                                                                             
  4.1　キーボードインターフェース概要                                        
                                                                             
　キーボードには、そのキー配列により、ＪＩＳ配列キーボードと親指シフトキーボ 
ードの2種類があり、キーボードインターフェースは、これらキーボードからのデータ
の読み込みをサポートします。                                                 
　なお、キーボードインターフェースを使用する場合は、TLINKまたは、386|LINKで必
ず次のオプションスイッチを指定してください。                                 
                                                                             
-TWOCASE                                                                     
キーボードからのキーインデータは、いったんキーボードバッファに格納され、プロ 
グラムからの指定により、各種コード系に変換され、プログラムに渡されます。この 
時、BIOSでは、入力された文字を自動的にエコーバック(繰り返し表示)することはあ 
りません。渡されたデータは、スキャンコードデータまたはエンコードデータ以外   
に、詳細情報として、CTRLキーや SHIFTキー等のシフトキー情報やキーアドレスが合 
わせて通知されるので、より細かい制御ができます。また、キーボードからの特定の 
文字コード毎に別の文字や文字列を割り当てる機能もあり、オペレータの入力負荷を 
軽減することができます。                                                     
  キーボードインターフェースは、ＪＩＳキーボードおよび親指シフトキーボード、 
マウス、拡張入力装置からの入力データを受け取り、各BIOSの呼び出しを行います。 
　さらに、キーボードからの入力文字に対しては、種々の機能が準備されており、   
以下にその概要を示します。                                                   
　キーの押下は、以下の手順にてBIOSユーザに通知されます。                     
                                                                             
 1.キー押下時に、以下の割り込みが発生し、割り込み管理サポート配下のキーボード
   IDハンドラに制御が渡されます。                                            
 2.キーボードIDハンドラでは、ＪＩＳキーボードおよび親指シフトキーボード、    
   マウス、拡張入力装置の中からキーデータであることを判定して、キーボード割り
   込みハンドラに制御を渡します。                                            
                                                                             
 3.キーボード割り込みハンドラでは、コード系に従った文字コードに変換し、キーボ
   ードバッファに格納します。                                                
   その際にCTRL、SHIFT、CAPキーなどのシフトキー状態および全キーの押下状態を示
   すマトリクス情報を記憶します。                                            
 4.BIOSユーザからの要求に従い、上記の情報を通知します。                      
                                                                             
図CL21R-054                                                                  
                                                                             
 (1) キーボードバッファ                                                      
　キーボードバッファは、以下のように読み込みポインタ、書き込みポインタ、格納 
文字数およびバッファから構成されます。このバッファサイズは 128文字およびキー 
割り当て処理時に使用するキー割り当てバッファ(1文字)です。                    
                                                                             
                                                                             
                      ┌────┬──────┬────┬──────┐     
                      │文字ｺｰﾄﾞ│FUNCTIONｺｰﾄﾞ│ｼﾌﾄｽﾃｰﾀｽ│ｷｰｱﾄﾞﾚｽｺｰﾄﾞ │     
                      └────┴──────┴────┴──────┘     
       格納文字数:n         ↑                                               
┌─┬─┬─┬─┬─┬─┬─┬─┬  ─┬─┬─┬─┬─┬─┬─┬─┬─┐     
│      │      │文字1 │文字2 │････│文字n │      │      │      │     
└─┴─┴─┴─┴─┴─┴─┴─┴  ─┴─┴─┴─┴─┴─┴─┴─┴─┘     
                    ↑  →更新                    ↑  →更新                 
              読み込みポインタ               書き込みポインタ                
                                                                             
                                                                             
  バッファに文字を格納する際には、書き込みポインタの示す位置に格納され、ポイ 
ンタを次の位置へ更新するとともに、格納文字数に1が加算されます。バッファから文
字を取り出す際には、読み込みポインタの示す位置の文字が取り出され、ポインタは 
次の位置へ更新するとともに、格納文字数から1減算されます。上図の場合、文字1が 
取り出され読み　込みポインタは文字2の位置へ移動します。書き込みあるいは読み込
みポインタがバッファの最後に達した際には、そのポインタを先頭に位置付けます。 
すなわち、キーボードバッファはリング構造となっています。                     
　また、キーボードバッファ内がすべて文字で埋められた場合、キーボードからの入 
力は無視されます。すなわち、読み込みポインタは書き込みポインタを追い越すこと 
はありません。                                                               
                                                                             
　なお、この文字のバッファリング機能を動作させないことも可能です。バッファリ 
ング機能がない場合には、読み込みポインタと書き込みポインタは同一位置を示して 
います。キーボードからの文字の入力あるいはプログラムからの文字の読み込み要求 
があっても、これらのポインタは更新されません。すなわち、読み込み要求がない間 
に次の文字が入力されれば、以前入力した文字は捨てられることになります。       
                                                                             
 1.　文字コード                                                              
　キーボードバッファに格納される文字には、以下のようにモードとコード系により3
種類の形式があります。                                                       
                                                                             
コード系──┬──エンコードモード──┬──ASCII (7bit)                     
　　　　　　│　　　　　　　　　　　　└──シフトjis (8bit)                 
　　　　　　└──スキャンモード　─────キーアドレスコード (8bit)        
                                                                             
　スキャンモードでは、キーが押されたり、離されたりしたタイミングを通知するこ 
とが可能であり、キーアドレスコードは以下の2つの情報から構成されます。        
                                                                             
　キーアドレス    　　キーボード上のキー位置を示します                       
　MAKE/BREAKビット  =0:キーアドレスで示されるキーが押されていることを示します
　　　　　　　　　　　　　(MAKEと呼びます)                                   
　　　　　　　　　　=1:キーアドレスで示されるキーが離されたことを示します    
　　　　　　　　　　　　  (BREAKと呼びます)                                  
                                                                             
  エンコードモードでは、スキャンモードで通知されるコードを各コード系に変換し 
た文字コードが、キーボードバッファに格納されユーザに通知されます。ASCII(7bit)
コード系では、キーボードからの入力時にMSB(bit7) =1である文字は無視され、キー 
ボードバッファ内に格納されません。すなわちカタカナのキーを押下しても無視され 
ますので、英字のみを扱うようなプログラムで使用されます。                     
　シフトjis(8bit)コード系では、カタカナを入力することが可能で、漢字を扱うプロ
グラムにも使用されます。                                                     
　エンコードモードでは、文字コード以外にその文字コードがどのキーから変換され 
たかを示すキーアドレスとその際のシフトキー状態が通知されます。これらの情報   
は、2個以上のキーから同一文字コードが通知される場合に、いずれのキーが押下され
たかを区別する情報として有効です。例えば、文字の'0'の場合、テンキーから入力さ
れたか否かということが決定できます。シフトキー情報については、後で詳しく述べ 
ます。                                                                       
                                                                             
 2.　キー種別                                                                
　キーは、以下のようにグループ分けされており、それぞれ入力を禁止することが可 
能です。                                                                     
                                                                             
通信キー:他のシステムとの通信用のキーであり、現在はサポートされていません    
編集キー:カーソル制御キー(↑、↓、←、→、DEL、INS、HOME、…)                
ＰＦ(Programmable Function) キー                                             
　　　　:キーボード上段のファンクションキーなど                              
文字キー:一般の文字キー                                                      
ＳＦ(System Function)キー                                                    
　　　　:BREAKキー、COPYキー                                                 
                                                                             
 3.　シフトステータス                                                        
　シフト状態は、文字を生成する時のモードを示します。このシフト状態は、以下に 
示す6つがあり、シフトステータスは、現在のシフト状態を保持しています。        
                                                                             
シフトキー情報─┬─英大/英小   (英大の時、1)─┐カナが 1の時、カナモードが優
　　　　　　　　├─カナ　　　  (カナの時、1)─┘先されます                  
　　　　　　　　│                                                           
　　　　　　　　├─SHIFT 　　─┬─文字が入力されたとき、各キーが押されてい 
　　　　　　　　├─CONTROL 　─┘　る場合に1                                
　　　　　　　　├─右親指シフト─┐                                         
　　　　　　　　└─左親指シフト─┴文字が入力されたとき、親指シフトキーが同 
　　　　　　　　　　　　　　　　　　時打鍵された場合に1                      
                                                                             
　右あるいは左親指シフトの情報がいずれか1である場合には、親指シフトキーの同時
打鍵により文字が入力されたことを示しており、親指シフトキーボードにて有効     
です。                                                                       
JISキーボードでは、常に0が通知されます。                                     
                                                                             
 4.  キーアドレスコード                                                      
　キーボードから送られてくるキーアドレスがそのまま入ります。                 
                                                                             
 (2) 入力モード                                                              
　入力モードは、ＪＩＳキーボードと親指シフトキーボードで異なるシフト変換をし 
ます。                                                                       
  デフォルト値は英小文字でスタートします。以下にキーボードBIOSの入力モード変 
換を示します。なお、かな漢字変換の入力モードとは異なりますので、日本語入力に 
関しては、かな漢字変換のマニュアルを参照してください。                       
                                                                             
1.　ＪＩＳキーボード                                                         
                                                                             
      ┌─←──  CAP ────┐                                             
┌──┴┐                  ┌┴──┐                                       
│ 英小 │                  │ 英大 │                                       
└┬┬┬┘                  └┬┬┬┘                                       
  ↑│└────  CAP ──→─┘│↑                                         
  │└─ ｶﾀｶﾅ →┐  ┌← ｶﾀｶﾅ ─┘│                                         
  │          ┌┴─┴┐          │                                         
  └─ ｶﾀｶﾅ ─┤ カナ ├─ ｶﾀｶﾅ ─┘                                         
              └───┘                                                     
        注)ひらがなキーはカタカナキーと同じ動作をします                      
                                                                             
2.　親指シフトキーボード                                                     
  シフトキーのうち、無変換キーはシフトキーとＰＦキーの2つの動作をします。    
                                                                             
    ┌←─┐  ┌─←─英小文字────┐  ┌─→┐                           
    │  ┌┴─┴┐                  ┌┴─┴┐  │                           
英小文字│ 英小 │                  │ 英大 │英大文字                       
    │  └┬┬┬┘                  └┬┬┬┘  │                           
    │    ↑│└───英大文字──→─┘│↑    │                           
    └──┘└─無変換→┐  ┌←無変換─┘└──┘                           
                      ┌┴─┴┐                                             
                ┌──┤ カナ ├──┐                                       
                │    └───┘    │                                       
                └── カタカナ →─┘                                       
                                                                             
(3) 入力モードの表示                                                         
　入力モードは、システム行に表示されます。ただし、コンソールBIOSによりシステ 
ム行なしの設定になっている場合、または、キーボードBIOSによりスキャンモードの 
設定になっている場合は表示しません(デフォルトでは表示されます)。             
　　　　　　　　　　　　　                            │                     
　　　表示例　　　　　　　システム行　　　　　　英小　│                     
　　　　　　　　　　                ─────────┘                     
　キー入力モードは、画面右下の全角2文字分を用いて表示します。各入力モードに対
応する表示は、次の通りです。                                                 
　  英小･････英小文字入力モード                                              
　　英大･････英大文字入力モード                                              
　　カナ･････カナ文字入力モード                                              
                                                                             
  4.2　関数一覧                                                              
                                                                             
  キーボードインターフェースの機能説明中、特に指定のないものは、これらすべて 
のモードで有効です。｢エンコードモードで有効｣と明記してあるものについては、エ 
ンコードモードのみで有効です。                                               
                                                                             
　また、文字コード系の指定とは別に、文字コード毎に通知する文字あるいは文字列 
を割り当てることが可能です。初期化状態では、キートップの刻印に従った文字コー 
ドが割り当てられています。例えば、この割り当て機能を使用して、ＰＦキーの一つ 
一つのキーが押下された際に、文字列"dir"を通知することが可能です。            
　なお、この割り当て機能で設定されている文字あるいは文字列は、キーボードバッ 
ファには格納されません。すなわち、ＰＦキーに文字列"dir" を割り当てたとして   
も、キーボードバッファ内に格納される文字数はあくまでも1文字であり、ＰＦキーの
文字コードが格納されるだけです。格納文字数もあくまで1文字として数えられます。
文字を読み取る際に、割り当て機能で設定されている文字あるいは文字列が通知され 
ます。                                                                       
┌───────┬────────────────────────┐         
│　関　数　名　│　　　　　　機      　　  　　　能　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_init　　　│初期化　　　　　　　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_setbuf　　│バッファリング機能の設定　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_setcode 　│コード系の設定　　　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_rdcode　　│コード系の読み取り　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_lock　　　│キーボードロックの制御　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_clic　　　│キーボードクリック音の制御　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_clrbuf　　│バッファのクリア　　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_inpchk　　│入力のチェック　　　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_shift 　　│シフトキー状態の読み取り　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_read　　　│文字の読み込み　　　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_matrix　　│マトリクス入力　　　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_addstr　　│入力文字列の追加　　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_pfint 　　│ＰＦキーの割り込み処理ルーチンの登録　　  　　  │         
├───────┼────────────────────────┤         
│KYB_rpfint　　│リアルＰＦキーの割り込み処理ルーチンの登録　　  │         
├───────┼────────────────────────┤         
│KYB_rdpfint 　│リアルＰＦキーの割り込み処理ルーチンの読み取り　│         
├───────┼────────────────────────┤         
│KYB_asign 　　│キーの割り当て　　　　　　　　　　　　　　　　　│         
├───────┼────────────────────────┤         
│KYB_rdasign 　│キーの割り当て状態の読み取り　　　　　　　　　　│         
└───────┴────────────────────────┘         
                                                                             
  4.3　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.KYB_addstr                                                                  
入力文字列の追加                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int     KYB_addstr( sw, chrcnt, string );                                    
int     sw;     　　　　　　　　　/*　0:読み込みポインタの前側に挿入  */     
  　　　        　　　　　　　　　/*　1:読み込みポインタ以降に追加　  */     
int     chrcnt; 　　　　　　　　　/*  追加文字数                        */   
unsigned short int    *string;    /*  追加文字列                  　　　*/   
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:入力文字の追加は不可                                                       
                                                                             
- 例 -                                                                       
int             sw, chrcut, ret;                                             
unsigned short int    string[] ={'A'+0x0000,                                 
                                  'B'+0x8000, 'C'+0x0000};                   
sw = 0;                                                                      
chrcnt = 3;                                                                  
                                                                             
ret = KYB_addstr( sw, chrcnt, string );                                      
                                                                             
- 内容 -                                                                     
キーボードバッファの先頭あるいは最後に文字列を追加します。                   
『文字の読み込み:KYB_read』を使用したとき、                                  
･読み込みポインタの前側に挿入をした場合:                                     
  最初に、挿入した文字列が読み取られ、これに続きキーボードより入力した文字列 
が読み取られます。                                                           
･読み込みポインタ以降に追加をした場合:                                       
  最初に、キーボードに既に入力していた文字がすべて読み取られた後に、追加文字 
列が読み取られます。                                                         
　　　　　　　　　　　　　　　　　　　　　　文字の読み取り/入力の            
                                      　　　チェック時の通知レジスタ         
string→　┌─┬─┬─────┐                                             
         0│　│　│文字コード│　←ｌｏｗ側                                 
        　│Ｅ│Ｗ│─────│                                             
         1│　│　│※1　　　 │　←ｈｉｇｈ側                               
        　├─┼─┼─────┤                                             
        　│　　　　　　　　　│                                             
        　│　上記繰り返し　　│        　　　※1　00H:通常文字              
        　│　　　　　　　　　│                                             
        　└─┴─┴─────┘        　　　　　 80H:PFキー                
                                                                             
この機能は｢バッファリング機能あり｣の場合に有効であり、｢バッファリング機能なし
｣の場合は｢入力文字列の追加は不可(ret=2)｣と通知されます。                     
swに2以上の値を設定した場合は、sw=0と見なされます。追加した文字は、『文字の  
読み込み:KYB_read』又は『入力のチェック:KYB_inpchk』にて取り出すことが出来ま 
す。                                                                         
その際、入力された文字は『キー割り当て:KYB_asign』により割りつけられた文字に 
変換されてから通知されます。すなわち、オペレータから入力された文字となんら変 
わりなく扱われます。                                                         
文字格納形式の詳細は、『文字の読み込み:KYB_read』あるいは『入力のチェック:KYB
_inpchk』を参照してください。                                                
ただし、キーボードバッファには、指定された文字コードを単に格納するのみであ   
り、格納した文字コードが正常か否かは全くチェックしないので注意してください。 
また、キーボードバッファの空き領域がなく追加が不可能な場合は、エラーを通知   
するのみで、キーボードバッファの内容は破壊しません。                         
                                                                             
-----------------------------------------------------------------------------
.KYB_asign                                                                   
キーの割り当て                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_asign( sw, moji, chrcnt, string );                               
int             sw;     　　　　/*  0:割り当て文字に押下された               
                  　　　　      　　　　キーアドレスを追加　　  */           
          　　　        　　　　/*  1:割り当て文字のキー                     
                　　　　　　　　　　　　アドレスに00Hを付加　   */           
unsigned int    moji;   　　　　/*  文字コード(JIS)(2byte)　　  */           
int             chrcnt; 　　　　/*  割り当て文字数(byte)  　　  */           
char            *string;　　　　/*  割り当て文字列        　　  */           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int             sw, chrcnt;                                                  
unsigned int    moji;                                                        
char            *string = "abcde";                                           
sw = 0;                                                                      
moji = 0x0061;              　　　　/*  a 　　　*/                           
chrcnt = strlen( string );                                                   
                                                                             
KYB_asign( sw, moji, chrcnt, string );                                       
                                                                             
- 内容 -                                                                     
文字コードが示すキーに、文字列を割り当てます。                               
キー押下時には、割り当てられている文字列がキーボードバッファに格納されます。 
文字列の指定形式は、以下の通りです。                                         
                                                                             
string→　┌─┬─┬─────┐───                                       
         0│Ｅ│Ｂ│文字コード│　↑                                         
        　├─┼─┼─────┤　│chrcnt bytes                             
        　│　　　　　　　　　│　│                                         
         1│　上記繰り返し　　│　│                                         
  　　　　│　　　　　　　　　│　↓                                         
        　└─┴─┴─────┘───                                       
                                                                             
sw=0であれば、エンコード情報には、押下キーのキーアドレスと押下時のシフトキー 
状態がすべての文字列に付加されます。                                         
sw=1であれば、エンコード情報のキーアドレスには00Ｈが、シフトキー状態には押下 
時のシフトキー状態がすべての文字列に付加されます。                           
                                                                             
swに2以上の値を設定した場合はsw=0と見なされます。                            
文字コードの指定形式は、以下のとおりです。                                   
                                                                             
  (1) 英数カナ、グラフィック文字キー                                         
　　　ｍｏｊｉ                                                               
  　  　bit15-8 ＝00Ｈ                                                       
  　    bit7-0  ＝ASCII/シフトJISコード                                      
                                                                             
  (2) ＰＦキー                                                               
　　　ｍｏｊｉ                                                               
  　　　bit15-8 ＝80Ｈ                                                       
  　　　bit7-0  ＝PFキーコード                                               
                                                                             
なお、割り当て可能な最大文字数が、以下のようにキーごとに異なります。その文字 
数を越えたキー割り当てに対しては、先頭からの最大文字数分の文字列が有効になり 
ます。                                                                       
                                                                             
･ＰＦキー　                            15文字                                
･編集キー                      　　     7文字                                
･コントロールキー以外の文字コード  　   7文字                                
･コントロールキー(CTRL＋〜)           割り当て不可                           
                                                                             
割り当て文字数に0を指定した場合には、その文字コードに対応するキーの押下が読み
取れなくなりますので、注意してください。                                     
                                                                             
-----------------------------------------------------------------------------
.KYB_clic                                                                    
キーボードクリック音の制御                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_clic( sw );                                                      
int     sw;             　　/*  0:クリック音あり　　　　　　  */             
                        　　/*  1:クリック音なし　　　　　　  */             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int     sw;                                                                  
                                                                             
sw = 0; 　　　　　　　　　　/*  クリック音あり　　　　　　　　  */           
KYB_clic( sw );                                                              
                                                                             
- 内容 -                                                                     
キー(シフトキーを除く)押下時にクリック音を出すか否かを制御します。           
swに2以上の値を指定した場合には、｢クリック音あり｣と見なされます。            
                                                                             
-----------------------------------------------------------------------------
.KYB_clrbuf                                                                  
バッファのクリア                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_clrbuf( void );                                                  
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
KYB_clrbuf();                                                                
                                                                             
- 内容 -                                                                     
キーボードバッファ内のすべての文字を消去します。                             
                                                                             
-----------------------------------------------------------------------------
.KYB_init                                                                    
初期化                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_init( void );                                                    
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
KYB_init();                                                                  
                                                                             
- 内容 -                                                                     
キーボードを以下のように初期化します。                                       
バッファリング機能              あり                                         
キーボードバッファ              クリア状態                                   
コード系                        シフトjis (8bit)                             
キーのマスク                    なし                                         
シフト状態                      英小文字                                     
キーボードロック                解除                                         
クリック音                      あり                                         
ＰＦキー割り込み機能            なし                                         
キー割り当て                    デフォルトのキー配列通り                     
タイパマティック待ち時間        400ms                                        
タイパマティック周期            30ms                                         
                                                                             
-----------------------------------------------------------------------------
.KYB_inpchk                                                                  
入力のチェック                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
unsigned int    KYB_inpchk( chrcnt, encode );                                
int     　　    *chrcnt;　　/*  文字数                              */       
unsigned int    *encode;　　/*  エンコード情報                      */       
                        　　/*  bit15-8:キーアドレス　　        　 */        
                    　　　　/*  bit7-0 :シフトキー状態　　         */        
                                                                             
- 戻り値 -                                                                   
文字コードを返します。                                                       
                                                                             
- 例 -                                                                       
unsigned int    moji, encode;                                                
int             chrcnt;                                                      
                                                                             
moji = KYB_inpchk( &chrcnt, &encode );                                       
                                                                             
- 内容 -                                                                     
キーボードバッファ内に格納されている文字数と、キーボードバッファの読み込みポ 
インタが示している文字(文字コードおよびエンコード情報)を通知します。その際   
に、読み込みポインタは更新されません。文字コードは、モードにより通知形式が以 
下のように異なります。                                                       
                                                                             
 (1) 拡張文字コード                                                          
                                                                             
  1.エンコードモード                                                         
                                                                             
bit15-8 ＝00Ｈ　　 PFキー、シフトキー以外のキー押下により文字                
　　　　　　　　　　 コードが発生したことを示します。                        
　　　　＝80Ｈ　   PFキー押下により文字コードが発生したことを                
　　　　　　　　　　 示します。                                              
　　　　＝0ＦＦＨ　 入力文字が無いことを示します。                           
bit7-0:文字コード　bit15-8 ≠0ＦＦＨの場合に有効です。                       
                                                                             
  2.スキャンモード                                                           
                                                                             
bit15-8 ＝00Ｈ　　スキャンコードが有効です。                                 
    　　＝0ＦＦＨ　入力文字がないことを示します。                            
bit7-0:スキャンコード                                                        
                                                                             
   7   6   5   4   3   2   1   0                                             
┌─┬─────────────┐                                           
│　│　キーアドレス(01H〜7FH)　│                                           
└┬┴─────────────┘                                           
　└─0:キーアドレスで示されるキーが押されていることを示します。             
　　　　(MAKE)                                                               
　　　1:キーアドレスで示されるキーが離されたことを示します。                 
　　　　(BREAK)                                                              
　　　ただし、キーアドレスは各機種固有の形式です。                           
                                                                             
 (2) エンコード情報(encode)                                                  
                                                                             
エンコード情報はエンコードモードにて有効であり、以下のようにどのキーより文字 
コードが得られたかを示すキーアドレスと、押下時のシフト状態から構成されます。 
                                                                             
 　　　15　        〜         8   7   6   5   4   3   2   1   0              
     　┌───────────┬─┬─┬─┬─┬─┬─┬─┬─┐            
encode:│キーアドレス(00H〜7FH)│ 0│  │  │  │ 0│　│　│　│ｼﾌﾄｷｰ状態   
     　└───────────┴─┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘(0:off､1:on)
     　                          　　│　│　│　│　│　│(1:英大/0:英小)   
 　　　　　　　　　　　　　　　　　　│　│　│　│　│　└─カナの時1       
                               　　　│　│　│　│　└─ＳＨＩＦＴ          
                               　　　│　│　│　└─ＧＲＡＰＨ              
                               　　　│　│　└─ＣＯＮＴＲＯＬ              
                               　　　│　右親指シフト┬親指ｼﾌﾄｷｰﾎﾞｰﾄﾞにて有効
                               　　　└左親指シフト─┘                      
                                                                             
  なお、キーボードバッファ内に格納されている文字が、次のように入力された場合 
は、キーアドレスが0(encodeのbit15-8=00H)になります。                         
･『入力文字列の追加:KYB_addstr』により入力された文字                         
･『キー割り当て:KYB_asign』により入力された文字                              
･『DSRシーケンス:ESC〔6n』による『CPRシーケンス:ESC〔P1;Pc R』(カーソル位置) 
 の通知                                                                      
･『ESC ? シーケンス』によるカーソル位置の通知                                
                                                                             
 (3) 文字数(chrcnt)                                                          
文字数は、キーボードバッファに格納されている文字(この場合、キーに2文字以上の 
文字が割り当てられたとしても1文字と見なされます)およびキー割り当て処理時に使 
用するキー割り当てバッファ(1文字)です。                                      
                                                                             
-----------------------------------------------------------------------------
.KYB_lock                                                                    
キーボードロックの制御                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_lock( sw );                                                      
int     sw;                 /*  0:キーボードロックなし　　　  */             
                            /*  1:キーボードロックあり　　　  */             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int     sw;                                                                  
                                                                             
sw = 0; 　　　　　　　　　　/*  キーボードロックなし　　　　　  */           
KYB_lock( sw );                                                              
                                                                             
- 内容 -                                                                     
エンコードモードの時、キーボードよりキー入力を許すか否かを制御します。swに2以
上の値を指定した場合には、｢キーボードロックなし｣と見なされます。             
                                                                             
-----------------------------------------------------------------------------
.KYB_matrix                                                                  
マトリクス入力                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_matrix( matrix );                                                
char    *matrix;            /*  マトリクス情報格納領域　　　　  */           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
char    matrix[16];                                                          
                                                                             
KYB_matrix( matrix );                                                        
                                                                             
- 内容 -                                                                     
キーボードの全てのキーの状態(1:押している、0:離している)を、128ビット(16バイ 
ト)の領域に通知します。                                                      
通知形式は、以下の通りです。                                                 
                                                                             
matrix→　┌─┬─┬─────┐                                             
         0│Ｒ│Ｂ│キーの状態│                                             
        　├─┼─┼─────┤                                             
  　　　　│　　　　　　　　　│                                             
        　│　上記繰り返し　　│                                             
         F│　│　│　　　　　│                                             
        　└─┴─┴─────┘                                             
キーとその状態の格納位置は、以下の計算式にて求めることができます。           
(格納領域先頭からの相対アドレス)＝(キーアドレス)/8                           
(ビット位置)＝(キーアドレス) mod　8                                          
                                                                             
例えば、キーアドレス25Ｈのキーが押されている状態は、以下のようになります。   
                                                                             
7Ｆ<───────────────────00　キーアドレス                   
　15　14　         7   6   5   4   3   2   1   0  byte                       
┌─┬─┬─〜─┬─┬─┬─┬─┬─┬─┬─┬─┐                           
│00│00│　　　│00│00│00│20│00│00│00│00│                           
└─┴─┴─〜─┴─┴─┴─┴─┴─┴─┴─┴─┘                           
                            │　│                                           
                ┌─────┘　└───────┐                           
                │ 7   6   5   4   3   2   1   0│bit                        
                ┌─┬─┬─┬─┬─┬─┬─┬─┐                           
                │ 0│ 0│ 1│ 0│ 0│ 0│ 0│ 0│                           
                └─┴─┴─┴─┴─┴─┴─┴─┘                           
                          ↑                                                 
                        　└キーアドレス25ＨのキーのON/OFF状態               
                                                                             
キーアドレスに対応するキーが無い場合には、0が通知されます。                  
                                                                             
-----------------------------------------------------------------------------
.KYB_pfint                                                                   
ＰＦキー割り込み処理ルーチンの登録                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_pfint( pfflg, extflg, markflg, intentry );                       
unsigned int    pfflg;      　/*  PFキー制御フラグ              */           
ungigned int    extflg;     　/*  PFキー制御フラグ              */           
ungigned int    markflg;    　/*  PFキー制御フラグ              */           
char            *intentry;  　/*  PFキー割り込み処理ルーチンの               
　　　　　　　　　　　　　　　　　アドレス(4byte) 　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
unsigned int    pfflg, extflg, markflg;                                      
char            intentry[4];                                                 
extern int      func1();  　  /*  割り込み処理ルーチン(ｱｾﾝﾌﾞﾗ記述)*/         
pfflg = 0x8002;             　/*  PF1 　　　                  　  */         
exflg = 0x1000;             　/*  漢字　　　                  　  */         
markflg = 0x0002;           　/*  PF13　　　                  　  */         
BSETCODEADR( intentry, func1 );                                              
                                                                             
KYB_pfint( pfflg, exflg, markflg, intentry );                                
                                                                             
- 内容 -                                                                     
制御フラグにて指定されるＰＦキーが押下された際に呼び出すＰＦキー割り込み処理 
ルーチンを登録します。                                                       
制御フラグは各ＰＦキーに割り当てられ、各ビットの値が1のとき、割り込み処理ルー
チンが呼び出されます。0の場合には、通常の文字コードと同様に、キーボードバッフ
ァにＰＦキーに対応する文字コードとエンコード情報が格納されます。             
markflgを有効にしたい場合は、拡張フラグに1をセットしてください。             
                                                                             
　　　　　15　14　13　12　11　10　 9   8   7   6   5   4   3   2   1   0     
　　  　┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐   
　pfflg:│　│ 0│ 0│ 0│　│　│　│　│　│  │  │  │　│　│　│ 0│   
　　    └┬┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┘   
　　　　　│        　　PF11 PF10 PF9 PF8 PF7 PF6 PF5 PF4 PF3 PF2 PF1        
　　　　拡張フラグ                                                           
　　        0:pfflg、extflgのみ有効                                          
　　        1:pfflg、extflg、markflgが有効                                   
                                                                             
　　　　　15　14　13　12　11　10　 9   8   7   6   5   4   3   2   1   0     
　　    ┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐   
 extflg:│　│　│　│　│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│   
　　    └┬┴┬┴┬┴┬┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┘   
　　　　　│　│　│　│                                                     
　　　　　│　│　│　漢字                                                   
　　　　　│　│　PF12(EXT)                                                  
　　　　　│　変換                                                           
　　　　無変換                                                               
                                                                             
　　　　　15　14　13　12　11　10　 9   8   7   6   5   4   3   2   1   0     
　　    ┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐   
markflg:│ 0│ 0│ 0│ 0│ 0│ 0│ 0│　│　│  │  │  │　│　│　│ 0│   
　　    └─┴─┴─┴─┴─┴─┴─┴┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┴─┘   
　　                                 PF20 │ PF18 │ PF16 │ PF14 │         
　　                                     PF19    PF17    PF15    PF13        
                                                                             
ＰＦキー割り込み処理ルーチンを呼び出す際には、セグメント内呼び出し(NEARCALL) 
が使用されますので、セグメント内復帰(NEAR RET)を使用して、キーボード割り込み 
ハンドラに復帰してください。ただし、レジスタを復旧する必要はありません。呼び 
出し時には、以下に示すように、BXレジスタに割り込み発生原因のキーアドレスとシ 
フトキー情報を通知します。                                                   
                                                                             
　　15　        〜         8   7   6   5   4   3   2   1   0                 
　　┌───────────┬─┬─┬─┬─┬─┬─┬─┬─┐               
(BX)│キーアドレス(01H〜7FH)│ 0│　│  │  │ 0│　│　│　│ｼﾌﾄｷｰ状態      
　　└───────────┴┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘　(0:off､1:on) 
    　            　　　　　　│　│　│　│　│　│　└(1:英大/0:英小)      
          　　　　　　　　　　│　│　│　│　│　└─カナの時1              
                          　　│　│　│　│　└─ＳＨＩＦＴ                 
                          　　│　│　│　└─ＧＲＡＰＨ                     
                          　　│　│　└─ＣＯＮＴＲＯＬ                     
                          　　│　└─右親指シフト┬親指ｼﾌﾄｷｰﾎﾞｰﾄﾞにて有効   
                          　　└─左親指シフト──┘                         
                                                                             
なお、ＰＦキーがマスクされている場合でも、設定情報は保持されており、マスクが 
解除された際に有効になります。                                               
                                                                             
-----------------------------------------------------------------------------
.KYB_rdasign                                                                 
キーの割り当て状態の読み取り                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_rdasign( sw, moji, chrcnt, string );                             
int             *sw;      　/*  0:割り当て文字に押下された                   
　　　　　　　　　　　　　　　　　　キーアドレスを追加　　　　   */          
　　　　　　　　　　　　　　/*　1:割り当て文字のキーアドレスに               
　　　　　　　　　　　　　　　　　　00Hを付加  　　　　    　    */          
unsigned int    moji;     　/*  文字コード(JIS)(2byte)      　   */          
int             *chrcnt;  　/*  割り当て文字数(byte)        　   */          
                                                                             
char            *string;  　/*  割り当て文字列(領域サイズをセッ              
　　　　　　　　　　　　　　　　トする) 　　　　　　　　　　　   */          
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
unsigend int    moji;                                                        
int             sw, chrcnt;                                                  
char            string[50];                                                  
moji = 0x0061;              /*  a                           　  */           
string[0] = 50-1;           /*  MAX = 255                   　  */           
                                                                             
.KYB_rdasign( &sw, moji, &chrcnt, string );                                  
                                                                             
- 内容 -                                                                     
文字コードが示すキーに割り当てられている文字列を通知します。                 
文字列の通知形式は、以下の通りです。                                         
                                                                             
string→　┌─┬─┬────────┐                                       
         0│Ｅ│Ｂ│領域サイズ(byte)│                                       
        　├─┼─┼────────┤                                       
         1│Ｒ│Ｂ│文字コード　　　│                                       
        　├─┼─┼────────┤                                       
         2│　│　│　　　　　　　　│                                       
        　│　│　│上記繰り返し　　│                                       
        　└─┴─┴────────┘                                       
                                                                             
chrcntで通知される文字数は、『キー割り当て:KYB_asign 』にて割り当てられた文字
数です。                                                                     
領域サイズが割り当て文字数よりも小さい場合には、割り当て文字列の先頭から領域 
サイズ分の文字が通知されます。                                               
                                                                             
-----------------------------------------------------------------------------
.KYB_rdcode                                                                  
コード系の読み取り                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
unsigned int    KYB_rdcode( void );                                          
                                                                             
- 戻り値 -                                                                   
現在のコード系(モード、コード系、マスク情報)を返します。                     
                                                                             
- 例 -                                                                       
unsigned int   mode;　　　　/*  モード  */                                   
                                                                             
mode = KYB_rdcode();                                                         
                                                                             
- 内容 -                                                                     
現在のコード系を通知します。通知形式は以下の通りです。                       
なお、サポートされていないキーでは、マスクの値は無視されます。               
                                                                             
　　　　15  14  13  12  11  10   9   8   7   6   5   4   3   2   1   0       
      ┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐     
 mode:│　│　│ 0│ 0│ 0│ 0│　│　│ 0│ 0│ 0│ 0│　│　│　│　│     
    　└┬┴┬┴─┴─┴─┴─┴┬┴┬┴─┴─┴─┴─┴┬┴─┴─┴┬┘     
        └┬┘                  └┬┘                  └──┬──┘       
          │                      │                          │             
モード               ｺｰﾄﾞ系 : ｴﾝｺｰﾄﾞﾓｰﾄﾞにて有効    ﾏｽｸ:ｴﾝｺｰﾄﾞﾓｰﾄﾞにて有効   
　 00 : エンコード       00 : ASCII(7bit)               (1: 禁止,0: 有効)    
　 01 : スキャン         01 : リザーブ                bit3: 通信キー         
　 10,11 :リザーブ       10 : シフトjis(8bit)            2: 編集キー         
　                       11 : リザーブ                   1: PFキー           
　                                                       0: 文字キー         
                                                                             
-----------------------------------------------------------------------------
.KYB_rdpfint                                                                 
リアルＰＦキー割り込み処理ルーチンの読み取り                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_rdpfint( pfflg, extflg, markflg, intentry );                     
unsigned int    *pfflg;       /*  PFキー制御フラグ              */           
ungigned int    *extflg;      /*  PFキー制御フラグ              */           
ungigned int    *markflg;     /*  PFキー制御フラグ              */           
char            *intentry;  　/*  PFキー割り込み処理ルーチンの               
　　　　　　　　　　　　　　　　　アドレス･セグメント(6byte) 　*/            
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
unsigned int    pfflg, extflg, markflg;                                      
char            intentry[6];                                                 
                                                                             
KYB_rdpfint( &pfflg, &exflg, &markflg, intentry );                           
                                                                             
- 内容 -                                                                     
制御フラグにて指定されるPFキーが押下された際に呼び出すPFキー割り込み処理ルー 
チンを読み取ります。この関数は、リアル側のアドレスを読み取るために使用しま   
す。                                                                         
                                                                             
-----------------------------------------------------------------------------
.KYB_read                                                                    
文字の読み込み                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
unsigned int    KYB_read( sw, encode );                                      
int             sw;     　/*  0:入力待ち        　              */           
        　              　/*  1:入力待ちなし    　              */           
unsigned int    *encode;　/*  エンコード情報          　　　　    */         
　　　　　　　　　　　　　/*  bit15-8:キーアドレス  　           */          
                    　　　/*  bit7-0 :シフトキー状態　           */          
                                                                             
- 戻り値 -                                                                   
文字コードを返します。                                                       
                                                                             
- 例 -                                                                       
int             sw;                                                          
unsigned int    moji,encode;                                                 
sw = 0;                                                                      
                                                                             
moji = KYB_read( sw, &encode );                                              
                                                                             
- 内容 -                                                                     
キーボードから文字を入力します。                                             
すなわち、キーボードバッファから読み込みポインタが示す文字(文字コードとエンコ
ード情報)を取り出し、通知します。                                            
前述の『入力のチェック:KYB_inpchk』と異なり、その後、読み込みポインタが更新さ
れます。                                                                     
入力待ちが指定された場合、有効であるキー(コード系あるいはキーのマスクにより無
効なキーがあります)が押下されるまで待ちます。                                
入力待ちが指定されていない場合、この機能が呼び出された際、まだ文字が入力され 
ていない場合には、直ちにこの機能より復帰します。その際には、以下の情報が通知 
されます。                                                                   
                                                                             
･拡張文字コード(moji)                                                        
  bit15-8 ＝0FFＨ                                                            
  bit7-0　＝0FFＨ                                                            
･エンコード情報(encode)                                                      
　bit15-8 ＝0FFＨ                                                            
　bit7-0　＝この機能が呼び出された際のシフトキー状態                         
                                                                             
すでに文字が入力されている場合、入力待ちが指定された場合と機能は変わりま     
せん。                                                                       
swに2以上の値を設定した場合には、｢入力待ち｣と見なされます。                  
文字コードは、モードにより通知形式が以下のように異なります。                 
                                                                             
 (1) 拡張文字コード(moji)                                                    
                                                                             
  1.エンコードモード                                                         
                                                                             
bit15-8 ＝00Ｈ　　　PFキー、シフトキー以外のキー押下により                   
　　　　　　　　　　　文字コードが発生したことを示します。                   
　　　　＝80Ｈ　　　PFキー押下により文字コードが発生したことを示します。     
　　　　＝0FFＨ　　入力文字が無いことを示します。                            
bit7-0  :文字コード　bit15-8 ≠0FFＨの場合に有効です。                       
                                                                             
  2.スキャンモード                                                           
                                                                             
bit15-8 ＝00Ｈ　　　　スキャンコードが有効です。                             
　　　　＝0ＦＦＨ　　　入力文字が無いことを示します。                        
bit7-0  :スキャンコード                                                      
                                                                             
　　  　 7   6   5   4   3   2   1   0                                       
　　　┌─┬─────────────┐                                     
moji: │　│　キーアドレス(01H〜7FH)　│                                     
　　　└┬┴─────────────┘                                     
　　　  └─0:キーアドレスで示されるキーが押されていることを示します。       
　　　　　　　(MAKE)                                                         
　　　　　　1:キーアドレスで示されるキーが離されたことを示します。           
　　　　　　　(BREAK)                                                        
                                                                             
ただし、キーアドレスは各機種固有の形式です。                                 
                                                                             
 (2) エンコード情報(encode)                                                  
                                                                             
エンコード情報はエンコードモードの場合に有効であり、どのキーより文字コードが 
得られたかを示すキーアドレスと、押下時のシフト状態から以下のように構成され   
ます。                                                                       
                                                                             
　　　　15　　　  〜      　  8   7   6   5   4   3   2   1   0              
 　　　┌───────────┬─┬─┬─┬─┬─┬─┬─┬─┐            
encode:│キーアドレス(00H〜7FH)│ 0│  │  │  │ 0│　│　│　│ｼﾌﾄｷｰ状態   
 　　　└───────────┴─┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘(0:off､1:on)
 　　　　　　　　　　　　　　　　　　│　│　│　│　│　│(1:英大/0:英小)   
       　　                　　　　　│　│　│　│　│　└─カナの時1       
       　　                　　　　　│　│　│　│　└─ＳＨＩＦＴ          
       　　                　　　　　│　│　│　└─ＧＲＡＰＨ              
       　　                　　　　　│　│　└─ＣＯＮＴＲＯＬ              
       　　                　　　　　│　右親指シフト┬親指ｼﾌﾄｷｰﾎﾞｰﾄﾞにて有効
       　　                　　　　　└左親指シフト─┘                      
                                                                             
なお、キーボードバッファ内に格納されている文字が、次のように入力された場合   
は、キーアドレスが0(encodeのbit15-8=00H)になります。                         
･『入力文字列の追加:KYB_addstr』により入力された文字                         
･『キー割り当て:KYB_asign』により入力された文字                              
･『DSRシーケンス:ESC〔6n』による『CPRシーケンス:ESC 6Pl;Pc R』(カーソル位置) 
 の通知                                                                      
･『ESC ? シーケンス』によるカーソル位置の通知                                
                                                                             
-----------------------------------------------------------------------------
.KYB_rpfint                                                                  
リアルＰＦキー割り込み処理ルーチンの登録                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_rpfint( pfflg, extflg, markflg, intentry );                      
unsigned int    pfflg;        /*  PFキー制御フラグ              */           
ungigned int    extflg;       /*  PFキー制御フラグ              */           
ungigned int    markflg;      /*  PFキー制御フラグ              */           
char            *intentry;  　/*  PFキー割り込み処理ルーチンの               
　　　　　　　　　　　　　　　　　アドレス･セグメント(6byte) 　*/            
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
unsigned int    pfflg, extflg, markflg;                                      
char            intentry[6];                                                 
                                                                             
KYB_rdpfint( &pfflg, &exflg, &markflg, intentry );                           
　　　.                                                                      
　　　.                                                                      
　　　.                                                                      
KYB_rpfint( pfflg, exflg, markflg, intentry );                               
                                                                             
- 内容 -                                                                     
制御フラグにて指定されるPFキーが押下された際に呼び出すPFキー割り込み処理ルー 
チンを登録します。この関数は、リアル側のアドレスを戻すために使用します。     
                                                                             
-----------------------------------------------------------------------------
.KYB_setbuf                                                                  
バッファリング機能の設定                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_setbuf( sw );                                                    
int     sw;                 /*  0:バッファリング機能あり  　　*/             
                            /*  1:バッファリング機能なし  　　*/             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int     sw;                                                                  
                                                                             
sw = 0; 　　　　　　　　　　/*  バッファリングを行う　　　  　　*/           
KYB_setbuf( sw );                                                            
                                                                             
- 内容 -                                                                     
キーボードからの文字入力の際、バッファリングを行うか否かを指定します。swに2以
上の値を指定した場合は、｢バッファリング機能あり｣と見なされます。             
なお、バッファリング機能の設定後、キーボードバッファはクリア状態となります   
が、コード系･キーのマスク等の他の状態は変更されません。                      
バッファリング機能              指定値                                       
キーボードバッファ              クリア状態                                   
コード系                        変更なし                                     
キーのマスク                    変更なし                                     
シフト状態                      変更なし                                     
キーボードロック                変更なし                                     
クリック音                      変更なし                                     
ＰＦキー割り込み機能            変更なし                                     
キー割り当て                    変更なし                                     
オートリピート開始時間　        変更なし                                     
オートリピート周期　            変更なし                                     
                                                                             
-----------------------------------------------------------------------------
.KYB_setcode                                                                 
コード系の設定                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    KYB_setcode( mode );                                                 
unsigned int    mode;         /*  モード、コード系、マスク　　　 */          
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
unsigned int    mode;                                                        
mode = 0x0000;                                                               
                                                                             
KYB_setcode( mode );　　  　　/*  エンコード、ASCII、マスクなし  */          
                                                                             
- 内容 -                                                                     
『入力のチェック:KYB_inpchk』、『文字の読込み:KYB_read』の通知コード系を     
modeにて指定します。なお、サポートされていないキーでは、マスクの値は無視され 
ます。                                                                       
コード系の切り換え後、キーボードバッファはクリア状態に、シフト状態は英小文字 
に設定されますが、その他の状態は変更されません。                             
                                                                             
　　　　15　14　13　12　11　10　 9   8   7   6   5   4   3   2   1   0       
      ┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐     
 mode:│　│　│ 0│ 0│ 0│ 0│　│　│ 0│ 0│ 0│ 0│　│　│　│　│     
      └┬┴┬┴─┴─┴─┴─┴┬┴┬┴─┴─┴─┴─┴┬┴─┴─┴┬┘     
        └┬┘                  └┬┘                  └──┬──┘       
          │                      │                          │             
　モード　　         ｺｰﾄﾞ系 : ｴﾝｺｰﾄﾞﾓｰﾄﾞにて有効    ﾏｽｸ:ｴﾝｺｰﾄﾞﾓｰﾄﾞにて有効   
　 00 : エンコード       00 : ASCII(7bit)             　(1: 禁止、0: 有効)   
　 01 : スキャン         01 : リザーブ                bit3: 通信キー         
　 10,11 :リザーブ       10 : シフトjis(8bit)            2: 編集キー         
　　                     11 : リザーブ                   1: PFキー           
　　                                                     0: 文字キー         
                                                                             
-----------------------------------------------------------------------------
.KYB_shift                                                                   
シフトキー状態の読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
unsigned int    KYB_shift( void );                                           
                                                                             
- 戻り値 -                                                                   
シフトキー状態を返します。                                                   
                                                                             
- 例 -                                                                       
unsigned int    mode;                                                        
                                                                             
mode = KYB_shift();                                                          
                                                                             
- 内容 -                                                                     
現在のキーボードのシフト状態を、以下の形式で通知します。                     
スキャンモードの時には、意味を持ちません。                                   
                                                                             
　15　14　13　12　11　10　 9   8   7   6   5   4   3   2   1   0 (0:off,1:on)
┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│  │  │  │ 0│　│　│　│ｼﾌﾄｷｰ状態  
└─┴─┴─┴─┴─┴─┴─┴─┴─┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘           
　　　　　　　　　　　　　　　　　　　│　│　│　│　│　│(1:英大/0:英小)  
                                　　　│　│　│　│　│　└─カナの時1      
　　　　　　　　　　　　　　　　　　　│　│　│　│　└─ＳＨＩＦＴ         
                                　　　│　│　│　└─ＧＲＡＰＨ             
                                　　　│　│　└─ＣＯＮＴＲＯＬ             
                                　　　│右親指シフト┬親指ｼﾌﾄｷｰﾎﾞｰﾄﾞにて有効 
                                　　　└左親指シフト┘                       
                                                                             
 5.　コンソール(文字ディスプレイ)インターフェース                            
                                                                             
  5.1　関数一覧                                                              
                                                                             
┌─────────┬───────────────────┐               
│　　関　数　名　　│　　　　　　機    　  　能　　　　　　│               
├─────────┼───────────────────┤               
│VDB_init　　　　　│初期化　　　　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_kind　　　　　│画面の表示制御　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_cls 　　　　　│全画面消去　　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setsize 　　　│表示画面サイズの設定　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdsize　　　　│表示画面サイズの読み取り　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_screensize　　│表示画面サイズレパートリの読み取り　　│               
├─────────┼───────────────────┤               
│VDB_rdatrarea 　　│アトリビュート機能範囲の読み取り　　　│               
├─────────┼───────────────────┤               
│VDB_rdfont　　　　│フォントパターンの取り出し　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setfont 　　　│外字パターンの登録　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setcustype　　│カーソル形状の設定　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdcustype 　　│カーソル形状の読み取り　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setcusmd　　　│カーソル表示状態の設定　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdcusmd 　　　│カーソル表示状態の読み取り　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setposcus 　　│カーソル位置の指定　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdposcus　　　│カーソル位置の読み取り　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setatr　　　　│アトリビュートの設定　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdatr 　　　　│アトリビュートの読み取り　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setdefatr 　　│デフォルトアトリビュートの設定　　　　│               
├─────────┼───────────────────┤               
│VDB_rddefatr　　　│デフォルトアトリビュートの読み取り　　│               
├─────────┼───────────────────┤               
│VDB_setchr　　　　│文字の設定　　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdchr 　　　　│文字の読み取り　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setarea 　　　│矩形域の設定　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdarea　　　　│矩形域の読み取り　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_cpyarea 　　　│矩形域の複写　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_clrarea 　　　│矩形域の消去　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_scroll　　　　│全画面スクロール　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_areascroll　　│部分スクロール　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_setcon　　　　│コンソール機能の設定　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdcon 　　　　│コンソール機能設定値の読み取り　　　　│               
├─────────┼───────────────────┤               
│VDB_outchr　　　　│文字の出力　　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_outstr　　　　│文字列の出力　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_wtsysline 　　│システム行の書き込み　　　　　　　　　│               
├─────────┼───────────────────┤               
│VDB_rdbackground　│背景色の読み取り　　　　　　　　　　　│               
└─────────┴───────────────────┘               
                                                                             
  5.2　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.VDB_areascroll                                                              
部分スクロール                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 VDB_areascroll( direction, count, x1, y1, x2, y2 );                   
int 　 direction;             　　　　/*  0:上方向　　　　　　*/             
　　　　　　　　　　　　　　　　　　　/*　1:下方向　　　　　　*/             
　　　　　　　　　　　　　　　　　　　/*　2:右方向　　　　　　*/             
　　　　　　　　　　　　　　　　　　　/*　3:左方向　　　　　　*/             
int 　 count;                 　　　　/*  スクロール行/桁数　　*/            
int 　 x1;    　　　　　　　　　　　　/*  桁1位置(左上位置)　*/              
int 　 y1;    　　　　　　　　　　　　/*  行1位置(左上位置)　*/              
int 　 x2;    　　　　　　　　　　　　/*  桁2位置(右下位置)　*/              
int 　 y2;    　　　　　　　　　　　　/*  行2位置(右下位置)　*/              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int    direction, count, x1, y1, x2, y2, ret;                                
direction = 0;                                                               
count 　　= 2;                                                               
x1 = y1 = 2;                                                                 
x2 = 5;                                                                      
y2 = 4;                                                                      
                                                                             
ret = VDB_areascroll( direction, count, x1, y1, x2, y2 );                    
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を除く)の矩形域内にて、縦/横方向に指定された
行/桁数分スクロールします。directionの値が4以上の場合には､｢上方向へのスクロー
ル｣が指定されたものと見なされます。また、矩形域が文字ディスプレイ画面からはみ
出した場合、または行桁1が左上位置を、行桁2が右下位置を示していない場合には、 
エラーが通知され部分スクロールは行われません。スクロールにより消去された行ま 
たは桁には空白(00H/20H)とデフォルトアトリビュートが埋められます。カーソル位置
は変化しません。スクロール行/桁数に0、または矩形域の行/桁サイズ以上の値が指定
された場合には、矩形域全体に空白(00H/20H)とデフォルトアトリビュートが埋められ
ます。次頁に、上方向にスクロールする場合の例を示します。                     
                                                                             
┌───────────┐　　　　　┌───────────┐               
│行桁1　　　　　　　 　│　　　　　│行桁1　　　　　　　　 │               
││　┌─────┐　　│　　　　　││　┌─────┐　　│               
│└─→ＡＢＣＤＥ│　　│上へ1行　 │└─→ＦＧＨＩＪ│　　│               
│　　│ＦＧＨＩＪ←─┐│　→　　　│　　│　　　　　←─┐│               
│　　└─────┘　││スクロール│　　└─────┘　││               
│　　　　　　　　 行桁2│　　　　　│　　　　　　　　 行桁2│               
└───────────┘　　　　　└───────────┘               
                                                                             
-----------------------------------------------------------------------------
.VDB_clrarea                                                                 
矩形域の消去                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 VDB_clrarea( x1, y1, x2, y2 );                                        
int 　 x1;            　　　　　　　  /*  桁1位置(左上位置)  */              
int 　 y1;            　　　　　　　  /*  行1位置(左上位置)  */              
int 　 x2;            　　　　　　　  /*  桁2位置(右下位置)  */              
int 　 y2;            　　　　　　　  /*  行2位置(右下位置)  */              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int    x1, y1, x2, y2, ret ;                                                 
x1 = y1 = 2;                                                                 
x2 = 5;                                                                      
y2 = 4;                                                                      
                                                                             
ret = VDB_clrarea( x1, y1, x2, y2 );                                         
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を除く)の矩形域内の文字とアトリビュートを消 
去します。                                                                   
矩形域が文字ディスプレイ画面からはみ出した場合、または行桁1が左上位置を、行桁
2が右下位置を示していない場合には、エラーが通知され、矩形域の消去は行われませ
ん。矩形域には空白(00H/20H)とデフォルトアトリビュートが埋められます。        
ただし、矩形域の境界に漢字がまたがっていた場合には、消去後の表示は保証されま 
せん。                                                                       
                                                                             
-----------------------------------------------------------------------------
.VDB_cls                                                                     
全画面消去                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_cls( void );                                                     
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
VDB_cls();                                                                   
                                                                             
- 内容 -                                                                     
画面全体(システム行含む。但し、モード表示域を除く)に空白(00H/20H)と、デフォル
トアトリビュート(『デフォルトアトリビュートの設定:VDB_setdefatr』)を設定し   
て、カーソルを1行1桁目に移動します。ただし、画面サイズ･カーソル形状等の他の属
性は変更されません。                                                         
                                                                             
-----------------------------------------------------------------------------
.VDB_cpyarea                                                                 
矩形域の複写                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 VDB_cpyarea( sw, x1, y1, x2, y2, x3, y3 );                            
int 　 sw;            　　　/*  0:文字のみ複写　　　　　　　　*/             
　　　　　　　　　　  　　　/*  1:文字とアトリビュートを複写　*/             
int 　 x1;            　　　/*  桁1位置(複写元左上位置)　　　*/              
int 　 y1;            　　　/*  行1位置(複写元左上位置)　　　*/              
int 　 x2;            　　　/*  桁2位置(複写元右下位置)　　　*/              
int 　 y2;            　　　/*  行2位置(複写元右下位置)　　　*/              
int 　 x3;            　　　/*  桁3位置(複写先左上位置)　　　*/              
int 　 y3;            　　　/*  行3位置(複写先左上位置)　　　*/              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int    sw, x1, y1, x2, y2, x3, y3, ret ;                                     
sw = 0;                                                                      
x1 = y1 = 2;                                                                 
x2 = 5;                                                                      
y2 = 4;                                                                      
x3 = y3 = 4;                                                                 
                                                                             
ret = VDB_cpyarea( sw, x1, y1, x2, y2, x3, y3 );                             
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を除く)の矩形域内の文字のみ、または文字とア 
トリビュートを複写先へ複写します。swに2以上の値を設定した場合には、｢文字のみ 
複写｣が指定されたものと見なします。複写元･複写先の矩形域が文字ディスプレイ画 
面からはみ出した場合、または複写元の矩形域である行桁1が左上位置を、行桁2が右 
下位置を示していない場合には、エラーが通知され、矩形域の複写は行われません。 
文字のみ複写の場合にも文字属性は複写されます。複写元と複写先の矩形域が重なる 
場合には、次頁のように複写先の文字とアトリビュートが優先されます。ただし、以 
下のような場合には、複写後の表示は保証されません。                           
　･複写元の矩形域の境界に漢字がまたがっている。                              
　･複写後の矩形域の境界に漢字がまたがっている。                              
                                                                             
┌───────────┐　　　　　┌───────────┐               
 行桁1┌─────┐　　│　　　　　│　　┌─────┐　　│               
│└─→ＡＢＣＤＥ│　　│Ｈの位置へ│　　│ＡＢＣＤＥ└─┐│               
│　　│ＦＧＨＩＪ←─┐│　→　　　│　　│ＦＧＡＢＣＤＥ││               
│　　└──↑──┘　││　複写　　│　　└─┐ＦＧＨＩＪ││               
│　 行桁3─┘　　 行桁2│　　　　　│　　　　└─────┘│               
└───────────┘　　　　　└───────────┘               
                                                                             
-----------------------------------------------------------------------------
.VDB_init                                                                    
初期化                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_init( void );                                                    
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
VDB_init();                                                                  
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面を以下のように初期化するとともに、画面全体(システム行含む
)にスペース(20H) とデフォルトアトリビュートを設定します。                    
画面の表示状態　　　　　:　すべてのCRTに表示                                 
表示画面サイズ　　　　　:　80桁、25行                                        
デフォルトアトリビュート:　色識別番号:最大値(7:白色)                         
　　　　　　　　　　　　　　他の属性はOFF状態                                
カーソル形状　　　　　　:　低輝度、高速ブリンク                              
　　　　　　　　　　　　　　アンダーライン                                   
　　　　　　　　　　　　　　半角                                             
カーソル位置　　　　　　:　1行1桁目                                          
コンソール機能　　　　　:　オーダ動作する                                    
　　　　　　　　　　　　　　システム行あり                                   
　　　　　　　　　　　　　　空白文字は20H                                    
　　　　　　　　　　　　　　タブ有効                                         
　　　　　　　　　　　　　　CR(0DH)、LF(0AH)オーダは各々の動作               
タブ設定　　　　　　　　:　なし                                              
                                                                             
-----------------------------------------------------------------------------
.VDB_kind                                                                    
画面の表示制御                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_kind( mode );                                                    
unsigned int    mode;       /*  CRT制御フラグ  　　　　　　　　*/            
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
unsigned int    mode;                                                        
                                                                             
mode = 0x0005;　　　　　　　/*　グラフィック画面のみ表示　　　 */            
VDB_kind( mode );                                                            
                                                                             
- 内容 -                                                                     
各CRTに対するコンソール画面、および、グラフィック画面の表示と停止を制御します
。設定形式は、以下の通りです。                                               
　　　　7　6　5　4　3　2　1　0　　　　　　　　　　　　　　                   
　　　┌─┬─┬─┬─┬─┬─┬─┬─┐　　　　　　　　　　　　　           
 mode:│ 0│ 0│ 0│ 0│　│　│　│　│　　　　　　　　　　　　　           
　　　└─┴─┴─┴─┴┬┴┬┴┬┴┬┘　　　　　　　　　　　　　           
　　　　　　　　　　　　│　└─┼┬┘　　　　　　　　　　　　　　           
　　　　　　　　　　　　└┬──┘└──文字ディスプレイ画面の制御           
　　　　　　　　　　　　　│　　　　　　 00:表示する　　　　　　　           
　　　　　　　　　　　　　│　　　　　　 01:表示する　　　　　　　           
　　　　　　　　　　　　　│　　　　　　 10:表示する　　　　　　　           
　　　　　　　　　　　　　│　　　　　　 11:表示しない　　　　　　           
　　　　　　　　　　　　　└──────グラフィック画面の制御　　           
　　　　　　　　　　　　　　　　　　　　 00:表示する　　　　　　　           
　　　　　　　　　　　　　　　　　　　　 01:表示する　　　　　　　           
　　　　　　　　　　　　　　　　　　　　 10:表示する　　　　　　　           
　　　　　　　　　　　　　　　　　　　　 11:表示しない　　　　　　           
                                                                             
-----------------------------------------------------------------------------
.VDB_outchr                                                                  
文字の出力                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_outchr( moji );                                                  
char　　moji;           /*  文字コード(シフトjisコード、1byte)   */          
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
char    moji;                                                                
moji = 0x41;                                                                 
                                                                             
VDB_outchr( moji );                                                          
                                                                             
- 内容 -                                                                     
シフトjisコードによる文字の出力をカーソル位置に行います。                    
文字を画面(システム行を含む)に書き込む際には、ＪＩＳコードに変換した文字コー 
ドとともにデフォルトアトリビュートを使用します。文字には、オーダコードまたは 
エスケープシーケンスなどを含めることが可能です。エスケープシーケンスは、この 
機能を繰り返して使用すことにより、画面への操作が可能です。ただし、オーダおよ 
びエスケープシーケンスの動作は、『コンソール機能の設定:VDB_setcon』にて解除す
ることが可能です。                                                           
                                                                             
-----------------------------------------------------------------------------
.VDB_outstr                                                                  
文字列の出力                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_outstr( chrcnt, string );                                        
int 　　chrcnt;       　　　　　　    /*  出力文字数(バイト)*/               
char　　*string;      　　　　　　    /*  出力文字列格納領域　*/             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int     chrcnt;                                                              
char    string[10];                                                          
chrcnt = 10;                                                                 
string[0] = 0x41;                                                            
string[1] = 0x42;                                                            
   　 …                                                                     
                                                                             
VDB_outstr( chrcnt, string );                                                
                                                                             
- 内容 -                                                                     
シフトjisコード列からなる文字列の出力をカーソル位置から行います。            
文字列を画面(システム行を含む。但し、モード表示域を除く)に書き込む際には、Ｊ 
ＩＳコードに変換した文字コードとともにデフォルトアトリビュートを使用します。 
文字列には、オーダコードまたはエスケープシーケンスなどを含めることが可能であ 
り、以下のような形式にて指定します。ただし、オーダおよびエスケープシーケンス 
の動作は、『コンソール機能の設定:VDB_setcon』にて解除することが可能です。    
                                                                             
string　→┌─┬─┬──────────────┐───　　　　　           
　　　　 0│Ｅ│Ｂ│　文字コード　　　　　　　　│　↑　　　　　　           
　　　　　├─┼─┼──────────────┤　│　　　　　　           
　　　　 1│　│　│　　　　　　　　　　　　　　│　│ chrcnt byte           
　　　　　〜　　　　　上記繰り返し　　　　　　　〜　│　　　　　　           
　　　　　│　│　│　　　　　　　　　　　　　　│　↓　　　　　　           
　　　　　└─┴─┴──────────────┘───　　　　　           
                                                                             
-----------------------------------------------------------------------------
.VDB_rdarea                                                                  
矩形域の読み取り                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　  VDB_rdarea( sw, x1, y1, x2, y2, chrbuf, atrbuf );                    
int 　  sw;           　/*  0:文字のみ読み取り　　　　　　　　*/             
　　　　　　　　　　　　/*　1:文字とアトリビュートの読み取り　*/             
int 　  x1;           　/*  桁1位置(左上位置)　　　　　　　　*/              
int 　  y1;           　/*  行1位置(左上位置)　　　　　　　　*/              
int 　  x2;           　/*  桁2位置(右下位置)　　　　　　　　*/              
int 　  y2;           　/*  行2位置(右下位置)　　　　　　　　*/              
char　　*chrbuf;      　/*  文字コード格納領域　　　　　　　　　*/           
char　　*atrbuf;      　/*  文字属性格納領域　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int 　sw, x1, y1, x2, y2, ret;                                               
char  chrbuf[15], atrbuf[15];                                                
sw = 0;                                                                      
x1 = y1 = 2;                                                                 
x2 = 5;                                                                      
y2 = 4;                                                                      
                                                                             
ret = VDB_rdarea( sw, x1, y1, x2, y2, chrbuf, atrbuf );                      
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を含む)の矩形域内の文字のみ、または文字とア 
トリビュートを読み取ります。swに2以上の値を設定した場合には、｢文字のみの読み 
取り｣とみなされます。                                                        
矩形域が文字ディスプレイ画面からはみ出した場合、または行桁1が左上位置を、行桁
2が右下位置を示していない場合には、エラーが通知され矩形域の読み取りは行われま
せん。文字およびアトリビュートは、次頁のように、行桁1と行桁2で囲まれる矩形域 
に対して、折り返しながら読み取られます。                                     
                                                                             
　　　　　　　　　　　　文字ディスプレイ画面　                               
┌─────────────────────────────┐               
│ 行桁1┌─────────────────────┐　　　│               
│　└─→□←読み込み開始位置─────────→┐│　　　│               
│　　　│┌───────────────────┘│　　　│               
│　　　│└──────────────────→┐│　　　│               
│　　　│　　　　　　　　　…　　　　　　　　　　┘│　　　│               
│　　　│　─────────→読み込み終了位置→□←─┐　│               
│　　　└─────────────────────┘　│　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　 行桁2│               
└─────────────────────────────┘               
                                                                             
文字およびアトリビュートの指定形式は、以下の通りです。                       
                                                                             
〔文字のみの読み取りの場合〕                                                 
                                                                             
chrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｒ│Ｂ│　文字コード（ＪＩＳ）　　　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│　│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
atrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｒ│Ｂ│　文字属性　　　　　　　　　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│　│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
                                                                             
〔文字とアトリビュートの読み取りの場合〕                                     
                                                                             
chrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｒ│Ｂ│　文字コード(ＪＩＳ）　　 　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│Ｒ│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
atrbuf　→┌─┬─┬──────────────┐┐                         
　　　　 0│Ｒ│Ｂ│　文字属性　　　　　　　　　││1バイトの文字コ          
　　　　　│　├─┼──────────────┤│                         
　　　　 1│　│Ｂ│　表示属性　　　　　　　　　│├ードに対するアト         
　　　　　│　├─┼──────────────┤│                         
　　　　 2│　│Ｗ│　色識別番号　　　　　　　　││リビュート　　　         
　　　　　├─┼─┼──────────────┤┘                         
　　　　 4│Ｒ│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
                                                                             
■文字属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                           
└─┴─┴─┴─┴─┴─┴┬┴┬┘                                           
　　　　　　　　　　　　　│　└─半角/全角フラグ                            
　　　　　　　　　　　　　│　　　 0: 半角文字                               
　　　　　　　　　　　　　│　　　 1: 全角文字                               
　　　　　　　　　　　　　└───全角文字フラブ                             
　　　　　　　　　　　　　　　　　(bit0 = 1 にて有効)                        
　　　　　　　　　　　　　　　　　 0: 第1バイトコード                        
　　　　　　　　　　　　　　　　　 1: 第2バイトコード                        
                                                                             
■表示属性                                                                   
                                                                             
　 7 　6 　5 　4 　3 　2 　1 　0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│　│　│　│                                           
└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　│　│　│　│　│　│　└─アンダーライン                             
　│　│　│　│　│　│　└───オーバライン                               
　│　│　│　│　│　└─────垂線                                       
　│　│　│　│　└───────リバース                                   
　│　│　│　└─────────ブリンク                                   
　│　│　└───────────強調                                       
　│　└─────────────シークレット                               
　└───────────────アンダスコア                               
これらのアトリビュートがサポートされていないものについては、対応するビットの 
値は0が通知されます。                                                        
■色識別番号                                                                 
                                                                             
0:黒色、1:青色、2:赤色、3:紫色                                               
4:緑色、5:水色、6:黄色、7:白色                                               
                                                                             
-----------------------------------------------------------------------------
.VDB_rdatr                                                                   
アトリビュートの読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 VDB_rdatr( x, y, atr );                                               
int 　 x;                 　/*  桁位置(1〜)　　　    　　　  */              
int 　 y;                 　/*  行位置(1〜)　　　    　　　  */              
VDB_ATR 　 *atr;        　　/*  アトリビュート情報格納領域      */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int 　     x, y, ret;                                                        
VDB_ATR 　 atr;                                                              
x =  1;                                                                      
y = 10;                                                                      
                                                                             
ret = VDB_rdatr( x, y, &atr );                                               
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を含む)の指定行桁位置に設定されているアトリ 
ビュートを読み取ります。行桁位置に現在の文字ディスプレイ画面サイズよりも大き 
い値を指定した場合には、エラーが通知され、アトリビュートは読み取られません。 
格納領域には、以下の形式にて通知します。                                     
                                                                             
atr →┌─┬─┬──────────────┐                               
　 　0│Ｒ│Ｂ│　文字属性　　　　　　　　　│                               
　　　├─┼─┼──────────────┤                               
　 　1│Ｒ│Ｂ│　表示属性　　　　　　　　　│                               
　　　├─┼─┼──────────────┤                               
　 　2│Ｒ│Ｗ│　色識別番号　　　　　　　　│                               
　　　└─┴─┴──────────────┘                               
                                                                             
■文字属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                           
└─┴─┴─┴─┴─┴─┴┬┴┬┘                                           
　　　　　　　　　　　　　│　└─半角/全角フラグ                            
　　　　　　　　　　　　　│　　　 0: 半角文字                               
　　　　　　　　　　　　　│　　　 1: 全角文字                               
　　　　　　　　　　　　　└───全角文字フラブ                             
　　　　　　　　　　　　　　　　　(bit0 = 1 にて有効)                        
　　　　　　　　　　　　　　　　　 0: 第1バイトコード                        
　　　　　　　　　　　　　　　　　 1: 第2バイトコード                        
                                                                             
■表示属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│　│　│　│                                           
└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　│　│　│　│　│　│　└─アンダーライン                             
　│　│　│　│　│　│　└───オーバライン                               
　│　│　│　│　│　└─────垂線                                       
　│　│　│　│　└───────リバース                                   
　│　│　│　└─────────ブリンク                                   
　│　│　└───────────強調                                       
　│　└─────────────シークレット                               
　└───────────────アンダスコア                               
                                                                             
これらのアトリビュートがサポートされていないものについては、対応するビットの 
値は0が通知されます。                                                        
                                                                             
■色識別番号                                                                 
                                                                             
0:黒色、1:青色、2:赤色、3:紫色                                               
4:緑色、5:水色、6:黄色、7:白色                                               
                                                                             
-----------------------------------------------------------------------------
.VDB_rdatrarea                                                               
アトリビュート機能範囲の読み取り                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_rdatrarea( atr );                                                
VDB_ATR 　 *atr;          /*  アトリビュート情報格納領域　　　*/             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
VDB_ATR 　 atr;                                                              
                                                                             
VDB_rdatrarea( &atr );                                                       
                                                                             
- 内容 -                                                                     
コンソールが保持しているアトリビュートの機能範囲を通知します。               
格納領域には、以下の形式にて通知します。                                     
                                                                             
 atr　→┌─┬─┬──────────────┐                             
　　　 0│Ｒ│Ｂ│　文字属性　　　　　　　　　│                             
　　　　├─┼─┼──────────────┤                             
　　　 1│Ｒ│Ｂ│　表示属性　　　　　　　　　│                             
　　　　├─┼─┼──────────────┤                             
　　　 2│Ｒ│Ｗ│　最大色識別番号　　　　　　│                             
　　　　└─┴─┴──────────────┘                             
                                                                             
■文字属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                           
└─┴─┴─┴─┴─┴─┴┬┴┬┘                                           
　　　　　　　　　　　　　└┬┘                                             
　　　　　　　　　　　　　　└──漢字識別                                   
　　　　　　　　　　　　　　　　　 00:漢字識別不可                           
　　　　　　　　　　　　　　　　　 01:漢字第1バイト/第2バイト識別不可        
　　　　　　　　　　　　　　　　　 10:(リザーブ)                             
　　　　　　　　　　　　　　　　　 11:漢字第1バイト/第2バイト識別可          
                                                                             
アトリビュートの読み取りの際に、漢字識別が可能であるか否か、もし可能であるな 
らば、漢字の第1バイトと第2バイトの識別が可能であるか否かを通知します。       
                                                                             
■表示属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│　│　│　│                                           
└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　│　│　│　│　│　│　└─アンダーライン                             
　│　│　│　│　│　│　└───オーバライン                               
　│　│　│　│　│　└─────垂線                                       
　│　│　│　│　└───────リバース                                   
　│　│　│　└─────────ブリンク                                   
　│　│　└───────────強調                                       
　│　└─────────────シークレット                               
　└───────────────アンダスコア                               
                                                                             
各機能がある場合に、対応するビットの値を1として通知します。                  
これらのアトリビュートがサポートされていない機種については、対応するビットの 
値を0として通知します。                                                      
                                                                             
■最大色識別番号                                                             
                                                                             
アトリビュートとして色識別番号を設定する際の最大値を通知します。             
                                                                             
-----------------------------------------------------------------------------
.VDB_rdbackground                                                            
背景色の読み取り                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
unsigned int     VDB_rdbackground( void );                                   
                                                                             
- 戻り値 -                                                                   
背景色の色識別番号を返します。                                               
                                                                             
- 例 -                                                                       
unsigned int    color;                                                       
                                                                             
color = VDB_rdbackground();                                                  
                                                                             
- 内容 -                                                                     
背景色の読み取りを行います。                                                 
『ESCシーケンス:背景色の設定』で設定されている背景色を読み取ります。         
                                                                             
■色識別番号:0〜7                                                            
                                                                             
0:黒色、1:青色、2:赤色、3:紫色                                               
4:緑色、5:水色、6:黄色、7:白色                                               
                                                                             
ハードウェアに対して直接背景色の設定を行っている場合は、正常な読み取りができ 
ないことがあります。                                                         
                                                                             
-----------------------------------------------------------------------------
.VDB_rdchr                                                                   
文字の読み取り                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int    VDB_rdchr( x, y, chratr, moji );                                      
int 　 x;         　　　　  /*  桁位置(1〜)　　　　　　      */              
int 　 y;         　　　　  /*  行位置(1〜)　　　　　　      */              
int 　 *chratr;         　　/*  文字属性　　　　　　　　　　　  */           
int 　 *moji;           　　/*  文字コード(JISコード、1byte)　  */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int 　x, y, chratr, moji, ret;                                               
x =  1;                                                                      
y = 10;                                                                      
                                                                             
ret = VDB_rdchr( x, y, &chratr, &moji );                                     
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を含む)の指定行桁位置の文字をＪＩＳコードに 
て読み取るとともに、その文字属性も読み取ります。行桁位置に現在の文字ディスプ 
レイ画面サイズよりも大きい値を指定した場合には、エラーを通知し、文字は読み取 
られません。文字属性の通知形式は、以下のとおりです。                         
                                                                             
           7 　6 　5 　4 　3 　2 　1 　0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
 chratr:│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                   
　　　　└─┴─┴─┴─┴─┴─┴┬┴┬┘                                   
　　　　　　　　　　　　　　　　　│　└─半角/全角フラグ                    
　　　　　　　　　　　　　　　　　│　　　 0: 半角文字                       
　　　　　　　　　　　　　　　　　│　　　 1: 全角文字                       
　　　　　　　　　　　　　　　　　└───全角文字フラブ                     
　　　　　　　　　　　　　　　　　　　　　(bit0 = 1 にて有効)                
　　　　　　　　　　　　　　　　　　　　　 0: 第1バイトコード                
　　　　　　　　　　　　　　　　　　　　　 1: 第2バイトコード                
                                                                             
-----------------------------------------------------------------------------
.VDB_rdcon                                                                   
コンソール機能設定値の読み取り                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
unsigned int     VDB_rdcon( void );                                          
                                                                             
- 戻り値 -                                                                   
制御フラグを返します。                                                       
                                                                             
- 例 -                                                                       
unsigned int    flg;                                                         
                                                                             
flg = VDB_rdcon();                                                           
                                                                             
- 内容 -                                                                     
コンソール機能の設定値を、以下の制御フラグにて読み取ります。                 
                                                                             
　　　　 7　 6　 5　 4　 3　 2　 1　 0                                       
　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                     
 flg: │　│　│ 0│　│　│　│　│　│                                     
　　　└┬┴┬┴─┴┬┴┬┴┬┴┬┴┬┘                                     
　　　　│　│　　　└┬┘　│　│　└─CR&LF フラグ                         
　　　　│　│　　　　│　　│　└───TAB フラグ                           
　　　　│　│　　　　│　　└─────空白文字フラグ                       
　　　　│　│　　　　└────────パターンサイズ                       
　　　　│　└─────────────システム行フラグ                     
　　　　└───────────────オーダ動作フラグ                     
                                                                             
■オーダ動作フラグ                                                           
                                                                             
0:オーダおよびエスケープシーケンスの機能を無効にし、すべての文字を画面に出力 
  する                                                                       
1:オーダおよびエスケープシーケンスの機能を有効にする                         
                                                                             
■システム行フラグ                                                           
                                                                             
0:システム行なし                                                             
1:システム行あり                                                             
                                                                             
■空白文字フラグ                                                             
                                                                             
0:スペース(20H)                                                              
1:NULL(00H)                                                                  
                                                                             
■パターンサイズ                                                             
                                                                             
00:パターンサイズ1(全角:縦16横16、半角:縦 8横8)                              
01:パターンサイズ2(全角:縦16横16、半角:縦 8横8、縦16横8)                     
10:パターンサイズ3(全角:縦24横24、半角:縦24横12)                             
11:パターンサイズ4(リザーブ)                                                 
                                                                             
■TABフラグ                                                                  
                                                                             
0:タブを空白(00H/20H)に置き換える                                            
1:タブ(09H)を有効にする                                                      
                                                                             
■CR&LFフラグ                                                                
                                                                             
0:CR、LF各々の動作を行う                                                     
1:CR(0DH)あるいはLF(0AH)に対して、CR,LF両方の動作を同時に行う。              
                                                                             
なお、TAB, CR&LFフラグともにオーダ動作フラグが1の場合、有効となります。      
                                                                             
-----------------------------------------------------------------------------
.VDB_rdcusmd                                                                 
カーソル表示状態の読み取り                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　  VDB_rdcusmd( void );                                                 
                                                                             
- 戻り値 -                                                                   
0:カーソルは表示中                                                           
1:カーソルは非表示                                                           
                                                                             
- 例 -                                                                       
int    sw;                                                                   
                                                                             
sw = VDB_rdcusmd();                                                          
                                                                             
- 内容 -                                                                     
カーソルの表示状態を読み取ります。                                           
                                                                             
-----------------------------------------------------------------------------
.VDB_rdcustype                                                               
カーソル形状の読み取り                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
unsigned int     VDB_rdcustype( startraster, endraster );                    
int 　　　　    *startraster; /*  スタートラスタ　　　　　　　    */         
　　　　　　　　　　　　　　　/*  (カーソルタイプが拡張形式の                
　　　　　　　　　　　　　　　　　　場合に有効)　　　　　　　　　*/          
int 　　　　    *endraster;   /*  エンドラスタ　　　　　　　　    */         
　　　　　　　　　　　　　　　/*　(カーソルタイプが拡張形式の                
　　　　　　　　　　　　　  　　　　場合に有効)　　　　　　　　　*/          
                                                                             
- 戻り値 -                                                                   
カーソルタイプを返します。                                                   
                                                                             
- 例 -                                                                       
unsigned int    type;                                                        
int 　　　　    startraster, endraster;                                      
                                                                             
type = VDB_rdcustype( &startraster, &endraster );                            
                                                                             
- 内容 -                                                                     
現在、設定されているカーソルの形状を通知します。                             
通知形式は、以下の通りです。                                                 
                                                                             
　　　　 7　 6　 5　 4　 3　 2　 1　 0                                       
　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                     
type: │　│　│　│　│　│　│　│　│                                     
　　　└┬┴┬┴┬┴┬┴┬┴─┴─┴┬┘                                     
　　　　│　└┬┘　│　└──┬──┘                                       
　　　　│　　│　　│　　　　└────カーソル形状                         
　　　　│　　│　　│　　　　　　　　　 0000:アンダーライン（＿）           
　　　　│　　│　　│　　　　　　　　　 0001:ボックス（■）                 
　　　　│　　│　　│　　　　　　　　　 1111:拡張形式                       
　　　　│　　│　　└─────────輝度                                 
　　　　│　　│　　　　　　　　　　　　 0:低輝度                            
　　　　│　　│　　　　　　　　　　　　 1:高輝度                            
　　　　│　　└────────────カーソルブリンク                     
　　　　│　　　　　　　　　　　　　　　 00:ブリンクなし                     
　　　　│　　　　　　　　　　　　　　　 01:カーソル非表示                   
　　　　│　　　　　　　　　　　　　　　 10:高速ブリンク                     
　　　　│　　　　　　　　　　　　　　　 11:低速ブリンク                     
　　　　└───────────────カーソルサイズ                       
　　　　　　　　　　　　　　　　　　　　 0:半角                              
　　　　　　　　　　　　　　　　　　　　 1:全角                              
                                                                             
拡張形式が通知された場合には、スタートラスタとエンドラスタにて囲まれるボック 
スカーソルを表示し、スタートラスタの値は常にエンドラスタの値以下になります。 
                                                                             
-----------------------------------------------------------------------------
.VDB_rddefatr                                                                
デフォルトアトリビュートの読み取り                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　  VDB_rddefatr( atr );                                                 
VDB_ATR 　 *atr;          /*  アトリビュート情報格納領域　　　*/             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
VDB_ATR 　 atr;                                                              
                                                                             
VDB_rddefatr( &atr );                                                        
                                                                             
- 内容 -                                                                     
設定されているデフォルトアトリビュートを読み取ります。                       
デフォルトアトリビュートの指定形式は、以下の通りです。                       
                                                                             
 atr　→┌─┬─┬──────────────┐                             
　　　 0│Ｒ│Ｂ│　リザーブ　　　　　　　　　│                             
　　　　├─┼─┼──────────────┤                             
　　　 1│Ｒ│Ｂ│　表示属性　　　　　　　　　│                             
　　　　├─┼─┼──────────────┤                             
　　　 2│Ｒ│Ｗ│　色識別番号　　　　　　　　│                             
　　　　└─┴─┴──────────────┘                             
                                                                             
■表示属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│　│　│　│                                           
└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　│　│　│　│　│　│　└─アンダーライン                             
　│　│　│　│　│　│　└───オーバライン                               
　│　│　│　│　│　└─────垂線                                       
　│　│　│　│　└───────リバース                                   
　│　│　│　└─────────ブリンク                                   
　│　│　└───────────強調                                       
　│　└─────────────シークレット                               
　└───────────────アンダスコア                               
                                                                             
これらのアトリビュートがサポートされていないものについては、対応するビットの 
値は0が通知されます。                                                        
■色識別番号                                                                 
                                                                             
0:黒色、1:青色、2:赤色、3:紫色                                               
4:緑色、5:水色、6:黄色、7:白色                                               
                                                                             
-----------------------------------------------------------------------------
.VDB_rdfont                                                                  
フォントパターンの取り出し                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　VDB_rdfont( x, y, moji, pattern );                                     
int 　　　　　  x;          /*  横のドット数　　　　　　　　　　*/           
int 　　　　　  y;          /*  縦のドット数　　　　　　　　　　*/           
unsigned int    moji;       /*  文字コード(JISコード、2byte)   */            
char　　　　　  *pattern;   /*  パターン格納領域　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:指定された文字コードに対するドット数が異常                                 
                                                                             
- 例 -                                                                       
int 　          x, y, ret;                                                   
unsigned int    moji;                                                        
char　　　　    pattern[8];                                                  
x = y = 8;                                                                   
moji = 0x0041;              /*  A         　　                  */           
                                                                             
ret = VDB_rdfont( x, y, moji, pattern );                                     
                                                                             
- 内容 -                                                                     
文字コードに対応するフォントパターンを通知します。                           
文字コードは、以下の形式にて指定します。                                     
                                                                             
■英数カナ、グラフィック文字                                                 
                                                                             
bit15-8:00Ｈ                                                                 
bit7-0 :文字コード                                                           
                                                                             
■漢字                                                                       
                                                                             
bit15-8:漢字第2バイトコード                                                  
bit7-0 :漢字第1バイトコード                                                  
                                                                             
フォントパターンサイズには、以下の値が設定可能です。他の値を設定した場合には 
エラーが通知され、フォントパターンの取り出しは行われません。可能なフォントパ 
ターンサイズは『コンソール機能設定値の読み取り:VDB_rdcon』で通知されます。   
                                                                             
■パターンサイズ1                                                            
                                                                             
英数カナ、グラフィック文字:縦 8、横 8                                        
漢字　　　　　　　　　　　:縦16、横16                                        
                                                                             
■パターンサイズ2                                                            
                                                                             
英数カナ、グラフィック文字:縦 8、横 8、及び、縦16、横 8                      
漢字　　　　　　　　　　　:縦16、横16                                        
                                                                             
■パターンサイズ3                                                            
                                                                             
英数カナ、グラフィック文字:縦24、横12                                        
漢字　　　　　　　　　　　:縦24、横24                                        
                                                                             
フォントパターンの通知形式は、以下の例のように、文字の左上の位置から順に右方 
向に指定します。                                                             
パターンサイズ1、2の例:                                                      
                                                                             
　　フォントパターン　　　　　　　　パターン格納領域 (pattern)               
　　76543210                                                                 
　┌────────┐　　　　　　　　　┌─────┐                       
 0│　　　■■　　　│　　　　　　　　 0│　18Ｈ　  │                       
 1│　　■　　■　　│　　　　　　　　 1│　24Ｈ　  │                       
 2│　■　　　　■　│　　　　　　　　 2│　42Ｈ　  │                       
 3│　■■■■■■　│　　　　　　　　 3│　7EＨ  　│                       
 4│　■　　　　■　│　　　　　　　　 4│　42Ｈ  　│                       
 5│　■　　　　■　│　　　　　　　　 5│　42Ｈ  　│                       
 6│　■　　　　■　│　　　　　　　　 6│　42Ｈ  　│                       
 7│　　　　　　　　│　　　　　　　　 7│　00Ｈ  　│                       
　└────────┘　　　　　　　　　└─────┘                       
（ﾌｫﾝﾄﾊﾟﾀｰﾝｻｲｽﾞ 8×8の場合:パターン格納領域サイズ　8byte）                   
                                                                             
　　フォントパターン　　　　　　　　パターン格納領域 (pattern)               
                                                                             
　　76543210                                                                 
　┌────────┐　　　　　　　　　┌─────┐                       
 0│　　　　　　　　│　　　　　　　　 0│　  00Ｈ　│                       
 1│　　　■　　　　│　　　　　　　　 1│　  10Ｈ　│                       
 2│　　■　■　　　│　　　　　　　　 2│　  28Ｈ　│                       
 3│　　■　■　　　│　　　　　　　　 3│　  28Ｈ　│                       
 4│　　■　■　　　│　　　　　　　　 4│　  28Ｈ　│                       
 5│　■　　　■　　│　　　　　　　　 5│　  44Ｈ　│                       
 6│　■　　　■　　│　　　　　　　　 6│　  44Ｈ　│                       
 7│　■　　　■　　│　　　　　　　　 7│　  44Ｈ　│                       
 8│　■　　　■　　│　　　　　　　　 8│　  44Ｈ　│                       
 9│■　　　　　■　│　　　　　　　　 9│　  82Ｈ　│                       
10│■■■■■■■　│　　　　　　　　10│　  FEＨ　│                       
11│■　　　　　■　│　　　　　　　　11│　  82Ｈ　│                       
12│■　　　　　■　│　　　　　　　　12│　  82Ｈ　│                       
13│■　　　　　■　│　　　　　　　　13│　  82Ｈ　│                       
14│　　　　　　　　│　　　　　　　　14│　  00Ｈ　│                       
15│　　　　　　　　│　　　　　　　　15│  　00Ｈ　│                       
　└────────┘　　　　　　　　　└─────┘                       
（ﾌｫﾝﾄﾊﾟﾀｰﾝｻｲｽﾞ 16×8の場合:パターン格納領域サイズ　16byte）                 
                                                                             
　　　フォントパターン　　　　　　　　パターン格納領域 (pattern)             
                                                                             
　　15　　　　　　 8 7　　　　　　 0　　　　　ｎ　　ｎ＋1                    
　┌────────────────┐　　┌────┬────┐             
 0│　　　　　　　■　　　　　　　　│　 0│　 01Ｈ │  00Ｈ　│             
 1│■■■■■■■■■■■■■■■　│　 2│　 FFＨ │  FEＨ　│             
 2│■　　　　　　　　　　　　　■　│　 4│　 80Ｈ │  02Ｈ　│             
 3│■　■■■■■■■■■■■　■　│　 6│　 BFＨ │  FAＨ　│             
 4│　　　　　　　　　　　　　　　　│　 8│　 00Ｈ │  00Ｈ　│             
 5│　　　■■■■■■■■■　　　　│　10│　 1FＨ │  F0Ｈ　│             
 6│　　　■　　　　　　　■　　　　│　12│　 10Ｈ │  10Ｈ　│             
 7│　　　■■■■■■■■■　　　　│　14│　 1FＨ │  F0Ｈ　│             
 8│　　　　　　　　　　　　　　　　│　16│　 00Ｈ │  00Ｈ　│             
 9│　　■■■■■■■■■■■　　　│　18│　 3FＨ │  F8Ｈ　│             
10│　　■　　　　■　　　　■　　　│　20│　 21Ｈ │  08Ｈ　│             
11│　　■　　　　■　　　　■　　　│　22│　 21Ｈ │  08Ｈ　│             
12│　　■■■■■■■■■■■　　　│　24│　 3FＨ │  F8Ｈ　│             
13│　　■　　　　■　　　　■　　　│　26│　 21Ｈ │  08Ｈ　│             
14│　　■　　　　■　　　　■　　　│　28│　 21Ｈ │  08Ｈ　│             
15│　　■■■■■■■■■■■　　　│　30│　 3FＨ │  F8Ｈ　│             
　└────────────────┘　　└────┴────┘             
　（ﾌｫﾝﾄﾊﾟﾀｰﾝｻｲｽﾞ 16×16の場合:パターン格納領域サイズ　32byte）              
                                                                             
パターンサイズ3の例:                                                         
                                                                             
　　　　　　　　フォントパターン　　　　　　　　パターン格納領域 (pattern)   
                                                                             
　　23　　　　　　1615　　　　　　 8 7　　　　　　  0　　　　 n   n+1   n+2  
　┌────────────────────────┐ 　┌──┬──┬──┐
 0│                                                │  0│ 00H│ 00H│ 00H│
 1│　　　　　　　　　　■■■　　　　　　　　　　　│  3│ 00H│ 38H│ 00H│
 2│　　　■　　　　　　　■■　　　　　　　■　　　│  6│ 10H│ 18H│ 08H│
 3│　　　■■■■■■■■■■■■■■■■■■■　　│  9│ 1FH│ FFH│ FCH│
 4│　　■■　　　　　　　　　　　　　　　　■■■　│ 12│ 30H│ 00H│ 0EH│
 5│　■■　　　　　　　　　　　　　　■■　■　　　│ 15│ 60H│ 00H│ 68H│
 6│　■■　■■■■■■■■■■■■■■■■　　　　│ 18│ 6FH│ FFH│ F0H│
 7│　　　　　　　　　　　　　　　　　　　　　　　　│ 21│ 00H│ 00H│ 00H│
 8│　　　　　■■　　　　　　　　　■■　　　　　　│ 24│ 06H│ 00H│ C0H│
 9│　　　　　　■■■■■■■■■■■■■　　　　　│ 27│ 03H│ FFH│ E0H│
10│　　　　　　■■　　　　　　　　■■　　　　　　│ 30│ 03H│ 00H│ C0H│
11│　　　　　　■■　　　　　　　　■■　　　　　　│ 33│ 03H│ 00H│ C0H│
12│　　　　　　■■■■■■■■■■■■　　　　　　│ 36│ 03H│ FFH│ C0H│
13│　　　　　　　　　　　　　　　　　　　　　　　　│ 39│ 00H│ 00H│ 00H│
14│　　　■■　　　　　　　　　　　　　■■　　　　│ 42│ 18H│ 00H│ 30H│
15│　　　　■■■■■■■■■■■■■■■■■　　　│ 45│ 1FH│ FFH│ F8H│
16│　　　　■■　　　　　■■　　　　　■■　　　　│ 48│ 1CH│ 18H│ 30H│
17│　　　　■■　　　　　■■　　　　　■■　　　　│ 51│ 1CH│ 18H│ 30H│
18│　　　　■■■■■■■■■■■■■■■■　　　　│ 54│ 1FH│ FFH│ F0H│
19│　　　　■■　　　　　■■　　　　　■■　　　　│ 57│ 1CH│ 18H│ 30H│
20│　　　　■■　　　　　■■　　　　　■■　　　　│ 60│ 1CH│ 18H│ 30H│
21│　　　　■■■■■■■■■■■■■■■■　　　　│ 63│ 1FH│ FFH│ 0FH│
22│　　　　■■　　　　　　　　　　　　■■　　　　│ 66│ 1CH│ 00H│ 30H│
23│　　　　　　　　　　　　　　　　　　　　　　　　│ 69│ 00H│ 00H│ 00H│
　└────────────────────────┘ 　└──┴──┴──┘
　　　　　　（ﾌｫﾝﾄﾊﾟﾀｰﾝｻｲｽﾞ 24×24の場合:パターン格納領域サイズ　72byte）    
                                                                             
　　　　フォントパターン　　　　　　　　パターン格納領域 (pattern)           
                                                                             
　　15　　　　　　 8 7　  4　 3　   0　　　　　　ｎ　　  ｎ＋1               
　┌────────────┬────┐　　┌────┬────┐           
 0│　　　　　　　　　　　　│　　　　│　 0│　 00Ｈ │  00Ｈ　│           
 1│　　　　　　　　　　　　│　　　　│　 2│　 00Ｈ │  00Ｈ　│           
 2│　　　　　　　　　　　　│　　　　│　 4│　 00Ｈ │  00Ｈ　│           
 3│　　　　　　　　　　　　│　　　　│　 6│　 00Ｈ │  00Ｈ　│           
 4│　　　　　　　　　　　　│　　　　│　 8│　 00Ｈ │  00Ｈ　│           
 5│　　　　　■■　　　　　│　　　　│　10│　 06Ｈ │  00Ｈ　│           
 6│　　　　■■■■　　　　│　　　　│　12│　 0FＨ │  00Ｈ　│           
 7│　　　　■　■■　　　　│　　　　│　14│　 0BＨ │  00Ｈ　│           
 8│　　　　■　■■　　　　│　　　　│　16│　 0BＨ │  00Ｈ　│           
 9│　　　　■　■■　　　　│　　　　│　18│　 0BＨ │  00Ｈ　│           
10│　　　■■　　■■　　　│　　　　│　20│　 19Ｈ │  80Ｈ　│           
11│　　　■　　　■■　　　│　　　　│　22│　 11Ｈ │  80Ｈ　│           
12│　　　■　　　■■　　　│　　　　│　24│　 11Ｈ │  80Ｈ　│           
13│　　　■　　　■■　　　│　　　　│　26│　 11Ｈ │  80Ｈ　│           
14│　　　■　　　■■　　　│　　　　│　28│ 　11Ｈ │  80Ｈ　│           
15    　■■■■■■■■　　│　　　　│　30│　 3FＨ │  C0Ｈ　│           
16│　　■　　　　　■■　　│　　　　│　32│　 20Ｈ │  C0Ｈ　│           
17│　　■　　　　　■■　　│　　　　│　34│　 20Ｈ │  C0Ｈ　│           
18│　　■　　　　　■■　　│　　　　│　36│　 20Ｈ │  C0Ｈ　│           
19│　　■　　　　　■■　　│　　　　│　38│　 20Ｈ │  C0Ｈ　│           
20│　■■■　　　■■■■　│　　　　│　40│　 71Ｈ │  E0Ｈ　│           
21│　　　　　　　　　　　　│　　　　│　42│　 00Ｈ │  00Ｈ　│           
22│　　　　　　　　　　　　│　　　　│　44│　 00Ｈ │  00Ｈ　│           
23│　　　　　　　　　　　　│　　　　│　46│　 00Ｈ │  00Ｈ　│           
　└────────────┴────┘　　└────┴────┘           
　　（ﾌｫﾝﾄﾊﾟﾀｰﾝｻｲｽﾞ 24×12の場合:パターン格納領域サイズ　48byte）            
                                                                             
-----------------------------------------------------------------------------
.VDB_rdposcus                                                                
カーソル位置の読み取り                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　  VDB_rdposcus( x, y );                                                
int 　 *x;              　　/*  桁位置　　*/                                 
int 　 *y;              　　/*  行位置　　*/                                 
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int    x, y;                                                                 
                                                                             
VDB_rdposcus( &x, &y );                                                      
                                                                             
- 内容 -                                                                     
現在のカーソル位置を読み取ります。                                           
                                                                             
-----------------------------------------------------------------------------
.VDB_rdsize                                                                  
表示画面サイズの読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_rdsize( x, y );                                                  
int 　 *x;              　　/*  桁数　　*/                                   
int 　 *y;              　　/*  行数　　*/                                   
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int 　 x, y;                                                                 
                                                                             
VDB_rdsize( &x, &y );                                                        
                                                                             
- 内容 -                                                                     
現在のコンソール画面の行数と桁数を通知します。                               
                                                                             
-----------------------------------------------------------------------------
.VDB_screensize                                                              
表示画面サイズレパートリの読み取り                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_screensize( screen );                                            
char　　*screen;            /*  画面サイズ格納領域　　　　　　　*/           
                            /*  (領域サイズをセットする)　　　*/             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
- 例 -                                                                       
char  screen[10];                                                            
screen[0] = 10-1;                                                            
                                                                             
VDB_screensize( screen );                                                    
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面にて設定可能な画面サイズのレパートリを通知します。       
格納領域には、以下に示す形式にて通知します。                                 
                                                                             
 screen →┌─┬─┬──────────────┐　　　　                   
　　　　 0│Ｅ│Ｂ│　領域サイズ（バイト）　　　│───┐                   
　　　　　├─┼─┼──────────────┤───│                   
　　　　 1│Ｒ│Ｂ│　レパートリ数（ｎ）　　　　│　↑　│                   
　　　　　├─┼─┼──────────────┤　│　│                   
　　　　 2│　│　│　桁数（1番目）　　　　　　 │　│　│                   
　　　　　│Ｒ│Ｗ├──────────────┤　│　│                   
　　　　 3│　│　│　行数（1番目）　　　　　 　│　│　│                   
　　　　　├─┼─┼──────────────┤　│←┘                   
　　　　　│　│　│　　　　　　　　　　　　　　│　│　　                   
　　　　　├─┼─┼──────────────┤　│　　                   
　　　　2n│　│　│　桁数（ｎ番目）　　　　　　│　│　　                   
　　　　　│Ｒ│Ｗ├──────────────┤　│　　                   
　　　2n+1│　│　│　行数（ｎ番目）　　　　　　│　│　　                   
　　　　　├─┼─┼──────────────┤　│　　                   
　　　　　│　│　│　（値は不定）　　　　　　　│　↓　　                   
　　　　　└─┴─┴──────────────┘───　                   
                                                                             
レパートリを通知する格納領域サイズが小さい場合には、格納可能な値のみ通知しま 
す(格納領域に続くメモリを破壊することはありません)。大きい場合には、レパート 
リ数を越える領域の内容は不定(呼び出し時の値のまま)です。                     
                                                                             
-----------------------------------------------------------------------------
.VDB_scroll                                                                  
全画面スクロール                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void   VDB_scroll( direction, count );                                       
int 　 direction;               　　　/*  0:上方向　　　　　*/               
　　　　　　　　　　　　　      　　　/*  1:下方向　　　　　*/               
　　　　　　　　　　　　　      　　　/*  2:右方向　　　　　*/               
　　　　　　　　　　　　　      　　　/*  3:左方向　　　　　*/               
int 　 count;                   　　　/*  スクロール行/桁数　*/              
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int 　 direction, count;                                                     
direction = 0;                                                               
count 　　= 5;                                                               
                                                                             
VDB_scroll( direction, count );                                              
                                                                             
- 内容 -                                                                     
画面全体(システム行を除く)を縦/横方向に指定された行/桁数分スクロールします。 
directionの値が4以上の場合には、｢上方向へのスクロール｣が指定されたものと見な 
されます。                                                                   
スクロールにより消去された行または桁には空白(00H/20H)とデフォルトアトリビュー
トが埋められます。カーソル位置は変化しません。スクロール行/桁数に0、または画 
面行/桁サイズ以上の値が指定された場合には、システム行を含まない画面の消去とみ
なし、空白(00H/20H)とデフォルトアトリビュートを書き込みます。                
                                                                             
-----------------------------------------------------------------------------
.VDB_setarea                                                                 
矩形域の設定                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　  VDB_setarea( sw, x1, y1, x2, y2, chrbuf, atrbuf );                   
int 　  sw;           　　　/*  0:文字のみ設定　　　　　　　　*/             
　　　　　　　　　　  　　　/*  1:文字とアトリビュートを設定　*/             
int 　  x1;           　　　/*  桁1位置(左上位置)　　　　　　*/              
int 　  y1;           　　　/*  行1位置(左上位置)　　　　　　*/              
int 　  x2;           　　　/*  桁2位置(右下位置)　　　　　　*/              
int 　  y2;           　　　/*  行2位置(右下位置)　　　　　　*/              
char　　*chrbuf;      　　　/*  文字コード格納領域　　　　　　　*/           
char　　*atrbuf;      　　　/*  文字属性格納領域　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int 　sw, x1, y1, x2, y2, ret;                                               
char  chrbuf[15], atrbuf[15];                                                
sw = 0;                                                                      
x1 = y1 = 2;                                                                 
x2 = 5;                                                                      
y2 = 4;                                                                      
chrbuf[0] = 0x41;                                                            
chrbuf[1] = 0x42;                                                            
　　　…                                                                     
atrbuf[0] = 0x00;                                                            
atrbuf[1] = 0x00;                                                            
　　　…                                                                     
ret = VDB_setarea( sw, x1, y1, x2, y2, chrbuf, atrbuf );                     
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を除く)の矩形域に文字のみ、または文字とアト 
リビュートを設定します。swに2以上の値を設定した場合には、｢文字のみ設定｣とみな
されます。                                                                   
矩形域が文字ディスプレイ画面からはみ出した場合、または行桁1が左上位置を、行桁
2が右下位置を示していない場合には、エラーが通知され矩形域の設定は行われません
。文字およびアトリビュートは、次のように行桁1と行桁2で囲まれる矩形域に対して 
折り返しながら書き込まれます。                                               
                                                                             
　　　　　　　　　　　文字ディスプレイ画面                                   
┌─────────────────────────────┐               
│ 行桁1┌─────────────────────┐　　　│               
│　└─→□←書き込み開始位置─────────→┐│　　　│               
│　　　│┌───────────────────┘│　　　│               
│　　　│└──────────────────→┐│　　　│               
│　　　│　　　　　　　　　…　　　　　　　　　　┘│　　　│               
│　　　│　─────────→書き込み終了位置→□←─┐　│               
│　　　└─────────────────────┘　│　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　 行桁2│               
└─────────────────────────────┘               
                                                                             
文字およびアトリビュートの指定形式は、以下のとおりです。                     
                                                                             
〔文字のみの設定の場合〕                                                     
                                                                             
chrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｅ│Ｂ│　文字コード（ＪＩＳ）　　　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│　│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
atrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｅ│Ｂ│　文字属性　　　　　　　　　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│　│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
                                                                             
〔文字とアトリビュートの設定の場合〕                                         
                                                                             
chrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｅ│Ｂ│　文字コード（ＪＩＳ）　　　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│Ｅ│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
atrbuf　→┌─┬─┬──────────────┐┐                         
　　　　 0│Ｅ│Ｂ│　文字属性　　　　　　　　　││1バイトの文字コ          
　　　　　│　├─┼──────────────┤│                         
　　　　 1│　│Ｂ│　表示属性　　　　　　　　　│├ードに対するアト         
　　　　　│　├─┼──────────────┤│                         
　　　　 2│　│Ｗ│　色識別番号　　　　　　　　││リビュート               
　　　　　├─┼─┼──────────────┤┘                         
　　　　 4│Ｅ│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
                                                                             
■文字属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                           
└─┴─┴─┴─┴─┴─┴┬┴┬┘                                           
　　　　　　　　　　　　　│　└─半角/全角フラグ                            
　　　　　　　　　　　　　│　　　 0: 半角文字                               
　　　　　　　　　　　　　│　　　 1: 全角文字                               
　　　　　　　　　　　　　└───全角文字フラブ                             
　　　　　　　　　　　　　　　　　(bit0 = 1 にて有効)                        
　　　　　　　　　　　　　　　　　 0: 第1バイトコード                        
　　　　　　　　　　　　　　　　　 1: 第2バイトコード                        
                                                                             
なお、全角第1バイトに続いてさらに全角第1バイトが続く場合、または漢字コードが 
ＪＩＳコードの範囲外である場合のようなエラー事象(不正な値の設定)に対してのチ 
ェックは行いません。矩形域の境界に全角文字が書き込まれていた場合、書き換えら 
れない全角の第1バイトまたは第2バイトは、そのままの値が保持されます。不正な値 
が設定された場合、その表示は保証されません。                                 
                                                                             
■表示属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│　│　│　│                                           
└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　│　│　│　│　│　│　└─アンダーライン                             
　│　│　│　│　│　│　└───オーバライン                               
　│　│　│　│　│　└─────垂線                                       
　│　│　│　│　└───────リバース                                   
　│　│　│　└─────────ブリンク                                   
　│　│　└───────────強調                                       
　│　└─────────────シークレット                               
　└───────────────アンダスコア                               
                                                                             
これらのアトリビュートがサポートされていないものについては、対応するビットの 
設定値は無視されます。                                                       
                                                                             
■色識別番号                                                                 
                                                                             
0:黒色、1:青色、2:赤色、3:紫色                                               
4:緑色、5:水色、6:黄色、7:白色                                               
                                                                             
-----------------------------------------------------------------------------
.VDB_setatr                                                                  
アトリビュートの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　      VDB_setatr( x, y, atr );                                         
int 　　　  x;              /*  桁位置(1〜)　　　　　　　*/                  
int 　　　  y;              /*  行位置(1〜)　　　　　　　*/                  
VDB_ATR 　 *atr;      　    /*  アトリビュート情報格納領域   */              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int        x, y, ret;                                                        
VDB_ATR 　 atr;                                                              
x =  1;                                                                      
y = 10;                                                                      
atr.charatr = 0x00;                                                          
atr.dispatr = 0x38; 　　　　/*  強調、ブリンク、リバース　　*/               
atr.colot 　= 0x0007; 　　　/*  白色              　　　　　*/               
                                                                             
ret = VDB_setatr( x, y, &atr );                                              
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を含む。但し、モード表示域を除く)の指定行桁 
位置に、アトリビュートを設定します。行桁位置に現在の文字ディスプレイ画面サイ 
ズよりも大きい値を指定した場合には、エラーを通知し、アトリビュートは設定しま 
せん。アトリビュートの指定形式は、以下のとおりです。                         
                                                                             
 atr  →┌─┬─┬──────────────┐                             
　　　 0│Ｅ│Ｂ│（リザーブ）　　　　　　　　│                             
　　　　├─┼─┼──────────────┤                             
　　　 1│Ｅ│Ｂ│　表示属性　　　　　　　　　│                             
　　　　├─┼─┼──────────────┤                             
　　　 2│Ｅ│Ｗ│　色識別番号　　　　　　　　│                             
　　　　└─┴─┴──────────────┘                             
                                                                             
■表示属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│　│　│　│                                           
└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　│　│　│　│　│　│　└─アンダーライン                             
　│　│　│　│　│　│　└───オーバライン                               
　│　│　│　│　│　└─────垂線                                       
　│　│　│　│　└───────リバース                                   
　│　│　│　└─────────ブリンク                                   
　│　│　└───────────強調                                       
　│　└─────────────シークレット                               
　└───────────────アンダスコア                               
                                                                             
これらのアトリビュートがサポートされていないものについては、その設定は無視さ 
れます。                                                                     
                                                                             
■色識別番号                                                                 
                                                                             
0:黒色、1:青色、2:赤色、3:紫色                                               
4:緑色、5:水色、6:黄色、7:白色                                               
                                                                             
-----------------------------------------------------------------------------
.VDB_setchr                                                                  
文字の設定                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 VDB_setchr( sw, chratr, moji, x, y );                                 
int 　 sw;                /*  0:デフォルトアトリビュートにて                 
　　　　　　　　　　　　　　　　　書き込む　　　　　　　　　　　*/           
　　　　　　　　　　　　　/*　1:アトリビュートを書き換えない　  */           
int 　 chratr;      　　　/*  文字属性 (1byte)　　　　　　  　  */           
int 　 moji;      　　　　/*  文字コード(JISコード、1byte)  　  */           
int 　 x;       　　　　　/*  桁位置(1〜)　　　　　　　  　     */           
int 　 y;       　　　　　/*  行位置(1〜)　　　　　　　  　     */           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int    sw, chratr, moji, x, y, ret;                                          
sw = 1;                                                                      
chratr = 0x0000;                                                             
moji   = 0x0041;                                                             
x =  1;                                                                      
y = 10;                                                                      
                                                                             
ret = VDB_setchr( sw, chratr, moji, x, y );                                  
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上(システム行を含む。但し、モード表示域を除く)の指定行桁 
位置に1バイトの文字コード(ＪＩＳコード)を書き込みます。文字コードの書き込みの
際、『デフォルトアトリビュートの設定　:VDB_setdefatr 』にて設定された表示属性
色識別番号にてアトリビュートを書き換えるか、すでに指定行桁に設定されているア 
トリビュートのままにするかが指定可能です。swに2以上の値を設定した場合には、  
｢デフォルトアトリビュートにて書き込む｣が指定されたものと見なします。文字属性 
は、文字コードとともに指定されます。行桁位置に現在の文字ディスプレイ画面サイ 
ズよりも大きい値を指定した場合には、エラーを通知し、文字は書き込まれません。 
文字属性の指定形式は、次頁の通りです。                                       
                                                                             
　　　　　 7　 6　 5　 4　 3　 2　 1　 0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
 chratr:│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                   
　　　　└─┴─┴─┴─┴─┴─┴┬┴┬┘                                   
　　　　　　　　　　　　　　　　　│　└─半角/全角フラグ                    
　　　　　　　　　　　　　　　　　│　　　 0: 半角文字                       
　　　　　　　　　　　　　　　　　│　　　 1: 全角文字                       
　　　　　　　　　　　　　　　　　└───全角文字フラブ                     
　　　　　　　　　　　　　　　　　　　　　(bit0 = 1 にて有効)                
　　　　　　　　　　　　　　　　　　　　　 0: 第1バイトコード                
　　　　　　　　　　　　　　　　　　　　　 1: 第2バイトコード                
                                                                             
なお、全角第1バイトに続いてさらに全角第1バイトが続く場合、または漢字コードが 
ＪＩＳコードの範囲外である場合のような不正な値の設定に対してのチェックは行い 
ませんので、不当な値が設定されたときの表示は保証されません。                 
                                                                             
-----------------------------------------------------------------------------
.VDB_setcon                                                                  
コンソール機能の設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_setcon( flg );                                                   
unsigned int　  flg;          　/*  制御フラグ (1byte)　　　　　*/           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
unsigned int    flg;                                                         
flg = 0x0000; 　　　　　　　　  /*オーダ動作無効、システム行なし */          
                                                                             
VDB_setcon( flg );                                                           
                                                                             
- 内容 -                                                                     
『文字の出力:VDB_outchr』と『文字列の出力:VDB_outstr』の動作を以下の制御フラ 
グにて指定します。                                                           
                                                                             
　　　　 7　 6　 5　 4　 3　 2　 1　 0                                       
　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                     
 flg: │　│　│ 0│ 0│ 0│　│　│　│                                     
　　　└┬┴┬┴─┴─┴─┴┬┴┬┴┬┘                                     
　　　　│　│　　　　　　　│　│　└─CR&LF フラグ                         
　　　　│　│　　　　　　　│　└───TAB フラグ                           
　　　　│　│　　　　　　　└─────空白文字フラグ                       
　　　　│　└─────────────システム行フラグ                     
　　　　└───────────────オーダ動作フラグ                     
                                                                             
■オーダ動作フラグ                                                           
                                                                             
0:オーダおよびエスケープシーケンスの機能を無効にし、すべての文字を画面に出力 
  する。                                                                     
1:オーダおよびエスケープシーケンスの機能を有効にする。                       
                                                                             
■システム行フラグ                                                           
                                                                             
0:システム行なし *1                                                          
1:システム行あり                                                             
                                                                             
＊1:｢システム行なし｣の機能を使用すると、キーボードのシフト状態が表示されなく 
なりますので注意してください。･なるべく｢システム行なし｣は使用しないでくださ  
い。                                                                         
･もし、使用する場合は、キーボードのシフト状態が分からなくなりますので、必要な
 場合はアプリ側にて、BIOSのシフト状態を読み取り、アプリの画面に表示するように
 てください。                                                                
                                                                             
■空白文字フラグ                                                             
                                                                             
0:スペース(20H)                                                              
1:NULL(00H)                                                                  
                                                                             
■TABフラグ                                                                  
                                                                             
0:タブを空白(00H/20H)に置き換える                                            
1:タブ(09H)を有効にする                                                      
                                                                             
■CR&LFフラグ                                                                
                                                                             
0:CR,LF各々の動作を行う                                                      
1:CR(0DH)あるいはLF(0AH)に対してCR,LF両方の動作を同時に行う。                
                                                                             
･この機能では表示画面サイズの設定を行うため、コンソール画面(システム行含む)は
消去されます。システム行フラグは、『文字の出力:VDB_outchr』と『文字列の出力: 
VDB_outstr』の他に『全画面スクロール:VDB_scroll』の機能の働く画面行サイズを指
定します。｢システム行あり｣が指定された場合には、機能の動作範囲が画面先頭行か 
ら最終行の1行前までとなります。｢システム行なし｣の場合には、最終行までの画面全
体になります。                                                               
･『文字の出力:VDB_outchr』または『文字列の出力:VDB_outstr』にて文字あるいは文
字列を出力する場合、｢システム行あり｣が指定されていると画面の最終行の1行前まで
が出力可能となり、最終行への出力はできません。最終行へ文字を書き込む場合、   
『文字の設定:VDB_setchr』等を使用しなければなりません。                      
･『文字の出力:VDB_outchr』または『文字列の出力:VDB_outstr』にて出力されるオー
ダおよびエスケープシーケンスの機能も、｢システム行あり｣の場合には画面先頭行か 
ら最終行の1行前までの範囲の動作となります。例えば、FFオーダー(0CH)では最終行 
を除く画面に対して空白(00H/20H)とデフォルトアトリビュートを設定します。      
･『全画面スクロール:VDB_scroll』では、｢システム行あり｣が指定された場合、スク 
ロール範囲が画面先頭行から最終行の1行前までになります。空白文字フラグは、画面
消去等に使用する空白文字にNULL(OOH)あるいはスペース(20H)のいずれを使用するか 
を指定します。                                                               
･TAB, CR&LFフラグともにオーダ動作フラグが1の場合、各フラグの値が有効となりま 
す。                                                                         
                                                                             
-----------------------------------------------------------------------------
.VDB_setcusmd                                                                
カーソル表示状態の設定                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void   VDB_setcusmd( sw );                                                   
int    sw;            　　　/*　0:カーソルを表示する　　　　　*/             
                            /*　1:カーソルを表示しない　　　　*/             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int    sw;                                                                   
                                                                             
sw = 1; 　　　　　　　　　　/*　カーソル非表示　　　　　　　　　*/           
VDB_setcusmd( sw );                                                          
                                                                             
- 内容 -                                                                     
カーソルの表示を行うか否かを設定します。                                     
swに2以上の値を設定した場合には、｢カーソルを表示する｣と見なされます。        
                                                                             
-----------------------------------------------------------------------------
.VDB_setcustype                                                              
カーソル形状の設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_setcustype( type, startraster, endraster );                      
unsigned int    type;       /*  カーソルタイプ (1byte)　　　　　*/           
int 　　　　    startraster;/*  スタートラスタ　　　　　　　　　*/           
　　　　　　　　　　　　　　/*　(カーソルタイプが拡張形式の                  
　　　　　　　　　　　　　　　　　場合に有効)*/                              
int 　　　　    endraster;  /*  エンドラスタ　　　　　　　　　　*/           
　　　　　　　　　　　　　　/*　(カーソルタイプが拡張形式の                  
　　　　　　　　　　　　　　　　　場合に有効)　　　　　　　　　*/            
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
unsigned int    type;                                                        
int 　　　　    startraster, endraster;                                      
type = 0x000f;              /*  拡張形式指定　  */                           
startraster =  1;                                                            
endraster   = 10;                                                            
                                                                             
VDB_setcustype( type, startraster, endraster );                              
                                                                             
- 内容 -                                                                     
カーソルの形状を指定します。                                                 
指定形式は、次頁の通りです。                                                 
                                                                             
　　　　 7　 6　 5　 4　 3　 2　 1　 0                                       
　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                     
type: │　│　│　│　│　│　│　│　│                                     
　　　└┬┴┬┴┬┴┬┴┬┴─┴─┴┬┘                                     
　　　　│　└┬┘　│　└──┬──┘                                       
　　　　│　　│　　│　　　　└────カーソル形状                         
　　　　│　　│　　│　　　　　　　　　 0000:アンダーライン（＿）           
　　　　│　　│　　│　　　　　　　　　 0001:ボックス（■）                 
　　　　│　　│　　│　　　　　　　　　 1111:拡張形式                       
　　　　│　　│　　└─────────輝度                                 
　　　　│　　│　　　　　　　　　　　　 0:低輝度                            
　　　　│　　│　　　　　　　　　　　　 1:高輝度                            
　　　　│　　└────────────カーソルブリンク                     
　　　　│　　　　　　　　　　　　　　　 00:ブリンクなし                     
　　　　│　　　　　　　　　　　　　　　 01:カーソル非表示                   
　　　　│　　　　　　　　　　　　　　　 10:高速ブリンク                     
　　　　│　　　　　　　　　　　　　　　 11:低速ブリンク                     
　　　　└───────────────カーソルサイズ                       
　　　　　　　　　　　　　　　　　　　　 0:半角                              
  　　　　　　　　　　　　　　　　　　　 1:全角                              
                                                                             
拡張形式が指定された場合、カーソル形状はスタートラスタとエンドラスタにて囲ま 
れるボックスカーソルとなります。カーソルが表示されていない状態においても、カ 
ーソル形状の設定は可能です。スタートラスタとエンドラスタには、以下の値が設定 
可能であり、この値を越えた値が設定された場合には、各々最大値と見なされます。 
･0〜15                                                                       
                                                                             
カーソルの輝度設定、および全角カーソルが未サポートの場合では、設定値は無視さ 
れます。                                                                     
                                                                             
-----------------------------------------------------------------------------
.VDB_setdefatr                                                               
デフォルトアトリビュートの設定                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_setdefatr( atr );                                                
VDB_ATR 　 *atr;          /*  アトリビュート情報格納領域　　　*/             
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
VDB_ATR 　 atr;                                                              
atr.charatr = 0x00;                                                          
atr.dispatr = 0x38; 　　　　/*  強調、ブリンク、リバース　　*/               
atr.color 　= 0x0007; 　　　/*  白色              　　　　　*/               
                                                                             
VDB_setdefatr( &atr );                                                       
                                                                             
- 内容 -                                                                     
『文字設定:VDB_setchr』にて使用するデフォルトアトリビュートを設定します。    
文字設定の際には、このデフォルトアトリビュートが文字コードとともに文字ディス 
プレイ画面上に書き込まれます。デフォルトアトリビュートの指定形式は、以下の通 
りです。                                                                     
                                                                             
 atr　→┌─┬─┬──────────────┐                             
　　　 0│Ｅ│Ｂ│（リザーブ）　　　　　　　　│                             
　　　　├─┼─┼──────────────┤                             
　　　 1│Ｅ│Ｂ│　表示属性　　　　　　　　　│                             
　　　　├─┼─┼──────────────┤                             
　　　 2│Ｅ│Ｗ│　色識別番号　　　　　　　　│                             
　　　　└─┴─┴──────────────┘                             
                                                                             
■表示属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│　│　│　│                                           
└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　│　│　│　│　│　│　└─アンダーライン                             
　│　│　│　│　│　│　└───オーバライン                               
　│　│　│　│　│　└─────垂線                                       
　│　│　│　│　└───────リバース                                   
　│　│　│　└─────────ブリンク                                   
　│　│　└───────────強調                                       
　│　└─────────────シークレット                               
　└───────────────アンダスコア                               
                                                                             
これらのアトリビュートがサポートされていないものについては、その設定は無視さ 
れます。                                                                     
                                                                             
■色識別番号                                                                 
　                                                                           
0:黒色、1:青色、2:赤色、3:紫色                                               
4:緑色、5:水色、6:黄色、7:白色                                               
                                                                             
文字ディスプレイを初期化した際には、各々以下の値が設定されます。             
                                                                             
表示属性　:00Ｈ                                                              
色識別番号:最大値(7)                                                         
                                                                             
-----------------------------------------------------------------------------
.VDB_setfont                                                                 
外字パターンの登録                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　VDB_seftfont( x, y, moji, pattern );                                   
int 　　　　　  x;          /*  横のドット数　　　　　　　　　　*/           
int 　　　　　  y;          /*  縦のドット数　　　　　　　　　　*/           
unsigned int　  moji;       /*  文字コード(JISコード, 2byte)   */            
char　　　　　  *pattern;   /*  パターン格納領域　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:サイズ指定エラー                                                           
                                                                             
- 例 -                                                                       
int 　       x, y, ret;                                                      
unsigned int moji;                                                           
char　　　　 pattern[32];                                                    
x = y = 16;                                                                  
moji  = 0x7521;             /*  富  　*/                                     
pattern[0] = 0x01;                                                           
pattern[1] = 0x00;                                                           
　　　　…                                                                   
pattern[31] = 0xf8;                                                          
                                                                             
ret = VDB_setfont( x, y, moji, pattern );                                    
                                                                             
- 内容 -                                                                     
漢字の外字フォント(ＪＩＳコードに定義されていない文字のフォント)の登録を行い 
ます。外字コードは、登録する文字パターンのコードです。ＪＩＳコードに定めてあ 
る85区(7521H〜757EH)、および86区(7621H〜767EH)の188個を指定します。          
文字コードは、以下の形式にて指定します。                                     
                                                                             
bit15-8:漢字第2バイトコード                                                  
bit7-0 :漢字第1バイトコード                                                  
                                                                             
外字パターンサイズには、以下の値が設定可能です。他の値を設定した場合には、エ 
ラーが通知され、外字パターンの登録は行われません。現在のパターンサイズは、   
『コンソール機能設定値の読み取り:VDB_rdcon』で通知されます。                 
                                                                             
･パターンサイズ1:縦16、横16                                                  
･パターンサイズ2:縦16、横16                                                  
･パターンサイズ3:縦24、横24                                                  
                                                                             
文字パターンの登録形式は、以下の例のように、文字の左上の位置から順に右方向に 
指定します。                                                                 
なお、許されている文字コード(85区、86区)以外を指定した場合には、無動作となり 
ます。                                                                       
                                                                             
パターンサイズ1、2の例:                                                      
                                                                             
　　　フォントパターン　　　　　　　　パターン格納領域 (pattern)             
                                                                             
　　15　　　　　 8 7　　　　　　   0　　　　　 ｎ 　   ｎ＋1                 
　┌────────────────┐　　┌────┬────┐             
 0│　　　　　　　■　　　　　　　　│　 0│　 01Ｈ │  00Ｈ　│             
 1│■■■■■■■■■■■■■■■　│　 2│　 FFＨ │  FEＨ　│             
 2│■　　　　　　　　　　　　　■　│　 4│　 80Ｈ │  02Ｈ　│             
 3│■　■■■■■■■■■■■　■　│　 6│　 BFＨ │  FAＨ  │             
 4│　　　　　　　　　　　　　　　　│　 8│　 00Ｈ │  00Ｈ　│             
 5│　　　■■■■■■■■■　　　　│　10│　 1FＨ │  F0Ｈ　│             
 6│　　　■　　　　　　　■　　　　│　12│　 10Ｈ │  10Ｈ　│             
 7│　　　■■■■■■■■■　　　　│　14│　 1FＨ │  F0Ｈ　│             
 8│　　　　　　　　　　　　　　　　│　16│　 00Ｈ │  00Ｈ　│             
 9│　　■■■■■■■■■■■　　　│　18│　 3FＨ │  F8Ｈ　│             
10│　　■　　　　■　　　　■　　　│　20│　 21Ｈ │  08Ｈ　│             
11│　　■　　　　■　　　　■　　　│　22│　 21Ｈ │  08Ｈ　│             
12│　　■■■■■■■■■■■　　　│　24│　 3FＨ │  F8Ｈ　│             
13│　　■　　　　■　　　　■　　　│　26│　 21Ｈ │  08Ｈ　│             
14│　　■　　　　■　　　　■　　　│　28│　 21Ｈ │  08Ｈ　│             
15│　　■■■■■■■■■■■　　　│　30│　 3FＨ │  F8Ｈ　│             
　└────────────────┘　　└────┴────┘             
　　　　　(パターン格納領域サイズ　32byte)                                   
                                                                             
パターンサイズ3の例:                                                         
                                                                             
　　　　　　　　フォントパターン　　　　　　　　パターン格納領域 (pattern)   
                                                                             
　　23　　　　　　1615　　　　　　 8 7　　　　　   0　　　   n 　n+1   n+2   
　┌────────────────────────┐ 　┌──┬──┬──┐
 0│　　　　　　　　　　　　　　　　　　　　　　　　│  0│ 00H│ 00H│ 00H│
 1│　　　　　　　　　　■■■　　　　　　　　　　　│  3│ 00H│ 38H│ 00H│
 2│　　　■　　　　　　　■■　　　　　　　■　　　│  6│ 10H│ 18H│ 08H│
 3│　　　■■■■■■■■■■■■■■■■■■■　　│  9│ 1FH│ FFH│ FCH│
 4│　　■■　　　　　　　　　　　　　　　　■■■　│ 12│ 30H│ 00H│ 0EH│
 5│　■■　　　　　　　　　　　　　　■■　■　　　│ 15│ 60H│ 00H│ 68H│
 6│　■■　■■■■■■■■■■■■■■■■　　　　│ 18│ 6FH│ FFH│ F0H│
 7│　　　　　　　　　　　　　　　　　　　　　　　　│ 21│ 00H│ 00H│ 00H│
 8│　　　　　■■　　　　　　　　　■■　　　　　　│ 24│ 06H│ 00H│ C0H│
 9│　　　　　　■■■■■■■■■■■■■　　　　　│ 27│ 03H│ FFH│ E0H│
10│　　　　　　■■　　　　　　　　■■　　　　　　│ 30│ 03H│ 00H│ C0H│
11│　　　　　　■■　　　　　　　　■■　　　　　　│ 33│ 03H│ 00H│ C0H│
12│　　　　　　■■■■■■■■■■■■　　　　　　│ 36│ 03H│ FFH│ C0H│
13│　　　　　　　　　　　　　　　　　　　　　　　　│ 39│ 00H│ 00H│ 00H│
14│　　　■■　　　　　　　　　　　　　■■　　　　│ 42│ 18H│ 00H│ 30H│
15│　　　　■■■■■■■■■■■■■■■■■　　　│ 45│ 1FH│ FFH│ F8H│
16│　　　　■■　　　　　■■　　　　　■■　　　　│ 48│ 1CH│ 18H│ 30H│
17│　　　　■■　　　　　■■　　　　　■■　　　　│ 51│ 1CH│ 18H│ 30H│
18│　　　　■■■■■■■■■■■■■■■■　　　　│ 54│ 1FH│ FFH│ F0H│
19│　　　　■■　　　　　■■　　　　　■■　　　　│ 57│ 1CH│ 18H│ 30H│
20│　　　　■■　　　　　■■　　　　　■■　　　　│ 60│ 1CH│ 18H│ 30H│
21│　　　　■■■■■■■■■■■■■■■■　　　　│ 63│ 1FH│ FFH│ 0FH│
22│　　　　■■　　　　　　　　　　　　■■　　　　│ 66│ 1CH│ 00H│ 30H│
23│　　　　　　　　　　　　　　　　　　　　　　　　│ 69│ 00H│ 00H│ 00H│
　└────────────────────────┘ 　└──┴──┴──┘
　　　 　　　　　　(パターン格納領域サイズ　72byte)                          
                                                                             
-----------------------------------------------------------------------------
.VDB_setposcus                                                               
カーソル位置の指定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 VDB_setposcus( x, y );                                                
int 　 x;               　　/*  桁位置(1〜)　*/                              
int 　 y;               　　/*  行位置(1〜)　*/                              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:行桁位置が異常                                                             
                                                                             
- 例 -                                                                       
int    x, y, ret;                                                            
x =  1;                                                                      
y = 10;                                                                      
                                                                             
ret = VDB_setposcus( x, y );                                                 
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上のカーソルの表示位置を指定します。                     
行桁位置に現在の文字ディスプレイ画面サイズよりも大きい値を指定した場合には、 
エラーを通知し、カーソル位置の設定は行いません。                             
                                                                             
-----------------------------------------------------------------------------
.VDB_setsize                                                                 
表示画面サイズの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int    VDB_setsize( x, y );　                                                
int 　 x;               　　/*  桁数　　*/                                   
int 　 y;               　　/*  行数　　*/                                   
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:画面サイズの設定が不可                                                     
                                                                             
- 例 -                                                                       
int    x, y, ret;                                                            
x = 80;                                                                      
y = 25;                                                                      
ret = VDB_setsize( x, y );                                                   
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面の行数と桁数を設定し、全画面(システム行含む。但し、モード
表示域は除く)を消去します。                                                  
指定された画面サイズが設定不可能な場合、エラーが通知され、表示画面サイズの設 
定は行われません。次の表示画面サイズが設定可能です。                         
･80桁25行                                                                    
                                                                             
-----------------------------------------------------------------------------
.VDB_wtsysline                                                               
システム行の書き込み                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void    VDB_wtsysline( sw, chrcnt, sta_y, chrbuf, atrbuf );                  
int 　　sw;                 /*  0:文字のみ設定　　　　　　　　*/             
　　　　　　　　　　　　　　/*　1:文字とアトリビュートを設定　*/             
int 　　chrcnt;             /*  書き込み文字数(バイト)　　　　*/             
int 　　sta_y;          　  /*  開始桁位置　　　　　　　　　　　*/           
char　　*chrbuf;            /*  文字コード格納領域　　　　　　　*/           
char　　*atrbuf;            /*  文字属性格納領域　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int     sw, chrcnt, sta_y;　                                                 
char    chrbuf[15], atrbuf[15];                                              
sw = 0;                                                                      
chrcnt = 5;                                                                  
sta_y = 1;                                                                   
chrbuf[0] = 0x41;                                                            
chrbuf[1] = 0x42;                                                            
　　　…                                                                     
atrbuf[0] = 0x00;                                                            
atrbuf[1] = 0x00;                                                            
　　　…                                                                     
VDB_wtsysline( sw, chrcnt, sta_y, chrbuf, atrbuf );                          
                                                                             
- 内容 -                                                                     
文字ディスプレイ画面上のシステム行に文字のみ、または文字とアトリビュートを設 
定します。                                                                   
swに2以上の値を設定した場合には、｢文字のみ設定｣とみなされます。『コンソール機
能の設定:VDB_setcon』によってシステム行が設定されていないときには、すべての設
定が無視されます。                                                           
文字およびアトリビュートをシステム行の右10桁に設定しようとした場合には、その 
文字およびアトリビュートは無視されます。なお、全角第1バイトに続いてさらに全角
第1バイトが続く場合、または漢字コードがＪＩＳコードの範囲外である場合のような
エラー事象(不正な値の設定)に対してチェックは行いません。境界に全角文字が書き 
込まれていた場合、その全角文字の第1バイトまたは第2バイトは、そのままの値が保 
持されます。不正な値が設定された場合、その表示は保証されません。             
                                                                             
文字およびアトリビュートの指定形式は、以下の通りです。                       
                                                                             
〔文字のみの設定の場合〕                                                     
                                                                             
chrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｅ│Ｂ│　文字コード（ＪＩＳ）　　　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│　│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
atrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｅ│Ｂ│　文字属性　　　　　　　　　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│　│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
                                                                             
〔文字とアトリビュートの設定の場合〕                                         
                                                                             
chrbuf　→┌─┬─┬──────────────┐                           
　　　　 0│Ｅ│Ｂ│　文字コード（ＪＩＳ）　　　│                           
　　　　　├─┼─┼──────────────┤                           
　　　　 1│Ｅ│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
atrbuf　→┌─┬─┬──────────────┐┐                         
　　　　 0│Ｅ│Ｂ│　文字属性　　　　　　　　　││                         
　　　　　│　├─┼──────────────┤│1バイトの文字コ          
　　　　 1│　│Ｂ│　表示属性　　　　　　　　　│├ードに対するアト         
　　　　　│　├─┼──────────────┤│リビュート               
　　　　 2│　│Ｗ│　色識別番号　　　　　　　　││                         
　　　　　├─┼─┼──────────────┤┘                         
　　　　 4│Ｅ│　│　上記の繰り返し　　　　　　│                           
　　　　　〜　　　　　　　　　　　　　　　　　　〜                           
　　　　　│　│　│　　　　　　　　　　　　　　│                           
　　　　　└─┴─┴──────────────┘                           
                                                                             
■文字属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                           
└─┴─┴─┴─┴─┴─┴┬┴┬┘                                           
　　　　　　　　　　　　　│　└─半角/全角フラグ                            
　　　　　　　　　　　　　│　　　 0: 半角文字                               
　　　　　　　　　　　　　│　　　 1: 全角文字                               
　　　　　　　　　　　　　└───全角文字フラブ                             
　　　　　　　　　　　　　　　　　(bit0 = 1 にて有効)                        
　　　　　　　　　　　　　　　　　 0: 第1バイトコード                        
　　　　　　　　　　　　　　　　　 1: 第2バイトコード                        
                                                                             
■表示属性                                                                   
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│　│　│　│                                           
└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　│　│　│　│　│　│　└─アンダーライン                             
　│　│　│　│　│　│　└───オーバライン                               
　│　│　│　│　│　└─────垂線                                       
　│　│　│　│　└───────リバース                                   
　│　│　│　└─────────ブリンク                                   
　│　│　└───────────強調                                       
　│　└─────────────シークレット                               
　└───────────────アンダスコア                               
                                                                             
これらのアトリビュートがサポートされていないものについては、対応するビットの 
設定値は無視されます。                                                       
                                                                             
■色識別番号                                                                 
                                                                             
0:黒色、1:青色、2:赤色、3:紫色                                               
4:緑色、5:水色、6:黄色、7:白色                                               
                                                                             
 6.　補助記憶装置サポート                                                    
                                                                             
  6.1　関数一覧                                                              
                                                                             
┌────────┬─────────────────────────┐     
│ 　関　数　名　 │　　　　　　　機　　　　　　　　能　　　　　　　　│     
├────────┼─────────────────────────┤     
│DKB_setmode 　　│ドライブモードの設定　　　　　　　　　　　　　　　│     
├────────┼─────────────────────────┤     
│DKB_rdmode　　　│ドライブモードの取り出し　　　　　　　　　　　　　│     
├────────┼─────────────────────────┤     
│DKB_rdstatus　　│ドライブステータス情報の取り出し(320KB,1MBのみ）　│     
├────────┼─────────────────────────┤     
│DKB_rdstatus2 　│ドライブステータス情報の取り出し（SCSIのみ）　　　│     
├────────┼─────────────────────────┤     
│DKB_restore 　　│シリンダ0へのシーク　　　　　　　　　　　　　　　 │     
├────────┼─────────────────────────┤     
│DKB_seek　　　　│シーク　　　　　　　　　　　　　　　　　　　　　　│     
├────────┼─────────────────────────┤     
│DKB_read　　　　│データの読み出し（320KB,1MBのみ) 　　　　　　　　 │     
├────────┼─────────────────────────┤     
│DKB_read2 　　　│データの読み出し（SCSIのみ）　　　　　　　　　　　│     
├────────┼─────────────────────────┤     
│DKB_write 　　　│データの書き込み（320KB,1MBのみ) 　　　　　　　　 │     
├────────┼─────────────────────────┤     
│DKB_write2　　　│データの書き込み（SCSIのみ）　　　　　　　　　　　│     
├────────┼─────────────────────────┤     
│DKB_chksec　　　│セクタの検査（320KB,1MBのみ) 　　　　　　　　　　 │     
├────────┼─────────────────────────┤     
│DKB_chksec2 　　│セクタの検査（SCSIのみ）　　　　　　　　　　　　　│     
├────────┼─────────────────────────┤     
│DKB_reset 　　　│ハードディスクコントローラのリセット　　　　　　　│     
├────────┼─────────────────────────┤     
│DKB_rdsecid 　　│セクタＩＤの取り出し　　　　　　　　　　　　　　　│     
└────────┴─────────────────────────┘     
                                                                             
  6.2　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.DKB_chksec                                                                  
セクタの検査 (320KB,1MBのみ)                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_chksec( devno, cylno, headno, secno, seccnt, secnum );           
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
int 　　cylno;　　　　　　　/*　シリンダ番号　　　　　　　　　　*/           
int 　　headno; 　　　　　　/*　ヘッド番号　　　　　　　　　　　*/           
int 　　secno;　　　　　　　/*　セクタ番号　　　　　　　　　　　*/           
int 　　seccnt; 　　　　　　/*　セクタ数　　　　　　　　　　　　*/           
int 　　*secnum;　　　　　　/*　残りのセクタ数　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り                                                    
8???H :ハードエラー(??? は詳細エラー情報)                                    
                                                                             
- 例 -                                                                       
int 　　devno, cylno, headno, secno, seccnt, secnum, ret;                    
devno  = 0x0020;                                                             
cylno  = 2;                                                                  
headno = 0;                                                                  
secno  = 1;                                                                  
seccnt = 1;                                                                  
                                                                             
ret = DKB_chksec( devno, cylno, headno, secno, seccnt, &secnum );            
                                                                             
- 内容 -                                                                     
指定されたデバイスのseccntで指定されたセクタ分のデータを検査します。         
                                                                             
-----------------------------------------------------------------------------
.DKB_chksec2                                                                 
セクタの検査 (SCSIのみ)                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_chksec2( devno, blockno, blockcnt, blocknum );                   
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
long　　blockno;　　　　　　/*　論理ブロック番号　　　　　　　　*/           
int 　　blockcnt; 　　　　　/*　ブロック数　　　　　　　　　　　*/           
int 　　*blocknum;　　　　　/*　残りのブロック数　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り                                                    
8???H :ハードエラー(??? は詳細エラー情報)                                    
                                                                             
- 例 -                                                                       
int 　　devno,blockcnt, blocknum, ret;                                       
long　　blockno ;                                                            
devno 　 = 0x00B1;                                                           
blockno  = 1;                                                                
blockcnt = 1;                                                                
                                                                             
ret = DKB_chksec2( devno, blockno, blockcnt, &blocknum );                    
                                                                             
- 内容 -                                                                     
指定されたデバイスのblockcntで指定されたブロック分のデータを検査します。     
                                                                             
-----------------------------------------------------------------------------
.DKB_rdmode                                                                  
ドライブモードの取り出し                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_rdmode( devno, mode1, mode2 );                                   
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
unsigned int　　*mode1; 　　/*　ドライブモード1　　　　　　　　*/            
unsigned int　　*mode2; 　　/*　ドライブモード2　　　　　　　　*/            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:デバイス番号の誤り                                                         
                                                                             
- 例 -                                                                       
int 　　　　　　devno, ret;                                                  
unsigned int　　mode1, mode2;                                                
devno = 0x0020;                                                              
                                                                             
ret = DKB_rdmode( devno, &mode1, &mode2 );                                   
                                                                             
- 内容 -                                                                     
現在設定されているセクタ長、ドライブモード、記録密度、セクタ数、ヘッド数を取 
り出します。                                                                 
                                                                             
ドライブモード1                                                              
                                                                             
　　　　　 7　 6　 5　 4　 3　 2　 1　 0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
 mode1: │　│ 0│　│　│ 0│ 0│　│　│                                   
　　　　└┬┴─┴┬┴┬┴─┴─┴┬┴┬┘                                   
　　　　　│　　　└┬┘　　　　　└┬┘                                     
　　　　　│　　　　│　　　　　　　└───セクタ長:00… 128                
　　　　　│　　　　│　　　　　　　　　　　　　　　 01… 256                
　　　　　│　　　　└─1Ｍ2ＨＤドライブのモード　　 10… 512                
　　　　　│　　　　　　　　　　　　　　　00…2HD 　 11…1024                
　　　　　└─記録密度　　　　　　　　　　01…2DD                            
　　　　　　　　 0…ＭＦＭモード（倍密度）                                   
　　　　　　　　 1…ＦＭモード（単密度）                                     
                                                                             
ドライブモード2                                                              
                                                                             
　　　　　15　　〜　　 8　 7　　〜　　0                                      
　　　　┌─┬─〜─┬─┬─┬─〜─┬─┐                                   
 mode2: │　│　　　│　│　│　　　│　│                                   
　　　　└┬┴─〜─┴┬┴┬┴─〜─┴┬┘                                   
　　　　　└──┬──┘　└──┬──┘                                     
　　　　　　　　│　　　　　　　│                                           
　　　　　　　ヘッド数　　　　セクタ数                                       
                                                                             
-----------------------------------------------------------------------------
.DKB_rdsecid                                                                 
セクタＩＤの取り出し                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_rdsecid( devno, cylno, headno, secid );                          
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
int 　　cylno;　　　　　　　/*　シリンダ番号　　　　　　　　　　*/           
int 　　headno; 　　　　　　/*　ヘッド番号　　　　　　　　　　　*/           
DKB_SEC 　*secid; 　 　　　 /* 　セクタのID情報　　　　 　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り                                                    
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　　devno, cylno, headno, ret;                                           
DKB_SEC secid;                                                               
devno  = 0x0020;                                                             
cylno  = 2;                                                                  
headno = 1;                                                                  
                                                                             
ret = DKB_rdsecid( devno, cylno, headno, &secid );                           
                                                                             
- 内容 -                                                                     
指定トラックのセクタＩＤをバッファに読み込みます。                           
セクタＩＤ                                                                   
                                                                             
secid →　┌─┬─┬──────┐                                           
　　　　 0│Ｒ│Ｂ│トラック番号│                                           
　　　　　├─┼─┼──────┤                                           
　　　　 1│Ｒ│Ｂ│ヘッド番号　│                                           
　　　　　├─┼─┼──────┤　┌─0: 128バイト                         
　　　　 2│Ｒ│Ｂ│セクタ番号　│　│                                       
　　　　　├─┼─┼──────┤　├─1: 256バイト                         
　　　　 3│Ｒ│Ｂ│セクタ長　　│→│                                       
　　　 　 ├─┼─┼──────┤　├─2: 512バイト                         
　　　　 4│Ｒ│Ｂ│ＣＲＣ　　　│　│                                       
　　　　　├─┼─┼──────┤　└─3:1024バイト                         
　　　　 5│Ｒ│Ｂ│ＣＲＣ　　　│                                           
　　　　　└─┴─┴──────┘                                           
                                                                             
-----------------------------------------------------------------------------
.DKB_rdstatus                                                                
ドライブステータス情報の取り出し(320KB,1MBのみ)                              
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_rdstatus( devno, status );                                       
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
unsigned int　　*status;　　/*　ドライブステータス　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り                                                    
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　　　　　　devno, ret;                                                  
unsigned int　　status;                                                      
devno = 0x0020;                                                              
                                                                             
ret = DKB_rdstatus( devno, &status );                                        
                                                                             
- 内容 -                                                                     
現在のドライブ状態を取り出します。                                           
1ＭＢドライブではドライブステータスを返し、正常終了の時は取り出した情報のモー
ドにセットされます。ただし、エラー終了またはドライブモードが2Ｄ/2ＤＤの場合は
、『ドライブモードの設定:DKB_setmode 』により、モードの再設定を行う必要があり
ます。これは、2Ｄと2ＤＤの区別を行うためです。なお、この機能はフォーマット済 
のフロッピィディスクのみ動作します。                                         
                                                                             
ドライブステータス                                                           
                                                                             
　　　　　 7　 6　 5　 4　 3　 2　 1　 0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
status: │　│ 0│　│　│ 0│　│　│　│                                   
　　　　└┬┴─┴┬┴┬┴─┴┬┴┬┴┬┘                                   
　　　　　│　　　└┬┘　　　│　│　└────0:レディ                     
　　　　　│　　　　│　　　　│　│　　　　　　1:ノットレディ               
　　　　　│　　　　│　　　　│　└────0:未保護                         
　　　　　│　　　　│　　　　│　　　　　　1:書き込み保護                   
　　　　　│　　　　│　　　　└───0:片面                                 
　　　　　│　　　　│　　　　　　　　1:両面                                 
　　　　　│　　　　└─1Ｍ2ＨＤドライブのモード                             
　　　　　│　　　　　　　　　　　　　　　00…2HD                            
　　　　　└─記録密度　　　　　　　　　　01…2DD                            
　　　　　　　　 0…ＭＦＭモード（倍密度）                                   
　　　　　　　　 1…ＦＭモード（単密度）                                     
                                                                             
-----------------------------------------------------------------------------
.DKB_rdstatus2                                                               
ドライブステータス情報の取り出し (SCSIのみ)                                  
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_rdstatus2( devno, mode, blockcnt );                              
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
unsigned int　　*mode;　　　/*　ドライブモード　　　　　　　　　*/           
long　　 int　　*blockcnt;　/*　論理ブロック数　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り                                                    
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　　　　　　devno, ret;                                                  
unsigned int　　mode;                                                        
long　　 int　　blockcnt;                                                    
devno = 0x00B1;                                                              
                                                                             
ret = DKB_rdstatus2( devno, &mode, &blockcnt );                              
                                                                             
- 内容 -                                                                     
現在のドライブ状態を取り出します。                                           
                                                                             
ドライブモード───ハードディスク、SCSI                                     
                                                                             
　　　　15　　〜　　 8　 7　 6　 5　 4　 3　 2　 1　 0                       
　　　┌─┬─〜─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐                     
 mode:│ 0│　　　│ 0│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                     
　　　└─┴─〜─┴─┴─┴─┴─┴─┴─┴─┴┬┴┬┘                     
　　　　　　　　　　　　　　　　　　　　　　　　└┬┘                       
　　　　　　　　　　　　　　　　　　　　　　　　　└ブロック長:00… 128      
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 01… 256      
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 10… 512      
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 11…1024      
                                                                             
-----------------------------------------------------------------------------
.DKB_read                                                                    
データの読み出し (320KB,1MBのみ)                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_read( devno, cylno, headno, secno, seccnt, buf, secnum );        
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
int 　　cylno;　　　　　　　/*　シリンダ番号　　　　　　　　　　*/           
int 　　headno; 　　　　　　/*　ヘッド番号　　　　　　　　　　　*/           
int 　　secno;　　　　　　　/*　セクタ番号　　　　　　　　　　　*/           
int 　　seccnt; 　　　　　　/*　セクタ数　　　　　　　　　　　　*/           
char　　*buf; 　　　　　　　/*　データ　　　　　　　　　　　　　*/           
int 　　*secnum;　　　　　　/*　残りのセクタ数　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り、ヘッド番号の誤り                                  
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　　devno, cylno, headno, secno, seccnt, secnum, ret;                    
char　　buf[1024];                                                           
devno  = 0x0020;                                                             
cylno  = 2;                                                                  
headno = 0;                                                                  
secno  = 1;                                                                  
seccnt = 1;                                                                  
                                                                             
ret = DKB_read( devno, cylno, headno, secno, seccnt, buf, &secnum );         
                                                                             
- 内容 -                                                                     
指定されたデバイスよりseccntで指定されたセクタ分のデータを読み込みます。     
                                                                             
                                                                             
-----------------------------------------------------------------------------
.DKB_read2                                                                   
データの読み出し (SCSIのみ)                                                  
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_read2( devno, blockno, blockcnt, buf, blocknum );                
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
long　　blockno;　　　　　　/*　論理ブロック番号　　　　　　　　*/           
int 　　blockcnt; 　　　　　/*　ブロック数　　　　　　　　　　　*/           
char　　*buf; 　　　　　　　/*　データ　　　　　　　　　　　　　*/           
int 　　*blocknum;　　　　　/*　残りのブロック数　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り                                                    
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　　devno, blockcnt, blockno, blocknum, ret;                             
char　　buf[1024];                                                           
long　　blockno ;                                                            
devno 　 = 0x00B1;　　　　　/*　SCSIハードディスク　ドライブ1　*/            
blockno  = 1;                                                                
blockcnt = 1;                                                                
                                                                             
ret = DKB_read2( devno, blockno, blockcnt, buf, &blocknum );                 
                                                                             
- 内容 -                                                                     
指定されたデバイスよりblockcntで指定されたブロック分のデータを読み込みます。 
                                                                             
-----------------------------------------------------------------------------
.DKB_reset                                                                   
ハードディスクコントローラのリセット                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_reset( void );                                                   
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
                                                                             
ret = DKB_reset();                                                           
                                                                             
- 内容 -                                                                     
ハードエラーが発生した場合、ハードディスクコントローラをリセットします。     
                                                                             
-----------------------------------------------------------------------------
.DKB_restore                                                                 
シリンダ0へのシーク                                                          
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 DKB_restore( devno );                                                 
int 　 devno; 　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り                                                    
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　 ret, devno;                                                           
devno = 0x0020; 　　　　　　/*　1ＭＢドライブ　　　　　　　　　*/            
                                                                             
ret = DKB_restore( devno );                                                  
                                                                             
- 内容 -                                                                     
指定されたデバイスのヘッドを0シリンダへ移動します。(SCSI)                    
指定されたデバイスのリセットおよびヘッドを0シリンダへ移動します。(320KB、1MB)
                                                                             
-----------------------------------------------------------------------------
.DKB_seek                                                                    
シーク                                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 DKB_seek( devno, cylno );                                             
int 　 devno ;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
int 　 cylno; 　　　　　　　/*　シリンダ番号　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H : 正常終了                                                             
0002H : デバイス番号の誤り                                                   
8???H : ハードエラー(???は詳細エラー情報)                                    
                                                                             
- 例 -                                                                       
int 　 devno, cylno, ret;                                                    
devno = 0x0020;                                                              
cylno = 2 ;                                                                  
                                                                             
ret = DKB_seek( devno,cylno );                                               
                                                                             
- 内容 -                                                                     
指定されたデバイスのヘッドを、指定されたシリンダ番号へ移動します。           
                                                                             
-----------------------------------------------------------------------------
.DKB_setmode                                                                 
ドライブモードの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_setmode( devno, mode1, mode2 );                                  
int 　　　　　　devno;　　　/*　デバイス番号　　　　　　　　　　*/           
unsigned int　　mode1;　　　/*　ドライブモード1 (1byte)　　　　*/            
unsigned int　　mode2;　　　/*　ドライブモード2 (2byte)　　　　*/            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:デバイス番号の誤り、ドライブモードの誤り                                   
                                                                             
- 例 -                                                                       
int 　　　　　　devno, ret;                                                  
unsigned int　　mode1, mode2;                                                
devno = 0x0020; 　　　　　　/*　1ＭＢドライブ　　　　　　　　　*/            
mode1 = 0x0003;                                                              
mode2 = 0x0208;                                                              
                                                                             
ret = DKB_setmode( devno, mode1, mode2 );                                    
                                                                             
- 内容 -                                                                     
各デバイスのセクタ長、ドライブモード、記録密度、セクタ数、ヘッド数などを設定 
します。                                                                     
                                                                             
ドライブモード1                                                              
                                                                             
　　　　　 7　 6　 5　 4　 3　 2　 1　 0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
 mode1: │　│ 0│　│　│ 0│ 0│　│　│                                   
　　　　└┬┴─┴┬┴┬┴─┴─┴┬┴┬┘                                   
　　　　　│　　　└┬┘　　　　　└┬┘                                     
　　　　　│　　　　│　　　　　　　└───セクタ長:00… 128                
　　　　　│　　　　│　　　　　　　　　　　　　　　 01… 256                
　　　　　│　　　　└─1Ｍ2ＨＤドライブのモード　　 10… 512                
　　　　　│　　　　　　　　　　　　　　　00…2HD 　 11…1024                
　　　　　└─記録密度　　　　　　　　　　01…2DD                            
　　　　　　　　 0…ＭＦＭモード（倍密度）                                   
　　　　　　　　 1…ＦＭモード（単密度）                                     
                                                                             
ドライブモード2                                                              
                                                                             
　　　　　15　　〜　　 8　 7　　〜　　0                                      
　　　　┌─┬─〜─┬─┬─┬─〜─┬─┐                                   
 mode2: │　│　　　│　│　│　　　│　│                                   
　　　　└┬┴─〜─┴┬┴┬┴─〜─┴┬┘                                   
　　　　　└──┬──┘　└──┬──┘                                     
　　　　　　　　│　　　　　　　│                                           
　　　　　　　ヘッド数　　　　セクタ数                                       
                                                                             
-----------------------------------------------------------------------------
.DKB_write                                                                   
データの書き込み (320KB,1MBのみ)                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_write( devno, cylno, headno, secno, seccnt, buf, secnum );       
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
int 　　cylno;　　　　　　　/*　シリンダ番号　　　　　　　　　　*/           
int 　　headno; 　　　　　　/*　ヘッド番号　　　　　　　　　　　*/           
int 　　secno;　　　　　　　/*　セクタ番号　　　　　　　　　　　*/           
int 　　seccnt; 　　　　　　/*　セクタ数　　　　　　　　　　　　*/           
char　　*buf; 　　　　　　　/*　データ　　　　　　　　　　　　　*/           
int 　　*secnum;　　　　　　/*　残りのセクタ数　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り、ヘッド番号の誤り                                  
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　　devno, cylno, headno, secno, seccnt, secnum, ret;                    
char　　buf[100];                                                            
devno  = 0x0020;                                                             
cylno  = 2;                                                                  
headno = 0;                                                                  
secno  = 1;                                                                  
seccnt = 1;                                                                  
buf[0] = ???;                                                                
buf[1] = ???;                                                                
　　　　　 :                                                                 
ret = DKB_write( devno, cylno, headno, secno, seccnt, buf, &secnum );        
                                                                             
- 内容 -                                                                     
指定されたデバイスにseccntで指定されたセクタ分のデータを書き込みます。       
                                                                             
                                                                             
-----------------------------------------------------------------------------
.DKB_write2                                                                  
データの書き込み (SCSIのみ)                                                  
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　DKB_write2( devno, blockno, blockcnt, buf, blocknum );               
int 　　devno;　　　　　　　/*　デバイス番号　　　　　　　　　　*/           
long　　blockno;　　　　　　/*　論理ブロック番号　　　　　　　　*/           
int 　　blockcnt; 　　　　　/*　ブロック数　　　　　　　　　　　*/           
char　　*buf; 　　　　　　　/*　データ　　　　　　　　　　　　　*/           
int 　　*blocknum;　　　　　/*　残りのブロック数　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0000H :正常終了                                                              
0002H :デバイス番号の誤り                                                    
8???H :ハードエラー(???は詳細エラー情報)                                     
                                                                             
- 例 -                                                                       
int 　　devno,blockcnt, blocknum, ret;                                       
char　　buf[100];                                                            
long　　blockno                                                              
devno 　　= 0x00B1;                                                          
blockno 　= 1;                                                               
blockcnt　= 1;                                                               
buf[0] = ???;                                                                
buf[1] = ???;                                                                
　 :                                                                         
                                                                             
ret = DKB_write2( devno, blockno, blockcnt, buf, &blocknum );                
                                                                             
- 内容 -                                                                     
指定されたデバイスにblockcntで指定されたブロック分のデータを書き込みます。   
                                                                             
 7.　プリンタインターフェース                                                
                                                                             
  7.1　関数一覧                                                              
                                                                             
┌─────────┬───────────────────┐               
│　関　数　名　　　│　　　　機　　　　　能　　　　　　　　│               
├─────────┼───────────────────┤               
│PRB_status　　　　│プリンタ状態の読み取り　　　　　　　　│               
├─────────┼───────────────────┤               
│PRB_chr 　　　　　│1文字出力　　　　　　　　　　　　　　 │               
├─────────┼───────────────────┤               
│PRB_string　　　　│文字列出力　　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│PRB_remainbyte　　│未印字バイト数の読み取り　　　　　　　│               
└─────────┴───────────────────┘               
                                                                             
  7.2　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.PRB_chr                                                                     
1文字出力                                                                    
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　PRB_chr( chr );                                                      
char　　chr;　　　　　　　　/*　印字データ(キャラクタコード、　　            
　　　　　　　　　　　　　　　　プリンタ制御コードなど)(1byte)　*/           
                                                                             
- 戻り値 -                                                                   
00H :正常終了                                                                
04H :プリンタの紙切れ                                                        
05H :プリンタがノットレディ(オフライン)                                      
80H :プリンタの動作エラー                                                    
                                                                             
- 例 -                                                                       
char　　chr;                                                                 
int 　　ret;                                                                 
chr = 0x0041; 　　　　　　　/*　Ａ　　　　　　　　　　　　　　　*/           
                                                                             
ret = PRB_chr( chr );                                                        
                                                                             
- 内容 -                                                                     
プリンタへ印字データを送ります。                                             
文字を印字するときは、その文字コードを送った後に、プリンタのLF、CRコードを送 
らない限り、印字されません。                                                 
                                                                             
-----------------------------------------------------------------------------
.PRB_remainbyte                                                              
未印字バイト数の読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　PRB_remainbyte( void );                                              
                                                                             
- 戻り値 -                                                                   
印刷されなかった残りのバイト数を返します。                                   
                                                                             
- 例 -                                                                       
int 　　count, ret;                                                          
int 　　remain;                                                              
char　　string[] ={ " abcd " };                                              
count = 4;                                                                   
ret = PRB_string ( count, string ); 　　　　/*　文字列出力　　*/             
                                                                             
if (ret == 0x80) remain = PRB_remainbyte(); /*　動作エラー時　*/             
                                                                             
- 内容 -                                                                     
プリンタへの文字列出力(PRB_chr またはPRB_string)において、印字中にプリンタの 
動作エラーが発生したときのみ、印字されなかった残りのバイト数を通知します。   
プリンタ動作エラー時                                                         
                                                                             
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐       
(memory)│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│Ｂ│       
　　　　└─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┘       
　　　　　←───────────→↑←─────────────→         
　　　　　　　　　　　　　　　　　　│　　　　　　　　　　　　　　　         
　　　　　　プリンタへ送った部分　　│　　　　送っていない部分　　　         
　　　　　　　　　↑　　　　┌───┴───┐　　　↑　　　　　　　         
　　　　　　　　　│　　　　│　　ここで　　│　　　│　　　　　　　         
　　　　　　　　　│　　　　│　　　　　　　│　　　│　　　　　　　         
　　　　　　　　　│　　　　│プリントエラー│　　　│　　　　　　　         
　　　　　　　　　│　　　　│　　　　　　　│　　　│　　　　　　　         
　　　　　　　　　│　　　　│　　発　生　　│　　　│　　　　　　　         
　　　　　　　　　│　　　　└───────┘　　　│　　　　　　　         
　　　　　　印字したか否かは　　　　　　　　　残りのバイト数をremainに       
　　　　　　保障できません　　　　　　　　　　入れて返します                 
                                                                             
-----------------------------------------------------------------------------
.PRB_status                                                                  
プリンタ状態の読み取り                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　PRB_status( status );                                                
unsigned int　　*status;　　/*　プリンタの状態　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 status, ret;                                                          
                                                                             
ret = PRB_status( &status );                                                 
                                                                             
- 内容 -                                                                     
現在のプリンタの状態を読み取ります。                                         
                                                                             
- ステータス -                                                               
                                                                             
　15　14　13　12　11　10　 9　 8　 7　 6　 5　 4　 3　 2　 1　 0             
┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
│　│　│　│　│ 0│ 0│ 0│ 0│ 0│　│ 0│　│ 0│ 0│　│　│           
└┬┴┬┴┬┴┬┴─┴─┴─┴─┴─┴┬┴─┴┬┴─┴─┴┬┴┬┘           
　│　│　│　│　　　　　　　　　　　│　　　│　　　　　│  └─用紙切れ   
　│　│　│　└─セレクト　　　　　　│　　　│　　　　　│    ┌0:用紙あり 
　│　│　│　　┌0:オフライン　　　　│　　　│　　　　　│　　└1:用紙なし 
　│　│　│　　└1:オンライン　　　　│　　　│　　　　　└───ＢＵＳＹ   
　│　│　└───ＲＩＮＦ1 *1 　　 　│　　　│　　　　　　　　┌0:ﾃﾞｰﾀ待ち 
　│　└─────ＲＩＮＦ2 *1 　　 　│　　　│　　　　　　　　└1:動作中   
　└───────ＲＩＮＦ3 *1 　　 　│　　　└─────回復不可能エラー   
　　　　　　　　　　　　　　　　　　　│　　　　　　　　　　　　┌0:正常     
　*1: TESTコマンド実行時以外　　 　　 │　　　　　　　　　　　　└1:エラー   
　　　　　　　　　　　　　　　　　　　└─────────────アラーム   
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　┌0:正常     
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　└1:アラーム 
                                                                             
RINFについては、各プリンタのマニュアルをご覧ください。                       
また、セレクトが1の時、エラー情報、または、プリンタ情報が返ります。ただし、RI
NFは、プリンタによってサポートされないことがあります。アラームビットは、オフ 
ライン、用紙切れでオンになり、一度読むとオフになります。                     
                                                                             
-----------------------------------------------------------------------------
.PRB_string                                                                  
文字列出力                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　PRB_string( count, string );                                         
int 　　count ; 　　　　　　/*　データ長(バイト数)　　　　　　*/             
char　　*string;　　　　　　/*　文字列　　　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
00H :正常終了                                                                
04H :プリンタの紙切れ                                                        
05H :プリンタがノットレディ(オフライン)                                      
80H :プリンタの動作エラー                                                    
                                                                             
- 例 -                                                                       
int 　　count, ret;                                                          
char　　string[] ={ " abcd " };                                              
count = 4;                                                                   
                                                                             
ret = PRB_string ( count, string );                                          
                                                                             
- 内容 -                                                                     
プリンタへ文字列を送ります。                                                 
印字中にプリンタのエラーが発生したときは、印字されなかった残りのバイト数を   
『未印字バイト数の読み取り:PRB_remainbyte』により参照できます。また、プリンタ
内にあるバッファに残っているデータについては、印字されるかどうかは保障できま 
せん。                                                                       
                                                                             
 8.　時計サポート                                                            
                                                                             
  8.1　関数一覧  　　                                                        
                                                                             
┌──────────┬──────────────────┐               
│ 　　関　数　名　　 │　　　　　機　　　　　能　　　　　　│               
├──────────┼──────────────────┤               
│TIM_setcalendar 　　│日付/時刻の設定　　　　　　　　　　 │               
├──────────┼──────────────────┤               
│TIM_rdcalendar　　　│日付/時刻の読み取り　　　　　　　　 │               
├──────────┼──────────────────┤               
│TIM_settime 　　　　│タイマの登録　　　　　　　　　　　　│               
├──────────┼──────────────────┤               
│TIM_clrtime 　　　　│タイマの取り消し　　　　　　　　　　│               
├──────────┼──────────────────┤               
│TIM_rdtime　　　　　│タイマのカウント値の読み取り　　　　│               
├──────────┼──────────────────┤               
│TIM_setclock　　　　│指定時刻の割り込み処理の登録　　　　│               
├──────────┼──────────────────┤               
│TIM_clrclock　　　　│指定時刻の割り込み処理の取り消し　　│               
└──────────┴──────────────────┘               
                                                                             
  8.2　各関数の解説                                                          
                                                                             
                                                                             
-----------------------------------------------------------------------------
.TIM_clrclock                                                                
指定時刻の割り込み処理の取り消し                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 TIM_clrclock( clockno );                                              
int 　 clockno; 　　　　　　/*　時計管理番号　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:時計管理番号に誤り                                                         
                                                                             
- 例 -                                                                       
int 　 clockno, ret;                                                         
clockno = 1;                                                                 
                                                                             
ret = TIM_clrclock( clockno );                                               
                                                                             
- 内容 -                                                                     
指定された時計管理番号の、指定時刻の割り込み処理を取り消します。             
                                                                             
-----------------------------------------------------------------------------
.TIM_clrtime                                                                 
タイマの取り消し                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 TIM_clrtime( timeno );                                                
int 　 timeno;　　　　　　　/*　タイマ管理番号　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:タイマ管理番号に誤り                                                       
                                                                             
- 例 -                                                                       
int 　 timeno, ret;                                                          
timeno = 1;                                                                  
                                                                             
ret = TIM_clrtime( timeno );                                                 
                                                                             
- 内容 -                                                                     
指定されたタイマ管理番号のタイマ割り込み処理を取り消します。                 
タイマ管理番号は、登録済のタイマ管理番号でなければなりません。               
                                                                             
-----------------------------------------------------------------------------
.TIM_rdcalendar                                                              
日付/時刻の読み取り                                                          
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　　TIM_rdcalendar( calendar );                                          
TIM_CALEN 　 *calendar; 　/*　日付/時刻パラメータ　　　　　　*/              
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
TIM_CALEN 　 calendar;                                                       
                                                                             
TIM_rdcalendar( &calendar );                                                 
                                                                             
- 内容 -                                                                     
カレンダ時計から、現在の日付/時刻を読み取ります。                            
日付/時刻は、日付/時刻パラメータブロックの形式で読み取られます。日付/時刻パラ
メータブロックの形式を、以下に示します。                                     
calendar─→┌─┬─┬─────────────┐                           
　　　　　 0│Ｒ│Ｗ│　年　　（ 1980 〜 2079 ）│                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 2│Ｒ│Ｂ│　月　　（1〜 12 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 3│Ｒ│Ｂ│　日　　（1〜 31 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 4│Ｒ│Ｂ│　曜日　（0〜　6 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 5│Ｒ│Ｂ│　時　　（0〜 23 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 6│Ｒ│Ｂ│　分　　（0〜 59 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 7│Ｒ│Ｂ│　秒　　（0〜 59 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 8│Ｒ│Ｂ│ 1/100秒（0〜 99 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 9│Ｒ│Ｂ│　0　　　　　　　　　　　 │                           
　　　　　　└─┴─┴─────────────┘                           
各パラメータの値は、バイナリです。                                           
曜日の値の意味は、以下の通りです。                                           
0:日、1:月、2:火、3:水、4:木、5:金、6:土                                     
                                                                             
-----------------------------------------------------------------------------
.TIM_rdtime                                                                  
タイマのカウント値の読み取り                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 TIM_rdtime( timer, timeno );                                          
int 　 timeno;　　　　　　　 /* 　タイマ管理番号　　　　　　　　　*/         
TIM_TIME　  *timer;　　　　　/*　 タイマ管理パラメータ　　　　　　*/         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:タイマ管理番号に誤り                                                       
                                                                             
- 例 -                                                                       
int 　　　　timeno, ret;                                                     
TIM_TIME　　timer;                                                           
timeno = 1;                                                                  
                                                                             
ret = TIM_rdtime( &timer, timeno );                                          
                                                                             
- 内容 -                                                                     
タイマ管理では、登録されているタイマ毎に10ms単位でカウントを行っています。こ 
のカウント値は、タイマの登録時に指定された周期に達すると0に戻され、再びカウン
トを始めます(例えば、周期が100(1000ms)の場合、タイマカウント値は0〜99の値にな
ります)。この関数は、指定されたタイマ管理番号の、取得要求があった時点でのタイ
マカウント値を読み取ります。取得したタイマカウント値は、タイマ管理パラメータ 
ブロックに格納されます。タイマ管理番号は、登録済のタイマ管理番号でなければな 
りません。タイマ管理パラメータブロックの形式は、以下のとおりです。           
                                                                             
timer ─→┌─────────────────┐                             
　　　　 0│　　　　　　　　　　　　　　　　　│                             
　　　　　│─────────────────│                             
　　　　　├─┬─┬─────────────┤                             
　　　　 8│Ｒ│Ｗ│タイマカウント（ HIGH ）　│                             
　　　　　├─┼─┼─────────────┤                             
　　　　 A│Ｒ│Ｗ│タイマカウント（ LOW　）　│                             
　　　　　└─┴─┴─────────────┘                             
                                                                             
■タイマカウント( HIGH / LOW )                                               
                                                                             
取得要求があった時点の、タイマカウント値を示します。                         
カウント値の上位2byteがHIGHに、下位2byteがLOWに、設定されます。              
                                                                             
-----------------------------------------------------------------------------
.TIM_setcalendar                                                             
日付/時刻の設定                                                              
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　TIM_setcalendar( calendar );                                         
TIM_CALEN 　 *calendar; 　/*　日付/時刻パラメータ　　　　　　*/              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:日付/時刻の指定に誤り                                                      
                                                                             
- 例 -                                                                       
int 　　　　 ret;                                                            
TIM_CALEN 　 calendar;                                                       
calendar.year = 1990;                                                        
　　　…                                                                     
calendar.ext　= 　 0;                                                        
                                                                             
ret = TIM_setcalendar( &calendar );                                          
                                                                             
- 内容 -                                                                     
指定された日付/時刻を、カレンダ時計に設定します。                            
日付/時刻の指定は、日付/時刻パラメータブロックで指定します。                 
日付/時刻パラメータブロックの形式を、以下に示します。                        
                                                                             
calendar─→┌─┬─┬─────────────┐                           
　　　　　 0│Ｅ│Ｗ│　年　　（ 1980 〜 2079 ）│                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 2│Ｅ│Ｂ│　月　　（1〜 12 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 3│Ｅ│Ｂ│　日　　（1〜 31 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 4│Ｅ│Ｂ│　0　　　　　　　　　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 5│Ｅ│Ｂ│　時　　（0〜 23 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 6│Ｅ│Ｂ│　分　　（0〜 59 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 7│Ｅ│Ｂ│　秒　　（0〜 59 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 8│Ｅ│Ｂ│ 1/100秒（0〜 99 ）　　　 │                           
　　　　　　├─┼─┼─────────────┤                           
　　　　　 9│Ｅ│Ｂ│　0　　　　　　　　　　　 │                           
　　　　　　└─┴─┴─────────────┘                           
                                                                             
各パラメータの値は、バイナリで()内の範囲で指定してください。それ以外の値を指 
定した場合は、エラーとなります。曜日は、このルーチン内で自動設定されます。   
                                                                             
-----------------------------------------------------------------------------
.TIM_setclock                                                                
指定時刻の割り込み処理の登録                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　TIM_setclock( clock, clockno );                                      
TIM_CLOCK 　*clock; 　　　　/*　時計管理パラメータ　　　　　　　*/           
int 　　*clockno;　　　　　 /*　時計管理番号　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:時計管理パラメータの指定に誤り                                             
3:登録に失敗した(不可能だった)                                               
                                                                             
- 例 -                                                                       
int 　　　　 clockno, ret;                                                   
TIM_CLOCK 　 clock;                                                          
int 　　　　 func();　　　　/*　割り込み処理ルーチン　　　　　　*/           
clock.flg = 0x80;                                                            
clock.ext1 = 0;                                                              
BSETCODEADR( &clock.adr, func );                                             
clock.cycle = 0x0004;                                                        
　　…                                                                       
clock.sec = 0;                                                               
                                                                             
ret = TIM_setclock( &clock, &clockno );                                      
                                                                             
- 内容 -                                                                     
指定時刻の割り込み処理を登録します。                                         
登録が正常に行われると、時計管理パラメータブロックにより指定された、年･月･日･
時･分･秒から割り込みを開始します。                                           
割り込みが発生した場合、指定された割り込み処理に(NEAR CALL)します。処理を終了
した時には(NEAR RET)を行ってください。割り込み処理内でのレジスタの保存は必要 
ありません。時計管理パラメータブロックは、割り込み制御部分と時刻指定部分に分 
かれており、以下にその形式を示します。                                       
                                                                             
clock ─→┌─┬─┬───────────────┐┐                       
　　　　 0│Ｅ│Ｂ│設定フラグ　　　　　　　　　　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　 1│Ｅ│Ｂ│　0　　　　　　　　　　　　 　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　 2│Ｅ│Ｄ│時計管理割り込み処理ｵﾌｾｯﾄｱﾄﾞﾚｽ│├割り込み制御           
　　　　　├─┼─┼───────────────┤│                       
　　　　 6│Ｅ│Ｗ│リザーブ(0) 　　　　　　　　　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　 8│Ｅ│Ｗ│割り込み周期　　　　　　　　　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　 A│Ｅ│Ｗ│　0　　　　　　　　　　　　　 ││                       
　　　　　├─┼─┼───────────────┤┤                       
　　　　 C│Ｅ│Ｗ│　年　（ 1980 〜 2079 ）　　　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　 E│Ｅ│Ｂ│　月　（　1 〜 12 ）　　　　　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　 F│Ｅ│Ｂ│　日　（　1 〜 31 ）　　　　　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　10│Ｅ│Ｂ│　0　　　　　　　　　　　　　 │├時刻指定               
　　　　　├─┼─┼───────────────┤│                       
　　　　11│Ｅ│Ｂ│　時　（　0 〜 23 ）　　　　　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　12│Ｅ│Ｂ│　分　（　0 〜 59 ）　　　　　││                       
　　　　　├─┼─┼───────────────┤│                       
　　　　13│Ｅ│Ｂ│　秒　（　0 〜 59 ）　　　　　││                       
　　　　　└─┴─┴───────────────┘┘                       
                                                                             
時刻指定パラメータは、バイナリで() 内の値の範囲で指定してください。それ以外の
値を指定した場合は、エラーとなります。曜日は、本ルーチン内で自動設定されます 
                                                                             
■設定フラグ                                                                 
                                                                             
　 7　 6　 5　 4　 3　 2　 1 　0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│ 0│ 0│ 0│ 0│ 0│ 0│　│                                           
└┬┴─┴─┴─┴─┴─┴─┴┬┘                                           
　│　　　　　　　　　　　　　└─割り込みモード                             
　└───────────────指定時刻モード                             
                                                                             
■割り込みモード                                                             
                                                                             
0:インターバルモード                                                         
  (指定時刻から指定時間間隔で割り込み処理を起動し、取り消しされない限り指定時
  間間隔で、割り込み処理を続けるモード)                                      
1:ワンショットモード                                                         
  (指定時刻を通過すると、一回だけ割り込み処理を起動するモード。このモードの  
  時、割り込み周期は意味を持ちません)                                        
                                                                             
■指定時刻モード                                                             
                                                                             
0:年月日時分秒モード                                                         
  (指定されたパラメータブロックの年月日時分秒から、割り込み開始します)       
1:時分秒モード                                                               
  (パラメータブロックの年月日の指定を無効とし、この時計管理の登録が指定された
  時点での年月日が指定されたものとします。ただし、指定された時分秒は有効で   
  す。すなわち、当日の今後の割り込みに対して用いられます)                    
                                                                             
注)ワンショットモードで且つカウントモードの場合は、サポートしていません。    
                                                                             
■時計管理割り込み処理アドレス                                               
                                                                             
時計管理割り込み処理のオフセットアドレスを設定します。                       
                                                                             
■割り込み周期                                                               
                                                                             
割り込み時刻の間隔を指定します。                                             
                                                                             
　15　14　13　12　11　10　 9　 8　 7　 6　 5　 4　 3　 2　 1 　0             
┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│　│　│　│　│　│　│　│           
└─┴─┴─┴─┴─┴─┴─┴─┴─┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘           
　　　　　　　　　　　　　　　　　　　│　│　│　│　│　│　└─年         
　　　　　　　　　　　　　　　　　　　│　│　│　│　│　└───月         
　　　　　　　　　　　　　　　　　　　│　│　│　│　└─────日         
　　　　　　　　　　　　　　　　　　　│　│　│　└───────週         
　　　　　　　　　　　　　　　　　　　│　│　└─────────時         
　　　　　　　　　　　　　　　　　　　│　└───────────分         
　　　　　　　　　　　　　　　　　　　└─────────────秒         
                                                                             
各ビットがＯＮ(1)のとき、その周期が有効です。                                
割り込み周期と割り込み時刻の関係を次に示します。                             
                                                                             
┌───────┬────────────────────┐                 
│　 指定時刻　 │1987年8月6日（金）11時8分30秒           │                 
├───┬───┼──┬──┬──┬──┬──┬──┬──┤                 
│　割　│　年　│毎年│ ↑ │ ↑ │ ↑ │ ↑ │ ↑ │ ↑ │                 
│　　　├───┼──┼──┼──┼──┼──┼──┼──┤                 
│　り　│　月　│　　│毎月│ ↑ │ ↑ │ ↑ │ ↑ │ ↑ │                 
│　　　├───┼──┼──┼──┼──┼──┼──┼──┤                 
│　込　│　日　│　　│　　│毎日│ ↑ │ ↑ │ ↑ │ ↑ │                 
│　　　├───┼──┼──┼──┼──┼──┼──┼──┤                 
│　み　│　週　│　　│　　│　　│毎週│ ↑ │ ↑ │ ↑ │                 
│　　　├───┼──┼──┼──┼──┼──┼──┼──┤                 
│　周　│　時　│　　│　　│　　│　　│毎時│ ↑ │ ↑ │                 
│　　　├───┼──┼──┼──┼──┼──┼──┼──┤                 
│　期　│　分　│　　│　　│　　│　　│　　│毎分│ ↑ │                 
│　　　├───┼──┼──┼──┼──┼──┼──┼──┤                 
│ビット│　秒　│　　│　　│　　│　　│　　│　　│毎秒│                 
└───┴───┴──┴──┴──┴──┴──┴──┴──┘                 
                                                                             
指定時刻から、割り込みが開始します。例えば、割り込み周期が年の場合、指定時刻 
から毎年同じ月日の同じ時刻に割り込みが発生します。なお、割り込み周期は、複数 
指定できません。必ず1つのビットのみがＯＮで、その他はＯＦＦにしてください。複
数指定した場合は、パラメータエラーとなります。                               
                                                                             
-----------------------------------------------------------------------------
.TIM_settime                                                                 
タイマの登録                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　TIM_settime( timer, timeno );                                        
TIM_TIME　　*timer; 　　　　 /* 　タイマ管理パラメータ　　　　　*/           
int　　 *timeno;　　　　　　 /* 　タイマ管理番号　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:入力パラメータに誤り                                                       
3:登録に失敗した(不可能だった)                                               
                                                                             
- 例 -                                                                       
int 　　　　timeno, ret;                                                     
TIM_TIME　　timer;                                                           
int 　　　　 func();　　　　/*　割り込み処理ルーチン　　　　　　*/           
timer.mode = 0;                                                              
timer.inf  = 0;                                                              
BSETCODEADR( &timer.adr, func );                                             
timer.hcycle = 0;                                                            
timer.lcycle = 1;                                                            
                                                                             
ret = TIM_settime( &timer, &timeno );                                        
                                                                             
- 内容 -                                                                     
タイマ割り込み処理の登録を行います。                                         
タイマ割り込みの詳細は、タイマ管理パラメータブロックで指定します。タイマ管理 
パラメータブロックの形式を、以下に示します。                                 
                                                                             
timer ─→┌─┬─┬─────────────┐                             
　　　　 0│Ｅ│Ｂ│タイマ割り込みモード　　　│                             
　　　　　├─┼─┼─────────────┤                             
　　　　 1│Ｅ│Ｂ│　0　　　　　　　　　　　 │                             
　　　　　├─┼─┼─────────────┤                             
　　　　 2│Ｅ│Ｄ│ﾀｲﾏ 割り込み処理ｵﾌｾｯﾄｱﾄﾞﾚｽ│                             
　　　　　├─┼─┼─────────────┤                             
　　　　 6│Ｅ│Ｗ│リザーブ(0) 　　　　　　　│                             
　　　　　├─┼─┼─────────────┤                             
　　　　 8│Ｅ│Ｗ│タイマ周期（ HIGH ）　　　│                             
　　　　　├─┼─┼─────────────┤                             
　　　　 A│Ｅ│Ｗ│タイマ周期（ LOW　）　　　│                             
　　　　　└─┴─┴─────────────┘                             
また、各パラメタ詳細を以下に示します。                                       
                                                                             
■タイマ割り込みモード                                                       
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                           
└─┴─┴─┴─┴─┴─┴┬┴┬┘                                           
　　　　　　　　　　　　　│　└─割り込みモード                             
　　　　　　　　　　　　　└───割り込み情報                               
                                                                             
■割り込みモード                                                             
                                                                             
0:インターバルモード                                                         
  (指定時間間隔で割り込み処理を起動し、取り消しされない限り指定時間間隔で、割
  り込み処理を続けるモード)                                                  
1:ワンショットモード                                                         
  (指定時間経過すると、割り込み処理を起動するが、割り込みは一回のみで、割り込
  み処理後このタイマは、タイマ管理により自動的に取り消されるので、タイマの取 
  り消しをする必要はありません)                                              
                                                                             
■割り込み情報                                                               
                                                                             
0:割り込みモード                                                             
  (指定された周期で指定アドレスに割り込みを行います)                         
1:カウントモード                                                             
  (タイマカウントのみ行うことの指定であり、割り込み処理は行わない)           
                                                                             
注)ワンショットモードで且つカウントモードの場合はサポートしていません。      
                                                                             
■タイマ割り込み処理アドレス                                                 
                                                                             
割り込み情報がカウントモードの場合は、0を設定してください。                  
それ以外は、タイマ割り込み処理のオフセットアドレスとセグメントアドレスを設定 
します。                                                                     
                                                                             
■タイマ周期( HIGH / LOW )                                                   
                                                                             
タイマの周期を設定します。                                                   
周期の上位2byteを『HIGH』に、下位2byteを『LOW 』に設定してください。         
周期は、10ms単位に指定してください(1=10ms、2=20ms、3=30ms、…)。             
周期として、0を指定した場合は、パラメータエラーとなります。タイマ割り込みが発
生した場合、指定されたタイマ割り込み処理時に、(NEAR CALL)します。            
処理を終了した時には(NEAR RET)を行ってください。割り込み処理内でのレジスタの 
保存は必要ありません。                                                       
                                                                             
 9.　RS-232Cインターフェース                                                 
                                                                             
  9.1　関数一覧　　                                                          
                                                                             
┌────────┬────────────────────┐               
│　 関　数　名　 │　　　　　機　　　　　　　　能　　　　　│               
├────────┼────────────────────┤               
│RSB_chk 　　　　│シリアルポートの検出　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_open　　　　│回線のオープン　　　　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_close 　　　│回線のクローズ　　　　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_setpara 　　│通信パラメータの設定　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_rsetpara　　│リアル通信パラメータの設定　　　　　　　│               
├────────┼────────────────────┤               
│RSB_rdrpara 　　│リアル通信パラメータの読み取り　　　　　│               
├────────┼────────────────────┤               
│RSB_read　　　　│受信バッファ内有効データ数の読み取り　　│               
├────────┼────────────────────┤               
│RSB_receive 　　│データの受信　　　　　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_send　　　　│データの送信　　　　　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_ctrl　　　　│シリアルポートの制御　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_status　　　│ステータス情報の読み取り　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_initbuf 　　│受信バッファの初期化　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_break 　　　│ブレーク信号の送信　　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_setint　　　│拡張割り込みの設定　　　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_rdint 　　　│拡張割り込みの読み取り　　　　　　　　　│               
├────────┼────────────────────┤               
│RSB_dtr 　　　　│拡張ＤＴＲ信号の保持設定　　　　　　　　│               
└────────┴────────────────────┘               
                                                                             
  9.2　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.RSB_break                                                                   
ブレーク信号の送信                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　RSB_break( port, brktime );                                          
int 　　port ;　　　　　　　 /* 　ポート番号(0〜4)　　　　*/                 
unsigned int　 brktime ;　　 /* 　送信時間　　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
4:回線がオープン状態でない                                                   
6:送信時間の指定が異常                                                       
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
unsigned int brktime ;                                                       
                                                                             
port = 0 ;                                                                   
brktime = 65535 ;                                                            
ret = RSB_break( port, brktime ) ;                                           
                                                                             
- 注意 -                                                                     
時間指定が0のときは、エラーとなります。                                      
                                                                             
- 内容 -                                                                     
送信時間が終了するまで、ブレーク信号を送信します。                           
送信時間　　1〜65535×10ms                                                   
                                                                             
-----------------------------------------------------------------------------
.RSB_chk                                                                     
シリアルポートの検出                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
unsigned int　　RSB_chk( void );                                             
                                                                             
- 戻り値 -                                                                   
検出データを返します。                                                       
                                                                             
- 例 -                                                                       
unsigned int　　portdt ;                                                     
                                                                             
portdt =　RSB_chk() ;                                                        
                                                                             
- 内容 -                                                                     
RS-232Cカードの接続状態を読み取ります。                                      
                                                                             
検出データ                                                                   
                                                                             
　　　　　15　14　13　12　11　10　 9　 8　                                   
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
portdt: │ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│                                   
　　　　└─┴─┴─┴─┴─┴─┴─┴─┘                                   
　　　　　 7　 6　 5　 4　 3　 2　 1　 0　                                   
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
　　　　│ 0│ 0│ 0│　│　│　│　│　│                                   
　　　　└┬┴─┴┬┴┬┴┬┴┬┴┬┴┬┘                                   
　　　　　└─┬─┘　│　│　│　│　└─　ポート0                          
　　　　　　　│　　　│　│　│　└───　ポート1                          
　　　　　　　│　　　│　│　└─────　ポート2                          
　　　　　　　│　　　│　└───────　ポート3                          
　　　　　　　│　　　└─────────　ポート4                          
　　　　　　　└─────────────　リザーブ                         
                                                                             
ビット対応により、0:非接続、1:接続となります。                               
ポート0は内蔵のため、常に1となります。                                       
                                                                             
-----------------------------------------------------------------------------
.RSB_close                                                                   
回線のクローズ                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_close( port );                                                    
int 　 port 　　　　　　　　/*　ポート番号(0〜4)　　　　　*/                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
4:回線がオープン状態でない                                                   
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
                                                                             
port = 0 ;                                                                   
ret =  RSB_close( port ) ;                                                   
                                                                             
- 内容 -                                                                     
回線のクローズ(回線による割り込みの禁止)を行います。                         
回線による割り込みの禁止                                                     
･送信割り込み禁止(TXRdy OFF)                                                 
･受信割り込み禁止(RXRdy OFF)                                                 
･ブレーク信号検出割り込み禁止(Syndet OFF)                                    
                                                                             
FIFO機能が付いている機種では、標準ポートをクローズしようとした場合にFIFO機能 
が初期状態に戻ります。                                                       
                                                                             
-----------------------------------------------------------------------------
.RSB_ctrl                                                                    
シリアルポートの制御                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_ctrl( port, ctrl ) ;                                              
int 　 port ; 　　　　　　　/*　ポート番号(0〜4)　　　　　*/                 
unsigned int　　ctrl ;　　　/*　制御データ (1byte)　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
4:回線がオープン状態でない                                                   
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
unsigned int　　ctrl ;                                                       
                                                                             
port = 0 ;                                                                   
ctrl = 0x0000 ;                                                              
ret = RSB_ctrl( port, ctrl ) ;                                               
                                                                             
- 内容 -                                                                     
シリアルポートのDTR/RTS の信号をコントロールします。                         
このモードは、次にこの関数によって書き換えられるか、回線がクローズされるまで 
続きます。                                                                   
                                                                             
■制御データ                                                                 
                                                                             
　　　　 7　 6　 5　 4　 3　 2　 1　 0                                       
　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                     
ctrl: │ 0│ 0│　│ 0│ 0│ 0│　│ 0│                                     
　　　└─┴─┴┬┴─┴─┴─┴┬┴─┘                                     
　　　　　　　　│　　　　　　　└───ＤＴＲ　0:OFF                        
　　　　　　　　│　　　　　　　　　　　　　　　1:ON                         
　　　　　　　　└───────────ＲＴＳ　0:OFF                        
　　　　　　　　　　　　　　　　　　　　　　　　1:ON                         
                                                                             
-----------------------------------------------------------------------------
.RSB_dtr                                                                     
拡張ＤＴＲ信号の保持設定                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_dtr( port, sw );                                                  
int 　 port ; 　　　　　　　/*　ポート(0〜4)　　　　　　　*/                 
int 　 sw ; 　　　　　　　　/*　0:保持しない                                 
　　　　　　　　　　　　　　　　1:保持する　　　　　　　　　*/               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
                                                                             
- 例 -                                                                       
int 　 port, sw, ret ;                                                       
                                                                             
port = 0 ;                                                                   
sw = 1 ;                                                                     
ret = RSB_dtr( port, sw) ;                                                   
                                                                             
- 内容 -                                                                     
『回線クローズ:RSB_close 』を行っても、ＤＴＲ信号がＯＦＦされないように保持し
ます。                                                                       
なお、この機能は『回線オープン:RSB_open』を行うと無効となります。            
初期状態は｢保持しない｣になっています。                                       
                                                                             
-----------------------------------------------------------------------------
.RSB_initbuf                                                                 
受信バッファの初期化                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_initbuf( port );                                                  
int 　 port ; 　　　　　　　/*　ポート番号(0〜4)　　　　　*/                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
4:回線がオープン状態でない                                                   
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
                                                                             
port = 0 ;                                                                   
ret  = RSB_initbuf( port ) ;                                                 
                                                                             
- 内容 -                                                                     
受信バッファ内のデータカウント、各ポインタを初期化します。                   
                                                                             
-----------------------------------------------------------------------------
.RSB_open                                                                    
回線のオープン                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_open( port );                                                     
int 　 port ; 　　　　　　　/*　ポート番号(0〜4)　　　　　*/                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
5:回線がクローズ状態でない                                                   
7:通信パラメータが設定されていないのに、回線をオープンしようとした           
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
                                                                             
port = 0 ;                                                                   
ret =  RSB_open( port ) ;                                                    
                                                                             
- 内容 -                                                                     
『通信パラメータの設定:RSB_setpara 』で設定したモードで、回線をオープンします
通信パラメータを設定しない場合、またはすでにオープンされている状態ではオープ 
ンできません。回線オープン時には、受信バッファ内の文字カウンタ、入力ポインタ 
出力ポインタを初期化します。                                                 
FIFO機能が付いている機種では、標準ポートをオープンしようとした場合にFIFO機能 
がON状態になります。                                                         
                                                                             
-----------------------------------------------------------------------------
.RSB_rdint                                                                   
拡張割り込みの読み取り                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_rdint( port, inbuf );                                             
int 　 port ; 　　　　　　　/*　ポート(0〜4)　　　　　　　*/                 
RSB_INT   *intbuf ; 　　　　/*　割り込みパラメータ　　　　　  */             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
RSB_INT 　 intbuf  ;                                                         
port = 0 ;                                                                   
ret = RSB_rdint( port, &intbuf ) ;                                           
                                                                             
- 内容 -                                                                     
『拡張割り込みの設定:RSB_setint』で設定した割り込みパラメータを、指定した割り
込みパラメータ用領域に読み込みます。                                         
                                                                             
■割り込みパラメータアドレス                                                 
                                                                             
intbuf　→　┌─┬─┬─────────────────────┐           
　　　　　 0│Ｒ│Ｂ│　　　　　　　割り込みフラグ　　　　　　　│           
　　　　　　├─┼─┼─────────────────────┤           
　　　　　 1│Ｒ│Ｄ│　　ＣＳ信号割り込みオフセットアドレス　　│           
　　　　　　├─┼─┼─────────────────────┤           
　　　　　 5│Ｒ│Ｗ│　　ＣＳ信号割り込みセグメントアドレス　　│           
　　　　　　├─┼─┼─────────────────────┤           
　　　　　 7│Ｒ│Ｄ│　　ＣＩ信号割り込みオフセットアドレス　　│           
　　　　　　├─┼─┼─────────────────────┤           
　　　　　11│Ｒ│Ｗ│　　ＣＩ信号割り込みセグメントアドレス　　│           
　　　　　　└─┴─┴─────────────────────┘           
                                                                             
-----------------------------------------------------------------------------
.RSB_rdrpara                                                                 
リアル通信パラメータの読み取り                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_rdrpara( port, paraadr );                                         
int 　 port ; 　　　　　　　/*　ポート番号(0〜4)　　　　　*/                 
RSB_PARA  *paraadr ;　　　　/*　通信パラメータ　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
7:通信パラメータが設定されていないのに、通信パラメータを取得しようとした     
                                                                             
- 注意 -                                                                     
通信パラメータのオフセットアドレス 12H以降は、通信モードの拡張モード指定     
(bit7) がONの時のみ読み取りができ、OFFの時は読み取りができません。           
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
RSB_PARA　paraadr ;                                                          
                                                                             
port = 0 ;                                                                   
ret = RSB_rdrpara( port, &paraadr ) ;                                        
                                                                             
- 内容 -                                                                     
『リアル通信パラメータの設定 : RSB_rsetpara』で設定した通信パラメータを指定さ
れた通信パラメータ用領域に読み込みます。この関数は、リアル側のアドレスを読み 
取るのに使用します。                                                         
                                                                             
通信パラメータアドレス                                                       
                                                                             
paraadr →　┌─┬─┬───────────────────┐               
　　　　　 0│Ｒ│Ｂ│　　　通信モード　　　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 1│Ｒ│Ｂ│　　　ボーレート　　　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 2│Ｒ│Ｄ│　　　受信バッファオフセット　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 6│Ｒ│Ｗ│　　　受信バッファセグメント　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　 　8│Ｒ│Ｗ│　　　送信タイムアウト時間　　　　　　│               
　　　　　  ├─┼─┼───────────────────┤               
　　　　　 A│Ｒ│Ｗ│　　　受信タイムアウト時間　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 C│Ｒ│Ｄ│　　　受信通知オフセット　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　10│Ｒ│Ｗ│　　　受信通知セグメント　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　12│Ｒ│Ｂ│　　　拡張通信モード　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　13│Ｒ│Ｂ│　　　ＸＯＮコード　　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　14│Ｒ│Ｂ│　　　ＸＯＦＦコード　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　15│Ｒ│Ｄ│　　　送信バッファオフセット　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　19│Ｒ│Ｗ│　　　送信バッファセグメント　　　　　│               
　　　　　　└─┴─┴───────────────────┘               
                                                                             
-----------------------------------------------------------------------------
.RSB_read                                                                    
受信バッファ内の有効データ数の読み取り                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_read( port, leng );                                               
int 　 port ; 　　　　　　　/*　ポート番号(0〜4)　　　　　*/                 
int 　 *leng ;　　　　　　　/*　データ長　　　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
4:回線がオープン状態でない。                                                 
                                                                             
- 例 -                                                                       
int 　 port, leng, ret ;                                                     
                                                                             
port = 0 ;                                                                   
ret = RSB_read( port, &leng ) ;                                              
                                                                             
- 内容 -                                                                     
受信バッファ内に入っているデータ数を返します。                               
                                                                             
-----------------------------------------------------------------------------
.RSB_receive                                                                 
データの受信                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　RSB_receive(　port, data, status );                                  
int 　　port ;　　　　　　　　 /* 　ポート番号(0〜4)　　　*/                 
int 　 *data ;　　　　　　　　 /* 　データ　　　　　　　　　　*/             
unsigned int　　*status ; 　　 /* 　ステータス　　　　　　　　*/             
　　　　　　　　　　　　　　　 /* 　bit15-8 :ステータス　　　*/              
　　　　　　　　　　　　　　　 /* 　bit7-0　:拡張ステータス　*/              
                                                                             
- 戻り値 -                                                                   
 0:正常終了                                                                  
 2:範囲以外のポート番号を指定した                                            
 3:拡張カードが接続されていないポートを指定した                              
 4:回線がオープン状態でない                                                  
 8:タイムアウト時間内にデータの受信ができなかった                            
10:即時復帰の場合に受信バッファにデータがなかった                            
                                                                             
- 注意 -                                                                     
statusのbit7-0は、『通信パラメータの設定:RSB_setpara』で｢拡張通信モード｣の｢デ
ータ受信時のバッファオーバーフロー通知｣が1に設定されているときのみ有効です。 
｢バッファオーバーフロー通知｣が0に設定されているときは、statusのbit7-0の値は保
存されます。                                                                 
                                                                             
- 例 -                                                                       
int 　 port, data, ret ;                                                     
unsigned int　　status ;                                                     
                                                                             
port = 0 ;                                                                   
ret = RSB_receive( port, &data, &status ) ;                                  
                                                                             
- 内容 -                                                                     
受信バッファ内に入っているデータを受け渡します。                             
また、受信バッファが空の場合、受信タイムアウト時間内にデータの受信ができなか 
ったときは、強制復帰を行います。                                             
XON/XOFF制御ありのとき、XONコードとXOFFコードはデータにはなりません。        
バッファオーバーフローになった場合、あふれたデータは捨てられます。           
                                                                             
■ステータス                                                                 
                                                                             
　　　　　15　14　13　12　11　10　 9　 8                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
status: │　│　│　│　│　│　│　│　│                                   
　　　　└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                   
　　　　　│　│　│　│　│　│　│　└─書き込み状態 (TxRdy)　0:不可       
　　　　　│　│　│　│　│　│　│　　　　　　　　　　　　　　1:可能       
　　　　　│　│　│　│　│　│　└───読み込み状態 (RxRdy)　0:不可       
　　　　　│　│　│　│　│　│　　　　　　　　　　　　　　　　1:可能       
　　　　　│　│　│　│　│　└─────送信キャラクタ (TXE)　0:あり       
　　　　　│　│　│　│　│　　　　　　　　　　　　　　　　　　1:なし       
　　　　　│　│　│　│　└───────パリティエラー (PE) 　0:なし       
　　　　　│　│　│　│　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　│　│　└────────オーバランエラー (OE) 　0:なし       
　　　　　│　│　│　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　│　└───────────フレームエラー (FE) 　0:なし       
　　　　　│　│　　　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　└───────────SYNCキャラクタ (SYNDET) 　0:なし       
　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　└─────────────────DSR 信号 (DSR)　　0:OFF        
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　1:ON         
                                                                             
■拡張ステータス                                                             
                                                                             
　　　　　 7　 6　 5　 4　 3　 2　 1　 0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
status: │ 0│ 0│ 0│ 0│ 0│ 0│ 0│　│                                   
　　　　└─┴─┴─┴─┴─┴─┴─┴┬┘                                   
　　　　　　　　　　　　　　　　　　　│                                     
　　　　　　　　　　　　　　　　　　　└──バッファオーバーフロー           
　　　　　　　　　　　　　　　　　　　　　　　　　0:　なし                   
　　　　　　　　　　　　　　　　　　　　　　　　　1:　あり                   
                                                                             
-----------------------------------------------------------------------------
.RSB_rsetpara                                                                
リアル通信パラメータの設定                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_rsetpara( port, paraadr );                                        
int 　 port ; 　　　　　　　/*　ポート番号(0〜4)　　　　　*/                 
RSB_PARA  *paraadr; 　　　　/*　通信パラメータ　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
5:回線クローズ状態でない                                                     
6:受信バッファ領域が確保されていない                                         
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
RSB_PARA　paraadr, paraadra                                                  
                                                                             
port = 0 ;                                                                   
ret = RSB_rdrpara( port, &paraadr ) ;                                        
　　　　　　　･                                                              
　　　　　　　･                                                              
ret = RSB_setpara( port, &paraadra )；                                       
　　　　　　　･                                                              
　　　　　　　･                                                              
ret = RSB_rsetpara( port, &paraadr )；                                       
                                                                             
- 内容 -                                                                     
シリアル･ポートの通信パラメータを設定します。                                
オープン状態でパラメータを変更することはできません。                         
この関数は、リアル側のアドレスを戻すのに使用します。                         
                                                                             
-----------------------------------------------------------------------------
.RSB_send                                                                    
データの送信                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　RSB_send(  port, data, status ) ;                                    
int 　　port ;　　　　　　　　/*　ポート番号(0〜4)　　　　*/                 
int 　　data ;　　　　　　　　/*　データ(1バイト)　　　　　*/                
unsigned int　　*status ; 　　/*　ステータス　　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
 0:正常終了                                                                  
 2:範囲以外のポート番号を指定した                                            
 3:拡張カードが接続されていないポートを指定した                              
 4:回線がオープン状態でない                                                  
 8:タイムアウト時間内にデータの送信ができなかった                            
 9:XOFFコードを受信していたため、タイムアウト時間内にデータの送信ができなかっ
   た                                                                        
11:即時復帰の場合にデータが送信できる状態ではなかった                        
                                                                             
- 例 -                                                                       
int 　 port, data, ret ;                                                     
unsigned int　　status ;                                                     
                                                                             
port = 0 ;                                                                   
data = 0x41 ;                                                                
ret = RSB_send( port, data, &status ) ;                                      
                                                                             
- 内容 -                                                                     
シリアルポートにデータを書き込みます。                                       
送信タイムアウト時間内に送信できない場合は、強制復帰を行います。             
                                                                             
■ステータス                                                                 
                                                                             
　　　　　15　14　13　12　11　10　 9　 8                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
status: │ 0│ 0│ 0│ 0│ 0│ 0│ 0│ 0│                                   
　　　　└─┴─┴─┴─┴─┴─┴─┴─┘                                   
                                                                             
　　　　　 7　 6　 5　 4　 3　 2　 1　 0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
　　　　│　│　│　│　│　│　│　│　│                                   
　　　　└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                   
　　　　　│　│　│　│　│　│　│　│                                     
　　　　　│　│　│　│　│　│　│　└─書き込み状態 (TxRdy)　0:不可       
　　　　　│　│　│　│　│　│　│　　　　　　　　　　　　　　1:可能       
　　　　　│　│　│　│　│　│　└───読み込み状態 (RxRdy)　0:不可       
　　　　　│　│　│　│　│　│　　　　　　　　　　　　　　　　1:可能       
　　　　　│　│　│　│　│　└─────送信キャラクタ (TXE)　0:あり       
　　　　　│　│　│　│　│　　　　　　　　　　　　　　　　　　1:なし       
　　　　　│　│　│　│　└───────パリティエラー (PE) 　0:なし       
　　　　　│　│　│　│　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　│　│　└────────オーバランエラー (OE) 　0:なし       
　　　　　│　│　│　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　│　└───────────フレームエラー (FE) 　0:なし       
　　　　　│　│　　　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　└───────────SYNCキャラクタ (SYNDET) 　0:なし       
　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　└─────────────────DSR 信号 (DSR)　　0:OFF        
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　1:ON         
                                                                             
-----------------------------------------------------------------------------
.RSB_setint                                                                  
拡張割り込みの設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　RSB_setint( port, inbuf );                                           
int 　　port ;　　　　　　　 /* 　ポート番号(0〜4)　　　　　*/               
RSB_INT   *intbuf ; 　　　　 /* 　割り込みパラメータ　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
RSB_INT 　 intbuf ;                                                          
int 　 func1(), func2() ; 　/*　割り込み処理ルーチン　　　　　*/             
                                                                             
port = 0 ;                                                                   
intbuf.flg = 0x03 ; 　　　　/*　CS,CI 割り込みあり　　　　　　*/             
BSSETCODEADR( &intbuf.cs_adr, func1 ) ;                                      
BSSETCODEADR( &intbuf.ci_adr, func2 ) ;                                      
ret = RSB_setint( port, &intbuf ) ;                                          
                                                                             
- 注意 -                                                                     
CS割り込みとCI割り込みは割り込みが入った場合、NEAR CALLしますので、処理が終了
した時は、NEAR RETを行ってください。                                         
処理ルーチンに制御が渡った時、ルーチン内でのレジスタの保証は必要ありません。 
リンク時には、処理ルーチンのオフセットアドレスが0にならないように、オブジェク
トを配置してください。                                                       
CS/CI割り込みルーチンは、それぞれ一つずつしか登録できません。                
                                                                             
- 内容 -                                                                     
拡張割り込みの指定を行います。                                               
                                                                             
■割り込みパラメータアドレス                                                 
                                                                             
intbuf　→　┌─┬─┬─────────────────────┐           
　　　　　 0│Ｅ│Ｂ│　　　　　　　割り込みフラグ　　　　　　　│           
　　　　　　├─┼─┼─────────────────────┤           
　　　　　 1│Ｅ│Ｄ│　　ＣＳ信号割り込みオフセットアドレス　　│           
　　　　　　├─┼─┼─────────────────────┤           
　　　　　 5│Ｅ│Ｗ│　　ＣＳ信号割り込みセグメントアドレス　　│           
　　　　　　├─┼─┼─────────────────────┤           
　　　　　 7│Ｅ│Ｄ│　　ＣＩ信号割り込みオフセットアドレス　　│           
　　　　　　├─┼─┼─────────────────────┤           
　　　　　11│Ｅ│Ｗ│　　ＣＩ信号割り込みセグメントアドレス　　│           
　　　　　　└─┴─┴─────────────────────┘           
                                                                             
■割り込みフラグ                                                             
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│ 0│ 0│　│　│                                           
└─┴─┴─┴─┴─┴─┴┬┴┬┘                                           
　　　　　　　　　　　　　│　└──CS割り込み　0:　なし                     
　　　　　　　　　　　　　│　　　　　　　　　　1:　あり                     
　　　　　　　　　　　　　└────CI割り込み　0:　なし                     
　　　　　　　　　　　　　　　　　　　　　　　　1:　あり                     
                                                                             
■ＣＳ割り込みアドレス                                                       
                                                                             
回線からCS(Clear to Send)による割り込みがあったことを通知す処理ルーチンのアド
レスを設定します。　この指定は｢割り込みフラグ｣の｢CS割り込み(bit0)｣が｢1｣の場合
にのみ設定されます。なお、セグメントの値が｢0｣の時は通知しません。            
                                                                             
■ＣＩ割り込みアドレス                                                       
                                                                             
　回線からCI(Clear to indicator)による割り込みがあったことを通知す処理ルーチ 
ンのアドレスを設定します。                                                   
　この指定は｢割り込みフラグ｣の｢CI割り込み(bit1)｣が｢1｣の場合にのみ設定されます
なお、セグメントの値が｢0｣の時は通知しません。                                
                                                                             
-----------------------------------------------------------------------------
.RSB_setpara                                                                 
通信パラメータの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　 RSB_setpara( port, paraadr );                                         
int 　 port ; 　　　　　　　/*　ポート番号(0〜4)　　　　　*/                 
RSB_PARA  *paraadr ;　　　　/*　通信パラメータ　　　　　　　　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
5:回線がクローズ状態でない                                                   
6:受信バッファ領域が確保されていない                                         
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
RSB_PARA　paraadr ;                                                          
int 　 func1() ;　　　　　　/*　割り込み処理ルーチン　　　　　*/             
                                                                             
port = 0 ;                                                                   
paraadr.mode = 0x01 ;                                                        
paraadr.baud = 0x00 ;                                                        
paraadr.stime = paraadr.rtime = 65535 ;                                      
BSETCODEADR( &paraadr.rinfbuf, func1 ) ;                                     
ret =  RSB_setpara( port, &paraadr) ;                                        
                                                                             
- 内容 -                                                                     
シリアル･ポートの通信パラメータを設定します。                                
オープン状態で、パラメータを変更することはできません。                       
この関数は、ネイティブモードで使用する通信パラメータを設定するのに使用します 
                                                                             
通信パラメータアドレス                                                       
                                                                             
paraadr →　┌─┬─┬───────────────────┐               
　　　　　 0│Ｅ│Ｂ│　　　　　通信モード　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 1│Ｅ│Ｂ│　　　　　ボーレート　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 2│Ｅ│Ｄ│　　　受信バッファオフセット　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 6│Ｅ│Ｗ│　　　受信バッファセグメント　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 8│Ｅ│Ｗ│　　　送信タイムアウト時間　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 A│Ｅ│Ｗ│　　　受信タイムアウト時間　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　 C│Ｅ│Ｄ│　　　受信通知オフセット　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　10│Ｅ│Ｗ│　　　受信通知セグメント　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　12│Ｅ│Ｂ│　　　拡張通信モード　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　13│Ｅ│Ｂ│　　　ＸＯＮコード　　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　14│Ｅ│Ｂ│　　　ＸＯＦＦコード　　　　　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　15│Ｅ│Ｄ│　　　送信バッファオフセット　　　　　│               
　　　　　　├─┼─┼───────────────────┤               
　　　　　19│Ｅ│Ｗ│　　　送信バッファセグメント　　　　　│               
　　　　　　└─┴─┴───────────────────┘               
                                                                             
- 注意 -                                                                     
通信パラメータ内のオフセットアドレス 12H以降は、通信モードの拡張モード指定   
(bit7)がONの時のみ設定でき、 OFFの時は設定する必要はありません。             
                                                                             
■通信モード                                                                 
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│ 0│　│　│　│　│　│　│                                           
└┬┴─┴┬┴┬┴┬┴┬┴┬┴┬┘                                           
　│　　　│　│　│　│　│　└──ビット長　0:7 bit                        
　│　　　│　│　│　│　│　　　　　　　　　1:8 bit                        
　│　　　│　│　│　│　└────パリティ　0:なし                         
　│　　　│　│　│　│　　　　　　　　　　　1:あり                         
　│　　　│　│　│　└───パリティビット　0:奇数 (ODD)                   
　│　　　│　│　│　　　　　　　　　　　　　1:偶数 (EVEN)                  
　│　　　│　│　└─────ストップビット　0:1 bit                        
　│　　　│　│　　　　　　　　　　　　　　　1:2 bit                        
　│　　　│　└───────XON/XOFF制御　　0:なし                         
　│　　　│　　　　　　　　　　　　　　　　　1:あり                         
　│　　　└─────────クロック状態　　0:内部                         
　│　　　　　　　　　　　　　　　　　　　　　1:外部                         
　└────────────拡張モードの設定　0:なし                         
　　　　　　　　　　　　　　　　　　　　　　　1:あり                         
                                                                             
■ボーレート                                                                 
                                                                             
シリアルポートのボーレートを設定します。                                     
                                                                             
　 7　 6　 5　 4　 3　 2　 1 　0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│ 0│　│　│　│                                           
└─┴─┴─┴─┴─┴┬┴─┴┬┘                                           
　　　　　　　　　　　└─┬─┘                                             
　　　　　　　　　　　　　└────ボーレート                               
　　　　　　　　　　　　　　　　　　　000:　 300 bps                         
　　　　　　　　　　　　　　　　　　　001:　 600 bps                         
　　　　　　　　　　　　　　　　　　　010:　1200 bps                         
　　　　　　　　　　　　　　　　　　　011:　2400 bps                         
　　　　　　　　　　　　　　　　　　　100:　4800 bps                         
　　　　　　　　　　　　　　　　　　　101:　9600 bps                         
　　　　　　　　　　　　　　　　　　　110: 19200 bps                         
                                                                             
■受信バッファ                                                               
                                                                             
本ＦＭ Ｃ関数ライブラリでは、受信バッファをユーザが指定することができます。  
受信バッファのセレクタに0を入れた場合は、V2.1L10ライブラリ互換として、       
for RBIOS本体が確保します。実際に確保されたバッファアドレスは、通信パラメータ
中に返されます。また『リアル通信パラメータの読み取り:RSB_rdrpara』でも取得す 
ることができます。                                                           
                                                                             
受信バッファアドレス                                                         
　│                                                                         
　└→　┌─┬─┬─────────────────┐                       
　　　　│Ｅ│Ｄ│　　　受信バッファ長　　　　　　　│                       
　　　　├─┼─┼─────────────────┤                       
　　　　│　│Ｄ│　　　文字カウンタ　　　　　　　　│                       
　　　　├─┼─┼─────────────────┤                       
　　　　│　│Ｄ│　　　入力ポインタ　　　　　　　　│                       
　　　　├─┼─┼─────────────────┤                       
　　　　│　│Ｄ│　　　出力ポインタ　　　　　　　　│                       
────├─┼─┼─────────────────┤                       
　↑　　│Ｒ│Ｂ│　　　データ　　　　　　　　　　　│                       
　受信　├─┼─┼─────────────────┤                       
　バッ　│Ｒ│Ｂ│　　　ステータス　　　　　　　　　│                       
　ファ　├─┼─┼─────────────────┤                       
　領域　│　│　│　データ/ステータス部分の　　　 　│                       
　↓　　│　〜　〜　繰り返し　　　　　　　　　　　　〜                       
────└─┴─┴─────────────────┘                       
                                                                             
バッファ長　:　受信バッファ領域の大きさを設定します。                        
文字カウンタ:　受信バッファ内に入っているデータ数を示します。                
入力ポインタ:　次に入力される文字のバッファ位置を示します。                  
出力ポインタ:　次に出力される文字のバッファ位置を示します。                  
                                                                             
- 注意 -                                                                     
受信バッファ内でのセグメントオーバーランを防ぐ為、受信バッファ領域を受信バッ 
ファ長より16byte余分に確保します。                                           
文字カウンタ、入力ポインタ、出力ポインタは回線オープン時に初期化を行います。 
                                                                             
■タイムアウト時間                                                           
                                                                             
送信/受信のタイムアウト時間を設定します。                                    
                                                                             
　タイムアウト時間                                                           
　　指定時間　1〜65534×10ms                                                 
　　　0　　　　　　:　送/受信の結果にかかわらず即時復帰を行います            
　　　1〜65534  　 :　指定時間内に送/受信が完了しない場合はタイムアウトとなり
                      強制復帰をおこないます。                               
　　　65535 　　　 :　送/受信が完了するまで復帰しません                      
                                                                             
■受信通知アドレス                                                           
                                                                             
回線からデータを受信したことを通知する処理ルーチンのアドレスを設定します。   
                                                                             
受信通知アドレスのparaadrへのセットは、『5.1.1 アドレスのセット方法について』
を参照してください。但し、リンク時に受信通知アドレスが0にならないように、オブ
ジェクトを配置してください。                                                 
データを受信した場合、処理ルーチンヘセグメント内呼び出し(NEAR CALL)しますので
処理が終了した時は、セグメント内復帰(NEAR RET)を行ってください。処理ルーチン 
に制御が渡った時、ルーチン内でのレジスタの保護は必要ありません。             
ただし、受信通知アドレスは、一つしか登録できません。                         
                                                                             
通知する場合は受信通知ステータスをいっしょに渡します。                       
                                                                             
受信通知ステータス                                                           
                                                                             
ＡＨ=00Ｈ　　正常                                                            
　　=10Ｈ　　受信バッファ内のデータがあふれた                                
　　=11Ｈ　　ストップビットが検出できない                                    
　　=12Ｈ　　正しいパリティビットが検出できない                              
ＡＬ:受信ポート番号                                                          
                                                                             
- 注意 -                                                                     
セグメントの値が0の時は、通知しません。                                      
通信パラメタを1度、設定すると『通信パラメタが設定されていないのに･･･』のエラ 
ーは発生しません。                                                           
                                                                             
受信通知割り込み制御の流れ                                                   
                                                                             
┌───────┐　　　┌───────┐　　　┌───────┐           
│　　　　　　　│　　　│　　　　　　　│　　　│　　　　　　　│           
│　ユーザ　　　│　　　│　RS-232C 　　│　　　│　割り込み　　│           
│　　　　　　　│　　　│　　　　　　　│　　　│　　　　　　　│           
│　プログラム　│　　　│　インタ　　　│　　　│　処理　　　　│           
│　　　　　　　│　　　│　　　　　　　│　　　│　　　　　　　│           
│　　　　　　　│　　　│　　フェース　│　　　│　　　　　　　│           
│　　　　　　　│　2.　│　　　　　　　│　1.  │　　　　　　　│           
├───────┤←┐　├───────┤←┐　│　　　　　　　│           
│　受信通知　　│　└─│　データ受信　│　└─│　　　　　　　│           
│　　　　　　　│　　　│　　　　　　　│　　　│　　　　　　　│           
│　　割り込み　│　┌→│　　割り込み　│　┌→│　　　　　　　│           
│　　　　　　　│　│　│　　　　　　　│　│　│　　　　　　　│           
│　　　ハンドラ│　│　│　　　ハンドラ│　│　│　　　　　　　│           
└───────┘─┘　└───────┘─┘　└───────┘           
　　　　　　　　　　3.　　　　　　　　　　　4.                               
                                                                             
1.回線よりデータが受信され、割り込み管理から RS-232Cの割り込みハンドラへ制御 
  が渡る。                                                                   
2.データを受信バッファに入れ、ユーザの割り込みハンドラが登録されている場合に 
  そのハンドラへ通知を行う。                                                 
3.受信通知ハンドラからRS-232Cの割り込みハンドラへ復帰を行う。                
4.RS-232Cの割り込みハンドラから割り込み管理への復帰を行う。                  
                                                                             
■拡張通信モード                                                             
                                                                             
　 7 　6 　5 　4 　3 　2 　1 　0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│ 0│ 0│ 0│ 0│　│　│　│　│                                           
└─┴─┴─┴─┴┬┴┬┴┬┴┬┘                                           
　　　　　　　　　│　│　│　└──XON/XOFFコード変更                       
　　　　　　　　　│　│　│　　　　　　　　　　　0:なし                     
　　　　　　　　　│　│　│　　　　　　　　　　　1:あり                     
　　　　　　　　　│　│　└────データ受信時の                           
　　　　　　　　　│　│　　　　　　バッファオーバーフロー通知               
　　　　　　　　　│　│　　　　　　　　　　　　　0:なし                     
　　　　　　　　　│　│　　　　　　　　　　　　　1:あり                     
　　　　　　　　　│　└──────RTSフロー制御                            
　　　　　　　　　│　　　　　　　　　　　　　　　0:なし                     
　　　　　　　　　│　　　　　　　　　　　　　　　1:あり                     
　　　　　　　　　└────────送信バッファアドレスの指定               
　　　　　　　　　　　　　　　　　　　　　　　　　0:なし                     
　　　　　　　　　　　　　　　　　　　　　　　　　1:あり                     
                                                                             
■XON/XOFFコード                                                             
                                                                             
XON/XOFFのバッファ制御を指定します。                                         
このコードは、｢拡張通信モード｣の｢XON/XOFFコード変更(bit0)｣が｢1｣の場合にのみ設
定されてます。                                                               
                                                                             
■送信バッファ                                                               
                                                                             
本ＦＭ Ｃ関数ライブラリでは、送信バッファをユーザが指定することができます。  
                                                                             
- 注意 -                                                                     
セグメントの値が0の時は、送信バッファはforBIOS本体に確保されます。実際に確保 
されたバッファアドレスは、送信バッファが指定されていた場合には通信パラメータ 
中に返されます。また『リアル通信パラメータの読み取り:RSB_rdrpara』でも取得す 
ることができます。                                                           
                                                                             
送信バッファアドレス                                                         
　│                                                                         
　└→　┌─┬─┬─────────────────┐                       
　　　　│Ｅ│Ｄ│　　　送信バッファ長　　　　　　　│                       
　　　　├─┼─┼─────────────────┤                       
　　　　│Ｅ│Ｄ│　　　文字カウンタ　　　　　　　　│                       
　　　　├─┼─┼─────────────────┤                       
　　　　│Ｅ│Ｄ│　　　入力ポインタ　　　　　　　　│                       
　　　　├─┼─┼─────────────────┤                       
　　　　│Ｅ│Ｄ│　　　出力ポインタ　　　　　　　　│                       
────├─┼─┼─────────────────┤                       
　↑　　│Ｅ│Ｂ│　　　データ　　　　　　　　　　　│                       
　　　　├─┼─┼─────────────────┤                       
　送信　│　│　│　　　　　　　　　　　　　　　　　│                       
　バッ　│　│　│　　　　　　　　　　　　　　　　　│                       
　ファ　│　│　│　データの繰り返し　　　　　　　　│                       
　領域　〜　〜　〜　　　　　　　　　　　　　　　　　〜                       
　↓　　│　│　│　　　　　　　　　　　　　　　　　│                       
────└─┴─┴─────────────────┘                       
                                                                             
バッファ長　:　送信バッファ領域の大きさを設定します。                        
文字カウンタ:　送信バッファ内に入っているデータ数を示します。                
入力ポインタ:　次に入力される文字のバッファ位置を示します。                  
出力ポインタ:　次に出力される文字のバッファ位置を示します。                  
                                                                             
■RTSフロー制御                                                              
                                                                             
本bitを｢1｣に設定すると、｢通信モード｣のXON/XOFF制御指定が無視され、RTSフロー制
御になります。                                                               
                                                                             
                                                                             
-----------------------------------------------------------------------------
.RSB_status                                                                  
ステータス情報の読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int 　　RSB_status( port, status, serial ) ;                                 
int 　　port ;　　　　　　/*　ポート番号(0〜4)　　　　　　 */                
unsigned int　*status ; 　/*　bit15-8 :ステータスレジスタの                  
　　　　　　　　　　　　　　　　　　　　内容　　　　　　　　　 */            
　　　　　　　　　　　　　/*　bit7-0　:信号線状態　　　　　　 */             
unsigned int　*scrial ; 　/*　bit15-8 :0:オープン状態　　　 */               
　　　　　　　　　　　　　　　　　　　　1:クローズ状態　　　 */              
　　　　　　　　　　　　　/*　bit7-0　:シリアルポートの状態　 */             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
2:範囲以外のポート番号を指定した                                             
3:拡張カードが接続されていないポートを指定した                               
                                                                             
- 例 -                                                                       
int 　 port, ret ;                                                           
unsigned int　　status , serial ;                                            
                                                                             
port = 0 ;                                                                   
ret = RSB_status( port, &status , &serial ) ;                                
                                                                             
- 内容 -                                                                     
シリアルポートのステータス情報を通知します。                                 
                                                                             
■シリアルポートの状態                                                       
                                                                             
シリアルポートの制御で設定したDTS/RTS信号の状態                              
                                                                             
　　　　　 7　 6　 5　 4　 3　 2　 1　 0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
serial: │ 0│ 0│　│ 0│ 0│ 0│　│ 0│                                   
　　　　└─┴─┴┬┴─┴─┴─┴┬┴─┘                                   
　　　　　　　　　│　　　　　　　└───ＤＴＲ　0:OFF                      
　　　　　　　　　│　　　　　　　　　　　　　　　1:ON                       
　　　　　　　　　└───────────ＲＴＳ　0:OFF                      
　　　　　　　　　　　　　　　　　　　　　　　　　1:ON                       
                                                                             
■ステータスレジスタの内容                                                   
                                                                             
　　　　　15　14　13　12　11　10　 9　 8                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
status: │　│　│　│　│　│　│　│　│                                   
　　　　└┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘                                   
　　　　　│　│　│　│　│　│　│　└─書き込み状態 (TxRdy)　0:不可       
　　　　　│　│　│　│　│　│　│　　　　　　　　　　　　　　1:可能       
　　　　　│　│　│　│　│　│　└───読み込み状態 (RxRdy)　0:不可       
　　　　　│　│　│　│　│　│　　　　　　　　　　　　　　　　1:可能       
　　　　　│　│　│　│　│　└─────送信キャラクタ (TXE)　0:あり       
　　　　　│　│　│　│　│　　　　　　　　　　　　　　　　　　1:なし       
　　　　　│　│　│　│　└───────パリティエラー (PE) 　0:なし       
　　　　　│　│　│　│　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　│　│　└────────オーバランエラー (OE) 　0:なし       
　　　　　│　│　│　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　│　└───────────フレームエラー (FE) 　0:なし       
　　　　　│　│　　　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　│　└───────────SYNCキャラクタ (SYNDET) 　0:なし       
　　　　　│　　　　　　　　　　　　　　　　　　　　　　　　　　1:あり       
　　　　　└─────────────────DSR 信号 (DSR)　　0:OFF        
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　1:ON         
                                                                             
■信号線状態                                                                 
                                                                             
　　　　　　7　6　 5　 4　 3　 2　 1　 0                                     
　　　　┌─┬─┬─┬─┬─┬─┬─┬─┐                                   
status: │ 0│ 0│ 0│ 0│　│　│　│　│                                   
　　　　└─┴─┴─┴─┴┬┴┬┴┬┴┬┘                                   
　　　　　　　　　　　　　│　│　│　└──Ｃ1　　 0:OFF                    
　　　　　　　　　　　　　│　│　│　　　　　　　　1:ON                     
　　　　　　　　　　　　　│　│　└────ＣＴＳ　0:OFF                    
　　　　　　　　　　　　　│　│　　　　　　　　　　1:ON                     
　　　　　　　　　　　　　│　└──────ＣＤ　　0:OFF                    
　　　　　　　　　　　　　│　　　　　　　　　　　　1:ON                     
　　　　　　　　　　　　　└────────ＤＳＲ　0:OFF                    
　　　　　　　　　　　　　　　　　　　　　　　　　　1:ON                     
                                                                             
 10.　ブザー(BEEP音)インターフェース                                         
                                                                             
  10.1　関数一覧　　                                                         
                                                                             
┌─────────┬───────────────────┐               
│　　関　数　名　　│　　　　　　機　　　　　能　　　　　　│               
├─────────┼───────────────────┤               
│BPB_on　　　　　　│ブザー　ＯＮ　　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│BPB_off 　　　　　│ブザー　ＯＦＦ　　　　　　　　　　　　│               
├─────────┼───────────────────┤               
│BPB_fixon 　　　　│ブザー（一定時間）　ＯＮ　　　　　　　│               
├─────────┼───────────────────┤               
│BPB_freeon　　　　│ブザー（カウンタ数、指定時間）ＯＮ　　│               
├─────────┼───────────────────┤               
│BPB_rdinf 　　　　│ブザー情報の読み取り1　　　　　　　　 │               
├─────────┼───────────────────┤               
│BPB_freeon2 　　　│ブザー（周波数、指定時間）ＯＮ　　　　│               
├─────────┼───────────────────┤               
│BPB_rdinf2　　　　│ブザー情報の読み取り2　　　　　　　　 │               
└─────────┴───────────────────┘               
                                                                             
  10.2　各関数の解説                                                         
                                                                             
-----------------------------------------------------------------------------
.BPB_fixon                                                                   
ブザー (一定時間) ＯＮ                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　 BPB_fixon( void );                                                    
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
BPB_fixon();                                                                 
                                                                             
- 内容 -                                                                     
システムが設定した周波数、時間でブザーを鳴らします。                         
システム周波数 = 1200Hz                                                      
システム時間　 = 200ms                                                       
                                                                             
-----------------------------------------------------------------------------
.BPB_freeon                                                                  
ブザー (カウンタ数、指定時間) ＯＮ                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　 BPB_freeon( time, count );                                            
int 　 time;　　　　　　　　/*　時間　　　　　　　　　　　　　　*/           
int 　 count; 　　　　　　　/*　カウンタ数　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int 　 time, count;                                                          
time = 10;                                                                   
count =16;                                                                   
                                                                             
BPB_freeon( time, count );                                                   
                                                                             
- 内容 -                                                                     
指定された周波数、時間でブザーを鳴らします。                                 
時間(time):10ms単位                                                          
　　　　　　　指定時間が｢0｣のときは音は鳴りません。                          
カウンタ数(count):BEEP音の周波数を決める値                                   
                                                                             
カウンタ数は、次の計算式によって求められます。                               
カウンタ数 = 基本周波数/周波数                                               
基本周波数 = 19200Hz (一定)                                                  
例えば、周波数を1200Hzにする場合は、                                         
カウンタ数 = 基本周波数/周波数                                               
　　　　　 = 19200 ÷1200                                                    
　　　　　 = 16                                                              
カウンタ数は、16になります。                                                 
                                                                             
-----------------------------------------------------------------------------
.BPB_freeon2                                                                 
ブザー (周波数、指定時間) ＯＮ                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　 BPB_freeon2( time, freq );                                            
int 　 time;　　　　　　　　/*　時間　　　　　　　　　　　　　　*/           
int 　 freq;　　　　　　　　/*　周波数　　　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int 　 time, freq;                                                           
time = 10;                                                                   
freq = 1200;                                                                 
                                                                             
BPB_freeon2( time, freq );                                                   
                                                                             
- 内容 -                                                                     
指定された周波数、時間でブザーを鳴らします。                                 
時間　(time):10ms単位                                                        
　　　　　　　指定時間が｢0｣のときは音は鳴りません。                          
周波数(freq):BEEP音の周波数を決める値                                        
                                                                             
-----------------------------------------------------------------------------
.BPB_off                                                                     
ブザー　ＯＦＦ                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　　BPB_off( void );                                                     
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
BPB_off();                                                                   
                                                                             
- 内容 -                                                                     
『ブザー　ＯＮ:BPB_on』で鳴らしたブザーを止めます。                          
                                                                             
-----------------------------------------------------------------------------
.BPB_on                                                                      
ブザー　ＯＮ                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
void　　BPB_on( void );                                                      
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
BPB_on();                                                                    
                                                                             
- 内容 -                                                                     
システムが設定した周波数で、ブザーを鳴らします。                             
システム周波数 = 1200Hz                                                      
                                                                             
-----------------------------------------------------------------------------
.BPB_rdinf                                                                   
ブザー情報の読み取り1                                                        
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int BPB_rdinf( time, count );                                                
int 　 *time; 　　　　　　　/*　時間　　　　　　　　　　　　　　*/           
int 　 *count;　　　　　　　/*　カウンタ数　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:ブザーが止まっている                                                       
1:ブザーが鳴っている                                                         
                                                                             
- 例 -                                                                       
int 　　beepon, time, count;                                                 
                                                                             
beepon = BPB_rdinf( &time, &count );                                         
                                                                             
- 内容 -                                                                     
『ブザー(指定時間):BPB_freeon』で指定した情報(カウンタ数、時間)を読み取ります
                                                                             
　　カウンタ数(count):BEEP音の周波数を決める値                               
　　時間　　　(time):10ms単位                                                
『ブザー(指定時間):BPB_freeon』で、周波数、時間が指定されていない場合は、カウ
ンタ数と時間は0になっています。                                              
                                                                             
-----------------------------------------------------------------------------
.BPB_rdinf2                                                                  
ブザー情報の読み取り2                                                        
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <FMCFRB.H>                                                          
int BPB_rdinf2( time, freq );                                                
int 　 *time; 　　　　　　　/*　時間　　　　　　　　　　　　　　*/           
int 　 *freq; 　　　　　　　/*　周波数　　　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:ブザーが止まっている                                                       
1:ブザーが鳴っている                                                         
                                                                             
- 例 -                                                                       
int 　　beepon, time, freq;                                                  
                                                                             
beepon = BPB_rdinf2( &time, &freq );                                         
                                                                             
- 内容 -                                                                     
『ブザー(指定時間):BPB_freeon2 』で指定した情報(周波数、時間)を読み取ります。
                                                                             
　　周波数(freq):BEEP音の周波数を決める値                                    
　　時間　(time):10ms単位                                                    
『ブザー(指定時間):BPB_freeon2 』で、周波数、時間が指定されていない場合は、周
波数と時間は0になっています。                                                
                                                                             
*****************************************************************************
第6章　ＣＤ-ＲＯＭライブラリ                                                 
*****************************************************************************
                                                                             
 1.　処理手順例                                                              
                                                                             
  1.1　データリード実行例                                                    
                                                                             
┌─────────────────────────┐                       
│　　　　　　　　　　 スタート　　　　　　　　　　 │                       
└─────┬────────────┬──────┘                       
　　　　　　│　　　　　　　　　　　　│                                     
┌─────┴──────┐　　　　　│                                     
│ドライブモードの読み取り│　　　　　│                                     
│　　　　　　　　　　　　│　　　　　│                                     
│　　( cdr_rdrvmd )　　　│　　　　　│                                     
└─────┬──────┘　　　　　│                                     
　　　　　　│　　　　　　　　　　　　│                                     
┌─────┴──────┐　　　　　│                                     
│ドライブモードの設定　　│　　　　　│                                     
│　　　　　　　　　　　　│　　　　　│                                     
│　　( cdr_sdrvmd )　　　│　　　　　│                                     
└─────┬──────┘　　　　　│                                     
　　　　　　│　　　　　　　　　　　　│                                     
┌─────┴────────────┴──────┐                       
│　ドライブステータス情報の読み取り( cdr_status )　│                       
└───────────┬─────────────┘                       
　　　　　　　　　　　　│                                                   
┌───────────┴─────────────┐                       
│　データの読み取り ( cdr_read )　　　　　　　　　 │                       
│　　　　　　　　　　　　　　　　　　　　　　　　　│                       
│　データの読み取り（時間指定）( cdr_tread )　　　 │                       
└───────────┬─────────────┘                       
　　　　　　　　　　　　│                                                   
┌───────────┴─────────────┐                       
│　　　　　　　　　　エンド　　　　　　　　　　　　│                       
└─────────────────────────┘                       
                                                                             
  1.2　音楽演奏実行例                                                        
┌─────────────────────────┐                       
│　　　　　　　　　　スタート　　　　　　　　　　　│                       
└────────────┬────────────┘                       
　　　　　　　　　　　　　│                                                 
┌────────────┴────────────┐                       
│　コンパクトディスク情報の読み取り( cdr_cdinfo )  │                       
└────────────┬────────────┘                       
　　　　　　　　　　　　　│                                                 
┌────────────┴────────────┐                       
│　　　時間指定音楽演奏スタート( cdr_mtplay )　　　│                       
└────────────┬────────────┘                       
　　　　　　　　　　　　　│                                                 
┌────────────┴────────────┐                       
│　　　　音楽演奏状態の読み取り　( cdr_mphase )　　│                       
└────────────┬────────────┘                       
　　　　　　　　　　　　　│                                                 
┌────────────┴────────────┐                       
│　　　　　　音楽演奏ストップ　( cdr_mstop ) 　　　│                       
└────────────┬────────────┘                       
　　　　　　　　　　　　　│                                                 
┌────────────┴────────────┐                       
│　　　　　　　　　　　エンド　　　　　　　　　　　│                       
└─────────────────────────┘                       
                                                                             
使用上の注意                                                                 
　本ライブラリは、forRBIOS(Native modeからReal mode BIOSを使用可能にするｲﾝﾀｰﾌ
ｪｰｽ)を使用して動作するライブラリです。forRBIOSが常駐していない場合は、完全な 
動作をしません。                                                             
                                                                             
 2.　ヘッダファイルｃｄｒｆｒｂ.ｈについて                                   
　ヘッダファイルでは、Ｃ関数ライブラリのプロトタイプ宣言およびエラー値の定義 
を行います。                                                                 
　Ｃ関数ライブラリを使用する場合には、Ｃ言語のプリプロセッサ疑似命令 #include
を使用してヘッダファイルcdrfrb.hをソースファイルに取り込んでください。       
                                                                             
 3.　ＣＤ-ＲＯＭエラー情報                                                   
                                                                             
  3.1　ＣＤ-ＲＯＭエラー内容と処理方法                                       
                                                                             
　Ｃ関数ライブラリは正常に動作を行った場合には0を返します。0以外はエラーが発 
生したことを表し、下記の値を設定します。                                     
                                                                             
ＣＤ-ＲＯＭエラー内容と発生時の処理方法                                      
┌─────────┬─────────┬────────────────┐ 
│　 　エラー値　　 │　　エラー内容　　│　　　　 原因または対処方法　　 │ 
├─────┬───┼─────────┼────────────────┤ 
│CDERR0　　│0x1 　│ノットレディ　　　│コンパクトディスクが入っていない│ 
│　　　　　│　　　│　　　　　　　　　│　　　　　　　　　　　　　　　　│ 
│　　　　　│　　　│（ドライブ状態）　│　　　　　　　　　　　　　　　　│ 
├─────┼───┼─────────┼────────────────┤ 
│CDERR1　　│0x2 　│パラメータエラー　│指定されたコマンド、パラメータに│ 
│　　　　　│　　　│　　　　　　　　　│誤りがある。　　　　　　　　　　│ 
│　　　　　│　　　│　　　　　　　　　│プログラムミス。　　　　　　　　│ 
├─────┼───┼─────────┼────────────────┤ 
│CDERR2　　│0x4 　│ドライブ非接続状態│指定したドライブが存在しない。　│ 
│　　　　　│　　　│　　　　　　　　　│ＣＤ-ＲＯＭユニットの電源が入っ │ 
│　　　　　│　　　│　　　　　　　　　│ていない。　　　　　　　　　　　│ 
├─────┼───┼─────────┼────────────────┤ 
│CDERR3　　│0x8 　│コマンド異常終了　│ＣＤ-ＲＯＭがコマンドを異常終了 │ 
│　　　　　│　　　│　　　　　　　　　│させた。　　　　　　　　　　　　│ 
│　　　　　│　　　│　　　　　　　　　│再実行が必要。　　　　　　　　　│ 
├─────┼───┼─────────┼────────────────┤ 
│CDERR4　　│0x10　│メディアエラー　　│メディアがキズなどによりアクセス│ 
│　　　　　│　　　│　　　　　　　　　│ができない。　　　　　　　　　　│ 
│　　　　　│　　　│　　　　　　　　　│オーディオトラックをＲＯＭリード│ 
│　　　　　│　　　│　　　　　　　　　│した。　　　　　　　　　　　　　│ 
│　　　　　│　　　│　　　　　　　　　│ＲＯＭトラックを演奏しようとした│ 
├─────┼───┼─────────┼────────────────┤ 
│CDERR5　　│0x20　│ハードエラー　　　│コマンド実行中、ハード的にエラー│ 
│　　　　　│　　　│　　　　　　　　　│が発生しアクセスが中断された。　│ 
│　　　　　│　　　│　　　　　　　　　│自己診断異常。　　　　　　　　　│ 
├─────┼───┼─────────┼────────────────┤ 
│CDERR7　　│0x80　│メディア交換あり　│コンパクトディスクが交換された。│ 
├─────┼───┼─────────┼────────────────┤ 
│DEVERR　　│0x100 │指定デバイス番号誤│ＣＤ-ＲＯＭ以外のデバイスがアク │ 
│　　　　　│　　　│り　　　　　　　　│セスされた。　　　　　　　　　　│ 
├─────┼───┼─────────┼────────────────┤ 
│DEVPLY　　│0x102 │音楽演奏中　　　　│音楽演奏中に他の処理を行った。　│ 
│　　　　　│　　　│　　　　　　　　　│音楽演奏を中止して処理を行ってく│ 
│　　　　　│　　　│　　　　　　　　　│ださい。　　　　　　　　　　　　│ 
├─────┼───┼─────────┼────────────────┤ 
│DEVPAUSE　│0x104 │既に音楽演奏が一時│演奏が一時停止中に、また一時停止│ 
│　　　　　│　　　│停止の状態　　　　│を行おうとした。　　　　　　　　│ 
├─────┼───┼─────────┼────────────────┤ 
│DEVNPAUSE │0x108 │音楽演奏が一時停止│演奏が一時停止中でないのに、一時│ 
│　　　　　│　　　│状態でない　　　　│停止解除を行おうとした。　　　　│ 
└─────┴───┴─────────┴────────────────┘ 
                                                                             
 4.　ＣＤ-ＲＯＭライブラリ                                                   
                                                                             
  4.1　サンプルプログラム                                                    
┌────────────────────────────────────┐ 
│　CD-ROMの内容から音楽演奏データを選んで演奏します。　　　　　　　　　　│ 
│                                                                        │ 
│　演奏の途中で何かキーが押されたら演奏を停止し、次の音楽データを演奏しま│ 
│                                                                        │ 
│　す。　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│ 
│                                                                        │ 
└────────────────────────────────────┘ 
                                                                             
#include "stdio.h"                                                           
#include "snd.h"                                                             
#include "cdrfrb.h"                                                          
#include "fmcfrb.h"                                                          
                                                                             
extern　　void SubOne(char, char, char, char *, char *, char *);             
extern　　void IfKey_Next(void);                                             
                                                                             
struct　　TIMEADRS　　dsktim;                                                
struct　　TIMEADRS　　trktim[99];                                            
struct　　TIMEADRS　　starttime;                                             
struct　　TIMEADRS　　endtime;                                               
                                                                             
int 　　　 i, ret, driveno = 0x00;                                           
int 　　　 dsktype = 0, sttrk = 0, endtrk = 0;                               
unsigned int　　song_mum;                                                    
                                                                             
void main()                                                                  
{                                                                            
　　SND_elevol_init(); 　　　　　 /* 　 サウンドライブラリを用いて */        
　　SND_elevol_set(1,127,127); 　 /* 　 ボリュームを調節します　　 */        
　　SND_elevol_mute(0x0030);                                                 
                                                                             
　　printf("ディスク情報を読み取ります\n");                                  
　　ret = cdr_cdinfo( driveno, &dsktype, &sttrk, &endtrk, trktim, &dsktim ); 
　　if((ret & 0x80)!= 0){                                                    
　　　　printf("ハードエラーです!!ディスク情報が読めませんでした。\n");      
　　　　exit(1);                                                             
　　}                                                                        
　　printf("先頭トラック(曲)番号 = %d\n",sttrk);                             
　　printf("最終トラック(曲)番号 = %d\n",endtrk);                            
　　printf("ディスク内演奏時間(分) = %d\n",dsktim.min);                      
　　printf("ディスク内演奏時間(秒) = %d\n",dsktim.sec);                      
　　printf("ディスク内演奏時間(フレーム) = %d\n",dsktim.frame);              
                                                                             
　　for(i = sttrk-1 ; i < endtrk ; i++){　　/* トラック情報を表示します */   
                                                                             
　　　　if(((trktim[i].min) & 0x80) != 0){                                   
　　　　　　printf("☆%2d曲目 データ　　 ",i+1);                             
　　　　}else{                                                               
　　　　　　printf("★%2d曲目 オーディオ ",i+1);                             
　　　　}                                                                    
　　　　printf("%3d:%3d:%3d ★\n",trktim[i].min, trktim[i].sec,              
                                                 trktim[i].frame);           
                                                                             
　　}                                                                        
                                                                             
　　printf("\n先頭トラックから最終トラックまで演奏します。\n\n");            
　　printf("途中で\x22→\x22キーが押されると一曲進み、\x22←\x22キーが押され 
ると一曲戻ります。\n");                                                      
　　printf("また、ESCキーを押すとプログラムを終了します。\n");               
　　for(song_num = sttrk-1 ; song_num < endtrk ; song_num++){                
                                                                             
　　　　if((trktim[song_num].min & 0x80) != 0){                              
　　　　　　printf("%d曲目はデータです!飛ばします\n",song_num+1);            
　　　　}else{                                                               
　　　　　　printf("%d曲目は音楽データです!演奏します\n",song_num+1);        
                                                                             
　　　　　　starttime.min = trktim[song_num].min;                            
　　　　　　starttime.sec = trktim[song_num].sec;                            
　　　　　　starttime.frame = trktim[song_num].frame;                        
                                                                             
　　　　　　if(song-num != endtrk - 1){　　　　/* 最終トラック以外の場合 */  
　　　　　　　　SubOne(trktim[song_num+1].min, trktim[song_num+1].sec,       
　　　　　　　　　　　　trktim[song_num+1].frame, &endtime.min, &endtime.sec,
　　　　　　　　　　　　&endtime.frame);                                     
                                                                             
　　　　　　}else {　　　　　　　　　　　　 　/* 最終トラックの場合　　 */   
                                                                             
　　　　　　　　SubOne(dsktim.min, dsktim.sec, dsktim.frame,                 
　　　　　　　　　　　　&endtime.min, &endtime.sec, &endtime.frame);         
                                                                             
　　　　　　}                                                                
                                                                             
　　　　　　ret = cdr_mtplay( driveno, &starttime, &endtime);                
                                                                             
　　　　　　IfKey_Next();                                                    
                                                                             
　　　　}                                                                    
　　}                                                                        
}                                                                            
                                                                             
void SubOne(char a, char b, char c, char *d, char *e, char *f)               
　　　　　　　　　　　　　　　　/*　　演奏終了時間を計算します。 */          
{                                                                            
　　int 　　　 i;                                                            
　　int 　　　 maxtruck = 75;                                                
　　int 　　　 maxsec = 60;                                                  
                                                                             
　　i = a*maxsec*maxtruck+b*maxtruck+c-1;                                    
　　*d = i/(maxsec*maxtruck);                                                
　　*e = (i%(maxsec*maxtruck))/maxtruck;                                     
　　*f = (*e)%maxtruck;                                                      
}                                                                            
                                                                             
void IfKey_Next(void)　　/* 押されたキーを読み取り、キーに応じた処理を行う */
                                                                             
{                                                                            
　　int 　　　 sw = 1;                                                       
　　int 　　　 musno;                                                        
　　int 　　　 status = 1;                                                   
　　unsigned int　　moji, encode;                                            
　　struct　　TIMEADRS　　rdsktim;                                           
　　struct　　TIMEADRS　　rdtim;                                             
                                                                             
　　while(status != 0){                                                      
                                                                             
　　　　ret = cdr_mphase(driveno, &status, &musno, &rdtim,                   
　　　　　　　　　　　　　　　　　　　　　　　　　　&rdsktim );              
                                                                             
　　　　if(((moji = KYB_read(sw,&encode)) & 0xff00) != 0xff00) {             
                                                                             
　　　　　　switch(moji){                                                    
　　　　　　case 0x1c 　 : printf("→\n");                                   
　　　　　　　　　　　　　cdr_mstop( driveno );                              
　　　　　　　　　　　　　break;                                             
　　　　　　case 0x1d 　 : printf("←\n");                                   
　　　　　　　　　　　　　if(song_num != sttrk-1){                           
　　　　　　　　　　　　　　　　song_num -= 2;                               
　　　　　　　　　　　　　　}else{                                           
　　　　　　　　　　　　　　　　song_num -= 1;                               
　　　　　　　　　　　　　　}                                                
　　　　　　　　　　　　　cdr_mstop( driveno );                              
　　　　　　　　　　　　　break;                                             
　　　　　　case 0x1b 　 : printf("プログラム \n")                           
　　　　　　　　　　　　　cdr_mstop( driveno );                              
　　　　　　　　　　　　　exit(0);                                           
　　　　　　}                                                                
　　　　}                                                                    
                                                                             
　　}                                                                        
                                                                             
}                                                                            
                                                                             
  4.2　関数一覧                                                              
                                                                             
┌─────────┬────────────────────┐             
│　　関　数　名　　│　　　　　　機　　　　　　能　　　　　　│             
├─────────┼────────────────────┤             
│cdr_sdrvmd　　　　│ドライブモードの設定　　　　　　　　　　│             
├─────────┼────────────────────┤             
│cdr_rdrvmd　　　　│ドライブモードの読み取り　　　　　　　　│             
├─────────┼────────────────────┤             
│cdr_status　　　　│ドライブステータス情報の読み取り　　　　│             
├─────────┼────────────────────┤             
│cdr_restore 　　　│シリンダ0へのシーク　　　　　　　　　　 │             
├─────────┼────────────────────┤             
│cdr_seek　　　　　│指定位置へのシーク（論理セクタ指定）　　│             
├─────────┼────────────────────┤             
│cdr_read　　　　　│データの読み取り（論理セクタ指定）　　　│             
├─────────┼────────────────────┤             
│cdr_tseek 　　　　│指定位置へのシーク（時間指定）　　　　　│             
├─────────┼────────────────────┤             
│cdr_tread 　　　　│データの読み取り（時間指定）　　　　　　│             
├─────────┼────────────────────┤             
│cdr_mtplay　　　　│音楽演奏スタート（時間指定）　　　　　　│             
├─────────┼────────────────────┤             
│cdr_rmtplay 　　　│音楽演奏情報の読み取り（時間指定）　　　│             
├─────────┼────────────────────┤             
│cdr_mstop 　　　　│音楽演奏ストップ　　　　　　　　　　　　│             
├─────────┼────────────────────┤             
│cdr_mphase　　　　│音楽演奏状態の読み取り　　　　　　　　　│             
├─────────┼────────────────────┤             
│cdr_cdinfo　　　　│コンパクトディスク情報の読み取り　　　　│             
├─────────┼────────────────────┤             
│cdr_pause 　　　　│音楽演奏一時停止(PAUSE) 　　　　　　　　│             
├─────────┼────────────────────┤             
│cdr_continue　　　│音楽演奏一時停止解除(CONTINUE)　　　　　│             
├─────────┼────────────────────┤             
│cdr_read2 　　　　│データの読み取り2（論理セクタ指定）　　 │             
├─────────┼────────────────────┤             
│cdr_tread2　　　　│データの読み取り2（時間指定）　　　　　 │             
├─────────┼────────────────────┤             
│cdr_mtrplay 　　　│音楽演奏スタート（時間･回数指定）　　　 │             
├─────────┼────────────────────┤             
│cdr_stptime 　　　│ＣＤ-ＲＯＭドライブの回転停止時間の設定 │             
└─────────┴────────────────────┘             
                                                                             
  4.3　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.cdr_cdinfo                                                                  
コンパクトディスク情報の読み取り                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　 cdr_cdinfo( deviceno, cdtype, starttrack, endtrack,                   
　　　　　　　　　　　　　　　　　　　　　 tracktime, disctime );            
int 　 deviceno;　　　　　　/*　デバイス番号(0)　　　　　　　*/              
int 　 *cdtype; 　　　　　　/*　コンパクトディスクタイプ　　　　*/           
int 　 *starttrack; 　　　　/*　先頭トラック(曲)番号　　　　　*/             
int 　 *endtrack; 　　　　　/*　最終トラック(曲)番号　　　　　*/             
struct TIMEADRS {                                                            
　　　 char 　 min; 　　　　/*　分　　　　　　　　　　　　　　　*/           
　　　 char 　 sec; 　　　　/*　秒　　　　　　　　　　　　　　　*/           
　　　 char 　 frame; 　　　/*　フレーム　　　　　　　　　　　　*/           
}*tracktime, 　　　　　　　/*　トラック内演奏時間　　　　　　　*/            
　*disctime;　　　　　　　　/*　ディスク内演奏終了時間　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
トラック演奏開始時間(分)の7ビット目がＯＮの場合はデータトラックを示します。  
トラックとは、物理的に連続したデータのかたまりであり、オーディオ用のコンパク 
トディスクでは1つのトラックが1つの曲に対応しています(磁気ディスク等で使用され
ているトラックとは異なったものです)。                                        
tracktimeは最大99曲分の配列が必要です。                                      
1フレームは1/75秒です。                                                      
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットに挿入されているコンパクトディスク 
の情報を返します。cdtypeにはコンパクトディスクタイプ(0:なし、1:オーディオ･デ 
ータ、2:データ、3:オーディオ･データおよびデータ)、starttrack、endtrackには先 
頭･最終トラック(曲)番号を、 tracktimeにはトラックごとの演奏開始時間を、      
disctimeにはディスク内演奏終了時間をそれぞれ返します。                       
                                                                             
-----------------------------------------------------------------------------
.cdr_continue                                                                
音楽演奏一時停止解除(CONTINUE)                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_continue( deviceno );                                            
int 　　deviceno; 　　　　　/*　デバイス番号 (0) 　　　　　　　*/            
                                                                             
- 戻り値 -                                                                   
0    :正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
音楽演奏中または音楽演奏が一時停止中でない場合には、エラー(DEVPLAYまたは     
DEVNPAUSE)が返されます。                                                     
                                                                             
- 内容 -                                                                     
現在演奏の一時停止を解除します。                                             
                                                                             
- 参照 -                                                                     
cdr_pause                                                                    
                                                                             
-----------------------------------------------------------------------------
.cdr_mphase                                                                  
音楽演奏状態の読み取り                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　 cdr_mphase( deviceno, status, nowmusicno, tracktime,                  
　　　　　　　　　　　　　　　　　　　　　　　　　　　 disctime );           
int 　 deviceno;　　　　　　/*　デバイス番号(0)　　　　　　　*/              
int 　 *status; 　　　　　　/*　音楽の演奏状態　　　　　　　　　*/           
int 　 *nowmusicno　　　　　/*　現在演奏中の曲番号　　　　　　　*/           
struct TIMEADRS {                                                            
　　　 char min;　　　　　　/*　分　　　　　　　　　　　　　　　*/           
　　　 char sec;　　　　　　/*　秒　　　　　　　　　　　　　　　*/           
　　　 char frame;　　　　　/*　フレーム　　　　　　　　　　　　*/           
}*tracktime, 　　　　　　　/*　トラック内演奏時間　　　　　　　*/            
　*disctime;　　　　　　　　/*　ディスク内演奏時間　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
フレームは1/75秒です。                                                       
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットの音楽演奏状態を返します。         
statusには現在の演奏状態(1:演奏中、0:停止中)、nowmusicnoには現在演奏中の曲番 
号、tracktimeにはトラック内演奏時間、disctimeにはディスク内演奏時間を返します
                                                                             
-----------------------------------------------------------------------------
.cdr_mstop                                                                   
音楽演奏ストップ                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_mstop( deviceno );                                               
int 　　deviceno; 　　　　　 /* 　デバイス番号(0)　　　　　　　*/            
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットの演奏を中止します。               
                                                                             
- 参照 -                                                                     
cdr_mtplay                                                                   
                                                                             
-----------------------------------------------------------------------------
.cdr_mtplay                                                                  
音楽演奏スタート(時間指定)                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　 cdr_mtplay( deviceno, starttime, endtime );                           
int 　 deviceno;　　　　　　/*　デバイス番号(0)　　　　　　　   */           
struct TIMEADRS {                                                            
　　　 char 　 min; 　　　　/*　分　　　　　　　　　　　　　　　*/           
　　　 char 　 sec; 　　　　/*　秒　　　　　　　　　　　　　　　*/           
　　　 char 　 frame; 　　　/*　フレーム　　　　　　　　　　　　*/           
}*starttime, 　　　　　　　 /*　演奏開始時間　　　　　　　　　　*/           
　*endtime; 　　　　　　　　/*　演奏終了時間　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
フレームは1/75秒であり、0〜74の範囲で指定します。                            
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットにおいて、 starttimeで指定された演 
奏開始時間からendtimeで指定された演奏終了時間までの演奏を行います。          
                                                                             
- 参照 -                                                                     
cdr_rmtplay                                                                  
                                                                             
-----------------------------------------------------------------------------
.cdr_mtrplay                                                                 
音楽演奏スタート(時間･回数指定)                                              
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　 cdr_mtrplay( deviceno, starttime, endtime ,count );                   
int 　 deviceno;　　　　　　/*　デバイス番号(0)　　　　　　　   */           
struct TIMEADRS {                                                            
　　　 char 　　 min; 　　　/*　分　　　　　　　　　　　　　　　*/           
　　　 char 　　 sec; 　　　/*　秒　　　　　　　　　　　　　　　*/           
　　　 char 　　 frame; 　　/*　フレーム　　　　　　　　　　　　*/           
}*starttime, 　　　　　　　 /*　演奏開始時間　　　　　　　　　　*/           
　*endtime; 　　　　　　　　/*　演奏終了時間　　　　　　　　　　*/           
unsigned char 　 count ;　　/*　演奏回数　　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
フレームは1/75秒であり、0〜74の範囲で指定します。                            
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットのstarttimeで指定された演奏開始時間
から、endtimeで指定された演奏終了時間までの演奏を指定回数行います。          
指定回数が0の場合は連続演奏を行います。                                      
                                                                             
- 参照 -                                                                     
cdr_mtplay                                                                   
                                                                             
-----------------------------------------------------------------------------
.cdr_pause                                                                   
音楽演奏一時停止(PAUSE)                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_pause( deviceno );                                               
int 　　deviceno; 　　　　　/*　デバイス番号(0)　　　　　　　*/              
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
音楽演奏中でなければ、この関数は意味をもちません。既に演奏が一時停止中の場合 
にはエラー(DEVPAUSE)が返されます。                                           
                                                                             
- 内容 -                                                                     
現在演奏中の音楽を一時停止します。                                           
                                                                             
- 参照 -                                                                     
cdr_continue                                                                 
                                                                             
-----------------------------------------------------------------------------
.cdr_rdrvmd                                                                  
ドライブモードの読み取り                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_rdrvmd( deviceno, sectorsize );                                  
int 　　deviceno; 　　　　　 /* 　デバイス番号(0)　　　　　　　*/            
int 　　*sectorsize;　　　　 /* 　セクタ長　　　　　　　　　　　　*/         
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットのセクタ長をsectorsizeに返します。 
セクタ長は2048,2336,2340のいずれかが返ります。                               
                                                                             
- 参照 -                                                                     
cdr_sdrvmd,cdr_status                                                        
                                                                             
-----------------------------------------------------------------------------
.cdr_read                                                                    
データの読み取り(論理セクタ指定)                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_read( deviceno, lsector, buffer, count );                        
int 　　deviceno; 　　　/*　デバイス番号(0)　　　　　　　*/                  
long　　lsector;　　　　/*　論理セクタ番号　　　　　　　　　*/               
char　　*buffer;　　　　/*　転送アドレス　　　　　　　　　　*/               
unsigned int　count;　　/*　読み込みセクタ数　　　　　　　　*/               
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットの lsectorで指定された論理セクタ番 
号からcountで指定されたセクタ数分のデータをbufferに読み込みます。            
                                                                             
- 参照 -                                                                     
cdr_tread                                                                    
                                                                             
-----------------------------------------------------------------------------
.cdr_read2                                                                   
データの読み取り2(論理セクタ指定)                                            
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_read2( deviceno, lsector, buffer, count );                       
int 　　　　　　deviceno; 　/*　デバイス番号(0)　　　　　　　*/              
long　　　　　　lsector;　　/*　論理セクタ番号　　　　　　　　　*/           
char　　　　　　*buffer;　　/*　転送アドレス　　　　　　　　　　*/           
unsigned int　　count;　　　/*　読み込みセクタ数　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
cdr_readに比べて転送速度は速いのですが、転送アドレスが絶対アドレスで指定され 
ます。また、転送バッファとして確保した領域は、絶対アドレス768KBを超えるものは
使用できません。                                                             
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットのlsectorで指定された論理セクタ番号
から、countで指定されたセクタ数分のデータをbufferに読み込みます。            
                                                                             
- 参照 -                                                                     
cdr_tread2                                                                   
                                                                             
-----------------------------------------------------------------------------
.cdr_restore                                                                 
シリンダ0へのシーク                                                          
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_restore( deviceno );                                             
int 　　deviceno; 　　　　　 /* 　デバイス番号(0)　　　　　　　*/            
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットのヘッドをディスクの先頭部(最内周) 
へ移動させます。                                                             
                                                                             
-----------------------------------------------------------------------------
.cdr_rmtplay                                                                 
音楽演奏情報の読み取り(時間指定)                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　 cdr_rmtplay( deviceno, starttime, endtime );                          
int 　 deviceno;　　　　　/*　デバイス番号(0)　　　　　　　　*/              
struct TIMEADRS {                                                            
　　　 char 　 min; 　　　/*　分　　　　　　　　　　　　　　　　*/           
　　　 char 　 sec; 　　　/*　秒　　　　　　　　　　　　　　　　*/           
　　　 char 　 frame; 　　/*　フレーム　　　　　　　　　　　　　*/           
}*starttime, 　　　　　　/*　演奏開始時間　　　　　　　　　　　*/            
　*endtime; 　　　　　　　/*　演奏終了時間　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
フレームは1/75秒です。                                                       
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットから、cdr_mtplay関数で設定された演 
奏開始時間をstarttimeに、演奏終了時間をendtimeに返します。                   
                                                                             
- 参照 -                                                                     
cdr_mtplay                                                                   
                                                                             
-----------------------------------------------------------------------------
.cdr_sdrvmd                                                                  
ドライブモードの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_sdrvmd( deviceno, sectorsize );                                  
int 　　deviceno; 　　　　　 /* 　デバイス番号(0)　　　　　　　*/            
int 　　sectorsize; 　　　　 /* 　セクタ長　　　　　　　　　　　　*/         
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットに、sectorsizeで指定されたセクタ長 
を設定します。                                                               
セクタ長は2048,2336,2340のいずれかを設定します。                             
                                                                             
- 参照 -                                                                     
cdr_rdrvmd,cdr_status                                                        
                                                                             
-----------------------------------------------------------------------------
.cdr_seek                                                                    
指定位置へのシーク (論理セクタ指定)                                          
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_seek( deviceno, lsector );                                       
int 　　deviceno; 　　　　　/*　デバイス番号 (0) 　　　　　　　*/            
long　　lsector;　　　　　　/*　論理セクタ番号　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 参照 -                                                                     
cdr_tseek                                                                    
                                                                             
- 内容 -                                                                     
指定されたドライブのヘッドをコンパクトディスクの指定された論理セクタへ移動し 
ます。                                                                       
                                                                             
-----------------------------------------------------------------------------
.cdr_status                                                                  
ドライブステータス情報の読み取り                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_status( deviceno, sectorsize, lsectorsize );                     
int 　　deviceno; 　　　　　/*　デバイス番号(0)　　　　　　　*/              
int 　　*sectorsize;　　　　/*　セクタ長　　　　　　　　　　　　*/           
long　　*lsectorsize; 　　　/*　全セクタ数　　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
全セクタ数はユーザデータ領域を示しているため、セクタ長を2336あるいは2340バイ 
トに設定した場合は2048バイトの全セクタ数と同じになります。                   
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットに挿入されているコンパクトディスク 
のセクタ長をsectorsizeに全セクタ数をlsectorsizeに返します。                  
セクタ長は2048、2336、2340のいずれかが返ります。                             
                                                                             
- 参照 -                                                                     
cdr_sdrvmd, cdr_rdrvmd                                                       
                                                                             
-----------------------------------------------------------------------------
.cdr_stptime                                                                 
ＣＤ-ＲＯＭドライブの回転停止時間の設定                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　　cdr_stptime( deviceno, stoptime );                                   
int 　　　　　　 deviceno;　/*　デバイス番号(0)　　　　　　　*/              
unsigned char 　 stoptime 　/*　回転停止時間　　　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
cdr_stptime実行後にCD-ROMを1度アクセスをしてください。アクセス後設定された時 
間まで回転し、その間にアクセスがなければ停止します。                         
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットに対して回転が停止するまでの時間を 
1〜255秒の間で設定します。                                                   
通常、0を設定した場合には連続して回転します。なお初期値は20秒です。          
                                                                             
-----------------------------------------------------------------------------
.cdr_tread                                                                   
データの読み取り(時間指定)                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　 cdr_tread( deviceno, timeadrs, buffer, count );                       
int 　 deviceno;　　　　　　/*　デバイス番号(0)　　　　　　　*/              
struct TIMEADRS {                                                            
　　　 char 　　min;　　　　/*　分　　　　　　　　　　　　　　　*/           
　　　 char 　　sec;　　　　/*　秒　　　　　　　　　　　　　　　*/           
　　　 char 　　frame;　　　/*　フレーム　　　　　　　　　　　　*/           
}*timeadrs;　　　　　　　　/*　読み込みアドレス　　　　　　　　*/            
char　　　　　　*buffer;　　/*　転送アドレス　　　　　　　　　　*/           
unsigned int　　count;　　　/*　読み込みセクタ数　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
フレームは1/75秒であり、0〜74の範囲で指定します。                            
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットのtimeadrsで指定されたアドレスから 
countで指定されたセクタ数分のデータをbufferに読み込みます。                  
                                                                             
- 参照 -                                                                     
cdr_read                                                                     
                                                                             
-----------------------------------------------------------------------------
.cdr_tread2                                                                  
データの読み取り2(時間指定)                                                  
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　 cdr_tread2( deviceno, timeadrs, buffer, count );                      
int 　 deviceno;　　　　　　/*　デバイス番号(0)　　　　　　　*/              
struct TIMEADRS {                                                            
　　char min; 　　　　　　　/*　分　　　　　　　　　　　　　　　*/           
　　char sec; 　　　　　　　/*　秒　　　　　　　　　　　　　　　*/           
　　char frame; 　　　　　　/*　フレーム　　　　　　　　　　　　*/           
}*timeadrs;　　　　　　　　/*　読み込みアドレス　　　　　　　　*/            
char *buffer; 　　　　　　　/*　転送アドレス　　　　　　　　　　*/           
unsigned int count; 　　　　/*　読み込みセクタ数　　　　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
cdr_treadに比べて転送速度は速いのですが、転送アドレスが絶対アドレスで指定され
ます。また、転送バッファとして確保した領域は、絶対アドレスで768KB を超えるも 
のは使用できません。                                                         
                                                                             
- 内容 -                                                                     
devicenoで指定されたCD-ROMドライブユニットのtimeadrsで指定されたアドレスから 
countで指定されたセクタ数分のデータをbufferに読み込みます。                  
                                                                             
- 参照 -                                                                     
cdr_read2                                                                    
                                                                             
-----------------------------------------------------------------------------
.cdr_tseek                                                                   
指定位置へのシーク (時間指定)                                                
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <CDRFRB.H>                                                          
int 　 cdr_tseek( deviceno, timeadrs );                                      
int 　 deviceno;　　　　　　/*　デバイス番号(0)　　　　　　　*/              
struct TIMEADRS {                                                            
　　　 char min;　　　　　　/*　分　　　　　　　　　　　　　　　*/           
　　　 char sec;　　　　　　/*　秒　　　　　　　　　　　　　　　*/           
　　　 char frame;　　　　　/*　フレーム　　　　　　　　　　　　*/           
}*timeadrs;                                                                  
                                                                             
- 戻り値 -                                                                   
0　　:正常終了                                                               
0以外:エラー                                                                 
                                                                             
- 注意 -                                                                     
フレームは1/75秒であり、0〜74の範囲で指定します。                            
                                                                             
- 内容 -                                                                     
指定されたドライブのヘッドをコンパクトディスクの指定された時間の位置へ移動し 
ます。                                                                       
                                                                             
- 参照 -                                                                     
cdr_seek                                                                     
                                                                             
*****************************************************************************
第7章　サウンドライブラリ                                                    
*****************************************************************************
                                                                             
 1.　サウンド機能について                                                    
                                                                             
  1.1　概要                                                                  
                                                                             
　本機にはＦＭ音源ＬＳＩ(YM2612)およびＰＣＭ音源ＬＳＩ(RF5C68)が搭載されてい 
ます。それらをコントロールするためのドライバは大きく3つのレベルに分れます。  
ユーザはその3つのどのレベルからでもアクセスできます。                        
　最も低レベルなルーチンは、音色変更や発音などの各種コントロールを行う、｢サウ
ンドＢＩＯＳ｣です。                                                          
　その上には、アセンブラやＣ言語のライブラリとしてＭＩＤＩエミュレータが提供 
されます。このＭＩＤＩエミュレータは、後述の演奏ドライバが各音源をＭＩＤＩ機 
器とみなしてコントロールできるようにするためのものです。これにより、ＭＩＤＩ 
カード等に対応して作られるアプリケーションで容易に内蔵音源を使用することがで 
きます。                                                                     
　さらに、その上には、ＥＵＰＨＯＮＹ互換データ形式の演奏ドライバがあります。 
このデータ形式は従来のＭＭＬ等より解像度が高く、トラック数も大幅に増えるため 
よりきめ細かく、かつ重厚なサウンドをクリエイトすることができます。また、デー 
タの作成はＥＵＰＨＯＮＹを用いることができ、データの生産性は従来より格段に向 
上します。                                                                   
                                                                             
 2.　ＰＣＭについて                                                          
                                                                             
　ＰＣＭ音源再生には2つの方法があります。                                    
　1つは、あらかじめ波形メモリ内にＰＣＭデータを転送しておき、それを再生する方
法で｢楽器モード｣と呼びます。これは主に音楽等を演奏するための音源として使用す 
ることを目的とし、マルチスプリットによるリアルな楽器のシミュレートが可能とな 
っています。                                                                 
　もう1つは、メインメモリ上にあるデータを転送しながら再生する方法で｢音声モー 
ド｣と呼びます。これは長時間の連続再生が可能で、音声メッセージなどの長時間再生
を目的としています。                                                         
                                                                             
  2.1　楽器モードのデータ構造                                                
                                                                             
　楽器モードには、2つのデータがあります。                                    
　1つは、音をサンプリングした波形データで、これを｢サウンド｣と呼びます。もう1 
つは｢サウンド｣を活用するためのデータで、これを｢インストゥルメンツ｣と呼びます 
                                                                             
　｢サウンド｣と｢インストゥルメンツ｣の関係は、例えばピアノを例にとると、ピアノ 
は高音域、中音域、低音域でそれぞれ特徴のある音がするため、1つの音で全音域を鳴
らそうとすると、リアルな音になりません。そこで、それぞれの音域の音をサンプリ 
ングし、それぞれの音を鳴らす音域を分担することで、よりリアルな音となります。 
また同じ｢サウンド｣でもエンベロープを変えることにより色々な音を表現することが 
できます。                                                                   
　つまり、それぞれの音域ごとにサンプリングしたデータが｢サウンド｣であり、その 
サウンドをどう使うかを示したものが｢インストゥルメンツ｣です。                 
　異なるインストゥルメンツが同一のサウンドを共有できるので、同じピアノのサウ 
ンド群を使って色々なピアノを表現することができます。                         
　サウンドは波形メモリの容量の範囲内で、最大 128個まで登録できます。サウンド 
データの先頭32バイトの情報は、登録時にＢＩＯＳ内のサウンド管理領域にコピーさ 
れます。                                                                     
　インストゥルメンツは、最大32個まで登録できます。登録されているサウンドデー 
タのサウンドIDをもとに発音動作を行うので、使用するサウンドが登録されていない 
場合は発音されません。                                                       
　また、インストゥルメンツとサウンドをひとまとめにして、ファイルに格納するこ 
とができ、その形式を｢バンク｣と呼びます。                                     
　ＰＣＭ音源バンク形式ファイルの拡張子は｢.ＰＭＢ｣で表されます。              
                                                                             
サウンドデータ　ヘッダ形式                                                   
                                                                             
　　┌────┬─────────┬──────────────────┐   
　　│ サイズ │　　内　　　容　　│　　　　　　備　　　　考　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋0 │　  8　 │サウンドネーム　　│8文字の名前　　　　　　　　　　　　 │   
　　├────┼─────────┼──────────────────┤   
＋8 │　ＤＷ　│サウンドＩＤ　　　│ＢＩＯＳ内のサウンド管理識別用ＩＤ　│   
　　├────┼─────────┼──────────────────┤   
＋12│　ＤＷ　│データ幅　　　　　│ウェーブデータの総バイト数　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋16│　ＤＷ　│ループポイント　　│ループの開始点　　　　　　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋20│　ＤＷ　│ループレングス　　│ループの長さ（0の時はループしない） │   
　　├────┼─────────┼──────────────────┤   
＋24│　 Ｗ　 │サンプリング周波数│サンプリング周波数(*1)　　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋26│　 Ｗ　 │原音の補正値　　　│サンプリング周波数に対する加減算値　│   
　　├────┼─────────┼──────────────────┤   
＋28│　 Ｂ　 │原音の音階　　　　│サウンドデータの基本音階　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋29│　 Ｂ　 │リザーブ　　　　　│　　　　　　　　　　　　　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋30│　 Ｗ　 │リザーブ　　　　　│　　　　　　　　　　　　　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋32│　ＢＡ　│ウェーブデータ　　│ＰＣＭデータ　　　　　　　　　　　　│   
　　└────┴─────────┴──────────────────┘   
                                                                             
*1) サンプリング周波数｢Ｆ｣は、以下の式によって求められます。                 
　Ｆ　=　Ｆｒｅｑ(KHz) ＊　0x62                                              
[例]　サンプリング周波数が16KHzならば、｢Ｆ｣=0x10 ＊ 0x62=0x620               
                                                                             
ＰＣＭデータ形式について                                                     
　ＰＣＭ音源のデータフォーマットは以下のようになっています。                 
　最上位ビットが正負の方向を示し、下位7ビットが波形の振幅の度合いを示します。
                                                                             
　0xffは、ＰＣＭ音源のループマーカとなっているため、通常のデータには含まれま 
せん。                                                                       
                                                                             
図CL21R-055                                                                  
                                                                             
インストゥルメンツデータ形式                                                 
                                                                             
　　　┌───┬────────┬──────────────────┐     
　　　│サイズ│　　- 内容 -　　│　　　　　　備　　　　考　　　　　　│     
　　　├───┼────────┼──────────────────┤     
 ＋0　│　 8　│プログラムネーム│8文字の名前　　　　　　　　　　　　 │     
　　　├───┼────────┼──────────────────┤     
 ＋8　│　 8　│リザーブ　　　　│　　　　　　　　　　　　　　　　　　│     
　　　├───┼────────┼──────────────────┤     
＋16　│　Ｗ　│スプリット1　　 │サウンドを鳴らす音階の上限値　　　　│     
　　　├───┼────────┼──────────────────┤     
＋18　│　Ｗ　│スプリット2　　 │サウンドを鳴らす音階の上限値　　　　│     
　　　├───┼────────┼──────────────────┤     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　├───┼────────┼──────────────────┤     
＋30　│　Ｗ　│スプリット8　　 │サウンドを鳴らす音階の上限値　　　　│     
　　　├───┼────────┼──────────────────┤     
＋32　│ ＤＷ │サウンドＩＤ1 　│スプリット1で使用するサウンドのＩＤ │     
　　　├───┼────────┼──────────────────┤     
＋36　│ ＤＷ │サウンドＩＤ2　 │スプリット2で使用するサウンドのＩＤ │     
　　　├───┼────────┼──────────────────┤     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　├───┼────────┼──────────────────┤     
＋60　│ ＤＷ │サウンドＩＤ8　 │スプリット8で使用するサウンドのＩＤ │     
　　　├───┼────────┼──────────────────┤     
＋64　│　8　 │エンベロープ1　 │スプリット1のエンベロープ　　　　　 │     
　　　├───┼────────┼──────────────────┤     
＋72　│　8　 │エンベロープ2　 │スプリット2のエンベロープ　　　　　 │     
　　　├───┼────────┼──────────────────┤     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　│　　　│　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
　　　├───┼────────┼──────────────────┤     
＋120 │　8　 │エンベロープ8　 │スプリット8のエンベロープ　　　　　 │     
　　　└───┴────────┴──────────────────┘     
                                                                             
エンベロープデータ形式                                                       
                                                                             
　　┌──┬────────┬────────────────────┐     
 ＋0│ Ｂ │トータルレベル　│最大音量　　　　　　　　　　　0〜127    │     
　　├──┼────────┼────────────────────┤     
 ＋1│ Ｂ │アタックレート　│アタックの増加レート　　　　　0〜127    │     
　　├──┼────────┼────────────────────┤     
 ＋2│ Ｂ │ディケイレート　│アタック後の減衰レート　　　　0〜127    │     
　　├──┼────────┼────────────────────┤     
 ＋3│ Ｂ │サスティンレベル│減衰レベル　　　　　　　　　　0〜127    │     
　　├──┼────────┼────────────────────┤     
 ＋4│ Ｂ │サスティンレート│減衰レート　　　　　　　　　　0〜127    │     
　　├──┼────────┼────────────────────┤     
 ＋5│ Ｂ │リリースレート　│キーＯＦＦ時の減衰レート　　　0〜127    │     
　　├──┼────────┼────────────────────┤     
 ＋6│ Ｂ │ルートキー　　　│音階の加減算値　　　　　   -128〜127    │     
　　├──┼────────┼────────────────────┤     
 ＋7│ Ｂ │リザーブ　　　　│　　　　　　　　　　　　　　　　　　　　│     
　　└──┴────────┴────────────────────┘     
                                                                             
ＰＣＭエンベロープについて                                                   
                                                                             
　楽器モードではエンベロープカーブの設定が行えます。これにより楽器データの圧 
縮と、よりリアルな音の再現が可能となります。                                 
                                                                             
図CL21R-056                                                                  
                                                                             
ＰＣＭ音源バンクデータ形式                                                   
                                                                             
　バンクデータは、サウンドとインストゥルメンツを組み合わせたファイル形式です 
32個のインストゥルメンツと 128個のサウンドから成り、バンク毎に名前をつけるこ 
とができます。また、サウンドデータは必ずしも128個なくてもかまいません。      
                                                                             
┌───┬───────────┬──────────────────┐     
│サイズ│　　　内　　　容　　　│　　　　　　備　　　　考　　　　　　│     
├───┼───────────┼──────────────────┤     
│　 8　│バンクネーム　　　　　│8文字までの名前　　　　　　　　　　 │     
├───┼───────────┼──────────────────┤     
│  128 │インストゥルメンツ1　 │　　　　　　　　　　　　　　　　　　│     
├───┼───────────┼──────────────────┤     
│  128 │インストゥルメンツ2　 │　　　　　　　　　　　　　　　　　　│     
├───┼───────────┼──────────────────┤     
│　　　│　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
├───┼───────────┼──────────────────┤     
│  128 │インストゥルメンツ32  │ 　　　　　　　　　　　　　　　　　 │     
├───┼───────────┼──────────────────┤     
│ 不定 │サウンド1　　　　　 　│　　　　　　　　　　　　　　　　　　│     
├───┼───────────┼──────────────────┤     
│ 不定 │サウンド2　　　　　 　│　　　　　　　　　　　　　　　　　　│     
├───┼───────────┼──────────────────┤     
│　　　│　　　　　　　　　　　│　　　　　　　　　　　　　　　　　　│     
├───┼───────────┼──────────────────┤     
│ 不定 │サウンド128　　　　   │　　　　　　　　　　　　　　　　　　│     
└───┴───────────┴──────────────────┘     
                                                                             
  2.2　音声モードのデータ形式                                                
                                                                             
　基本的には楽器モードのサウンドデータと同じですが、エンベロープのコントロー 
ルが行われていません。                                                       
　音声モードのデータファイルの拡張子は｢.ＳＮＤ｣で表されます。                
                                                                             
サウンドデータ形式                                                           
                                                                             
　　┌────┬─────────┬──────────────────┐   
　　│ サイズ │　　内　　　容　　│　　　　　　備　　　　考　　　　　　│   
　　├────┼─────────┼──────────────────┤   
 ＋0│ 　 8　 │サウンドネーム　　│8文字の名前　　　　　　　　　　　　 │   
　　├────┼─────────┼──────────────────┤   
 ＋8│　ＤＷ　│サウンドＩＤ　　　│ＢＩＯＳ内のサウンド管理識別用ＩＤ　│   
　　├────┼─────────┼──────────────────┤   
＋12│　ＤＷ　│データ幅　　　　　│ウェーブデータの総バイト数　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋16│　ＤＷ　│ループポイント　　│ループの開始点　　　　　　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋20│　ＤＷ　│ループレングス　　│ループの長さ（0の時はループしない） │   
　　├────┼─────────┼──────────────────┤   
＋24│ 　Ｗ　 │サンプリング周波数│サンプリング周波数(*1)　　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋26│ 　Ｗ　 │原音の補正値　　　│サンプリング周波数に対する加減算値　│   
　　├────┼─────────┼──────────────────┤   
＋28│ 　Ｂ　 │原音の音階　　　　│サウンドデータの基本音階　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋29│ 　Ｂ　 │リザーブ　　　　　│　　　　　　　　　　　　　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋30│ 　Ｗ　 │リザーブ　　　　　│　　　　　　　　　　　　　　　　　　│   
　　├────┼─────────┼──────────────────┤   
＋32│　ＢＡ　│ウェーブデータ　　│ＰＣＭデータ　　　　　　　　　　　　│   
　　└────┴─────────┴──────────────────┘   
                                                                             
*1) サンプリング周波数｢Ｆ｣は、以下の式によって求められます。                 
　　Ｆ　=　Ｆｒｅｑ(KHz) ＊　0x62                                            
[例]　サンプリング周波数が16KHzならば、｢Ｆ｣=0x10 ＊ 0x62=0x620               
                                                                             
 3.　ＦＭ音源                                                                
                                                                             
　ＦＭ音源データは、1インストゥルメンツ当たり48バイトで構成され、最大128個の 
音色を登録することができます。ファイル形式はＰＣＭ音源と同様にインストゥルメ 
ンツの集合体であるバンクの形式をとります。ＦＭ音源バンク形式ファイルの拡張子 
は、｢.ＦＭＢ｣で表されます。                                                  
                                                                             
　　┌───┬───────────┬────────────────┐     
　　│サイズ│　　　内　　　容　　　│　　　　　備　　　　考　　　　　│     
　　├───┼───────────┼────────────────┤     
 ＋0│　 8　│プログラムネーム　　　│8文字までの名前　　　　　　　 　│     
　　├───┼───────────┼────────────────┤     
 ＋8│　 4　│ＤＴ、ＭＵＬＴＩ　　　│ディチューン、マルチプル　　　　│     
　　├───┼───────────┼────────────────┤     
＋12│　 4　│ＴＬ　　　　　　　　　│トータルレベル　　　　　　　　　│     
　　├───┼───────────┼────────────────┤     
＋16│　 4　│ＫＳ、ＡＲ　　　　　　│キースケール、アタックレート　　│     
　　├───┼───────────┼────────────────┤     
＋20│　 4　│ＡＭＯＮ、ＤＲ　　　　│ＡＭＳフラグ、ディケイレート　　│     
　　├───┼───────────┼────────────────┤     
＋24│　 4　│ＳＲ　　　　　　　　　│サスティンレート　　　　　　　　│     
　　├───┼───────────┼────────────────┤     
＋28│　 4　│ＳＬ、ＲＲ　　　　　　│サスティンレベル、リリースレート│     
　　├───┼───────────┼────────────────┤     
＋32│　Ｂ　│ＦＢ、ＣＮＣＴ　　　　│フィードバック、コネクト　　　　│     
　　├───┼───────────┼────────────────┤     
＋33│　Ｂ　│ＬＲ、ＡＭＳ、ＰＭＳ　│パン、ＬＦＯ　　　　　　　　　　│     
　　├───┼───────────┼────────────────┤     
＋34│  14  │リザーブ　　　　　　　│　　　　　　　　　　　　　　　　│     
　　└───┴───────────┴────────────────┘     
                                                                             
　　ＦＭ音源バンクデータ形式                                                 
                                                                             
　　┌───┬───────────┬────────────────┐     
　　│サイズ│　　　内　　　容　　　│　　　　　備　　　　考　　　　　│     
　　├───┼───────────┼────────────────┤     
　　│　 8　│バンクネーム　　　　　│8文字までの名前　　　　　　　 　│     
　　├───┼───────────┼────────────────┤     
　　│  48  │インストゥルメンツ1　 │1番目の音色データ　　　　　　 　│     
　　├───┼───────────┼────────────────┤     
　　│  48  │インストゥルメンツ2 　│2番目の音色データ　　　　　　　 │     
　　├───┼───────────┼────────────────┤     
　　│ 　･　│　　　　　　　　　　　│　　　　　　　　　　　　　　　　│     
　　│ 　･　│　　　　　　　　　　　│　　　　　　　　　　　　　　　　│     
　　│　　　│　　　　　　　　　　　│　　　　　　　　　　　　　　　　│     
　　├───┼───────────┼────────────────┤     
　　│  48  │インストゥルメンツ128 │128番目の音色データ　　　　 　　│     
　　└───┴───────────┴────────────────┘     
                                                                             
　　ＦＭ音源データ形式(ＦＭ音源レジスタ構成)                                 
                                                                             
　　┌──┬───────────────┬───────────────┐ 
　　│ｽﾛｯﾄ│　　　　　ビット構成　　　　　│　　　　　備　　　　考　　　　│ 
　　├──┼─┬─┬─┬─┬─┬─┬─┬─┼───────────────┤ 
　　│──│b7│b6│b5│b4│b3│b2│b1│b0│───────────────│ 
　　├──┼─┴─┴─┴─┴─┴─┴─┴─┼───────────────┤ 
 ＋0│──│　　　　 Program Name 　　　　│8文字までの名前　　　　　　　 │ 
　　├──┼─┬─────┬───────┼───────────────┤ 
 ＋8│ OP1│　│　Detune　│　 Multipul 　│ディチューン、マルチプル　　　│ 
    │　 3│─│　　　　　│　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│　 2│　│　　　　　│　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│　 4│　│　　　　　│　　　　　　　│　　　　　　　　　　　　　　　│ 
　　├──┼─┼─────┴───────┼───────────────┤ 
＋12│ OP1│　│　　　 Total Level　　　　│トータルレベル　　　　　　　　│ 
　　│　 3│─│　　　　　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│　 2│　│　　　　　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│　 4│　│　　　　　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　├──┼─┴─┬─┬─────────┼───────────────┤ 
＋16│ OP1│　KS　│　│　 Attack Rate　　│キースケール、アタックレート　│ 
　　│　 3│　　　│─│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│　 2│　　　│　│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│　 4│　　　│　│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　├──┼─┬─┴─┼─────────┼───────────────┤ 
＋20│ OP1│AM│　　　│　　Decay Rate　　│ＡＭＳフラグ、ディケイレート　│ 
　　│　 3│　│───│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│　 2│　│　　　│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│　 4│　│　　　│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　├──┼─┴───┼─────────┼───────────────┤ 
＋24│ OP1│　　　　　│　 Sustain Rate 　│サスティンレート　　　　　　　│ 
　　│ 　3│─────│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│ 　2│　　　　　│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│ 　4│　　　　　│　　　　　　　　　│　　　　　　　　　　　　　　　│ 
　　├──┼─────┴─┬───────┼───────────────┤ 
＋28│ OP1│Sustain Level │ Rerease Rate │サスティンレベル、            │ 
　　│ 　3│　　　　　　　│　　　　　　　│リリースレート　　　　　　　　│ 
　　│ 　2│　　　　　　　│　　　　　　　│　　　　　　　　　　　　　　　│ 
　　│ 　4│　　　　　　　│　　　　　　　│　　　　　　　　　　　　　　　│ 
　　├──┼───┬───┴─┬─────┼───────────────┤ 
＋32│──│───│ Feedback │ Connect　│フィードバック、コネクト　　　│ 
　　├──┼─┬─┼───┬─┼─────┼───────────────┤ 
＋33│──│Ｌ│Ｒ│ AMS　│─│　 PMS　　│パン、ＬＦＯ　　　　　　　　　│ 
　　├──┼─┴─┴───┴─┴─────┼───────────────┤ 
＋34│──│　　　　　　Reserve 　　　　　│リザーブ　　　　　　　　　　　│ 
　　└──┴───────────────┴───────────────┘ 
                                                                             
 4.　サウンドＢＩＯＳについて                                                
                                                                             
  4.1　電子ボリュームの使い方                                                
                                                                             
　サウンドＢＩＯＳを初期化した時点では、ＣＤ、マイク、ＬＩＮＥ、モデムはすべ 
て、-∞dbに設定され、ＰＣＭ音源、ＦＭ音源はミュート状態になっており、オールミ
ュートは解除されているので、使用する入力ソースのミュートを外してから使用しな 
ければなりません。                                                           
　また、電子ボリュームを操作する場合、各ボリュームの音量が大きな状態でオール 
ミュートのスイッチを操作すると、スイッチングノイズが発生して、外部機器のスピ 
ーカを破壊してしまうこともありうるので十分に注意しておかなければなりません。 
　ノイズをできる限り少なくするため、使用する入力ソース以外はミュート状態にし 
ておくことが理想です。                                                       
　ミュート設定のファンクションSND_elevol_muteはＰＣＭ、ＦＭに関してはミュート
レジスタのアクセスをしますが、ＣＤ、マイク、ＬＩＮＥ、モデムにはミュートレジ 
スタが無いため-∞dbに設定します。もし、ミュート中にＣＤ、マイク、ＬＩＮＥ、モ
デムのボリューム変更や読み込みを実行すると、ミュートが自動的に外れてしまうの 
で注意しなければなりません。                                                 
　特に、マイクのミュート/ボリュームを操作する場合、内蔵マイクとスピーカがハウ
リングを起こす可能性が高いので、十分に注意してください。                     
                                                                             
  4.2　サンプリングについて                                                  
                                                                             
　FM TOWNSにはサンプリング機能を実現するためのＡ/Ｄコンバータが内蔵されていま
すが、このサンプリングを行う際に注意しなければならない事項があります。       
　サンプリングはパラメータに関係なく常に約20ＫHzで行われます。本機にはＦＩＦ 
Ｏのような特殊なバッファが存在しないので、ＣＰＵが約50μs毎にデータを1バイト 
ずつ読み込まなければなりません。もしここで、頻繁に割り込みが発生しデータのと 
りこぼしが発生すると著しく音質が悪化するので、サンプリング時にはできる限り割 
り込み処理をマスクしなければなりません。ライブラリでは、このサンプリングのフ 
ァンクションを使う時にＦＭ音源のタイマＢを停止するため、サンプリング中はマウ 
スやエンベロープのコントロールが行えません。                                 
　また、ＥＵＰＨＯＮＹドライバ等を使用している場合、SND_fm_timer_a_setを用い 
てタイマＡを停止させることをお勧めします。                                   
　サンプリングのソースは、マイク以外にＣＤ、ＬＩＮＥ等からも可能です。サンプ 
リングのソースに何を選択するかは、各ソースのボリューム/ミュート状態によります
つまり、ＣＤを鳴らしながらマイクのボリュームを上げれば、ＣＤ、マイクのミック 
スした音をサンプリングすることができます。具体的には、SND_pcm_recを呼ぶ前に各
電子ボリューム等を設定することにより、入力ソースを選択します。               
　マイク等からサンプリングする場合、内蔵スピーカや外部のステレオ装置などのス 
ピーカとハウリングすることがあります。この場合、SND_elevol_all_muteを使用して
内蔵スピーカ及びＬＩＮＥ　ＯＵＴに対して出力をミュートすることができます。こ 
の場合でもＡ/Ｄコンバータに対しては入力状態なので、正常にサンプリングできます
                                                                             
 5.　サウンドライブラリ                                                      
                                                                             
  5.1　サンプルプログラム                                                    
                                                                             
┌────────────────────────────────────┐ 
│　サウンドライブラリサンプルプログラム　　　　　　　　　　　　　　　　  │ 
│                                                                        │ 
│　- 機能 - 　マイクからの音をサンプリングし、再生します。　　　　　　　 │ 
└────────────────────────────────────┘ 
                                                                             
#include <stdlib.h>                                                          
#include <egb.h>                                                             
#include <mos.h>                                                             
#include <snd.h>                                                             
                                                                             
#define ch　 71 　　　　　　　　　　　/*　音声出力チャンネル　　　　　　　 */
#define note 60 　　　　　　　　　　　/*　音声出力の音階　　　　　　　　　 */
#define vol  127　　　　　　　　　　　/*　音声出力の音量　　　　　　　　　 */
#define freq 19200　　　　　　　　　　/*　サンプリングレート　　　　　　　 */
#define size freq*10　　　　　　　　　/*　サンプリングデータ長　　　　　 　*/
#define evol 2　　　　　　　　　　　　/*　電子ボリュームチャンネル(マイク) */
                                                                             
struct str_data{                                                             
　　　　　　　　short 　x ;                                                  
　　　　　　　　short 　y ;                                                  
　　　　　　　　unsigned short len ;                                         
　　　　　　　　char　　string_buf[60] ;                                     
　　　　} ;                                                                  
                                                                             
struct str_data m[5] = {                                                     
　　　184,159, 34,"マイクからの音をサンプリングします",                      
　　　184,191, 34,"マウスの左ボタンを押すと開始します",                      
　　　232,223, 22,"サンプリングしています",                                  
　　　200,255, 30,"サンプリングした音を再生します",                          
　　　 96,287, 56,"マウスの左ボタンを押すと再生。右ボタンを押すと終了します" 
　　　　} ;                                                                  
                                                                             
void main()                                                                  
{                                                                            
　　char *snd_work ;                                                         
　　char *egb_work ;                                                         
　　char *mos_work ;                                                         
                                                                             
　　char *buff ;                                                             
                                                                             
　　int btn,x,y ;                                                            
                                                                             
　　if ((snd_work = malloc(16384)) == 0) 　　　/*サウンド作業領域の取得　  */
　　　　exit(1) ;                                                            
　　if ((egb_work = malloc(EgbWorkSize)) == 0) /*グラフィック作業領域の取得*/
　　　　exit(1) ;                                                            
　　if ((mos_work = malloc(MosWorkSize)) == 0) /*マウス作業領域の取得　    */
　　　　exit(1) ;                                                            
　　if ((buff = malloc(size+32)) == 0)　　　　 /*サンプリング作業領域の確保*/
　　　　exit(1) ;                                                            
　　SND_init(snd_work) ; 　　　　　　　　　　　/*　サウンドドライバの初期化*/
　　EGB_init(egb_work,EgbWorkSize) ; 　　　　　/*　グラフィック初期化　　　*/
　　MOS_start(mos_work,MosWorkSize) ; 　　　　 /*　マウス動作開始の設定　　*/
　　SND_elevol_all_mute(0) ; 　　　　　　　　　/*　サウンド全ミュートの設定*/
　　SND_elevol_mute(0) ; 　　　　　　　　　　　/*　サウンドミュートの設定　*/
　　SND_elevol_set(evol,127,127) ; 　　　　　　/*　サウンドマイク入力の設定*/
　　EGB_sjisString(egb_work,(char *)&m[0]) ; 　/*　グラフィック文字列　　　*/
　　EGB_sjisString(egb_work,(char *)&m[1]) ; 　/*　グラフィック文字列　　　*/
　　do {                                                                     
　　　　MOS_rdpos(&btn,&x,&y) ; 　　　　　　 /*マウス位置とボタンの読み取り*/
　　　　} while(btn != 0x01) ; 　　　　　　　/*　左ボタンが押されている？　*/
                                                                             
　　EGB_sjisString(egb_work,(char *)&m[2]) ; 　/*　グラフィック文字列　　  */
　　SND_pcm_rec(freq,&buff[32],size,0) ;　　　 /*　サウンドＰＣＭ録音開始　*/
                                                                             
                                                                             
　　*(int *)&buff[0]　　　　= 0 ; 　　　　　　 /*　サウンドネームの設定　　*/
　　*(int *)&buff[4]　　　　= 0 ; 　　　　　　 /*　サウンドＩＤの設定　　　*/
                                                                             
　　srand(((int)buff[32]+(int)buff[34]*256)*(int)buff[38]*256+size) ;        
                                                                             
　　*(int *)&buff[8]　　　　= rand()+(buff[33]+buff[35]*256+1) ;             
　　*(int *)&buff[12] 　　　= size ;　　　　　 /*　データ長の設定　　　　　*/
　　*(int *)&buff[16] 　　　= size ;　　　　　 /*　ループポイントの設定　　*/
　　*(int *)&buff[20] 　　　= 0 ; 　　　　　　 /*　ループレングスの設定　　*/
　　*(short int *)&buff[24] = freq*0x62/1000 ; /*　サンプリング周波数の設定*/
　　*(short int *)&buff[26] = 0 ; 　　　　　　 /*　原音の補正値の設定　　　*/
　　*(char *)&buff[28]　　　= 60 ;　　　　　　 /*　原音の音階の設定　　　　*/
　　*(char *)&buff[29]　　　= 0 ; 　　　　　　 /*　リザーブ領域の設定　　　*/
　　*(short int*)&buff[30]　= 0 ;                                            
                                                                             
　　SND_elevol_all_mute(-1) ;　　　　　/*　サウンド全ミュートの解除　　　　*/
　　SND_elevol_mute(0x01) ;　　　　　　/*　サウンドミュートの設定　　　　　*/
　　SND_pcm_mode_set(1) ;　　　　　　/*サウンド音声モードチャンネル数の設定*/
                                                                             
　　EGB_sjisString(egb_work,(char *)&m[3]) ; 　/*　グラフィック文字列　　　*/
　　EGB_sjisString(egb_work,(char *)&m[4]) ; 　/*　グラフィック文字列　　　*/
　　do {                                                                     
　　　　MOS_rdpos(&btn,&x,&y) ; 　　　　　　 /*マウス位置とボタンの読み取り*/
　　　　if (btn == 0x01){　　　　　　　　　　/*　左ボタンが押されている？　*/
　　　　　　SND_pcm_play(ch,note,vol,buff) ; /*  サウンド音声モード再生開始*/
　　　　　　do{}while(SND_pcm_status(ch));   /*  音声モード再生終了待ち　　*/
　　　　　　SND_pcm_play_stop(ch) ;　　　　　/*　サウンド音声モード再生停止*/
　　　　　　}                                                                
　　　　}while(btn != 0x02) ;　　　　　　　　/*　右ボタンが押されている？　*/
                                                                             
　　MOS_end() ; 　　　　　　　　　　　　　　　/*　マウス動作終了の設定　　 */
　　SND_end() ; 　　　　　　　　　　　　　　　/*　サウンド動作終了の設定　 */
　　free(buff) ;                                                             
　　free(mos_work) ;                                                         
　　free(egb_work) ;                                                         
　　free(snd_work) ;                                                         
}                                                                            
                                                                             
  5.2　関数一覧                                                              
                                                                             
┌───────────────┬────────────────────┐ 
│　　　　　関　数　名　　　　　│　　　　　　機　　　　　　　　能　　　　│ 
├───────────────┼────────────────────┤ 
│SND_init　　　　　　　　　　　│ドライバの初期化　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_end 　　　　　　　　　　　│ドライバの終了　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_key_on　　　　　　　　　　│音源の発音開始　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_key_off 　　　　　　　　　│音源の発音停止　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pan_set 　　　　　　　　　│音源の定位の設定　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_inst_change　　　　　　　 │音色の変更　　　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_inst_write 　　　　　　　 │音色の書き込み　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_inst_read　　　　　　　　 │音色の読み込み　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pitch_change　　　　　　　│ピッチベンド　　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_volume_change　　　　　　 │ボリューム変更　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_key_abort 　　　　　　　　│音源の発音の強制停止　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_read_status　　　　　　│ＦＭ音源ステータスの読み込み　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_write_data　　　　　　 │ＦＭ音源レジスタ書き込み　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_write_save_data　　　　│ＦＭ音源レジスタ保存領域への書き込み　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_read_save_data　　　　 │ＦＭ音源レジスタ保存領域の読み込み　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_timer_a_set 　　　　　 │ＦＭ音源タイマＡ設定　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_timer_b_set 　　　　　 │ＦＭ音源タイマＢ設定　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_timer_a_start          │ＦＭ音源タイマＡの動作開始　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_timer_b_start 　　　　 │ＦＭ音源タイマＢの動作開始　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_lfo_set 　　　　　　　 │ＦＭ音源ハードウェアＬＦＯの設定　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_wave_set 　　　　　　 │ＰＣＭウェーブデータの転送　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_mode_set 　　　　　　 │ＰＣＭ音声モードチャンネル数の設定　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_sound_set 　　　　　　│ＰＣＭサウンドデータの登録　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_sound_delete　　　　　│ＰＣＭサウンドデータの削除　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_rec 　　　　　　　　　│ＰＣＭ録音開始　　　　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_rec2　　　　　　　　　│ＰＣＭ録音開始2　　　　　　　　　　　　 │ 
├───────────────┼────────────────────┤ 
│SND_pcm_play　　　　　　　　　│ＰＣＭ音声モード再生開始　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_play2 　　　　　　　　│ＰＣＭ音声モード再生開始2　　　　　　　 │ 
├───────────────┼────────────────────┤ 
│SND_pcm_play_rom 　　　　　　 │ＰＣＭ音声モードシステムＲＯＭデータ    │ 
│                              │再生開始                                │ 
├───────────────┼────────────────────┤ 
│SND_pcm_rec_stop　　　　　　　│ＰＣＭ録音の強制停止　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_play_stop　　　　　　 │ＰＣＭ音声モード再生の強制停止　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_status　　　　　　　　│音声モード再生状態の入手　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_abort 　　　　　　　　│ＰＣＭ音源の強制停止　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_joy_in_1 　　　　　　　　 │ジョイスティックポートの読み込み1　　　 │ 
├───────────────┼────────────────────┤ 
│SND_joy_in_2 　　　　　　　　 │ジョイスティックポートの読み込み2　　　 │ 
├───────────────┼────────────────────┤ 
│SND_joy_out 　　　　　　　　　│ジョイスティックポート出力　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_elevol_set 　　　　　　　 │電子ボリュームの設定　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_get_elevol_set 　　　  　 │電子ボリュームの設定状態読み込み　　　　│ 
├───────────────┼────────────────────┤ 
│SND_elevol_init　　　　　　　 │電子ボリュームの初期化　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_elevol_read　　　　　　　 │電子ボリュームの読み込み　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_elevol_mute　　　　　　　 │電子ボリュームのミュート　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_get_elevol_mute　　　　　 │電子ボリュームのミュート状態の読み込み　│ 
├───────────────┼────────────────────┤ 
│SND_elevol_all_mute　　　　　 │電子ボリューム全ミュート　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_int_timer_a_set 　　　　　│タイマＡ割り込みの登録　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_int_timer_b_set 　　　　　│タイマＢ割り込みの登録　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_int_timer_a_get 　　　　　│タイマＡ割り込みの読み込み　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_int_timer_b_get 　　　　　│タイマＢ割り込みの読み込み　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_int_timer_sub_set 　　　　│タイマ割り出しの登録　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_int_timer_sub_get 　　　　│タイマ割り出しの読み込み　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_fm_bank_load　　　　　　　│ＦＭ音源バンクデータを読み込む　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_bank_load　　　　　　 │ＰＣＭ音源バンクデータを読み込む　　　　│ 
├───────────────┼────────────────────┤ 
│SND_get_int_status　　　　　　│割り込み処理登録状況の取得　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_sound_get 　　　　　　│ＰＣＭサウンドデータの読み取り　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_sound_ID_get 　　　　 │全サウンドＩＤの取得　　　　　　　　　　│ 
├───────────────┼────────────────────┤ 
│SND_pcm_mode_get 　　　　　　 │ＰＣＭ音声モードチャンネル数の読み取り　│ 
├───────────────┼────────────────────┤ 
│SND_status　(1) 　　　　　　　│ＰＣＭ音声モード再生アドレスの取得　　　│ 
├───────────────┼────────────────────┤ 
│SND_status　(2) 　　　　　　　│現在の発音状態の取得　　　　　　　　　　│ 
└───────────────┴────────────────────┘ 
                                                                             
  5.3　各関数の解説                                                          
                                                                             
　戻り値で特に指定がない場合の返り値の意味は以下の通りです。                 
                                                                             
 　0:正常終了                                                                
 　1:チャンネル番号が異常                                                    
 　2:キーＯＮ中                                                              
 　3:パラメータエラー                                                        
 　4:未定義ファンクション                                                    
 　5:波形メモリが不足                                                        
 　6:サウンドにデータ長が存在しない                                          
 　7:音声モードに使えないチャンネル                                          
 　8:スプリットの上限音階が小さすぎる                                        
 　9:サウンドＩＤが見つからない                                              
　10:サウンドの二重登録                                                      
　11:音声モードの上限周波数を超えた                                          
　12:サンプリングを強制停止した                                              
　13:サウンドデータのヘッダが異常                                            
                                                                             
　各チャンネルと音源の対応は以下の通りです。                                 
┌───────┬────────┬───────┬────────┐       
│　チャンネル　│　　音源種別　　│　チャンネル　│　　音源種別　　│       
├───────┼────────┼───────┼────────┤       
│　 　0　　　　│ＦＭ音源　ｃｈ1 │　  64　　　　│ＰＣＭ　ｃｈ1　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 1  　　　│ＦＭ音源　ｃｈ2 │　  65　　　　│ＰＣＭ　ｃｈ2　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 2　　　　│ＦＭ音源　ｃｈ3 │　  66　　　　│ＰＣＭ　ｃｈ3　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 3　　　　│ＦＭ音源　ｃｈ4 │　  67　　　　│ＰＣＭ　ｃｈ4　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 4　　　　│ＦＭ音源　ｃｈ5 │　  68　　　　│ＰＣＭ　ｃｈ5　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 5　　　　│ＦＭ音源　ｃｈ6 │　  69　　　　│ＰＣＭ　ｃｈ6　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 6〜15　  │ＦＭ音源拡張　　│　  70　　　　│ＰＣＭ　ｃｈ7　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　  16〜31　  │拡張用　　　　　│　  71　　　　│ＰＣＭ　ｃｈ8　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　  32〜63　  │リズム音源等拡張│　  72〜　95  │ＰＣＭ拡張　　　│       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　　　　　　│　　　　　　　　│　  96〜127   │その他の音源拡張│       
└───────┴────────┴───────┴────────┘       
                                                                             
-----------------------------------------------------------------------------
.SND_elevol_all_mute                                                         
電子ボリューム全ミュート                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_elevol_all_mute( sw );                                           
int 　　sw; 　　 /* スイッチ(0:ミュート、-1:ミュート解除) */                 
                                                                             
- 戻り値 -                                                                   
0 : 正常終了                                                                 
                                                                             
- 例 -                                                                       
int 　 ret, sw;                                                              
sw = 0;                                                                      
                                                                             
ret = SND_elevol_all_mute( sw );                                             
                                                                             
- 内容 -                                                                     
電子ボリュームのＡＬＬミュートを設定します。                                 
swが0の時ミュートし、-1の時ミュートを解除します。                            
                                                                             
-----------------------------------------------------------------------------
.SND_elevol_init                                                             
電子ボリュームの初期化                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_elevol_init( void );                                             
                                                                             
- 戻り値 -                                                                   
0 : 正常終了                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_elevol_init();                                                     
                                                                             
- 内容 -                                                                     
電子ボリュームを初期化します。                                               
各チャンネルを最小音量に設定し、ミュートします。                             
ＦＭ音源とＰＣＭ音源もミュートします。                                       
                                                                             
-----------------------------------------------------------------------------
.SND_elevol_mute                                                             
電子ボリュームのミュート                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_elevol_mute( sw_bit );                                           
int 　　sw_bit;　　　/* ミュート設定ビット */                                
                                                                             
- 戻り値 -                                                                   
0 : 正常終了                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_elevol_mute( 0x03 );                                               
                                                                             
- 内容 -                                                                     
各電子ボリュームのミュートを設定します。                                     
sw_bit の各ビットのオン･オフによって設定を行います。                         
1の時はミュートを解除しそのままの音量を維持、0の時はミュートします。         
ただし、SND_elevol_setを実行すると、ミュートが自動的に解除されてしまうので注 
意が必要です。                                                               
                                                                             
　　　　┌─┬─┬〜┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
sw_bit: │31│30│　│10│ 9│ 8│ 7│ 6│ 5│ 4│ 3│ 2│ 1│ 0│           
　　　　└─┴─┴〜┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┘           
　　　　0　　ＰＣＭ音源                                                      
　　　　1　　ＦＭ音源                                                        
　　　　2　　ＬＩＮＥ　ＩＮ　ＲＩＧＨＴ                                      
　　　　3　　ＬＩＮＥ　ＩＮ　ＬＥＦＴ                                        
　　　　4　　ＣＤ　ＲＩＧＨＴ                                                
　　　　5　　ＣＤ　ＬＥＦＴ                                                  
　　　　6　　ＭＩＣ                                                          
　　　　7　　ＭＯＤＥＭ                                                      
　　　　8〜　未使用                                                          
                                                                             
-----------------------------------------------------------------------------
.SND_elevol_read                                                             
電子ボリュームの読み込み                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_elevol_read( sw, l_vol, r_vol )                                  
int 　　sw; 　　　　 /* ボリューム番号(0〜3)　 */                            
int 　　l_vol;　　　 /* 左音量　　　　(0〜127) */                            
int 　　r_vol;　　　 /* 右音量　　　　(0〜127) */                            
                                                                             
- 戻り値 -                                                                   
0 : 正常終了                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
int 　 l_vol, r_vol;                                                         
                                                                             
ret = SND_elevol_read( 1, &l_vol, &r_vol );                                  
                                                                             
- 内容 -                                                                     
電子ボリュームの設定状態を読み込みます。以下にボリューム番号の割り当てを示し 
ます。                                                                       
                                                                             
┌───────┬────────────────┐                         
│ボリューム番号│　　　ボリューム設定入力名　　　│                         
├───────┼────────────────┤                         
│　　　 0　　　│ＬＩＮＥ-ＩＮ（ＳＴＥＲＥＯ）　 │                         
├───────┼────────────────┤                         
│　　　 1　　　│ＣＤ　　　　　（ＳＴＥＲＥＯ）　│                         
├───────┼────────────────┤                         
│　　　 2　　　│ＭＩＣ　　　　（ＭＯＮＯ）　　　│                         
├───────┼────────────────┤                         
│　　　 3　　　│ＭＯＤＥＭ　　（ＭＯＮＯ）　　　│                         
└───────┴────────────────┘                         
                                                                             
-----------------------------------------------------------------------------
.SND_elevol_set                                                              
電子ボリュームの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_elevol_set( sw, l_vol, r_vol );                                  
int 　　sw; 　　　　 /* ボリューム番号(0〜3)　 */                            
int 　　l_vol;　　　 /* 左音量　　　　(0〜127) */                            
int 　　r_vol;　　　 /* 右音量　　　　(0〜127) */                            
                                                                             
- 戻り値 -　　                                                               
0 : 正常終了                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_elevol_set( 1, 127, 127 );                                         
                                                                             
- 内容 -                                                                     
電子ボリュームに音量を設定します。                                           
以下に、ボリューム番号の割り当てを示します。音量を設定すると、自動的にミュー 
トが解除されます。                                                           
                                                                             
┌───────┬────────────────┐                         
│ボリューム番号│　　　ボリューム設定入力名　　　│                         
├───────┼────────────────┤                         
│　　　0　　　 │ＬＩＮＥ-ＩＮ（ＳＴＥＲＥＯ）　 │                         
├───────┼────────────────┤                         
│　　　1　　 　│ＣＤ　　　　　（ＳＴＥＲＥＯ）　│                         
├───────┼────────────────┤                         
│　　　2　　　 │ＭＩＣ　　　　（ＭＯＮＯ）　　　│                         
├───────┼────────────────┤                         
│　　　3　　　 │ＭＯＤＥＭ　　（ＭＯＮＯ）　　　│                         
└───────┴────────────────┘                         
                                                                             
-----------------------------------------------------------------------------
.SND_end                                                                     
ドライバの終了                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_end( void );                                                     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_end();                                                             
                                                                             
- 内容 -                                                                     
エンベロープ等の割り込みベクタの設定を解除します。                           
SND_initと対になっているので、ドライバの初期化を行ったプログラムは必ずこの関 
数を呼び出してください。                                                     
                                                                             
-----------------------------------------------------------------------------
.SND_fm_bank_load                                                            
ＦＭ音源バンクデータを読み込む                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_bank_load( path, bankname );                                  
char　　*path;　　　　　/* パス名 */                                         
char　　*bankname;　　　/* バンクデータ読み込み用作業領域 */                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
1:ファイルが見つからない                                                     
2:読み込み途中のエラー                                                       
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
char bankname[8];                                                            
                                                                             
ret = SND_fm_bank_load( "a:preset.fmb", bankname );                          
                                                                             
- 内容 -                                                                     
指定されたパスからFM音源バンク形式の音色データを読み込み、そのバンク名を     
banknameに設定します。もし、指定したパスにファイルが見つからない場合には、   
MS-DOSの環境変数FMINSTの指すパスから同名のファイルを探して読み込みます。     
banknameには8文字の領域を確保してください。                                  
スタック領域にバンクデータ読み込みバッファを確保するので、バンクデータ長＋通 
常動作用のスタックを確保する必要があります。                                 
                                                                             
-----------------------------------------------------------------------------
.SND_fm_lfo_set                                                              
ＦＭ音源ハードウェアＬＦＯの設定                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_lfo_set( frq );                                               
int 　　frq;　　　/* 基本周波数(0〜8) */                                     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_fm_lfo_set( 0 );                                                   
                                                                             
- 内容 -                                                                     
ＦＭ音源のハードウェアＬＦＯの基本周波数を設定します。                       
この基本周波数は、6チャンネルすべてに対して有効となるので、注意が必要です。  
frqは0〜8の値をとり、大きい程周波数が高くなります。0の時はＬＦＯを停止します 
各チャンネルごとのＬＦＯは、音色データのAMON、AMS/PMSで設定します。          
                                                                             
┌─────┬──┬──┬──┬──┬──┬──┬──┬──┬──┐         
│　 frq　　│  0 │  1 │  2 │  3 │  4 │  5 │  6 │  7 │  8 │         
├─────┼──┼──┼──┼──┼──┼──┼──┼──┼──┤         
│周波数(Hz)│停止│3.98│5.56│6.02│6.37│6.88│9.63│48.1│72.2│         
└─────┴──┴──┴──┴──┴──┴──┴──┴──┴──┘         
                                                                             
-----------------------------------------------------------------------------
.SND_fm_read_save_data                                                       
ＦＭ音源レジスタ保存領域の読み込み                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_read_save_data( bank, reg, data );                            
int 　　bank; 　　　/* バンク番号　(0,1) 　 */                               
int 　　reg;　　　　/* レジスタ番号(0〜255) */                               
int 　　*data;　　　/* データ　　　　　　　 */                               
                                                                             
- 戻り値 -                                                                   
0:正常終了　                                                                 
3:パラメータエラー                                                           
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
int 　 data;                                                                 
ret = SND_fm_read_save_data( 0, 0x27, &data );                               
                                                                             
- 内容 -                                                                     
ＦＭ音源レジスタの保存領域からデータを読み込みます。                         
ＦＭ音源ＬＳＩのレジスタは書き込みのみで、読み込みができないため、どのレジス 
タにどのような値を書いたのかをＢＩＯＳが保存しており、この関数ではその保存領 
域の値を読み込みます。                                                       
bank0 = ch1〜ch3                                                             
bank1 = ch4〜ch6                                                             
                                                                             
-----------------------------------------------------------------------------
.SND_fm_read_status                                                          
ＦＭ音源ステータスの読み込み                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_read_status( void );                                          
                                                                             
- 戻り値 -                                                                   
ステータスデータを返します。                                                 
                                                                             
- 例 -                                                                       
int ret;                                                                     
                                                                             
ret = SND_fm_read_status();                                                  
                                                                             
- 内容 -                                                                     
ＦＭ音源のステータスを読み込みます。                                         
                                                                             
　　　 b7 　 b6 　 b5 　 b4 　 b3 　 b2 　 b1 　 b0                          
　　┌──┬──┬──┬──┬──┬──┬──┬──┐                       
　　│　　│　　│　　│　　│　　│　　│FLAG│FLAG│                       
ret │BUSY│──│──│──│──│──│　　│　　│　 bit31〜8は不定      
　　│　　│　　│　　│　　│　　│　　│ Ｂ │ Ａ │                       
　　└──┴──┴──┴──┴──┴──┴──┴──┘                       
　　　↑　　　　　　　　　　　　　　　　　　↑　↑                           
　　　│　　　　　　　　　　　　　　　　　　│　└─0:ﾀｲﾏA割り込み要因なし   
　　　│　　　　　　　　　　　　　　　　　　│　　　1:ﾀｲﾏA割り込み要因あり   
　　　│　　　　　　　　　　　　　　　　　　│                               
　　　│　　　　　　　　　　　　　　　　　　└─0:ﾀｲﾏB割り込み要因なし       
　　　└─0:FM音源動作待ち　　　　　　　　　　　1:ﾀｲﾏB割り込み要因あり       
　　　　　1:FM音源動作中                                                     
                                                                             
-----------------------------------------------------------------------------
.SND_fm_timer_a_set                                                          
ＦＭ音源タイマＡ設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_timer_a_set( sw, count );                                     
int 　　sw; 　　　　/* スイッチ　(0,255) 　*/                                
int 　　count;　　　/* カウント値(0〜1023) */                                
                                                                             
- 戻り値 -                                                                   
0:正常終了　                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
int 　 count;                                                                
                                                                             
count = 0x15;                                                                
                                                                             
ret = SND_fm_timer_a_set( 255, count );                                      
                                                                             
- 内容 -                                                                     
ＦＭ音源タイマＡにカウント値を設定します(10bit)。                            
sw=0の時タイマＡを停止します。カウント値は保持されます。                     
sw=0以外の時タイマＡにカウント値を設定してタイマをスタートさせます。         
カウント値はインクリメントカウンタなので0で最大、1023で最小となります。      
カウント値countとインターバルT(ms)は、次の関係式を満たします。               
                                                                             
　　T(ms) = 12 * (1024-count) * 12 / 8000(kHz)                               
ＢＩＯＳ初期化時にはタイマＡは停止状態となります。                           
ＥＵＰＨＯＮＹドライバを使用する場合は、ドライバがこのタイマＡを使用するので 
停止したりカウント値を変えると正常な演奏ができなくなります。                 
                                                                             
-----------------------------------------------------------------------------
.SND_fm_timer_a_start                                                        
ＦＭ音源タイマＡの動作開始                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_timer_a_start( void );                                        
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_fm_timer_a_start();                                                
                                                                             
- 内容 -                                                                     
停止しているタイマＡの動作を開始させます。                                   
SND_fm_timer_a_setで停止させた後、再スタートさせる時やＦＭ音源割り込みの要因 
を消して再スタートをかける際に使用します。                                   
                                                                             
-----------------------------------------------------------------------------
.SND_fm_timer_b_set                                                          
ＦＭ音源タイマＢ設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_timer_b_set( sw, count );                                     
int 　　sw; 　　　　/* スイッチ　(0,255)  */                                 
int 　　count;　　　/* カウント値(0〜255) */                                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
int 　 count;                                                                
                                                                             
count = 0x15;                                                                
                                                                             
ret = SND_fm_timer_b_set( 255, count );                                      
                                                                             
- 内容 -                                                                     
ＦＭ音源タイマＢにカウント値を設定します(8bit)。                             
sw=0の時タイマＢを停止します。カウント値は保持されます。                     
sw=0以外の時タイマＢにカウント値を設定してタイマをスタートさせます。         
カウント値はインクリメントカウンタなので0で最大、255で最小となります。       
カウント値countとインターバルT(ms)は、次の関係式を満たします。               
                                                                             
　　T(ms) = 192 * (256-count) * 12 / 8000(kHz)                               
タイマＢは初期化時に約10msに設定され、ＰＣＭ音源の楽器モードのエンベロープ処 
理やマウスの更新処理に使用します。よって、カウント値を変更する時は注意が必要 
です。                                                                       
                                                                             
-----------------------------------------------------------------------------
.SND_fm_timer_b_start                                                        
ＦＭ音源タイマＢの動作開始                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_timer_b_start( void );                                        
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_fm_timer_b_start();                                                
                                                                             
- 内容 -                                                                     
停止しているタイマＢの動作を開始させます。                                   
SND_fm_timer_b_setで停止させた後、再スタートさせる時やＦＭ音源割り込みの要因 
を消して再スタートをかける際に使用します。                                   
                                                                             
-----------------------------------------------------------------------------
.SND_fm_write_data                                                           
ＦＭ音源レジスタ書き込み                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_write_data( bank, reg, data );                                
int 　　bank; 　　 /* バンク番号　(0,1) 　 */                                
int 　　reg;　　　 /* レジスタ番号(0〜255) */                                
int 　　data; 　　 /* データ　　　(0〜255) */                                
                                                                             
- 戻り値 -                                                                   
0:正常終了　                                                                 
3:パラメータエラー                                                           
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_fm_write_data( 0, 0x27, 0x30 );                                    
                                                                             
- 内容 -                                                                     
ＦＭ音源のレジスタにデータを書き込みます。                                   
bank0 = ch1〜ch3                                                             
bank1 = ch4〜ch6                                                             
                                                                             
-----------------------------------------------------------------------------
.SND_fm_write_save_data                                                      
ＦＭ音源レジスタ保存領域への書き込み                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_fm_write_save_data( bank, reg, data );                           
int 　　bank; 　　 /* バンク番号　(0,1) 　 */                                
int 　　reg;　　　 /* レジスタ番号(0〜255) */                                
int 　　data; 　　 /* データ　　　(0〜255) */                                
                                                                             
- 戻り値 -                                                                   
0:正常終了　                                                                 
3:パラメータエラー                                                           
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_fm_write_save_data( 0, 0x27, 0x30 );                               
                                                                             
- 内容 -                                                                     
ＦＭ音源レジスタの保存領域にデータを書き込みます。                           
ＦＭ音源ＬＳＩのレジスタは書き込みのみで、読み込みができないため、どのレジス 
タにどのような値を書いたのかをＢＩＯＳが保存しており、この関数ではその保存領 
域へ値を書き込みます。                                                       
bank0 = ch1〜ch3                                                             
bank1 = ch4〜ch6                                                             
                                                                             
-----------------------------------------------------------------------------
.SND_get_elevol_mute                                                         
電子ボリュームのミュート状態の読み込み                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_get_elevol_mute( sw_bit );                                       
int 　　*sw_bit;　　　/* 電子ボリュームのミュート状態 */                     
                                                                             
- 戻り値 -                                                                   
電子ボリュームのミュート状態を以下の形式で返します。                         
                                                                             
　　　　┌─┬─┬〜┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐           
sw_bit: │31│30│　　10│ 9│ 8│ 7│ 6│ 5│ 4│ 3│ 2│ 1│ 0│           
　　　　└─┴─┴〜┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┘           
                                                                             
　　　　0:　ＰＣＭ音源                                                       
　　　　1:　ＦＭ音源                                                         
　　　　2:　ＬＩＮＥ　ＩＮ　ＲＩＧＨＴ                                       
　　　　3:　ＬＩＮＥ　ＩＮ　ＬＥＦＴ                                         
　　　　4:　ＣＤ　ＲＩＧＨＴ                                                 
　　　　5:　ＣＤ　ＬＥＦＴ                                                   
　　　　6:　ＭＩＣ                                                           
　　　　7:　ＭＯＤＥＭ                                                       
　　　　8〜:未使用                                                           
                                                                             
- 例 -                                                                       
int 　sw;                                                                    
int 　ret;                                                                   
                                                                             
ret = SND_get_elevol_mute( &sw );                                            
                                                                             
- 内容 -                                                                     
各電子ボリュームのミュート/解除の設定状態を読み取ります。                    
sw_bit の各ビットはそれぞれ、1の時はミュートを解除状態、0の時はミュート状態で
す。                                                                         
変数の値がNULLの場合、変数に対して値を返しません。                           
                                                                             
-----------------------------------------------------------------------------
.SND_get_elevol_set                                                          
電子ボリュームの設定状態読み込み                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_get_elevol_set( sw, l_vol, r_vol );                              
int 　　sw; 　　　　 /* 電子ボリューム番号　*/                               
int 　　*l_vol;　　  /* 左の音量　　　　　　*/                               
int 　　*r_vol;　　  /* 右の音量　　　　　　*/                               
                                                                             
- 戻り値 -                                                                   
電子ボリュームの右、左の設定値を以下の形式で返します。                       
                                                                             
　　31　　　　　15　　　　　　　 7　　　　　　　0                            
　　┌─〜〜──┬───────┬───────┐                           
　　│　　　　　│　　　　　　　│　　　　　　　│                           
　　└─〜〜──┴┬─────┬┴┬─────┬┘                           
　　　　　　　　　└──┬──┘　└──┬──┘                             
　　　　　右の音量───┘　　　　　　　│                                   
　　　　　　　　　　　　左の音量────┘                                   
                                                                             
- 例 -                                                                       
int 　 sw;                                                                   
int 　 l_vol, r_vol;                                                         
int 　 ret;                                                                  
                                                                             
sw = 1;                                                                      
ret = SND_get_elevol_set( sw, &l_vol, &r_vol );                              
                                                                             
- 内容 -                                                                     
指定された電子ボリュームの右、左の設定値を読み取ります。                     
変数の値がNULLの場合、変数に対して値を返しません。                           
                                                                             
┌───────┬────────────────┐                         
│ボリューム番号│　　　ボリューム設定入力名　　　│                         
├───────┼────────────────┤                         
│　　　 0　　　│ＬＩＮＥ-ＩＮ（ＳＴＥＲＥＯ）　 │                         
├───────┼────────────────┤                         
│　　　 1　　　│ＣＤ　　　　　（ＳＴＥＲＥＯ）　│                         
├───────┼────────────────┤                         
│　　　 2　　　│ＭＩＣ　　　　（ＭＯＮＯ）　　　│                         
├───────┼────────────────┤                         
│　　　 3　　　│ＭＯＤＥＭ　　（ＭＯＮＯ）　　　│                         
└───────┴────────────────┘                         
                                                                             
-----------------------------------------------------------------------------
.SND_get_int_status                                                          
割り込み処理登録状況の取得                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_get_int_status( void );                                          
                                                                             
- 戻り値 -                                                                   
割り込み処理の登録状況を返します。                                           
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
                                                                             
ret = SND_get_int_status();                                                  
                                                                             
if ( ret == 0x00 )                                                           
　　printf("現在割り込みハンドラは登録されていません\n");                    
if ( ret == 0x11 )                                                           
　　printf("現在マウスＢＩＯＳが動作しています\n");                          
if ( ret == 0x0a )                                                           
　　printf("現在サウンドＢＩＯＳが動作しています\n");                        
if ( ret == 0x2a )                                                           
　　printf("現在サウンドＢＩＯＳとマウスＢＩＯＳが動作しています\n");        
                                                                             
- 内容 -                                                                     
マウス、サウンドの各割り込みハンドラの登録状態を取得します。                 
                                                                             
　　　　31　　　　　5　4　3　2　1　0                                         
　　　┌─┬─〜─┬─┬─┬─┬─┬─┬─┐                                 
  ret:│ 0│　　　│　│　│　│　│　│　│                                 
　　　└─┴─〜─┴┬┴┬┴┬┴─┴┬┴┬┘                                 
　　　　　　　　　　│　│　│　　　│　│                                   
　　　　　　　　　　│　│　│　　　│　└─マウスＢＩＯＳ割り込み処理       
　　　　　　　　　　│　│　│　　　└─サウンドＢＩＯＳ割り込み処理         
　　　　　　　　　　│　│　│                                               
　　　　　　　　　　│　│　└─サウンドＢＩＯＳ割り出し処理                 
　　　　　　　　　　│　└─マウスＢＩＯＳマウス処理                         
　　　　　　　　　　└─サウンドＢＩＯＳマウス処理                           
                                                                             
　　　　　　　　　　　　　　　　　　　　　各ビット　0:登録されていない       
　　　　　　　　　　　　　　　　　　　　　　　　　　1:登録されている         
                                                                             
-----------------------------------------------------------------------------
.SND_init                                                                    
ドライバの初期化                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_init( work );                                                    
char　　*work;　　　/* 作業域のアドレス */                                   
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　work[16384];                                                         
int 　　ret;                                                                 
                                                                             
ret = SND_init( work );                                                      
                                                                             
- 内容 -                                                                     
ハードウェアおよびドライバの初期化を行い、エンベロープ等の割り込みベクタを設 
定します。                                                                   
サウンドライブラリと同時にマウスを使用する場合は、先にこの関数を使ってサウン 
ドライブラリを初期化しておかなければなりません。作業域の大きさは 16384(16K)バ
イトを必要とします。以後、この作業域を用いてサウンドライブラリが動作するので 
ライブラリを使用する場合はこの関数を用いて初期化しなければなりません。ただし 
電子ボリュームとジョイスティックのみを使用する場合はこの初期化を行う必要はあ 
りませんが、その場合、SND_elevol_initを用いて、電子ボリュームの初期化をする必
要があります。SND_initでは次頁の内容で初期化をします。                       
                                                                             
┌─────────────────────────────┐               
│(1) ＦＭ音源ＬＳＩの初期化　　　　　　　　　　　　　　　　│               
├─────────────────────────────┤               
│(2) ＦＭ音源の発音の停止　　　　　　　　　　　　　　　　　│               
├─────────────────────────────┤               
│(3) ＰＣＭ音源の初期化　　　　　　　　　　　　　　　　　　│               
├─────────────────────────────┤               
│(4) ＰＣＭ音源の発音の停止　　　　　　　　　　　　　　　　│               
├─────────────────────────────┤               
│(5) 波形メモリの初期化　　　　　　　　　　　　　　　　　　│               
├─────────────────────────────┤               
│(6) ワークエリアの初期化　　　　　　　　　　　　　　　　　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＦＭ音源　　キーＯＦＦ　　　　　　　　　　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＦＭ音源　　パンポット　中央　　　　　　　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＦＭ音源　　音色変更　デフォルト音色(ELEPIANO)設定　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＦＭ音源　　音色データ書き込み　デフォルト音色(ELEPIANO) │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│　　　　　　　書き込み　　　　　　　　　　　　　　　　　　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＦＭ音源　　ピッチベンド　ピッチリセット　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＦＭ音源　　ボリューム変更　最大値設定　　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＰＣＭ音源　キーＯＦＦ　　　　　　　　　　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＰＣＭ音源　パンポット　中央　　　　　　　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＰＣＭ音源　音色変更　無音音色設定　　　　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＰＣＭ音源　音色データ書き込み　無音音色書き込み　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＰＣＭ音源　ピッチベンド　ピッチリセット　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＰＣＭ音源　ボリューム変更　最大値設定　　　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＰＣＭ音源　音声モードチャンネル設定数＝0 　　　　　　　 │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│･ＰＣＭ音源　サウンドデータ全削除　　　　　　　　　　　　 │               
├─────────────────────────────┤               
│(7) 電子ボリュームの初期化　　　　　　　　　　　　　　　　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│　　SND_initが呼ばれる以前にサウンドライブラリを使用して  │               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│　　設定していた値を再設定します。　　　　　　　　　　　　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
├─────────────────────────────┤               
│(8) ＦＭ音源タイマの初期化　　　　　　　　　　　　　　　　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│　　タイマＡ設定値＝0x01(18.414ms)　　　　　　　　　　　　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│　　タイマＢ設定値＝0xdd(10.08 ms)　　　　　　　　　　　　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│　　タイマＡ停止　　　　　　　　　　　　　　　　　　　　　│               
│　　　　　　　　　　　　　　　　　　　　　　　　　　　　　│               
│　　タイマＢ動作開始　　　　　　　　　　　　　　　　　　　│               
└─────────────────────────────┘               
                                                                             
-----------------------------------------------------------------------------
.SND_inst_change                                                             
音色の変更                                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_inst_change( ch, inst );                                         
int 　　ch; 　　　 /* チャンネル番号 */                                      
int 　　inst; 　　 /* 音色番号　　　 */                                      
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
int 　 ch, inst;                                                             
                                                                             
ch = 64;　　　　　　　　　　/*　PCM tone　　　　　　　　　　　　*/           
inst = 0; 　　　　　　　　　/*　Inst No.1 　　　　　　　　　　　*/           
                                                                             
ret = SND_inst_change( ch, inst );                                           
                                                                             
- 内容 -                                                                     
各音源の音色を変更します。                                                   
SND_inst_writeによって、ＢＩＯＳの音色格納領域に登録されたデータを参考に音色 
を変更します。                                                               
ＦＭ音源の場合は、音色の変更により音そのものが変化します。ＰＣＭ音源の場合は 
エンベロープとスプリットは変化しますが、音そのものを変化させることはできませ 
ん。ＦＭ音源の場合、音色のパンポットビット(LR,AMS,PMSのLR)が左右共にＯＦＦの 
ときは、音色を切り換える前のパンポットの状態を保持して音色が切り替わります。 
ch =　0〜5　FM音源、64〜71　PCM音源                                          
inst =　0〜127。ただし、PCM音源では0〜31                                     
                                                                             
-----------------------------------------------------------------------------
.SND_inst_read                                                               
音色の読み込み                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_inst_read( ch, inst, buff );                                     
int 　　ch; 　　　　/* チャンネル番号　　　 */                               
int 　　inst; 　　　/* 音色番号　　　　　　 */                               
char　　*buff;　　　/* 音色データのアドレス */                               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
int 　　ch, inst;                                                            
char　　buff[128];                                                           
                                                                             
ch = 64;　　　　　　　　　　/*　PCM tone　　　　　　　　　　　　*/           
inst = 3; 　　　　　　　　　/*　Inst No.4 　　　　　　　　　　　*/           
                                                                             
ret = SND_inst_read( ch, inst, buff );                                       
                                                                             
- 内容 -                                                                     
各音源の音色(インストゥルメンツ)を読み込みます。                             
この機能では、ＢＩＯＳの音色格納領域に登録されている音色データを、読み取り先 
へ転送します。                                                               
chの値で音源の種別を判定します。FM音源なら0、PCM音源なら64と指定します。     
inst =　0〜127。ただし、PCM音源では0〜31                                     
                                                                             
-----------------------------------------------------------------------------
.SND_inst_write                                                              
音色の書き込み                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_inst_write( ch, inst, buff );                                    
int 　　ch; 　　　　/* チャンネル番号　　　 */                               
int 　　inst; 　　　/* 音色番号　　　　　　 */                               
char　　*buff;　　　/* 音色データのアドレス */                               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
int 　　ch, inst;                                                            
char　　buff[48];                                                            
                                                                             
ch = 0; 　　　　　　　　　　/*　FM tone 　　　　　　　　　　　　*/           
inst = 0; 　　　　　　　　　/*　Inst No.1 　　　　　　　　　　　*/           
                                                                             
ret = SND_inst_write( ch, inst, buff );                                      
                                                                             
- 内容 -                                                                     
各音源の音色(インストゥルメンツ)を書き込みます。                             
この機能では、ＢＩＯＳの音色格納領域に音色を転送するだけで、音源の音自体は変 
化しません。                                                                 
音源の音を変化させる場合は、SND_inst_changeを使用します。                    
chの値で音源の種別を判定します。FM音源なら0、PCM音源なら64と指定します。     
inst =　0〜127。ただし、PCM音源では0〜31                                     
                                                                             
-----------------------------------------------------------------------------
.SND_int_timer_a_get                                                         
タイマＡ割り込みの読み込み                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
void　　(*SND_int_timer_a_get( void ))();                                    
                                                                             
- 戻り値 -                                                                   
割り込み処理アドレスを返します。                                             
                                                                             
- 例 -                                                                       
void　　(*addr)();                                                           
                                                                             
addr = SND_int_timer_a_get();                                                
                                                                             
- 内容 -                                                                     
タイマＡの割り込み処理先を読み込みます。                                     
SND_int_timer_a_setに先立って、割り込み処理先を保存する時などに用います。    
                                                                             
-----------------------------------------------------------------------------
.SND_int_timer_a_set                                                         
タイマＡ割り込みの登録                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_int_timer_a_set( addr );                                         
void　　*addr;                                                               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_int_timer_a_set(func1);                                            
                                                                             
void　　func1()                                                              
{　　                                                                        
　　･                                                                        
　　･                                                                        
　　･                                                                        
　}                                                                          
                                                                             
- 内容 -                                                                     
タイマＡの割り込み処理先を登録します。                                       
タイマＡの割り込みが発生すると、タイマを再設定したのちに登録アドレスが       
NEAR CALLされます。                                                          
割り込み処理先では、できる限りスタックを使用しないようにしなければなりません 
もし、スタックを多く使用する場合は、アセンブラ等で自前のローカルスタックに切 
り替える処理を追加する必要があります。                                       
                                                                             
-----------------------------------------------------------------------------
.SND_int_timer_b_get                                                         
タイマＢ割り込みの読み込み                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
void　　(*SND_int_timer_b_get( void ))();                                    
                                                                             
- 戻り値 -                                                                   
割り込み処理アドレスを返します。                                             
                                                                             
- 例 -                                                                       
void　　(*addr)();                                                           
                                                                             
addr = SND_int_timer_b_get();                                                
                                                                             
- 内容 -                                                                     
タイマＢの割り込み処理先を読み込みます。                                     
SND_int_timer_b_setに先立って、割り込み処理先を保存する時などに用います。    
                                                                             
-----------------------------------------------------------------------------
.SND_int_timer_b_set                                                         
タイマＢ割り込みの登録                                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_int_timer_b_set( addr );                                         
void　　*addr;                                                               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_int_timer_b_set(func1);                                            
                                                                             
void func1()                                                                 
{                                                                            
　　･                                                                        
　　･                                                                        
　　･                                                                        
　}                                                                          
                                                                             
- 内容 -                                                                     
タイマＢの割り込み処理先を登録します。                                       
タイマＢの割り込みが発生すると、タイマを再設定したのちに登録アドレスが       
NEAR CALLされます。                                                          
割り込み処理先では、できる限りスタックを使用しないようにしなければなりません 
もし、スタックを多く使用する場合は、アセンブラ等で自前のローカルスタックに切 
り替える処理を追加する必要があります。                                       
                                                                             
-----------------------------------------------------------------------------
.SND_int_timer_sub_get                                                       
タイマ割り出しの読み込み                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
void　　(*SND_int_timer_sub_get( void ))();                                  
                                                                             
- 戻り値 -                                                                   
割り出し処理アドレスを返します。                                             
                                                                             
- 例 -                                                                       
void　　(*addr)();                                                           
                                                                             
addr = SND_int_timer_sub_get();                                              
                                                                             
- 内容 -                                                                     
タイマの割り出し処理先を読み込みます。                                       
SND_int_timer_sub_getに先立って、割り込み処理先を保存する時などに用います。  
                                                                             
-----------------------------------------------------------------------------
.SND_int_timer_sub_set                                                       
タイマ割り出しの登録                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_int_timer_sub_set( addr );                                       
void　　*addr;                                                               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_int_timer_sub_set(func1);                                          
                                                                             
void func1()                                                                 
{　　                                                                        
　　･                                                                        
　　･                                                                        
　　･                                                                        
　}                                                                          
                                                                             
- 内容 -                                                                     
タイマの割り出し処理先を登録します。                                         
ただし、ＥＵＰＨＯＮＹドライバがこのルーチンを使用するので、ドライバ使用時に 
登録するとドライバが正常に動作しなくなります。                               
                                                                             
-----------------------------------------------------------------------------
.SND_joy_in_1                                                                
ジョイスティックポートの読み込み1                                            
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_joy_in_1( port, status );                                        
int 　　port; 　　　　/* ポート番号 (0 or 1) */                              
int 　　*status;　　　/* ポートの値　　　　　*/                              
                                                                             
- 戻り値 -                                                                   
0 : 正常終了                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
int 　 status;                                                               
                                                                             
ret =  SND_joy_in_1( 0, &status );                                           
                                                                             
- 内容 -                                                                     
ジョイスティックポートの値を読み込みます。                                   
各ビットの意味は以下の通りです。                                             
各スイッチが放されている時、各ビットはＯＮとなり、各スイッチが押されている時 
各ビットスイッチはＯＦＦとなります。スタートボタンが押されると左右のビットが 
ＯＦＦとなり、セレクトボタンが押されると上下のビットがＯＦＦとなります。     
bit 7 :不定　　　　　bit 3 :右                                               
bit 6 :不定　　　　　bit 2 :左                                               
bit 5 :トリガＢ　　　bit 1 :下                                               
bit 4 :トリガＡ　　　bit 0 :上                                               
                                                                             
-----------------------------------------------------------------------------
.SND_joy_in_2                                                                
ジョイスティックポートの読み込み2                                            
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_joy_in_2( port, status );                                        
int 　　port; 　　　　/* ポート番号 (0 or 1) */                              
int 　　*status;　　　/* ポートの値　　　　　*/                              
                                                                             
- 戻り値 -                                                                   
0 : 正常終了                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
int 　 status;                                                               
                                                                             
ret = SND_joy_in_2( 0, &status );                                            
                                                                             
- 内容 -                                                                     
ジョイスティックポートの値を読み込みます。                                   
SND_joy_in_1と同様に各ボタンが放されている時、ビットはＯＮとなり、各ボタンが 
押されている時、ビットはＯＦＦとなります。SND_joy_in_1との違いはスタートとセ 
レクトを不定ビットに割り当て、かつ方向ボタンでスタートやセレクトのコードの上 
がるパッド対策のデータ補正を行います。                                       
bit 7 :セレクト　　　bit 3 :右                                               
bit 6 :スタート　　　bit 2 :左                                               
bit 5 :トリガＢ　　　bit 1 :下                                               
bit 4 :トリガＡ　　　bit 0 :上                                               
                                                                             
-----------------------------------------------------------------------------
.SND_joy_out                                                                 
ジョイスティックポート出力                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_joy_out( data, status1, status2 );                               
int 　　data; 　　　　 /* ポート出力値　　 */                                
int 　　*status1; 　　 /* ポート0のデータ */                                 
int 　　*status2; 　　 /* ポート1のデータ */                                 
                                                                             
- 戻り値 -                                                                   
0 : 正常終了                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
int 　 status1;                                                              
int 　 status2;                                                              
                                                                             
ret = SND_joy_out( 0x0f, &status1, &status2 );                               
                                                                             
- 内容 -                                                                     
ジョイスティックポートに値を書き込み、その返り値を返します。                 
                                                                             
-----------------------------------------------------------------------------
.SND_key_abort                                                               
音源の発音の強制停止                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_key_abort( ch );                                                 
int 　　ch; 　　 /* チャンネル番号 */                                        
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret,ch;                                                               
                                                                             
ch = 64;　　　　　　　　　　/*　PCM tone　　　　　　　　　　　　*/           
                                                                             
ret = SND_key_abort( ch );                                                   
                                                                             
- 内容 -                                                                     
各チャンネルを強制的に発音停止し、リリース等もカットします。                 
この機能は、全モード(ＦＭ音源、楽器モード、音声モード)で使用できます。       
ch =　0〜5　FM音源、　64〜71　PCM音源                                        
                                                                             
-----------------------------------------------------------------------------
.SND_key_off                                                                 
音源の発音停止                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_key_off( ch );                                                   
int 　　ch; 　　 /* チャンネル番号 */                                        
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_key_off( 0 ); 　/*　FM tone 　　　　　　　　　　　　*/             
                                                                             
- 内容 -                                                                     
各音源の発音を停止します。                                                   
ただし、音楽的な意味のキーＯＦＦであるため、リリースレートの設定値によっては 
音が鳴り続ける場合もあります。発音の強制的な停止を行う場合は、SND_key_abort  
を使用します。ch =　0〜5　FM音源、64〜71　PCM音源                            
                                                                             
-----------------------------------------------------------------------------
.SND_key_on                                                                  
音源の発音開始                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_key_on( ch, note, velo );                                        
int 　　ch; 　　　 /* チャンネル番号 */                                      
int 　　note; 　　 /* 音程　　　　　 */                                      
int 　　velo; 　　 /* 音量　　　　　 */                                      
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret,note, velo;                                                       
                                                                             
note = 60;　　　　　　　　　　　　　 /*  Middle C 　　　　　　　　　*/       
velo = 120; 　　　　　　　　　　　　 /*  Normal 　　　　　　　　　　*/       
                                                                             
ret = SND_key_on( 0, note, velo );　 /*  FM tone　　　　　　　　　　*/       
                                                                             
- 内容 -                                                                     
各音源の発音を開始します。                                                   
音程、音量はＭＩＤＩに準拠します(Middle C=60)。                              
ch　 =　0〜5　FM音源、64〜71　PCM音源                                        
note =　1〜127                                                               
velo =　1〜127                                                               
                                                                             
-----------------------------------------------------------------------------
.SND_pan_set                                                                 
音源の定位の設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pan_set( ch, pan );                                              
int 　　ch; 　　　/* チャンネル番号 */                                       
int 　　pan;　　　/* パンポット　　 */                                       
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_pan_set( 64, 0 ); /*　PCM tone ,left　　　　　　　*/               
                                                                             
- 内容 -                                                                     
各音源の定位を指定します。                                                   
panの範囲は0〜127で、0の時最も左、64で中央、127の時最も右になります。        
ＰＣＭ音源では、中央左寄りといった詳細な設定が可能です。ＦＭ音源では、左、   
中央、右の3ポイントのみとなっています。この機能は、全モード(ＦＭ音源、楽器   
モード、音声モード)で使用できます。                                          
ch =　0〜5　FM音源、64〜71　PCM音源                                          
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_abort                                                               
ＰＣＭ音源の強制停止                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_abort( void );                                               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_pcm_abort();                                                       
                                                                             
- 内容 -                                                                     
ＰＣＭ音源の8チャンネルすべての発音を、モードに関係なく強制的に停止します。リ
リース等の処理も強制的にカットされます。                                     
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_bank_load                                                           
ＰＣＭ音源バンクデータを読み込む                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_bank_load( path, bankname );                                 
char　　*path;　　　　　/* パス名 */                                         
char　　*bankname;　　　/* バンクデータ読み込み用作業領域 */                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
char bankname[8];                                                            
                                                                             
ret = SND_pcm_bank_load( "a:RYM_ALL1.PMB"，bankname );                       
                                                                             
- 内容 -                                                                     
指定されたパスからＰＣＭ音源バンク形式の音色データを読み込み、そのバンク名を 
banknameに設定します。もし、指定したパスにファイルが見つからない場合には、   
MS-DOSの環境変数PCMINSTの指すパスから同名のファイルを探して読み込みます。    
banknameには8文字の領域を確保してください。                                  
この関数を使用する場合、バンクデータ長＋通常動作用のスタックを必要とするので 
十分にスタックを確保しておく必要があります。                                 
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_mode_get                                                            
PCM音声モードチャンネル数の読み取り                                          
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_mode_get( void );                                            
                                                                             
- 戻り値 -                                                                   
現在設定されている音声モードチャンネル数を返します。                         
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
                                                                             
ret = SND_pcm_mode_get();                                                    
                                                                             
- 内容 -                                                                     
現在設定されているPCM音声モードチャンネル数を読み取ります。                  
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_mode_set                                                            
ＰＣＭ音声モードチャンネル数の設定                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　 SND_pcm_mode_set( ch );                                               
int 　 ch;　　　/* ＰＣＭ音声モード使用チャンネル数 */                       
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
5:メモリ不足                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_pcm_mode_set( 1 );                                                 
                                                                             
- 内容 -                                                                     
ＰＣＭ音声モードに使用するチャンネル数を設定します。                         
使用するチャンネル数だけ、ＰＣＭの下方のチャンネル(71〜)から順に音声モードに 
割り当てられます。初期化直後の使用チャンネル数は0となっています。            
音声モードを使用する場合、使用するチャンネル数×8Ｋバイトの波形メモリを必要と
します。すでにサウンドが登録されていて波形メモリが確保できない場合はエラーが 
返ります。この場合はSND_pcm_mode_deleteを使用して、再度設定することになります
                                                                             
音声モードは、理論的に8ｃｈ同時再生が可能ですが、処理をすべてソフトウェアで行
っているため、4〜5ｃｈ以上を同時に再生する場合、ＣＰＵの負荷が高くなるので、 
おすすめできません。以下に、音声モードの設定数と使用可能チャンネル数の表を示 
します。                                                                     
                                                                             
┌───┬─────────────────┐                               
│設定数│　　 使用可能なチャンネル番号　　 │                               
├───┼─────────────────┤                               
│　 0　│　なし　　　　　　　　　　　　　　│                               
├───┼─────────────────┤                               
│　 1　│　71　　　　　　　　　　　　　　　│                               
├───┼─────────────────┤                               
│　 2　│　71、70、　　　　　　　　　　　　│                               
├───┼─────────────────┤                               
│　 3　│　71、70、69　　　　　　　　　　　│                               
├───┼─────────────────┤                               
│　 4　│　71、70、69、68　　　　　　　　　│                               
├───┼─────────────────┤                               
│　 5　│　71、70、69、68、67　　　　　　　│                               
├───┼─────────────────┤                               
│　 6　│　71、70、69、68、67、66　　　　　│                               
├───┼─────────────────┤                               
│　 7　│　71、70、69、68、67、66、65　　　│                               
├───┼─────────────────┤                               
│　 8　│　71、70、69、68、67、66、65、64　│                               
└───┴─────────────────┘                               
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_play                                                                
ＰＣＭ音声モード再生開始                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_play( ch, note, vol, buff );                                 
int 　　ch; 　　　　/* チャンネル番号(64〜71)  */                            
int 　　note; 　　　/* 音程(1〜127)　　　　　　*/                            
int 　　vol;　　　　/* 音量(1〜127)　　　　　　*/                            
char　　*buff;　　　/* 音声データのアドレス　　*/                            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　*buff;                                                               
int 　　ret;                                                                 
                                                                             
ret = SND_pcm_play( 71, 60, 127, buff );                                     
                                                                             
- 内容 -                                                                     
ＰＣＭ音声モードで再生を開始します。                                         
サンプリング周波数と音程を計算した結果が20ＫHzを超える場合は、20ＫHzで再生さ 
れます。                                                                     
buffの指すアドレスには音声モード形式のヘッダ付のデータが格納されていなければ 
なりません。                                                                 
音声モードは割り込みによるバックグラウンド処理なので、再生が終了する前にこの 
関数は戻ってきます。                                                         
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_play_rom                                                            
ＰＣＭ音声モードシステムＲＯＭデータ再生開始                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>　                                                           
int 　　SND_pcm_play_rom(ch,note,vol,romno);                                 
int 　　ch; 　　　　　　 /* チャンネル番号(64〜71)   */                      
int 　　note; 　　　　　 /* 音程(1〜127)　　　　　　 */                      
int 　　vol;　　　　　　 /* 音量(1〜127)　　　　　　 */                      
int 　　romno;　　　　　 /* システムＲＯＭデータ番号 */                      
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int ret;                                                                     
                                                                             
ret = SND_pcm_play_rom(71,62,127,2);                                         
                                                                             
- 内容 -                                                                     
システムＲＯＭの音声データをＰＣＭ音声モードで再生を開始します。             
音声モードは割り込みによるバックグラウンド処理なので、再生が終了する前に、こ 
の関数は戻ってきます。romnoを設定することによって、以下の音声が再生されます。
                                                                             
┌────────────┬────────────┐                       
│システムＲＯＭデータ番号│　　音声メッセージ　　　│                       
├────────────┼────────────┤                       
│　　　　　 1　　　　　  │　　おはよう　　　　　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　 2　　　　　  │　　こんにちは　　　　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　 3　　　　　  │　　こんばんは　　　　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　 4　　　　　  │　　バイバイ　　　　　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　 5　　　　　  │　　さようなら　　　　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　 6　　　　　  │　　おやすみ　　　　　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　 7　　　　　  │　　選んでください　　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　 8　　　　　  │　　入力してください　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　 9　　　　　  │　　ごめんなさい　　　　│                       
│　　　　　　　　　　　　│　　　　　　　　　　　　│                       
│　　　　　10　　　　　  │　　確認してください　　│                       
└────────────┴────────────┘                       
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_play_stop                                                           
ＰＣＭ音声モード再生の強制停止                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_play_stop( ch );                                             
int 　　ch; 　　 /* チャンネル番号 */                                        
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_pcm_play_stop( 71 );                                               
                                                                             
- 内容 -                                                                     
ＰＣＭ音声モード再生を強制的に停止します。                                   
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_play2                                                               
ＰＣＭ音声モード再生開始2                                                    
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_play2( ch, note, vol, buff );                                
int 　　ch; 　　　　/* チャンネル番号(64〜71)  */                            
int 　　note; 　　　/* 音程(1〜127)　　　　　　*/                            
int 　　vol;　　　　/* 音量(1〜127)　　　　　　*/                            
char　　*buff;　　　/* 音声データのアドレス　　*/                            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　 *buff;                                                                
int 　 ret;                                                                  
                                                                             
ret = SND_pcm_play2( 71, 60, 127, buff );                                    
                                                                             
- 内容 -                                                                     
ＰＣＭ音声モードで再生を開始します。                                         
buffの指すポインタには音声モード形式のデータが格納されていなければなりません 
                                                                             
音声モードは割り込みによるバックグラウンド処理なので、再生が終了する前にこの 
関数は戻ってきます。SND_pcm_playとの違いは、ＰＣＭ音源の量子化ノイズの低減の 
ため、データ伸長と、データの一次直線補完を行っており、音声の品質が向上してい 
ます。                                                                       
しかし、データの伸長と補完をすべてソフトウェアで行っているため、バックグラウ 
ンド処理に要する時間がSND_pcm_playと比べて長くなります。                     
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_rec                                                                 
ＰＣＭ録音開始                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_rec( freq, buff, size, trig );                               
int 　　freq; 　　　/* サンプリング周波数(Hz)　　　　 */                     
char　　*buff;　　　/* サンプリングバッファのアドレス */                     
int 　　size; 　　　/* サンプリングデータ長　　　　　 */                     
int 　　trig; 　　　/* トリガレベル　　　　　　　　　 */                     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
char　　buff[0x1000+32];                                                     
                                                                             
ret = SND_pcm_rec( 19200, buff＋32, 0x1000, 0 );                             
                                                                             
- 内容 -                                                                     
ＰＣＭ録音を開始します。                                                     
ただし、録音中はタイマＢは停止されるので、マウスやエンベロープのコントロール 
はできません。また、演奏ドライバなどの割り込み処理もできる限りマスクする方が 
音質を上げることができます。音質を下げてでもマウス等のコンロールを行いたい場 
合は、SND_pcm_rec2を使用してください。                                       
サンプリング周波数は｢Hz｣で指定します。トリガレベルは0〜127まです。サンプリン 
グデータの絶対値がトリガレベルを超えた時点からサンプリングを開始し、同時に開 
始時点より前のデータをトリガレベルバイト数だけリングバッファより転送します。 
録音ソースは、マイク、ＣＤ、ＬＩＮＥ等から選択することができます。さらに、ミ 
ュートを解除し電子ボリュームを設定することにより、ミックスした音をサンプリン 
グすることができます。録音したデータを音声モード等で再生するためには、サンプ 
リングデータとは別に、32バイトのヘッダを加える必要があります。               
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_rec_stop                                                            
ＰＣＭ録音の強制停止                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_rec_stop( void );                                            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_pcm_rec_stop();                                                    
                                                                             
- 内容 -                                                                     
ＰＣＭ録音を強制的に停止します。                                             
ただし、ＰＣＭ録音の関数は、録音が終了するまで戻ってこないので割り込み処理な 
どから、この関数を呼んでください。                                           
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_rec2                                                                
ＰＣＭ録音開始2                                                              
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_rec2( freq, buff, size, trig );                              
int 　　freq; 　　　/* サンプリング周波数(Hz)　　　　 */                     
char　　*buff;　　　/* サンプリングバッファのアドレス */                     
int 　　size; 　　　/* サンプリングデータ長　　　　　 */                     
int 　　trig; 　　　/* トリガレベル　　　　　　　　　 */                     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
char　　buff[0x1000+32]                                                      
                                                                             
ret = SND_pcm_rec2( 19200, buff＋32, 0x1000, 0 );                            
                                                                             
- 内容 -                                                                     
基本動作はSND_pcm_rec(ＰＣＭ録音開始)と同じですが、タイマＢをマスクしません。
                                                                             
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_sound_delete                                                        
ＰＣＭサウンドデータの削除                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_sound_delete( id );                                          
int 　　id; 　　 /* 削除するサウンドのＩＤ */                                
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_pcm_sound_delete( -1 );                                            
                                                                             
- 内容 -                                                                     
指定されたＩＤのサウンドを、ＢＩＯＳの管理テーブルから削除し波形メモリを整理 
し、再配置を行います。                                                       
サウンドＩＤが、-1の時には、登録されている全サウンドを削除します。削除時にＰ 
ＣＭ音源の発音が停止します。                                                 
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_sound_get                                                           
ＰＣＭサウンドデータの読み取り                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_sound_get( ID, buff );                                       
int 　　ID; 　　 /* 　ＰＣＭサウンド登録ＩＤ　*/                             
int 　　*buff;　 /* 　パラメータのアドレス　　*/                             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
9:該当するＩＤは存在しない                                                   
                                                                             
- 例 -                                                                       
char　　buff[65536+32];                                                      
int 　　ID = 0x0d0a;                                                         
int 　　ret;                                                                 
                                                                             
ret = SND_pcm_sound_get( ID, buff );                                         
                                                                             
- 内容 -                                                                     
｢サウンドの登録SND_pcm_sound_set｣により登録されたサウンドデータを読み取ります
                                                                             
読み取るために必要なサウンドＩＤの番号と、読み取るためのバッファのサイズを得 
る時は｢全サウンドＩＤの取得SND_pcm_sound_ID_get｣を使用します。               
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_sound_ID_get                                                        
全サウンドＩＤの取得                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_sound_ID_get( buff );                                        
int 　　*buff;　　/*　パラメータのアドレス　*/                               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　buff[(1+1)*128];                                                     
int 　　ret;                                                                 
                                                                             
ret = SND_pcm_sound_ID_get( buff );                                          
                                                                             
- 内容 -                                                                     
現在登録されている全サウンドIDとデータ長を取得します。                       
最大登録数分のバッファ(8バイト×128個=1024バイト)を必要とします。            
サウンドが登録されていない場合はサウンドＩＤに0が返されます。                
                                                                             
サウンドＩＤ登録状態のデータ形式                                             
                                                                             
　　　　　┌─┬────────────┐                                   
 buff+　 0│Ｄ│サウンド1のＩＤ　　　　 │                                   
　　　　　├─┼────────────┤                                   
 buff+　 4│Ｄ│サウンド1のデータ長　　 │                                   
　　　　　├─┼────────────┤                                   
 buff+　 8│Ｄ│サウンド2のＩＤ　　　　 │                                   
　　　　　├─┼────────────┤                                   
 buff+　12│Ｄ│サウンド2のデータ長　　 │                                   
　　　　　├─┼────────────┤                                   
　　　　　〜　〜　　　　　　　　　　　　〜                                   
　　　　　├─┼────────────┤                                   
 buff+1016│Ｄ│サウンド128のＩＤ　　   │                                   
　　　　　├─┼────────────┤                                   
 buff+1020│Ｄ│サウンド128のデ─タ長   │                                   
　　　　　└─┴────────────┘                                   
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_sound_set                                                           
ＰＣＭサウンドデータの登録                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_sound_set( buff );                                           
char　　*buff;　　　/* サウンドデータのアドレス */                           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　*buff;                                                               
int 　　ret;                                                                 
                                                                             
ret = SND_pcm_sound_set( buff );　                                           
                                                                             
- 内容 -                                                                     
ＰＣＭサウンドデータを波形メモリに転送し、ＢＩＯＳの管理テーブルに登録します 
波形メモリの容量が足りない場合や、サウンドデータの形式が異常な場合は、エラー 
となります。                                                                 
波形メモリへのデータ転送の後で、ループマーカ用のデータを32バイト付加します。 
ＢＩＯＳでは、波形メモリを256バイト単位で管理しているため、(256バイト×Ｎ)-32
バイトのデータ長のサウンドデータが最もメモリ効率が良くなります。             
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_status                                                              
音声モード再生状態の入手                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_status( ch );                                                
int 　　ch; 　　 /* チャンネル番号 */                                        
                                                                             
- 戻り値 -                                                                   
0　　:停止中                                                                 
0以外:演奏中                                                                 
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_pcm_status( 71 );                                                  
                                                                             
- 内容 -                                                                     
ＰＣＭ音声モード再生状態を得ます。                                           
0以外なら演奏中を表します。                                                  
                                                                             
-----------------------------------------------------------------------------
.SND_pcm_wave_set                                                            
ＰＣＭウェーブデータの転送                                                   
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pcm_wave_set( buff, addr, size );                                
char　　*buff;　　　/* 転送データのアドレス　　　　　　　　*/                
int 　　addr; 　　　/* 波形メモリ転送先アドレス(0〜0xffff) */                
int 　　size; 　　　/* 転送データ長　　　　　　　　　　　　*/                
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
char　　*buff;                                                               
int 　　addr, size;                                                          
                                                                             
addr = 0x0000;                                                               
size = 0x1000;                                                               
                                                                             
ret = SND_pcm_wave_set( buff, addr, size );                                  
                                                                             
- 内容 -                                                                     
メインメモリ上のＰＣＭデータを波形メモリに転送します。                       
この関数は、ＢＩＯＳの管理外で動作するので、使用する際には、十分に注意してく 
ださい。                                                                     
ＰＣＭ音源のループマーク用データ0xffが波形メモリに転送されることを防止するた 
めに、0xff→0xfeにデータを変換する処理が入っています。よって、ＰＣＭデータ専 
用の関数となっています。                                                     
                                                                             
-----------------------------------------------------------------------------
.SND_pitch_change                                                            
ピッチベンド                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_pitch_change( ch, pitch );                                       
int 　　ch; 　　　　/* チャンネル番号 */                                     
int 　　pitch;　　　/* ピッチ　　　　 */                                     
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret,ch;                                                               
                                                                             
ch = 64;　　　　　　　　　　/*　PCM tone　　　　　　　　　　　　*/           
                                                                             
ret = SND_pitch_change( ch, 8191 );                                          
                                                                             
- 内容 -                                                                     
各音源にピッチベンドをかけます。                                             
ピッチは、0を基準として、-8192〜8191までの上下1オクターブずつ、計2オクターブ 
の範囲内での変更が可能です。ピッチが正の場合に音程が上がり、負の場合は音程が 
下がります。                                                                 
ピッチは、ピッチリセット(pitch=0)を行うまで有効で、ピッチ変更以降のキーＯＮと
音声出力では、それぞれで指定した音程＋ピッチ変更値でキーＯＮもしくは音声出力 
されるので注意してください。                                                 
また、PCM 音声モードでは、サウンドデータのサンプリング周波数が高い場合、ピッ 
チの設定値まで音程が上がらない場合があります。                               
この機能は、全モード(ＦＭ音源、楽器モード、音声モード)で使用できます。       
ch　　 =　0〜5　FM音源、64〜71　PCM音源                                      
pitch = -8192 〜 +8191                                                       
                                                                             
-----------------------------------------------------------------------------
.SND_status  (1)                                                             
ＰＣＭ音声モード再生アドレスの取得                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_status( ch, 0, buff );                                           
int 　　ch; 　　　　　　　/*　チャンネル番号(64〜71)　*/                     
char　　*buff;　　　　　　/*　取得バッファのアドレス　　　　*/               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char　　buff[6];                                                             
int 　　ret;                                                                 
                                                                             
ret = SND_status( 71, 0, buff );                                             
                                                                             
- 内容 -                                                                     
ＰＣＭ音声モードの再生アドレスを返します。                                   
                                                                             
取得バッファのデータ格納形式                                                 
                                                                             
┌──┬───────────┐                                             
│ＤＷ│音声モード再生アドレス│                                             
├──┼───────────┤                                             
│ Ｗ │音声モード再生セレクタ│                                             
└──┴───────────┘                                             
                                                                             
-----------------------------------------------------------------------------
.SND_status  (2)                                                             
現在の発音状態の取得                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_status( ch, 1, buff );                                           
int 　　ch; 　　　　　　　/*　チャンネル番号(0,64)  　*/                     
char　　*buff;　　　　　　/*　取得バッファのアドレス　*/               
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
1:チャンネル番号エラー
3:引数エラー
4:未定義ファンクションエラー
                                                                             
- 例 -                                                                       
char　　buff[4];                                                             
SND_status( 64, 1, buff );                                             
                                                                             
- 内容 -                                                                     
現在の音源の発音状態を取得します｡チャンネル番号は音源の種別のため(FM.PCMの区
別)に使用します｡PCM音源の場合には4バイト､FM音源の場合には2バイトの取得バッフ
ァを必要とします｡
以下のように情報を返します｡

PCM音源

  b31                                   b8  b7  b6  b5  b4  b3  b2  b1  b0
┌────────────────────┬─┬─┬─┬─┬─┬─┬─┬─┐ 
│95  　　　　　　　　　　　　　        72│71│70│69│68│67│66│65│64│ 
└────────────────────┴┬┴┬┴┬┴┬┴┬┴┬┴┬┴┬┘ 
                                          ┌┴─┴─┴─┴─┴─┴─┴─┘ 
                                          │                                 
                                          └─ 演奏/発音状態
                                               ビットON  → 演奏中/発音中
                                               ビットOFF → 無演奏/無発音

FM音源

  b15                                   　　　　b6  b5  b4  b3  b2  b1  b0
┌────────────────────────┬─┬─┬─┬─┬─┬─┐ 
│15  　　　　　　　　　　　　　        　　　　 6│ 5│ 4│ 3│ 2│ 1│ 0│ 
└────────────────────────┴┬┴┬┴┬┴┬┴┬┴┬┘ 
                                          ┌────┴─┴─┴─┴─┴─┘ 
                                          │                                 
                                          └─ 演奏状態
                                               ビットON  → 演奏中
                                               ビットOFF → 無演奏


-----------------------------------------------------------------------------
.SND_volume_change                                                           
ボリューム変更                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_volume_change( ch, vol );                                        
int 　　ch; 　　　/* チャンネル番号 */                                       
int 　　vol;　　　/* 音量　　　　　 */                                       
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret,ch;                                                               
                                                                             
ch = 64;　　　　　　　　　　/*　PCM tone　　　　　　　　　　　　*/           
                                                                             
ret = SND_volume_change( ch, 127 );                                          
                                                                             
- 内容 -                                                                     
各チャンネルの音量を変更します。                                             
この機能は、全モード(ＦＭ音源、楽器モード、音声モード)で使用できます。       
ch　 =　0〜5　FM音源、64〜71　PCM音源                                        
vol = 0〜127                                                                 
                                                                             
*****************************************************************************
第8章　ＥＵＰＨＯＮＹドライバライブラリ                                      
*****************************************************************************
                                                                             
 1.　ＥＵＰＨＯＮＹドライバについて                                          
                                                                             
  1.1　概要                                                                  
                                                                             
　このＥＵＰＨＯＮＹ演奏ドライバは、アプリケーションソフト｢ＥＵＰＨＯＮＹ｣と 
同じデータ形式｢ＥＵＰファイル｣を演奏するためのライブラリです。このＥＵＰＨＯ 
ＮＹの演奏データ形式はＭＩＤＩを基に設計されており、種々の演奏情報を取り扱う 
ことができます。分解能は4分音符あたり96クロックとＭＩＤＩの4倍の性能をもつた 
め、従来のＭＭＬに比べてより多彩な演奏が可能となります。また、ＭＩＤＩエミュ 
レータ機能を使用することによって、内蔵音源をあたかもＭＩＤＩ楽器の一部として 
コントロールすることが可能となります。                                       
　また、演奏トラックは32トラックあり、各トラックはほぼ無制限のポリフォリック 
となっているため、内蔵音源とＭＩＤＩ音源を併用した重厚なサウンドをクリエイト 
することができます。                                                         
　リニアバッファ、リングバッファのどちらでも使用できるので、用途にあわせてメ 
モリを節約することができます。                                               
                                                                             
  1.2　データ形式                                                            
                                                                             
　曲情報は基本的には1つのシーケンシャルなデータ列となります。実際のデータ形式
は6バイトを1つのパケットとして扱いますが、データの余った部分にはダミーコード 
である$FFが入ります。                                                        
　音符情報をONとOFFのペアで管理するため同時発音数は制限されます。各トラックす
べてをあわせた同時発音数が最大128音まで可能となります。このON,OFFをペアで扱う
場合のメリットは編集時の容易性と、シーケンスの停止時に発音中の音をOFFにする処
理を迅速に行うことができる点であり、同時発音数についても128音あればさほど問題
となりません。                                                               
                                                                             
 (1) ステップタイム                                                          
　データの時間情報は小節マーカとステップタイムによって管理されます。ステップ 
タイムは小節の先頭からのクロック数で表し、14ビットの範囲をとります。通常、$90
以上のステータスには2バイト目と3バイト目に、このステップタイムが存在しますが 
例外として$F7及び$FFの場合には、ステップタイムは無効となります。また、小節マ 
ーカには、その小節のクロック数がステップタイムとなります。                   
                                                                             
 (2) ＭＩＤＩチャンネルの扱い                                                
　シーケンス中のチャンネルメッセージのステータスバイトに続く1バイトをトラック
番号とし、実際のＭＩＤＩチャンネルは下図のような変換テーブルを通って決定され 
ます。データ中のステータスバイトのチャンネルはテーブルのMIDI CHがOMNIの時には
そのまま出力され、CHが指定されている場合はそのチャンネルに置き換えられて出力 
されます。ポートは、内蔵音源と8つのMIDI OUT、RS-232Cのなかから選択できます。 
　この変換テーブルは、プログラマブルでユーザが自由に設定できます。           
(RS-232Cに対して出力したい場合は"SND_rs_midi_init"を用いて初期化を行って置く 
必要があります。)                                                            
                                                                             
- 例 -                                                                       
┌───┬───┬───┐┌───┬───┬───┐┌───┬───┬──┐ 
│TRACK │MIDI C│ PORT ││ 11 　│　12　│　 G　││ 22 　│　11　│  A │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　1 　│ OMNI │　 A　││ 12 　│　 6　│　 F　││ 23 　│　11　│  E │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　2 　│ OMNI │　 B　││ 13 　│　 7　│　 A　││ 24 　│　 5　│  A │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　3 　│　 2　│　 C　││ 14 　│　 8　│　 C　││ 25 　│　 5　│  C │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　4 　│　 2　│ INT　││ 15 　│　 9　│　 C　││ 26 　│　 5　│  C │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　5 　│　 3　│ INT　││ 16 　│　 6　│　 E　││ 27 　│　16　│  C │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　6 　│　 4　│ INT　││ 17 　│　 7　│　 B　││ 28 　│　14　│  B │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　7 　│　 5　│ INT　││ 18 　│　 8　│　 B　││ 29 　│　14　│  B │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　8 　│　16　│　RS　││ 19 　│　 9　│　 B　││ 30 　│　16　│  A │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│　9 　│　15　│　RS　││ 20 　│　15　│　 B　││ 31 　│　12　│  A │ 
│　　　│　　　│　　　││　　　│　　　│　　　││　　　│　　　│  　│ 
│ 10 　│ OMNI │　 D　││ 21 　│　15　│　 G　││ 32 　│　 1　│  H │ 
└───┴───┴───┘└───┴───┴───┘└───┴───┴──┘ 
                                                                             
 (3) ノートオン･オフ($90)                                                    
　NOTE ON&OFFは常にペアで管理され、12バイトの長さを持ちます。NOTE ONの後には 
必ずこのOFFコマンドが来なければなりません。                                  
　第1バイト目から、NOTE ONコマンド、トラック番号、STEP TIMEの下位、上位、音程
ONベロシティの計6バイトでNOTE ONを表します。GATE TIMEは16ビット長とし、それぞ
れ4ビットづつ格納されます。したがって、最大の音長は四分音符で682個分、四分の 
四で約170小節分になります。                                                  
　NOTE OFF情報はVELOCITY値が0または省略されたものは、$90のVELOCITY=0で出力し 
ますが、0でないものは$80で出力されます。                                     
                                                                             
$90,$00,$00,$00,$38,$40                                                      
┌─┌─┌─┌─┌─┌─                                                     
│　│　│　│　│　│                                                       
│　│　│　│　│　│                                                       
│　│　│　│　│　│                                                       
│　│　│　│　│　└────────NOTE ONベロシティ                      
│　│　│　│　└──────────音程                                   
│　│　│　└────────────STEP TIME MSB                          
│　│　└──────────────STEP TIME LSB                          
│　└────────────────トラック番号                           
└──────────────────NOTE ONコマンド& ＭＩＤＩチャンネル    
                                                                             
$80,$00,$00,$06,$08,$40                                                      
┌─┌─┌─┌─┌─┌─                                                     
│　│　│　│　│　│                                                       
│　│　│　│　│　│                                                       
│　│　│　│　│　│                                                       
│　│　│　│　│　└────────NOTE OFFベロシティ                     
│　│　│　│　└──────────GATE TIME MSB                          
│　│　│　└────────────GATE TIME MSB                          
│　│　└──────────────GATE TIME LSB                          
│　└────────────────GATE TIME LSB                          
└──────────────────NOTE OFFコマンド& ＭＩＤＩチャンネル   
                                                                             
 (4) エクスクルーシブ･ステータス($F0)                                        
　エクスクルーシブは任意の長さですが、データは6バイト単位とし、エクスクルーシ
ブの終了を示すEOX($f7)までをデータと認識します。余った部分にはダミーコード   
($ff)を入れます。                                                            
                                                                             
- 例 -                                                                       
                                                                             
$f0,TRK,STEP　 ,$ff,$ff,                                                     
$xx,$xx,$xx,...........                                                      
...............,$xx,$xx,                                                     
$xx,$f7,$ff,$ff,$ff,$ff                                                      
                                                                             
 (5) 小節マーカー($F2)                                                       
　1小節ごとに小節マーカーを挿入しなければなりません。小節マーカーは、拍子記号
とそれにつづく小節全体の長さを表すステップタイムで構成されます。拍子記号はこ 
の小節マーカー以降の拍子を表し、ステップタイムはそのマーカーまでの前の小節の 
長さを表します。                                                             
                                                                             
- 例 -                                                                       
                                                                             
　 $f2,$33,$00,$30,$ff,$ff ........  $f2,$52,$00,$30,$ff,$ff.....            
　　　┌─┌───　　　　　　　　　　　┌─┌───                         
　　　│　│　　　　　　　　　　　　　　│　│                               
　　　│　└─ステップタイム=384　　　　│　└─ステップタイム=384           
　　　└───拍子記号　　　=4/4　　　　└───拍子記号　　　=3/8           
　│　　　　　　　　　　　　　　　　│                                       
─┼────────────────┼──────────────           
　│　　　　　4/4 　　　　　　　　　│　　　　 3/8                           
                                                                             
 (6) テンポ ($F8)                                                            
　テンポは$F8で始まるステータスで定義され、30〜280までとします。実際に書かれ 
る値はテンポから30を引いた値(0〜250)となります。したがってリタルダントなど、 
テンポを随時変化をさせたい場合は、データを作る側でそのように処理しなければな 
りません。テンポはトラック番号を持たない点と、データは14ビット(実際のテンポ値
は8ビット長)として扱われる点に注意して、プログラミングしなければなりません。 
                                                                             
 (7) USER CALL PROGRAM ($FA)                                                 
　本ドライバではサポートされません。このステータスは無視されます。           
                                                                             
 (8) パターン番号($FB)                                                       
　本ドライバではサポートされません。このステータスは無視されます。           
                                                                             
 (9) TRACK COMMAND($FC)                                                      
　演奏中にポートやMIDI CHを変更することができます。                          
　コマンド=1　ポートの変更。                                                 
　コマンド=2　MIDI CHの変更。                                                
                                                                             
 (10) DATA CONTINUE($FD)                                                     
　ファイルなどから読み込みながら演奏する場合に、演奏ポインタがストアポインタ 
を追い越した時に、間違ったデータを読み込まない様にするためのマーカーです。   
　演奏ドライバがこのマーカーを検出すると一時停止状態(PAUSE)になります。再びデ
ータをストアしたのち演奏再開をさせると途切れますが、正常に演奏を続けることが 
できます。                                                                   
                                                                             
 (11) $FFの扱い                                                              
　一時的に削除したい部分などを$FFに変えると、本ドライバではこれを無視します。
                                                                             
┌───┬────┬────┬────┬────┬────┬───────┐ 
│ｽﾃｰﾀｽ │2バイト │ 3バイト│ 4バイト│ 5バイト│ 6バイト│　 意　味　   │ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$8n │GATE　　│GATE　　│GATE　　│GATE　　│OFF 　　│ノートオフ  　│ 
│　　　│LSB 　　│LSB 　　│MSB 　　│MSB 　　│VELO　　│　　　　　　  │ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$9n │TRACK 　│TIME　　│TIME　　│音程　　│ON　　　│ノートオン  　│ 
│　　　│番号　　│LSB 　　│MSB 　　│　　　　│VELO- 　│　　　　　　  │ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$An │TRACK 　│TIME　　│TIME　　│音程　　│プレッ　│ポリフォニック│ 
│　　　│番号　　│LSB 　　│MSB 　　│　　　　│シャー　│アフタータッチ│ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$Bn │TRACK 　│TIME　　│TIME　　│CONTR-OL│設定値　│コントロール　│ 
│　　　│番号　　│LSB 　　│MSB 　　│値　　　│　　　　│チェンジ　　　│ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$Cn │TRACK 　│TIME　　│TIME　　│PROGR-AM│ダミー　│プログラム　　│ 
│　　　│番号　　│LSB 　　│MSB 　　│値　　　│　　　　│チェンジ　　　│ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$Dn │TRACK 　│TIME　　│TIME　　│PRESS-ER│ダミー　│チャンネル　　│ 
│　　　│番号　　│LSB 　　│MSB 　　│値　　　│　　　　│アフタータッチ│ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$En │TRACK 　│TIME　　│TIME　　│BEND値　│BEND値　│ピッチベンド　│ 
│　　　│番号　　│LSB 　　│MSB 　　│ LSB　　│ MSB　　│　　　　　　　│ 
├───┼────┼────┼────┼────┴────┼───────┤ 
│　$F0 │TRACK 　│TIME　　│TIME　　│　データ列　　　　│エクスクルーシ│ 
│　　　│番号　　│LSB 　　│MSB 　　│　不定バイト数　　│ブステータス　│ 
├───┼────┼────┼────┼────┬────┼───────┤ 
│　$F2 │拍子値　│TIME　　│TIME　　│ダミー　│ダミー　│小節マーカー　│ 
│　　　│　　　　│LSB 　　│MSB 　　│　　　　│　　　　│　　　　　　　│ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$F7 │ダミー　│ダミー　│ダミー　│ダミー　│ダミー　│END OF エクス │ 
│　　　│　　　　│　　　　│　　　　│　　　　│　　　　│クルーシブ    │ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$F8 │ダミー　│TIME　　│TIME　　│テンポ　│テンポ　│テンポ　　　　│ 
│　　　│　　　　│LSB 　　│MSB 　　│LSB 　　│MSB 　　│　　　　　　　│ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$FA │TRACK 　│TIME　　│TIME　　│PROGR-AM│ダミー　│USER CALL     │ 
│　　　│番号　　│LSB 　　│MSB 　　│値　　　│　　　　│PROGRAM     　│ 
│　　　│    　　│    　　│    　　│  　　　│　　　　│(NOT SUPPORT) │ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$FB │TRACK 　│TIME　　│TIME　　│パターン│ダミー　│パターン番号　│ 
│　　　│番号　　│LSB 0　 │MSB 0　 │番号　　│　　　　│(NOT SUPPORT) │ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$FC │TRACK 　│TIME　　│TIME　　│コマンド│データ　│TRACK COMMAND │ 
│　　　│番号　　│LSB 0　 │MSB 0　 │　　　　│　　　　│　　　　　　　│ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$FD │────│────│────│────│────│DATA CONTINUE │ 
├───┼────┼────┼────┼────┼────┼───────┤ 
│　$FE │拍子値　│TIME　　│TIME　　│ダミー　│ダミー　│終端マーカー　│ 
│　　　│　　　　│LSB 　　│MSB 　　│　　　　│　　　　│　　　　　　　│ 
├───┼────┴────┴────┴────┴────┼───────┤ 
│　$FF │　　　　　　　　　　　　　　　　　　　　　　　　│ダミーコード　│ 
└───┴────────────────────────┴───────┘ 
                                                                             
拍子値                                                                       
                                                                             
┌─────┬──────┬─────┬─────┬─────┬─────┐ 
│上位ビット│　 分　母 　│上位ビット│　 分　母 │上位ビット│　 分　母 │ 
├─────┼──────┼─────┼─────┼─────┼─────┤ 
│　　000 　│　全音符　　│　　011 　│ 4分音符　│　　110 　│(12分音符)│ 
├─────┼──────┼─────┼─────┼─────┼─────┤ 
│　　001 　│ 2分音符　　│　　100 　│(6分音符) │　　111 　│16分音符　│ 
├─────┼──────┼─────┼─────┼─────┴─────┘ 
│　　010 　│(3分音符) 　│　　101 　│ 8分音符　│                         
└─────┴──────┴─────┴─────┘                         
                                                                             
  1.3　ＥＵＰファイル形式                                                    
                                                                             
　演奏データファイルは2048バイトのヘッダ部とそれに続く演奏データ部、パターン 
データ部、USER CALLデータ部で構成されます。通常の演奏データならば、パターンデ
ータ部、USER CALLデータ部は必要としない場合が多いのですが、ファイルから取り去
ってしまうとそれをサポートしているアプリの読み込みエラーを誘発する可能性があ 
りますので、必ずダミーを入れてください。                                     
なお、説明にあるALL ??Hと書いてあるところは｢アプリが自分でデータを生成する場 
合の初期値として??Hが望ましい。｣という意味です。                             
                                                                             
  1.4　アセンブラからの使用方法                                              
                                                                             
　アセンブリ言語から使用する場合は、各レジスタに値を設定した後、             
　　　"SND_eup_driver"                                                       
をNEARコールしてください。詳しくは｢3.1　サンプルプログラム｣を参照してください
                                                                             
 1.ヘッダ部                                                                  
┌───┬───┬─────────┬───┬───────────┐       
│ｵﾌｾｯﾄ │16進数│　　内　　　容　　│サイズ│　　　説　　　明　　　│       
├───┼───┼─────────┼───┼───────────┤       
│　　 0│　　 0│MAIN TITLE　　　　│　　32│アスキーコード　　　　│       
│　　32│　　20│FILE NAME 　　　　│　　 8│ファイル名と同じ　　　│       
│　　40│　　28│LACATION POINTERS │　　 8│─┐　　　　　　　　　│       
│　　48│　　30│FOOT SW1〜4 　　　│　　 4│　│　　　　　　　　　│       
│　　52│　　34│SYNC IN MODE&PORT │　　 2│　│ALL 00H 　　　　　│       
│　　54│　　36│SYNC OUT MODE&PORT│　　 2│─┘　　　　　　　　　│       
│　　56│　　38│REC PORT　　　　　│　　 4│──ALL FFH 　　　　　│       
│　　60│　　3C│REC CH & TRACK　　│　　 2│─┐　　　　　　　　　│       
│　　62│　　3E│REC FILTER　　　　│　　 6│　│　　　　　　　　　│       
│　　68│　　44│PLAY & REC MODE 　│　　 2│　│　　　　　　　　　│       
│　　70│　　46│AUTO CORRECT　　　│　　 1│　│　　　　　　　　　│       
│　　71│　　47│KEY TRIGGER 　　　│　　 1│　│　　　　　　　　　│       
│　　72│　　48│ASSIGN OUT　　　　│　　 1│　│　　　　　　　　　│       
│　　73│　　49│COUNT DOWN　　　　│　　 1│　│ALL 00H 　　　　　│       
│　　74│　　4A│METRONOME 　　　　│　　 1│　│　　　　　　　　　│       
│　　75│　　4B│NOTE METRONOME　　│　　 1│　│　　　　　　　　　│       
│　　76│　　4C│METRO PORT & CH 　│　　 2│　│　　　　　　　　　│       
│　　78│　　4E│HI　NOTE & VELO 　│　　 2│　│　　　　　　　　　│       
│　　80│　　50│LOW NOTE & VELO 　│　　 2│　│　　　　　　　　　│       
│　　82│　　52│METRO GATE　　　　│　　 2│─┘　　　　　　　　　│       
│　　84│　　54│TRK TITLE 　　　　│16*32 │各トラックのメモ　　　│       
│　　　│　　　│　　　　　　　　　│　 512│　　　　　　　　　　　│       
│　 596│　 254│TRK DATE & TIME 　│ 8*32 │作成日付　　　　　　　│       
│　　　│　　　│　　　　　　　　　│　 256│（INT96H参照）　　　　│       
│　 852│　 354│TRK MUTE　　　　　│ 1*32 │ALL FFH 　　　　　　　│       
│　　　│　　　│　　　　　　　　　│　　32│　　　　　　　　　　　│       
│　 884│　 374│TRK PORT　　　　　│ 1*32 │00H 〜 07H or FFH 　　│       
│　　　│　　　│　　　　　　　　　│　　32│(FFH　内蔵音源) 　　　│       
│　 916│　 394│TRK MIDI CH 　　　│ 1*32 │00H 〜 07H or FFH 　　│       
│　　　│　　　│　　　　　　　　　│　　32│(FFH　OMNI) 　　　　　│       
│　 948│　 3B4│TRK KEY BIAS　　　│ 1*32 │ALL 00H 　　　　　　　│       
│　　　│　　　│　　　　　　　　　│　　32│　　　　　　　　　　　│       
│　 980│　 3D4│TRK TRANSPOSE 　　│ 1*32 │ALL 00H 　　　　　　　│       
│　　　│　　　│　　　　　　　　　│　　32│　　　　　　　　　　　│       
│　1012│　 3F4│TRK PLAY FILTER 　│ 32*7 │ALL FFH 　　　　　　　│       
│　　　│　　　│　　　　　　　　　│　 224│　　　　　　　　　　　│       
│　1236│　 4D4│INSTRUMENTS NAME　│ 4*128│　　　　　　　　　　　│       
│　　　│　　　│　　　　　　　　　│　 512│　　　　　　　　　　　│       
│　1748│　 6D4│FM MIDI CH　　　　│　　 6│　　　　　　　　　　　│       
│　1754│　 6DA│PCM MIDI CH 　　　│　　 8│　　　　　　　　　　　│       
│　1762│　 6E2│FM FILE NAME　　　│　　 8│　　　　　　　　　　　│       
│　1770│　 6EA│PCM FILE NAME 　　│　　 8│　　　　　　　　　　　│       
│　1778│　 6F2│RESERVE 　　　　　│　 260│ALL 00H 　　　　　　　│       
│　　　│　　　│　　　　　　　　　│　　　│　　　　　　　　　　　│       
│　　　│　　　│　　　　　　　　　│　　　│　　　　　　　　　　　│       
│　2038│　　　│APLICATION NAME 　│　　 8│作成アプリ名　　　　　│       
│　2046│　 7FE│VERSION 　　　　　│　　 2│作成アプリバージョン　│       
├───┴───┴─────────┴───┴───────────┤       
│　　　　　　　　　　　　　　　　　　　　　　　　　 TOTAL 2048 BYTE│       
└─────────────────────────────────┘       
                                                                             
 2.演奏デ-タ部                                                               
                                                                             
　　4 BYTE　　　　　　　　1 BYTE　　　　　1 BYTE　　　不定 BYTE              
┌───────────┬───────┬─────┬─────────┐   
│演奏データバイト数　　│TOP SIGNATURE │TOP TEMPO │演奏データ　　　　│   
└───────────┴───────┴─────┴─────────┘   
                                                                             
─┬─ここより後ろは読み込まなくても構いませんが、作成する場合はダミーを入れ 
　↓　ます。                                                                 
                                                                             
 3.パターンデータ部                                                          
                                                                             
　 4 BYTE 　　　　　　　　　不定 BYTE                                        
┌───────────┬─────────────┐                       
│パターンデータバイト数│パターンデータ 1〜128 　　│                       
└───────────┴─────────────┘                       
                                                                             
　パターンデータは演奏データと同じく6バイト単位のデータで構成され、最後がFEH 
で終わりとなります。そのような小さな演奏データが128個連なる形になっています。
                                                                             
　したがって、パターンが無い場合でも6×128のサイズを必要とします。           
                                                                             
 4.ユーザコールプログラム部                                                  
                                                                             
　 4 BYTE 　　　　　　　　　不定 BYTE                                        
┌───────────┬─────────────┐                       
│USER CALL バイト数　　│USER CALL データ 1〜128 　│                       
└───────────┴─────────────┘                       
                                                                             
　 USER CALLデータもパターンデータと同様に6バイト単位の固まりで構成されますが
EXCLUSIVEデータのみ扱います。各USER CALLデータはF0Hで始まりF7Hを含むブロック 
と、その次のFEHで始まる終端コードとで構成されます。                          
　したがって、全くデータが無い場合でも6×128のサイズを必要とします。         
                                                                             
 2.　ＥＵＰＨＯＮＹドライバライブラリ                                        
                                                                             
  2.1　関数一覧                                                              
                                                                             
┌─────────────────┬─────────────────┐   
│　　　　　　関　数　名　　　　　　│　　　　　機　　　　　能　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_init　　　　　　　　　　　│ＥＵＰＨＯＮＹドライバの初期化　　│   
├─────────────────┼─────────────────┤   
│SND_eup_end 　　　　　　　　　　　│ＥＵＰＨＯＮＹドライバの終了　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_play_start 　　　　　　　 │演奏開始　　　　　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_play_stop　　　　　　　　 │演奏停止　　　　　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_play_pause 　　　　　　　 │演奏一時停止　　　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_play_restart 　　　　　　 │演奏再開　　　　　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_stat_ptr 　　　　　　　　 │演奏アドレスの入手　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_stat_meas　　　　　　　　 │演奏位置の小節番号の入手　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_stat_clock 　　　　　　　 │演奏位置のクロックの入手　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_stat_flag　　　　　　　　 │演奏状態の入手　　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_stat_tempo 　　　　　　　 │現在のテンポの入手　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_sync_out_set 　　　　　　 │MIDI SYNC信号の出力ポート設定　 　│   
├─────────────────┼─────────────────┤   
│SND_eup_int_set 　　　　　　　　　│割り込み処理の許可/禁止　　　　　│    
├─────────────────┼─────────────────┤   
│SND_eup_loop_set 　　　　　　　　 │ループフラグの設定　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_tempo_set 　　　　　　　　│テンポの設定　　　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_port_set 　　　　　　　　 │出力ポートの設定　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_midi_ch_set 　　　　　　　│出力ＭＩＤＩチャンネルの設定　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_mute_set 　　　　　　　　 │ミュートの設定　　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_transpose_set 　　　　　　│トランスポーズの設定　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_bias_set 　　　　　　　　 │キーバイアスの設定　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_midi_ch_assign　　　　　　　　│各音源のＭＩＤＩチャンネル設定　　│   
├─────────────────┼─────────────────┤   
│SND_midi_write 　　　　　　　　　 │各ポートへのＭＩＤＩデータ列の出力│   
├─────────────────┼─────────────────┤   
│SND_midi_read　　　　　　　　　　 │各ポートからＭＩＤＩデータの入力　│   
├─────────────────┼─────────────────┤   
│SND_rs_midi_init　　　　　　　　　│RS_MIDIドライバの初期化　　　　　 │   
├─────────────────┼─────────────────┤   
│SND_rs_midi_end 　　　　　　　　　│RS_MIDIドライバの終了　　　　　　 │   
├─────────────────┼─────────────────┤   
│SND_eup_fixed_init　　　　　　　　│固定タイマモードのドライバの初期化│   
├─────────────────┼─────────────────┤   
│SND_eup_fixed_end 　　　　　　　　│固定タイマモードのドライバの終了　│   
├─────────────────┼─────────────────┤   
│SND_eup_fixed_int 　　　　　　　　│固定タイマモードの割り込みエントリ│   
├─────────────────┼─────────────────┤   
│SND_eup_fixed_sub 　　　　　　　　│固定タイマモードの割り出しエントリ│   
├─────────────────┼─────────────────┤   
│SND_eup_play_int_set 　　　　　　 │演奏処理と同期して行う処理の登録　│   
├─────────────────┼─────────────────┤   
│SND_eup_play_int_get 　　　　　　 │演奏処理と同期して行う処理の取得　│   
├─────────────────┼─────────────────┤   
│SND_eup_relative_tempo_set　 　　 │相対テンポの設定　　　　　　　　　│   
├─────────────────┼─────────────────┤   
│SND_eup_relative_tempo_get 　　　 │相対テンポの読み取り　　　　　　　│   
└─────────────────┴─────────────────┘   
                                                                             
  2.2　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.SND_eup_bias_set                                                            
キーバイアスの設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_bias_set( track, bias );                                     
int 　　track;　　　/* トラック番号(0〜31) 　*/                              
int 　　bias; 　　　/* キーバイアス(-40〜40) */                              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int ret;                                                                     
                                                                             
ret = SND_eup_bias_set( 0, 20 ); 　 /*  set track 0 = +20　　　　 */         
                                                                             
- 内容 -                                                                     
各トラックのベロシティに対するオフセットを設定します。                       
trackの範囲は0〜31                                                           
biasの範囲は-40〜+40                                                         
                                                                             
-----------------------------------------------------------------------------
.SND_eup_end                                                                 
ＥＵＰＨＯＮＹドライバの終了                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_end( void );                                                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_end();                                                         
                                                                             
- 内容 -                                                                     
割り込み等の登録を解除します。                                               
SND_eup_initを使った後にプログラムを終了する場合は必ず呼び出してください。   
RS-232Cに対してMIDI出力していた場合は、この直前にSND_rs_midi_endを呼び出して 
ください。                                                                   
ユーザの管理する固定タイマでドライバを動作させていた場合には、               
SND_eup_fixed_endで終了してください。                                        
                                                                             
-----------------------------------------------------------------------------
.SND_eup_fixed_end                                                           
固定タイマモードのドライバの終了                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_fixed_end( void );                                           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
ret = SND_eup_fixed_end();                                                   
                                                                             
- 内容 -                                                                     
固定タイマモードでの処理を終了します。                                       
SND_eup_endの代わりにこちらで終了処理をしてください。                        
                                                                             
-----------------------------------------------------------------------------
.SND_eup_fixed_init                                                          
固定タイマモードのドライバの初期化                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_fixed_init( func0 , func1 );                                 
void (*func0)();　　　/* 割り込み処理エントリのアドレス */                   
void (*func1)();　　　/* 割り出し処理エントリのアドレス */                   
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
void (*int_ent)();                                                           
void (*sub_ent)();                                                           
ret = SND_eup_fixed_init(&int_ent,&sub_ent);                                 
                                                                             
- 内容 -                                                                     
固定タイマモードでの初期化を行います。                                       
このエントリはＶＳＹＮＣ割り込み等の一定間隔のタイマ割り込みでドライバを動作 
させる際に使用します。                                                       
SND_eup_initの代わりにこちらで初期化してください。                           
関数へのダブルポインタ内にはアセンブラ用割り込み処理エントリ及び割り出し処理 
エントリが返されます。                                                       
この各ルーチンはレジスタを退避しないため、直接High Cから呼ぶことができません 
                                                                             
High Cから扱う場合には、SND_eup_fixed_int(int time)やSND_eup_fixed_sub()を使 
用してください。                                                             
                                                                             
-----------------------------------------------------------------------------
.SND_eup_fixed_int                                                           
固定タイマモードの割り込みエントリ                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_fixed_int( time );                                           
int 　　time; 　　 /* 経過時間 (μsec単位) */                                
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int 　 time = 1000000/60;                                                    
SND_eup_fixed_int(time);                                                     
                                                                             
- 内容 -                                                                     
固定タイマモードの処理ルーチンのエントリです。                               
アプリケーションが管理する割り込み処理ルーチンがこの関数を呼ぶ事により演奏ド 
ライバが動作します。timeの値は、この関数を呼ぶ時間と1つ前に呼んだ時の時間との
差(経過時間)を代入します。                                                   
timeの時間の値はμsec単位となっています。                                    
                                                                             
-----------------------------------------------------------------------------
.SND_eup_fixed_sub                                                           
固定タイマモードの割り出しエントリ                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_fixed_sub( void );                                           
                                                                             
- 戻り値 -                                                                   
なし                                                                         
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
ret = SND_eup_fixed_sub();                                                   
                                                                             
- 内容 -                                                                     
固定タイマモードの処理ルーチンのエントリです。                               
アプリケーションが管理する割り出し処理ルーチンがこの関数を呼ぶ事により演奏ド 
ライバが動作します。                                                         
                                                                             
-----------------------------------------------------------------------------
.SND_eup_init                                                                
ＥＵＰＨＯＮＹドライバの初期化                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_init( void );                                                
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_init();                                                        
                                                                             
- 内容 -                                                                     
割り込みなどの登録を行い、ワークエリアの初期化を行います。                   
この関数を呼ぶ前に、サウンドライブラリのSND_initを用いてＢＩＯＳを初期化して 
おかなければなりません。RS-232Cに対してＭＩＤＩを出力したい場合はこの直後に  
SND_rs_midi_initを呼び出してください。                                       
ユーザの管理する固定タイマでドライバを動作させる場合には、SND_eup_initを用い 
ず、SND_eup_fixed_initで初期化してください。                                 
                                                                             
-----------------------------------------------------------------------------
.SND_eup_int_set                                                             
割り込み処理の許可/禁止                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_int_set( sw );                                               
int 　　sw; 　　　　 /* 　0:許可、0以外:禁止　　*/                           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_int_set( 1 );                                                  
                                                                             
- 内容 -                                                                     
演奏ドライバの割り込み処理を許可または禁止します。                           
sw=0:許可、sw=0以外:禁止。                                                   
バッファにデータを書き込む時などに、割り込み処理を行わないようにしたい場合に 
用います。この関数を使っても実際の割り込みはマスクされません。               
                                                                             
-----------------------------------------------------------------------------
.SND_eup_loop_set                                                            
ループフラグの設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_loop_set( sw );                                              
int 　　sw; 　　　　　 /* 　0:ループしない、0以外:ループする　*/             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_loop_set( 1 );                                                 
                                                                             
- 内容 -                                                                     
ループフラグの設定を行います。                                               
sw=0:ループしない、sw=0以外:ループする。                                     
ループフラグを設定した場合、0xfe(END OF SONG)を検出するとバッファの先頭にアド
レスを移して演奏を続けます。                                                 
                                                                             
-----------------------------------------------------------------------------
.SND_eup_midi_ch_set                                                         
出力ＭＩＤＩチャンネルの設定                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_midi_ch_set( track, ch );                                    
int 　　track;　　　/* トラック番号(0〜31) 　　　　　　 */                   
int 　　ch; 　　　　/* チャンネル番号(0〜15，または255) */                   
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret =  SND_eup_midi_ch_set( 0, 0 );　　/*　set track 0 = 1ch 　*/            
                                                                             
- 内容 -                                                                     
各トラックの出力ＭＩＤＩチャンネルを設定します。                             
trackの範囲は0〜31。                                                         
chは0〜15、または255。                                                       
255の時はomni(演奏データの持つそのままのMIDI CHで出力)が選択されます。       
                                                                             
-----------------------------------------------------------------------------
.SND_eup_mute_set                                                            
ミュートの設定                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_mute_set( track, sw );                                       
int 　　track;　　　/* トラック番号(0〜31) 　　　　　　　　 */               
int 　　sw; 　　　　/* スイッチ(0:ミュート，0以外:演奏) 　*/                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_mute_set( 0, 0 );　　/*　set track 0 = mute　　*/              
                                                                             
- 内容 -                                                                     
各トラックのミュートを設定します。                                           
trackの範囲は0〜31。                                                         
sw=0ならそのトラックは演奏しません。0以外の時、演奏します。                  
                                                                             
-----------------------------------------------------------------------------
.SND_eup_play_int_get                                                        
演奏処理と同期して行う処理の取得                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_play_int_get( func );                                        
void　　( *func )();                                                         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
void　　( *func )();                                                         
int 　　ret;                                                                 
                                                                             
ret = SND_eup_play_int_get( &func );                                         
                                                                             
- 内容 -                                                                     
設定されている演奏処理との同期処理のアドレスを取得します。                   
                                                                             
-----------------------------------------------------------------------------
.SND_eup_play_int_set                                                        
演奏処理と同期して行う処理の登録                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_play_int_set( func );                                        
void　　func();                                                              
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
extern void intFunc();                                                       
                                                                             
ret = SND_eup_play_int_set( intFunc );                                       
                                                                             
void　　intFunc()                                                            
{                                                                            
　〜〜                                                                       
}                                                                            
                                                                             
- 内容 -                                                                     
演奏処理と同期して行う処理を登録します。                                     
                                                                             
-----------------------------------------------------------------------------
.SND_eup_play_pause                                                          
演奏一時停止                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_play_pause( void );                                          
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_play_pause();                                                  
                                                                             
- 内容 -                                                                     
演奏を一時停止します。                                                       
                                                                             
-----------------------------------------------------------------------------
.SND_eup_play_restart                                                        
演奏再開                                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_play_restart( void );                                        
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_play_restart();                                                
                                                                             
- 内容 -                                                                     
SND_eup_play_pause(演奏一時停止)で停止していた演奏を再開します。             
                                                                             
-----------------------------------------------------------------------------
.SND_eup_play_start                                                          
演奏開始                                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_play_start( *buff, size, sign );                             
char　　*buff;　　　　　　　　　　 /* 　演奏バッファのアドレス　*/           
int 　　size; 　　　　　　　　　　 /* 　演奏バッファサイズ　　　*/           
int 　　sign; 　　　　　　　　　　 /* 　曲の先頭の拍子　　　　　*/           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
char　　buff[8192];                                                          
                                                                             
ret = SND_eup_play_start( buff, 8192, 0x33 );                                
                                                                             
- 内容 -                                                                     
演奏の開始を行います。                                                       
引数buffは、演奏データ部(1.3  EUPファイル形式を参照)の演奏データのアドレスを 
指します。                                                                   
                                                                             
-----------------------------------------------------------------------------
.SND_eup_play_stop                                                           
演奏停止                                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_play_stop( void );                                           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_play_stop();                                                   
                                                                             
- 内容 -                                                                     
演奏を停止します。                                                           
                                                                             
-----------------------------------------------------------------------------
.SND_eup_port_set                                                            
出力ポートの設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_port_set( track, port );                                     
int 　　track;　　　/* トラック番号(0〜31) */                                
int 　　port; 　　　/* ポート番号　　　　　*/                                
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_port_set( 0, 0 );　　/*　set track 0 = MIDI A　*/              
                                                                             
- 内容 -                                                                     
各トラックの出力ポートを設定します。                                         
trackの範囲は0〜31。                                                         
portが0〜7の時はＭＩＤＩカードのポート(a〜h)が選択されます。                 
portが16〜31の時はRS_MIDIが選択されます。                                    
portが240〜255以上の時は内蔵音源(ＭＩＤＩエミュレータ)が選択されます。       
                                                                             
-----------------------------------------------------------------------------
.SND_eup_relative_tempo_get                                                  
相対テンポの読み取り                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_relative_tempo_get( tempo );                                 
int 　　*tempo; 　 /* 　　相対テンポ　 */                                    
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　tempo;                                                               
int 　　ret;                                                                 
                                                                             
ret = SND_eup_relative_tempo_get( &tempo );                                  
                                                                             
- 内容 -                                                                     
現在設定されている相対テンポを読み取ります。                                 
                                                                             
-----------------------------------------------------------------------------
.SND_eup_relative_tempo_set                                                  
相対テンポの設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_relative_tempo_set( tempo );                                 
int 　　tempo;　 /* 　相対テンポ　*/                                         
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　tempo = 20;                                                          
int 　　ret;                                                                 
                                                                             
ret = SND_eup_relative_tempo_set( tempo );                                   
                                                                             
- 内容 -                                                                     
相対テンポの設定を行います。                                                 
相対テンポは -250 〜 +250 の範囲で設定できます。                             
                                                                             
-----------------------------------------------------------------------------
.SND_eup_stat_clock                                                          
演奏位置のクロックの入手                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_stat_clock( void );                                          
                                                                             
- 戻り値 -                                                                   
演奏位置のクロックを返します。                                               
                                                                             
- 例 -                                                                       
int 　 clock;                                                                
                                                                             
clock = SND_eup_stat_clock();                                                
                                                                             
- 内容 -                                                                     
現在、演奏しているクロックを返します。                                       
                                                                             
-----------------------------------------------------------------------------
.SND_eup_stat_flag                                                           
演奏状態の入手                                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_stat_flag( void );                                           
                                                                             
- 戻り値 -                                                                   
0　　:演奏していない                                                         
0以外:演奏中                                                                 
                                                                             
- 例 -                                                                       
int 　 flag;                                                                 
                                                                             
flag = SND_eup_stat_flag();                                                  
                                                                             
- 内容 -                                                                     
現在の演奏状態を返します。                                                   
                                                                             
-----------------------------------------------------------------------------
.SND_eup_stat_meas                                                           
演奏位置の小節番号の入手                                                     
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_stat_meas( void );                                           
                                                                             
- 戻り値 -                                                                   
演奏位置の小節番号を返します。                                               
                                                                             
- 例 -                                                                       
int 　 measure;                                                              
                                                                             
measure = SND_eup_stat_meas();                                               
                                                                             
- 内容 -                                                                     
現在、演奏している小節番号を返します。                                       
                                                                             
-----------------------------------------------------------------------------
.SND_eup_stat_ptr                                                            
演奏アドレスの入手                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
char　　 *SND_eup_stat_ptr( void );                                          
                                                                             
- 戻り値 -                                                                   
演奏位置のアドレスを返します。                                               
                                                                             
- 例 -                                                                       
char　　*addr;                                                               
                                                                             
addr = SND_eup_stat_ptr();                                                   
                                                                             
- 内容 -                                                                     
現在、演奏しているアドレスを返します。                                       
                                                                             
-----------------------------------------------------------------------------
.SND_eup_stat_tempo                                                          
現在のテンポの入手                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_stat_tempo( void );                                          
                                                                             
- 戻り値 -                                                                   
テンポを返します。                                                           
                                                                             
- 例 -                                                                       
int 　 tempo;                                                                
                                                                             
tempo = SND_eup_stat_tempo();                                                
                                                                             
- 内容 -                                                                     
現在、演奏しているテンポを返します。                                         
                                                                             
-----------------------------------------------------------------------------
.SND_eup_sync_out_set                                                        
ＭＩＤＩ　ＳＹＮＣ信号の出力ポート設定                                       
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_sync_out_set( int port );                                    
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_sync-out_set( 0 ); 　　/*　set SYNC port = A 　　*/            
                                                                             
- 内容 -                                                                     
MIDIの同期信号を出力するポートを設定します。                                 
出力ポート番号が0〜7の時はMIDIカードのポート(a〜h)が選択されます。           
出力ポート番号が16〜31の時はRS-MIDIが選択されます。                          
出力ポート番号が240〜255の時は同期信号は出力されません。                     
                                                                             
-----------------------------------------------------------------------------
.SND_eup_tempo_set                                                           
テンポの設定                                                                 
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_tempo_set( tempo );                                          
int 　　tempo;　　　　　　　　　　　　/*　テンポ(0〜250)　　　　　　*/       
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_tempo_set( 90 );　　　　/*　set tempo=120 　　　　　　　*/     
                                                                             
- 内容 -                                                                     
テンポの設定を行います。                                                     
テンポの範囲は0〜250で、実際のテンポから30を引いた値を設定します。           
ただし、演奏データ中にテンポの変更コマンドを検出した場合は、そのテンポに変更 
されます。                                                                   
                                                                             
-----------------------------------------------------------------------------
.SND_eup_transpose_set                                                       
トランスポーズの設定                                                         
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_eup_transpose_set( track, degree );                              
int 　　track;　　　 /* トラック番号(0〜31) 　　*/                           
int 　　degree; 　　 /* トランスポーズ(-12〜12) */                           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_eup_transpose_set( 0, 12 ); 　 /* set track 0 = 1oct. 　 */        
                                                                             
- 内容 -                                                                     
各トラックの移調を設定します。                                               
trackの範囲は0〜31                                                           
degreeの範囲は-12〜+12                                                       
                                                                             
-----------------------------------------------------------------------------
.SND_midi_ch_assign                                                          
各音源のＭＩＤＩチャンネル設定                                               
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_midi_ch_assign( ch, midi_ch );                                   
int 　　ch; 　　　　　　/* チャンネル番号　　　　　　　　*/                  
int 　　midi_ch; 　　　 /*  ＭＩＤＩチャンネル番号(0〜15) */                 
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_midi_ch_assign( 0 , 0 );　　/*　set FM 0 = MIDI CH1 　　*/         
                                                                             
- 内容 -                                                                     
各音源がどのＭＩＤＩチャンネルで発音するかを設定します。                     
chは0〜5がＦＭ音源、64〜71がＰＣＭ音源。                                     
midi_chの範囲は0〜15。                                                       
                                                                             
-----------------------------------------------------------------------------
.SND_midi_read                                                               
各ポートからＭＩＤＩデータの入力                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_midi_read( port, data );                                         
int 　　port; 　　　/* ポート番号　　 */                                     
char　　*data;　　　/* ＭＩＤＩデータ */                                     
                                                                             
- 戻り値 -                                                                   
0　　　 :正常終了                                                            
1　　　 :データが到着していない                                              
250 　　:使えないデバイス                                                    
それ以外:ハードウェアのエラー(over run等)                                    
                                                                             
- 例 -                                                                       
int 　　i,ret;                                                               
char　　data;                                                                
char　　*buffer;                                                             
                                                                             
do{                                                                          
　 if((ret = SND_midi_read( 0, &data )) == 0)                                
　　　　　　buffer[i++] = data;                                              
}while(ret == 0);                                                            
                                                                             
- 内容 -                                                                     
指定された入力ポートからデータを読み込みます。                               
portが0〜3の時はＭＩＤＩカードのポート(a〜d)が選択されます。                 
                                                                             
-----------------------------------------------------------------------------
.SND_midi_write                                                              
各ポートへのＭＩＤＩデータ列の出力                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_midi_write( port, buff, size );                                  
int 　　port; 　　　/* ポート番号　　　　　　　 */                           
char　　*buff;　　　/* データバッファのアドレス */                           
int 　　size; 　　　/* データ長　　　　　　　　 */                           
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
char buff[] = {0xf0,0x4b,0x01,0x01,0x00,0xf7 };                              
                                                                             
ret = SND_midi_write( 0, buff, 6 );                                          
                                                                             
- 内容 -                                                                     
指定された出力ポートにsizeバイトのデータをbuffから転送します。               
portが0〜7の時はＭＩＤＩカードのポート(a〜h)が選択されます。                 
portが16〜31の時はRS_MIDIが選択されます。                                    
portが240以上の時は内蔵音源(ＭＩＤＩエミュレータ)が選択されます。            
                                                                             
-----------------------------------------------------------------------------
.SND_rs_midi_end                                                             
RS-MIDIドライバの終了                                                        
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_rs_midi_end( void );                                             
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　 ret;                                                                  
                                                                             
ret = SND_rs_midi_end();                                                     
                                                                             
- 内容 -                                                                     
RS-232Cに対してＭＩＤＩデータを出力した場合に、この関数を使って終了します。  
SND_eup_end()の直前に行います。                                              
                                                                             
-----------------------------------------------------------------------------
.SND_rs_midi_init                                                            
RS-MIDIドライバの初期化                                                      
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <SND.H>                                                             
int 　　SND_rs_midi_init( void );                                            
                                                                             
- 戻り値 -                                                                   
0:正常終了                                                                   
                                                                             
- 例 -                                                                       
int 　　ret;                                                                 
                                                                             
ret = SND_rs_midi_init();                                                    
                                                                             
- 内容 -                                                                     
ＥＵＰＨＯＮＹドライバ上で RS-232Cに対してＭＩＤＩデータを出力する場合に、最 
初にこの関数を使って初期化を行います。初期化はSND_eup_init()の直後に行います 
                                                                             
この関数を実行すると、以後ポート番号16〜31が RS-MIDIに割り当てられます。     
                                                                             
 3.　アセンブラ言語のための関数                                              
                                                                             
  3.1　サンプルプログラム                                                    
                                                                             
┌────────────────────────────────────┐ 
│　EUPHONY ドライバ サンプルプログラム　　　　　　　　　　　　　　　　　 │ 
│　RS232C MIDI LIBRALY 　　　　　　　　　　　　　　　　　　　　　　　　　│ 
│　　　Copyright(C) 1991 FUJITSU LIMITED 　　　　　　　　　　　　　　　　│ 
└────────────────────────────────────┘ 
                                                                             
WAIT_REG　　　　equ 　　006CH                                                
RS_TIME_OVER　　equ 　　16000                                                
　　　　　　　　extrn 　SND_eup_driver:near                                  
　　　　　　　　public　SND_rs_midi_init                                     
　　　　　　　　public　rs_midi_init                                         
　　　　　　　　public　SND_rs_midi_end                                      
　　　　　　　　public　rs_midi_exit                                         
joedata 　　　　segment dword public use32 'DATA'                            
joedata 　　　　ends                                                         
joecode 　　　　segment dword public use32 'CODE'                            
joecode 　　　　ends                                                         
DGROUP　　　　　group 　joedata                                              
CGROUP　　　　　group 　joecode                                              
;---------------------------------------------------------------------       
joedata segment                                                              
rs_midi_ent_sav dd　　　?                                                    
modem_sav 　　　db　　　?                                                    
run_stat　　　　db　　　?                                                    
joedata 　　　　ends                                                         
　　　　　　　　page                                                         
;---------------------------------------------------------------------       
joecode 　　　　segment                                                      
　　　　　　　　assume　cs:CGROUP,ds:DGROUP                                  
;---------------------------------------------------------------------       
; 　　　initialize routine                                                   
;---------------------------------------------------------------------       
SND_rs_midi_init　　proc　　near                                             
rs_midi_init:                                                                
　　　　　　　　pushfd                                                       
　　　　　　　　cli                                                          
　　　　　　　　pushad                                                       
　　　　　　　　mov 　　dx,0a0ah                                             
　　　　　　　　in　　　al,dx 　　　　　;Get modem status                    
　　　　　　　　mov 　　modem_sav,al                                         
　　　　　　　　mov 　　al,080h 　　　　;Set rs232c                          
　　　　　　　　out 　　dx,al                                                
　　　　　　　　mov 　　dx,0a08h                                             
　　　　　　　　mov 　　al,0c0h 　　　　;Ext. sync                           
                                                                             
　　　　　　　　out 　　dx,al                                                
　　　　　　　　mov 　　dx,0a02h　　　　;init i8251                          
　　　　　　　　xor 　　al,al                                                
　　　　　　　　call　　rs_write                                             
　　　　　　　　call　　rs_write                                             
　　　　　　　　call　　rs_write                                             
　　　　　　　　mov 　　al,040h                                              
　　　　　　　　call　　rs_write                                             
　　　　　　　　mov 　　al,04dh                                              
　　　　　　　　call　　rs_write                                             
　　　　　　　　mov 　　al,031h                                              
　　　　　　　　call　　rs_write                                             
　　　　　　　　mov 　　ah,0ch                                               
　　　　　　　　call　　SND_eup_driver                                       
　　　　　　　　mov 　　rs_midi_ent_sav,ebx                                  
　　　　　　　　mov 　　ebx,offset rs_drive_entry                            
　　　　　　　　mov 　　ah,0dh                                               
　　　　　　　　call　　SND_eup_driver                                       
　　　　　　　　popad                                                        
　　　　　　　　popfd                                                        
　　　　　　　　xor 　　eax,eax                                              
　　　　　　　　ret                                                          
SND_rs_midi_init　　　　endp                                                 
rs_write 　　　 proc 　 near                                                 
　　　　　　　　out 　　dx,al                                                
　　　　　　　　out 　　WAIT_REG,al                                          
　　　　　　　　out 　　WAIT_REG,al                                          
　　　　　　　　out 　　WAIT_REG,al                                          
　　　　　　　　out 　　WAIT_REG,al                                          
　　　　　　　　ret                                                          
rs_write 　　　 endp                                                         
SND_rs_midi_end proc　　near                                                 
rs_midi_exit:                                                                
　　　　　　　　pushad                                                       
　　　　　　　　mov 　　ebx,rs_midi_ent_sav                                  
　　　　　　　　mov 　　ah,0dh                                               
　　　　　　　　call　　SND_eup_driver                                       
                                                                             
　　　　　　　　mov 　　dx,0a0ah                                             
　　　　　　　　mov 　　al,modem_sav                                         
　　　　　　　　out 　　dx,al                                                
　　　　　　　　popad                                                        
　　　　　　　　xor 　　eax,eax                                              
　　　　　　　　ret                                                          
SND_rs_midi_end endp                                                         
;---------------------------------------------------------------------       
　　　　　　　　align 　4                                                    
rs_drive_entry  proc 　 near                                                 
　　　　　　　　push　　ecx                                                  
　　　　　　　　push　　edx                                                  
　　　　　　　　cmp 　　al,080h 　　　　　　　　;Status?                     
　　　　　　　　jb　　　short #data 　　　　　　;No, jump                    
　　　　　　　　cmp 　　al,0f8h 　　　　　　　　;Real time status ?          
　　　　　　　　jae 　　short #data 　　　　　　;Yes, jump                   
　　　　　　　　cmp 　　al,0f0h 　　　　　　　　;Common status?              
　　　　　　　　jae 　　short #status 　　　　　;Yes, jump                   
　　　　　　　　cmp 　　al,run_stat　　　　　　 ;Same command?               
　　　　　　　　je　　　short #exit 　　　　　　;Yes, jump                   
#status:                                                                     
　　　　　　　　mov 　　run_stat,al 　　　　　　;No, set new command         
#data:                                                                       
　　　　　　　　push　　eax                                                  
　　　　　　　　mov 　　dx,0a02h                                             
　　　　　　　　mov 　　ecx,RS_TIME_OVER                                     
#loop:                                                                       
　　　　　　　　in　　　al,dx                                                
　　　　　　　　and 　　al,01h                                               
　　　　　　　　jne 　　short #ready                                         
　　　　　　　　loop　　short #loop                                          
　　　　　　　　pop 　　eax                                                  
　　　　　　　　jmp 　　short #error                                         
#ready:                                                                      
　　　　　　　　pop 　　eax                                                  
　　　　　　　　mov 　　dx,0a00h                                             
　　　　　　　　out 　　dx,al                                                
#exit:                                                                       
　　　　　　　　pop 　　edx                                                  
　　　　　　　　pop 　　ecx                                                  
　　　　　　　　xor 　　ah,ah                                                
　　　　　　　　clc                                                          
　　　　　　　　ret                                                          
#error:                                                                      
　　　　　　　　pop 　　edx                                                  
　　　　　　　　pop 　　ecx                                                  
　　　　　　　　mov 　　ah,0f0h                                              
　　　　　　　　stc                                                          
　　　　　　　　ret                                                          
rs_drive_entry  endp                                                         
joecode 　　　　ends                                                         
　　　　　　　　end                                                          
                                                                             
  3.2　関数一覧                                                              
                                                                             
┌────────────────────┬────────┐               
│　　　　　　　機　　　　能　　　　　　　│ 　コ　ー　ド　 │               
├────────────────────┼────────┤               
│ドライバの初期化　　　　　　　　　　　　│　　00Ｈ　　　  │               
├────────────────────┼────────┤               
│ドライバの終了　　　　　　　　　　　　　│　　01Ｈ　　　  │               
├────────────────────┼────────┤               
│演奏開始　　　　　　　　　　　　　　　　│　　02Ｈ　　　  │               
├────────────────────┼────────┤               
│演奏停止　　　　　　　　　　　　　　　　│　　03Ｈ　　　  │               
├────────────────────┼────────┤               
│演奏の一時停止　　　　　　　　　　　　　│　　04Ｈ　　　  │               
├────────────────────┼────────┤               
│演奏の再開　　　　　　　　　　　　　　　│　　05Ｈ　　　  │               
├────────────────────┼────────┤               
│演奏情報の取り出し　　　　　　　　　　　│　　06Ｈ　　　  │               
├────────────────────┼────────┤               
│MIDI SYNC信号の出力ポート設定　　　　　 │　　07Ｈ　　　  │               
├────────────────────┼────────┤               
│繰り返しの設定　　　　　　　　　　　　　│　　08Ｈ　　　  │               
├────────────────────┼────────┤               
│テンポの設定　　　　　　　　　　　　　　│　　09Ｈ　　　  │               
├────────────────────┼────────┤               
│MIDI出力ルーチンの取得　　　　　　　　　│　　0CＨ　　　  │               
├────────────────────┼────────┤               
│MIDI出力ルーチンの登録　　　　　　　　　│　　0DＨ　　　  │               
├────────────────────┼────────┤               
│タイマの停止/始動　　　　　　　　　　　 │　　0EＨ　　　  │               
├────────────────────┼────────┤               
│割り出し処理フラグの設定　　　　　　　　│　　0FＨ　　  　│               
├────────────────────┼────────┤               
│各トラックの出力ポートの設定　　　　　　│　　10Ｈ　　　  │               
├────────────────────┼────────┤               
│各トラックの出力MIDIチャンネルの設定　　│　　11Ｈ　　  　│               
├────────────────────┼────────┤               
│各トラックのPLAY/MUTE設定　　　　　　 　│　　12Ｈ　　　  │               
├────────────────────┼────────┤               
│各トラックのトランスポーズの設定　　　　│　　13Ｈ　　　  │               
├────────────────────┼────────┤               
│バイアスの設定　　　　　　　　　　　　　│　　14Ｈ　　　  │               
├────────────────────┼────────┤               
│内蔵音源のMIDIチャンネル設定　　　　　　│　　20Ｈ　　　  │               
├────────────────────┼────────┤               
│MIDIデータ列の出力　　　　　　　　　　　│　　21Ｈ　　　  │               
├────────────────────┼────────┤               
│MIDIデータの読み込み　　　　　　　　　　│　　22Ｈ　　　  │               
├────────────────────┼────────┤               
│固定タイマモードのドライバの初期化　　　│　　30Ｈ　　　  │               
├────────────────────┼────────┤               
│固定タイマモードのドライバの終了　　　　│　　31Ｈ　　　  │               
├────────────────────┼────────┤               
│固定タイマモードの割り込みエントリ　　　│　　32Ｈ　　　  │               
├────────────────────┼────────┤               
│固定タイマモードの割り出しエントリ　　　│　　33Ｈ　　　  │               
└────────────────────┴────────┘               
                                                                             
  3.3　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.ドライバの初期化                                                            
00Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =00H                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
ドライバを使用する際に、ハードウェア及びドライバの初期化と割り込みの登録を行 
います。このファンクションを使用する前にサウンドライブラリのSND-initを用いて 
初期化されていなければなりません。RS-232Cに対してMIDI出力をする場合には、この
直後にユーザの作成したRS-232C出力ルーチンを｢MIDI出力ルーチンの登録:0DH｣を用い
て登録する必要があります。ユーザの管理する固定タイマでドライバを動作させる場 
合には、｢固定タイマモードのドライバの初期化:30H｣で初期化してください。       
                                                                             
-----------------------------------------------------------------------------
.ドライバの終了                                                              
01Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =01H                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
プログラムの終了時に使用します。割り込みを終了し、ベクタはもとに戻します。RS-
232Cに対してMIDI出力をしていた場合には、この直前に｢MIDI出力ルーチンの登録:0DH
｣を用いて、RS-232C出力ルーチンを登録する以前の状態に戻す必要があります。ユー 
ザの管理する固定タイマでドライバを動作させていた場合には、｢固定タイマモードの
ドライバの終了:31H｣で終了してください。                                      
                                                                             
-----------------------------------------------------------------------------
.演奏開始                                                                    
02Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH　　=02H                                                                   
ES:ESI=演奏バッファの先頭アドレス                                            
ECX 　=演奏バッファのサイズ                                                  
DL　　=拍子記号                                                              
                                                                             
- 戻り値 -                                                                   
EAX 　=00H 　　　正常終了                                                    
                                                                             
- 機能 -                                                                     
演奏を開始します。拍子記号は一番最初の小節のものを入れます。演奏ポインタがバ 
ッファを越えた場合は、演奏ポインタは先頭にセットされます。これを利用してリン 
グバッファとすることができます。                                             
                                                                             
-----------------------------------------------------------------------------
.演奏停止                                                                    
03Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =03H                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
演奏を停止します。                                                           
                                                                             
-----------------------------------------------------------------------------
.演奏の一時停止                                                              
04Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =04H                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
演奏を一時停止します。                                                       
                                                                             
-----------------------------------------------------------------------------
.演奏の再開                                                                  
05Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =05H                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
一時停止中の演奏を再開します。                                               
                                                                             
-----------------------------------------------------------------------------
.演奏情報の取り出し                                                          
06Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH　　=06H                                                                   
                                                                             
- 戻り値 -                                                                   
ES:ESI=演奏アドレス                                                          
BX　　=小節                                                                  
CX　　=クロック                                                              
DH　　=演奏状態のフラグ(0=停止状態，0以外=演奏状態)                          
DL　　=テンポ　(0〜250)                                                      
                                                                             
EAX 　=00H 　　　正常終了                                                    
                                                                             
- 機能 -                                                                     
現在の演奏情報を返します。テンポは実際の値から30を引いたものが返ります。     
                                                                             
-----------------------------------------------------------------------------
.MIDISYNC信号の出力ポート設定                                                
07Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =07H                                                                      
DL =出力ポート番号(0〜7、16〜31、240〜255)                                   
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
MIDIの同期信号を出力するポートを設定します。                                 
出力ポート番号が0〜7の時はMIDIカードのポート(a〜h)が選択されます。           
出力ポート番号が16〜31の時は RS-MIDIが選択されます。                         
出力ポート番号が240〜255の時は同期信号は出力されません。                     
                                                                             
-----------------------------------------------------------------------------
.繰り返しの設定                                                              
08Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =08H                                                                      
DL =スイッチ(0=繰り返し無し、255=繰り返し)                                   
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
繰り返しをするかどうかを設定します。繰り返しを設定すると、曲の終端コードFEH  
(END OF SONG) を検出した時、演奏ポインタを先頭に戻して演奏を続けます。       
                                                                             
-----------------------------------------------------------------------------
.テンポの設定                                                                
09Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =09H                                                                      
DX =テンポ(0〜250)                                                           
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
テンポを変更します。テンポの値は実際の値から30を引いたもの(0〜250)となります 
ただし、演奏中にテンポ変更データを検出した場合には、そのテンポに再設定されま 
す。                                                                         
                                                                             
-----------------------------------------------------------------------------
.MIDI出力ルーチンの取得                                                      
0CＨ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =0CH                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=0 　　　　正常終了                                                       
EBX=MIDI出力ルーチン処理先アドレス                                           
                                                                             
- 機能 -                                                                     
MIDI出力ルーチン処理先を求めます。                                           
『MIDI出力ルーチンの登録 0DH』に先立って、出力ルーチン処理先を保存する時など 
に使用します。                                                               
                                                                             
-----------------------------------------------------------------------------
.MIDI出力ルーチンの登録                                                      
0DＨ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =0DH                                                                      
EBX=MIDI出力ルーチン処理先アドレス                                           
                                                                             
- 戻り値 -                                                                   
EAX=0 　　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
MIDI出力ルーチン処理先を登録します。                                         
RS-232C出力ルーチンを登録する時などに使用します。                            
                                                                             
-----------------------------------------------------------------------------
.タイマの停止/始動                                                           
0EＨ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =0EH                                                                      
DL =スイッチ　(0:停止、0以外:始動)                                           
                                                                             
- 戻り値 -                                                                   
EAX=0 　　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
ドライバの使用しているタイマの停止/始動を設定します。                        
                                                                             
-----------------------------------------------------------------------------
.割り出し処理フラグの設定                                                    
0FＨ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =0FH                                                                      
DL =スイッチ　(0:処理を行う、0以外:処理をしない)                             
                                                                             
- 戻り値 -                                                                   
EAX=0 　　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
ドライバの割り出し処理の動作/非動作を設定します。                            
                                                                             
-----------------------------------------------------------------------------
.各トラックの出力ポートの設定                                                
10Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =10H                                                                      
BL =トラック番号　(0〜31)                                                    
DL =出力ポート番号(0〜7、16〜31、240〜255)                                   
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
各トラックの出力ポートを設定します。                                         
出力ポート番号が0〜7の時はMIDIカードのポート(a〜h)が選択されます。           
出力ポート番号が16〜31の時は RS-MIDIが選択されます。                         
出力ポート番号が240〜255の時は内蔵音源が選択されます。                       
                                                                             
-----------------------------------------------------------------------------
.各トラックの出力MIDIチャンネルの設定                                        
11Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =11H                                                                      
BL =トラック番号　(0〜31)                                                    
DL =チャンネル番号(0〜15、255)                                               
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
各トラックの出力MIDIチャンネルを設定します。MIDIチャンネルに255を設定すると  
"OMNI"が選択され、データ中に書かれているMIDIチャンネルで出力されます。       
                                                                             
-----------------------------------------------------------------------------
.各トラックのPLAY/MUTE設定                                                   
12Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =12H                                                                      
BL =トラック番号　(0〜31)                                                    
DL =スイッチ　　　(0=MUTE、255×LAY)                                         
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
各トラックの演奏データ出力をPLAY/MUTEします。                                
                                                                             
-----------------------------------------------------------------------------
.各トラックのトランスポーズの設定                                            
13Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =13H                                                                      
BL =トラック番号　(0〜31)                                                    
DL =キー　　　　　(-12〜12)                                                  
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
各トラックのトランスポーズ(移調)を設定します。                               
                                                                             
-----------------------------------------------------------------------------
.バイアスの設定                                                              
14Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =14H                                                                      
BL =トラック番号　(0〜31)                                                    
DL =バイアス値　　(-40〜40)                                                  
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
各トラックのバイアス(ベロシティに対するオフセット)を設定します。             
                                                                             
-----------------------------------------------------------------------------
.内蔵音源のMIDIチャンネル設定                                                
20Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =20H                                                                      
BL =音源チャンネル番号　(0〜255)                                             
DL =MIDIチャンネル番号　(0〜15)                                              
                                                                             
- 戻り値 -                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
                                                                             
- 機能 -                                                                     
内蔵音源のMIDIチャンネルを設定します。                                       
                                                                             
┌───────┬────────┬───────┬────────┐       
│音源チャンネル│　　音源種別　　│音源チャンネル│　　音源種別　　│       
├───────┼────────┼───────┼────────┤       
│　　 0　　　　│ＦＭ音源　ｃｈ1 │　  64　　　　│ＰＣＭ　ｃｈ1　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 1　　　　│ＦＭ音源　ｃｈ2 │　  65　　　　│ＰＣＭ　ｃｈ2　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 2　　　　│ＦＭ音源　ｃｈ3 │　  66　　　　│ＰＣＭ　ｃｈ3　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 3　　　　│ＦＭ音源　ｃｈ4 │　  67　　　　│ＰＣＭ　ｃｈ4　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 4　　　　│ＦＭ音源　ｃｈ5 │　  68　　　　│ＰＣＭ　ｃｈ5　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 5　　　　│ＦＭ音源　ｃｈ6 │　  69　　　　│ＰＣＭ　ｃｈ6　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　 6〜　15  │ＦＭ音源拡張　　│　  70　　　　│ＰＣＭ　ｃｈ7　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　  16〜　31  │拡張用　　　　　│　  71　　　　│ＰＣＭ　ｃｈ8　 │       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　  32〜　63  │リズム音源拡張　│　  72〜　95  │ＰＣＭ拡張　　　│       
│　　　　　　　│　　　　　　　　│　　　　　　　│　　　　　　　　│       
│　　　　　　　│　　　　　　　　│　  96〜 255  │その他の音源拡張│       
└───────┴────────┴───────┴────────┘       
                                                                             
-----------------------------------------------------------------------------
.MIDIデータ列の出力                                                          
21Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH　　=21H                                                                   
BL　　=出力ポート　(0〜7、16〜31、255)                                       
DS:ESI=データ列先頭アドレス                                                  
ECX 　=データ列サイズ                                                        
                                                                             
- 戻り値 -                                                                   
EAX 　=00H 　　　正常終了                                                    
EAX 　=03H 　　　パラメータエラー                                            
                                                                             
- 機能 -                                                                     
MIDI OUTにMIDIデータを出力します。出力ポートに255を設定すると内蔵音源が選択さ
れます。データ列は0〜255のいずれの値でも出力できるので、MIDIの規格を十分に理 
解した上で使用しないと、誤動作等の原因となるので注意が必要です。             
                                                                             
-----------------------------------------------------------------------------
.MIDIデータの読み込み                                                        
22Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =22H                                                                      
BL =入力ポート　(0〜3)                                                       
                                                                             
- 戻り値 -                                                                   
DL =データ                                                                   
EAX=00H 　　　正常終了                                                       
EAX=03H 　　　パラメータエラー                                               
EAX=01H 　　　読み込むデータがありません。                                   
                                                                             
- 機能 -                                                                     
MIDI INよりデータを読み込みます。                                            
                                                                             
-----------------------------------------------------------------------------
.固定タイマモードのドライバの初期化                                          
30Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =30H                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=0 　　　　正常終了                                                       
EBX=割り込み処理エントリ                                                     
EDX=割り出し処理エントリ                                                     
                                                                             
- 機能 -                                                                     
固定タイマモードでの初期化を行います。                                       
『ドライバの初期化 00H』の代わりにこちらで初期化してください。               
各レジスタには、割り込み処理エントリ及び割り出し処理エントリが返されます。   
                                                                             
-----------------------------------------------------------------------------
.固定タイマモードのドライバの終了                                            
31Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =31H                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=0 　　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
固定タイマモードでの処理を終了します。                                       
『ドライバの終了 01H』の代わりにこちらで終了処理をしてください。             
                                                                             
-----------------------------------------------------------------------------
.固定タイマモードの割り込みエントリ                                          
32Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =32H                                                                      
EDX=time(μsec単位)                                                          
                                                                             
- 戻り値 -                                                                   
EAX=0 　　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
固定タイマモードの割り込み処理ルーチンのエントリです。                       
アプリケーションが管理する割り込み処理ルーチンがこの関数を呼ぶ事により演奏ド 
ライバが動作します。timeの値は、この関数を呼ぶ時間と1つ前に呼んだ時の時間との
差(経過時間)を代入します。                                                   
                                                                             
-----------------------------------------------------------------------------
.固定タイマモードの割り出しエントリ                                          
33Ｈ                                                                         
-----------------------------------------------------------------------------
                                                                             
- エントリ -                                                                 
AH =33H                                                                      
                                                                             
- 戻り値 -                                                                   
EAX=0 　　　　正常終了                                                       
                                                                             
- 機能 -                                                                     
固定タイマモードの割り出し処理ルーチンのエントリです。                       
アプリケーションが管理する割り出し処理ルーチンがこの関数を呼ぶことにより演奏 
ドライバが動作します。                                                       
                                                                             
*****************************************************************************
第9章　ハードコピーライブラリ                                                
*****************************************************************************
                                                                             
 1.　ハードコピーライブラリについて                                          
                                                                             
  1.1　概要                                                                  
                                                                             
　本ライブラリは画面上に表示されたイメージをプリンタ、ファイル、カラー複写機 
に出力するもので、下記の機能があります。                                     
                                                                             
 1.　画面出力機能                                                            
　･プリンタ出力(モノクロ/カラー)                                             
　･ファイル出力(ＴＩＦＦ形式)                                                
　･カラー複写機出力                                                          
                                                                             
 2.　出力内容指定機能                                                        
　･出力対象ページ                                                            
　･印刷開始位置                                                              
　･印刷範囲                                                                  
　･出力倍率                                                                  
                                                                             
　ハードコピーで出力可能な画面モードは、1024×768 16色、1024×768 256色、512 
×384 32768色、640×480 16色、640×480 256色、320×240 32768色とフルカラーカ 
ードの全画面です。                                                           
　ハードコピー機能を使用するためには、ハードコピードライバをシステムに組み込 
むことが必要です。TownsMenuの『設定』のグループアイテム内の『モノクロハードコ
ピー』、『カラーハードコピー』、『ハードコピー(ファイル)』を実行することによ 
り、ハードコピードライバを組み込むことができます(カラー複写機に出力する場合は
"\HCOPY"ディレクトリ内の"PHCOPY.BAT"を実行してください)。                    
　ハードコピードライバは同時に複数を組み込むことが可能です(ただし、『モノクロ
ハードコピー』と『カラーハードコピー』を同時に組み込むことはできません)。使用
目的に応じたドライバを組み込んでください。                                   
                                                                             
 2.　ハードコピーライブラリ                                                  
                                                                             
  2.1　サンプルプログラム                                                    
                                                                             
┌────────────────────────────────────┐ 
│ハードコピーライブラリサンプルプログラム　　　　　　　　　　　　　　　　│ 
│機　能:グラフィックスを描画し、プリンタ出力のハードコピーを開始します。 │ 
│                                                                        │ 
│マウスのボタンを押すとハードコピーを中止します。　　　　　　            │ 
└────────────────────────────────────┘ 
                                                                             
#include <egb.h>                                                             
#include <mos.h>                                                             
#include <hcopy.h>                                                           
                                                                             
char work[1536];                                                             
char mwork[4096];                                                            
char para[64];                                                               
                                                                             
void mouseEvent();　　　　　　　　　　　　　　/*--- 　イベントルーチン　---*/
void graphics();　　　　　　　　　　 /*--- サンプルグラフィック表示関数 ---*/
                                                                             
void main() 　　　　　　　　　　　　　　　　 /*--- ハードコピーサンプル ---*/
{                                                                            
　　　　void (*address)();                                                   
　　　　char *fname;                                                         
                                                                             
　　　　EGB_init( work, 1536 ); 　　　　　　　/*　グラフィック初期化　　　 */
　　　　MOS_start( mwork, 4096 ); 　　　　　　/*　マウス動作開始　　　　　 */
　　　　address = (void(*)())MOS_getEvent();  /*　イベントルーチンの保存　 */
　　　　MOS_setEvent( mouseEvent ); 　　　　　/*　イベントルーチンの登録　 */
                                                                             
　　　　graphics(); 　　　　　　　　　　　　　/*　サンプルグラフィック表示 */
                                                                             
　　　　fname = "dummy";　　　　　　　　　　　/*　パス名　　　　　　　　　 */
　　　　HCP_start( 0, 3, fname ); 　　　　　　/*　ハードコピー開始　　　　 */
　　　　MOS_setEvent( address );　　　　　　　/*　イベントルーチンの復帰　 */
                                                                             
　　　　MOS_end();　　　　　　　　　　　　　　/*　マウス動作終了　　　　　 */
}                                                                            
                                                                             
void mouseEvent() 　　　　　　　　　　　　　　/*--- 　イベントルーチン　---*/
{                                                                            
　　　　int button;                                                          
　　　　int bcount;                                                          
　　　　int x;                                                               
　　　　int y;                                                               
                                                                             
　　　　MOS_rdon( 0, &button, &bcount, &x, &y );　　　/*　マウス状態取得　 */
                                                                             
　　　　if( ( button & 3 ) != 0 ) 　　　　　　　　　　/*　ハードコピー中止 */
　　　　　　　　HCP_stop();                                                  
}                                                                            
                                                                             
void graphics() 　　　　　　　　　　 /*--- サンプルグラフィック表示関数 ---*/
{                                                                            
　　　　EGB_displayPage( work, 0,1 );                                        
                                                                             
　　　　WORD( para+0 ) = 300; 　　　　　　　　　　　　/*　　　　円　　　　 */
　　　　WORD( para+2 ) = 200;                                                
　　　　WORD( para+4 ) = 120;                                                
　　　　EGB_circle( work, para );                                            
                                                                             
　　　　WORD( para+0 ) = 300; 　　　　　　　　　　　　/*　　　矩　形　　　 */
　　　　WORD( para+2 ) = 200;                                                
　　　　WORD( para+4 ) = 500;                                                
　　　　WORD( para+6 ) = 400;                                                
　　　　EGB_rectangle( work, para );                                         
                                                                             
　　　　EGB_paintMode( work, 0x20 );　　　　　　　　　/*　　ペイント　　　 */
　　　　EGB_color( work, 2, 9 );                                             
　　　　WORD( para+0 ) = 0;                                                  
　　　　WORD( para+2 ) = 0;                                                  
　　　　EGB_closePaint( work, para );                                        
}                                                                            
                                                                             
  2.2　関数一覧                                                              
                                                                             
┌─────────────┬───────────────┐               
│　　　　関　数　名　　　　│　　　　機　　　　　能　　　　│               
├─────────────┼───────────────┤               
│HCP_start 　　　　　　　　│ハードコピーの開始　　　　　　│               
├─────────────┼───────────────┤               
│HCP_stop　　　　　　　　　│ハードコピーの終了　　　　　　│               
├─────────────┼───────────────┤               
│HCP_setPrnStart 　　　　　│印刷開始位置の設定　　　　　　│               
├─────────────┼───────────────┤               
│HCP_setOutMode　　　　　　│出力モードの設定　　　　　　　│               
└─────────────┴───────────────┘               
                                                                             
  2.3　各関数の解説                                                          
                                                                             
-----------------------------------------------------------------------------
.HCP_setOutMode                                                              
出力モードの設定                                                             
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <HCOPY.H>                                                           
int 　　HCP_setOutMode( para );                                              
char　　*para;　　　　　 /* 　パラメータブロックアドレス　*/                 
                                                                             
- 戻り値 -                                                                   
0x00:　正常終了                                                              
0x13:　範囲指定の誤り                                                        
0x14:　拡大指定の誤り                                                        
0x1A:　ハードコピー動作中                                                    
0x80:　ハードコピーが常駐していない                                          
                                                                             
- 注意 -                                                                     
ファイル出力の場合は無効です。                                               
                                                                             
- 例 -                                                                       
typedef struct{                                                              
　　char　　　　　 x ;                                                       
　　char　　　　　 y ;                                                       
}MAGS ;                                                                      
                                                                             
typedef struct{                                                              
　　char　　　　　 mode ;                                                    
　　char　　　　　 rsv ;                                                     
　　unsigned short lupx ;                                                    
　　unsigned short lupy ;                                                    
　　unsigned short rdwx ;                                                    
　　unsigned short rdwy ;                                                    
　　MAGS　　　　　 mags[4] ;                                                 
}OUTMODE ;                                                                   
                                                                             
int 　　ret ;                                                                
OUTMODE para ={0x0e0, 0, 100, 100, 200, 200, 1, 1, 1, 1, 1, 1, 1, 1};        
                                                                             
ret = HCP_setOutMode((char *)&para) ;                                        
                                                                             
- 内容 -                                                                     
出力範囲と出力倍率を指定します。                                             
出力範囲は、表示画面上のドットサイズ(ハード座標系)で指定します。             
出力倍率は、ページごとに倍率を指定します(出力対象に対する倍率ではありませんの
で注意してください)。これは、EGB_displayStart()の画面の拡大指定と同等の機能で
す(画面には反映されません)。                                                 
                                                                             
para  パラメータブロック先頭番地                                             
　　┌─┬─────────────┐                                       
 　0│Ｂ│　　　コピーモード　　　　│                                       
  　├─┼─────────────┤                                       
 　1│Ｂ│　　　　　0　　　　　　 　│                                       
　　├─┼─────────────┤                                       
 　2│Ｗ│　範囲指定（左上x）　 　　│                                       
　　├─┼─────────────┤                                       
 　4│Ｗ│　範囲指定（左上y）　 　　│                                       
　　├─┼─────────────┤                                       
 　6│Ｗ│　範囲指定（右下x）　 　　│                                       
　　├─┼─────────────┤                                       
 　8│Ｗ│　範囲指定（右下y）　 　　│                                       
　　├─┼─────────────┤                                       
 　A│Ｂ│ページ0横倍率(1〜16) 　　 │                                       
　　├─┼─────────────┤                                       
 　B│Ｂ│ページ0縦倍率(1〜16) 　　 │                                       
　　├─┼─────────────┤                                       
 　C│Ｂ│ページ1横倍率(1〜16) 　　 │                                       
　　├─┼─────────────┤                                       
 　D│Ｂ│ページ1縦倍率(1〜16) 　　 │                                       
　　├─┼─────────────┤                                       
 　E│Ｂ│ﾌﾙｶﾗｰﾍﾟｰｼﾞ0横倍率(1〜16)  │                                       
　　├─┼─────────────┤                                       
 　F│Ｂ│ﾌﾙｶﾗｰﾍﾟｰｼﾞ0縦倍率(1〜16)  │                                       
　　├─┼─────────────┤                                       
  10│Ｂ│ﾌﾙｶﾗｰﾍﾟｰｼﾞ1横倍率(1〜16)  │                                       
　　├─┼─────────────┤                                       
  11│Ｂ│ﾌﾙｶﾗｰﾍﾟｰｼﾞ1縦倍率(1〜16)  │                                       
　　└─┴─────────────┘                                       
                                                                             
コピーモード                                                                 
para中の各指定項目を有効にするかを指定します。                               
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│　│　│　│　│ 0│ 0│ 0│                                           
└┬┴┬┴┬┴┬┴┬┴─┴─┴─┘                                           
　│　│　│　│　│                                                         
　│　│　│　│　└─0:ﾌﾙｶﾗｰﾍﾟｰｼﾞ0の倍率指定をしない                        
　│　│　│　│　　　1:ﾌﾙｶﾗｰﾍﾟｰｼﾞ0の倍率指定をする                          
　│　│　│　└───0:ﾌﾙｶﾗｰﾍﾟｰｼﾞ1の倍率指定をしない                        
　│　│　│　　　　　1:ﾌﾙｶﾗｰﾍﾟｰｼﾞ1の倍率指定をする                          
　│　│　└─────0:ページ0の倍率指定をしない                            
　│　│　　　　　　　1:ページ0の倍率指定をする                              
　│　└───────0:ページ1の倍率指定をしない                            
　│　　　　　　　　　1:ページ1の倍率指定をする                              
　└─────────0:範囲指定しない                                       
　　　　　　　　　　　1:範囲指定する                                         
                                                                             
-----------------------------------------------------------------------------
.HCP_setPrnStart                                                             
印刷開始位置の設定                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <HCOPY.H>                                                           
int 　　HCP_setPrnStart( x, y );                                             
int 　　x;　　 /* 　印刷開始位置(桁) */                                      
int 　　y;　　 /* 　印刷開始位置(行) */                                      
                                                                             
- 戻り値 -                                                                   
0x00:　正常終了                                                              
0x1A:　ハードコピー動作中                                                    
0x80:　ハードコピーが常駐していない                                          
                                                                             
- 注意 -                                                                     
ファイル出力の場合は無効です。                                               
                                                                             
- 例 -                                                                       
int 　 ret ;                                                                 
                                                                             
ret = HCP_setPrnStart( 1, 1 );                                               
                                                                             
- 内容 -                                                                     
ハードコピーの印刷開始位置を指定します。                                     
印刷可能域左上より行桁単位で指定してください。                               
行桁の大きさはプリンタに依存します。                                         
                                                                             
-----------------------------------------------------------------------------
.HCP_start                                                                   
ハードコピーの開始                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <HCOPY.H>                                                           
int 　　HCP_start( out, page, adr );                                         
int 　　out;　　/*　出力先指定と出力モードの有効･無効　　　　*/              
int 　　page; 　/*　出力ページ指定　　　　　　　　　　　　　　*/             
char　　*adr; 　/*　パス名の先頭アドレス(ファイル出力時のみ)*/               
                                                                             
- 戻り値 -                                                                   
0x00:　正常終了                                                              
0x05:　プリンタの用紙切れ                                                    
0x06:　プリンタが動作状態でない                                              
0x07:　プリンタに動作エラーが発生した                                        
0x0f:　プリンタ情報ファイルが異常                                            
0x12:　ページ指定の誤り                                                      
0x15:　出力指定の誤り                                                        
0x17:　出力モード指定の誤り                                                  
0x18:　パス名の誤り                                                          
0x19:　ファイル出力時のエラー                                                
0x1A:　ハードコピー動作中                                                    
0x1B:　表示ページのＶＲＡＭがマッピングされてない                            
0x1C:　未サポート解像度                                                      
0x1D:　出力指定したページが存在しない                                        
0x1E:　出力指定したページが全く表示されていない                              
0x1F:　強制終了ファンクションにより中断された                                
0x80:　指定のハードコピーが常駐していない                                    
                                                                             
- 注意 -                                                                     
･フルカラー画面を出力する場合はフルカラーカードを装備し、フルカラードライバ  
 を組み込んでください。                                                      
･ファイル出力指定時は複数ページを出力指定することはできません。              
                                                                             
- 例 -                                                                       
int 　　ret ;                                                                
int 　　out  = 0x01 ;                                                        
int 　　page = 0x01 ;                                                        
char　 *path = "a:\hcopy.tif"                                                
                                                                             
ret = HCP_start( out, page, path ) ;                                         
                                                                             
- 内容 -                                                                     
ハードコピーを開始します。                                                   
                                                                             
out                                                                          
出力先とHCP_setOutMode()で設定された内容を有効にするかどうかを指定します。   
                                                                             
　15　　　 9　 8　 7　 6　 5　 4　 3　 2　 1　 0                             
┌─┬〜┬─┬─┬───────────────┐                           
│ 0│　│ 0│　│　　　　　　　　　　　　　　　│                           
└─┴〜┴─┴┬┴────────┬──────┘                           
　　　　　　　│　　　　　　　　　│                                         
　　　　　　　│　　　　　　　　　└─0:プリンタ出力                         
　　　　　　　└─0:出力指定無効　　  1:ファイル出力                         
　　　　　　　　　1:出力指定有効　　  2:カラー複写機出力                     
                                                                             
page                                                                         
出力ページと出力状態を指定します。                                           
                                                                             
　 7　 6　 5　 4　 3　 2　 1　 0                                             
┌─┬─┬─┬─┬─┬─┬─┬─┐                                           
│　│ 0│ 0│ 0│　│　│　│　│                                           
└┬┴─┴─┴─┴┬┴┬┴┬┴┬┘                                           
　│　　　　　　　│　│　│　│                                             
　│　　　　　　　│　│　│　└─0:ページ0を出力しない                      
　│　　　　　　　│　│　│　　　1:ページ0を出力する                        
　│　　　　　　　│　│　└───0:ページ1を出力しない                      
　│　　　　　　　│　│　　　　　1:ページ1を出力する                        
　│　　　　　　　│　└─────0:ﾌﾙｶﾗｰﾍﾟｰｼﾞ0を出力しない                  
　│　　　　　　　│　　　　　　　1:ﾌﾙｶﾗｰﾍﾟｰｼﾞ0を出力する                    
　│　　　　　　　└───────0:ﾌﾙｶﾗｰﾍﾟｰｼﾞ1を出力しない                  
　│　　　　　　　　　　　　　　　1:ﾌﾙｶﾗｰﾍﾟｰｼﾞ1を出力する                    
　└───────────────0:指定ページのうち表示ページを出力         
　　　　　　　　　　　　　　　　　1:表示ページに関係なく指定ページを出力     
                                                                             
path                                                                         
ファイル出力時の出力先と、出力ファイル名を指定します。フルパスで指定してくだ 
さい。                                                                       
                                                                             
-----------------------------------------------------------------------------
.HCP_stop                                                                    
ハードコピーの終了                                                           
-----------------------------------------------------------------------------
                                                                             
- 定義 -                                                                     
#include <HCOPY.H>                                                           
int 　　HCP_stop(void);                                                      
                                                                             
- 戻り値 -                                                                   
0x00:　正常終了                                                              
0x80:　ハードコピーが常駐していない                                          
                                                                             
- 例 -                                                                       
int 　　ret ;                                                                
                                                                             
ret = HCP_stop() ;                                                           
                                                                             
- 内容 -                                                                     
ハードコピーを強制終了します。                                               
                                                                             
*****************************************************************************
付録Ａ　システムアイコン一覧表                                               
*****************************************************************************
                                                                             
図CL21R-057                                                                  
                                                                             
*****************************************************************************
付録Ｂ　キーボード関連                                                       
*****************************************************************************
                                                                             
B.1　キーボード　キー配列図                                                  
                                                                             
図CL21R-058                                                                  
                                                                             
図CL21R-059                                                                  
                                                                             
図CL21R-060                                                                  
                                                                             
図CL21R-061                                                                  
                                                                             
B.2　キーボード　キー分類図                                                  
                                                                             
図CL21R-062                                                                  
                                                                             
図CL21R-063                                                                  
                                                                             
図CL21R-064                                                                  
                                                                             
図CL21R-065                                                                  
                                                                             
B.3　キーボード　キーアドレス配列図                                          
                                                                             
図CL21R-066                                                                  
                                                                             
図CL21R-067                                                                  
                                                                             
図CL21R-068                                                                  
                                                                             
図CL21R-069                                                                  
                                                                             
B.4　キーボード　ＡＳＣＩＩ(7ｂｉｔ)コード表                                 
                                                                             
┌───┬─────┬─────┬──┬──┬──┬──┬──┬──┐       
│　　　│　　0　　 │　　1　　 │  2 │  3 │  4 │  5 │  6 │  7 │       
├───┼──┬──┼──┬──┼──┼──┼──┼──┼──┼──┤       
│　 0　│↑＠│　　│↑Ｐ│　　│(SP)│ 0  │ ＠ │ Ｐ │ ‘ │ ｐ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 1　│↑Ａ│　　│↑Ｑ│DUP │ ！ │ 1  │ Ａ │ Ｑ │ ａ │ ｑ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 2　│↑Ｂ│　　│↑Ｒ│INS │  " │ 2  │ Ｂ │ Ｒ │ ｂ │ ｒ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 3　│↑Ｃ│　　│↑Ｓ│　　│ ＃ │ 3  │ Ｃ │ Ｓ │ ｃ │ ｓ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 4　│↑Ｄ│　　│↑Ｔ│　　│ ＄ │ 4  │ Ｄ │ Ｔ │ ｄ │ ｔ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 5　│↑Ｅ│EL　│↑Ｕ│　　│ ％ │ 5  │ Ｅ │ Ｕ │ ｅ │ ｕ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 6　│↑Ｆ│　　│↑Ｖ│　　│ ＆ │ 6  │ Ｆ │ Ｖ │ ｆ │ ｖ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 7　│↑Ｇ│　　│↑Ｗ│　　│ ’ │ 7  │ Ｇ │ Ｗ │ ｇ │ ｗ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 8　│↑Ｈ│←　│↑Ｘ│　　│ (  │ 8  │ Ｈ │ Ｘ │ ｈ │ ｘ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　 9　│↑Ｉ│TAB │↑Ｙ│　　│  ) │ 9  │ Ｉ │ Ｙ │ ｉ │ ｙ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　Ａ　│↑Ｊ│　　│↑Ｚ│　　│ ＊ │ :  │ Ｊ │ Ｚ │ ｊ │ ｚ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　Ｂ　│↑Ｋ│HOME│↑〔│ESC │ ＋ │ ； │ Ｋ │ 〔 │ ｋ │ {  │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　Ｃ　│↑Ｌ│CLS │↑￥│→　│ ， │ <  │ Ｌ │ ￥ │ ｌ │ ｜ │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　Ｄ　│↑Ｍ│　　│↑〕│←　│ -  │ ＝ │ Ｍ │ 〕 │ ｍ │ }  │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　Ｅ　│↑Ｎ│　　│↑＾│↑　│ .  │ >  │ Ｎ │ ＾ │ ｎ │ ~  │       
├───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤       
│　Ｆ　│↑Ｏ│　　│↑―│↓　│ /  │ ？ │ Ｏ │ ― │ ｏ │ DL │       
└───┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┘       
                                                                             
･コード 00H〜1FH の左側に示してある↑はコントロールキー(CTRL)との併用を示しま
 す。                                                                        
 例えば，↑Ａは CTRL キーを押しながらＡのキーを押すことを示します。          
･コード 80H〜FFH は出力されません。                                          
                                                                             
B.5　キーボード　シフトＪＩＳ(8ｂｉｔ)コード表                               
                                                                             
図CL21R-070                                                                 
                                                                             
B.6　キーボード　ＰＦキーコード表                                            
                                                                             
　ＰＦキーのコード表を示します.                                              
                                                                             
┌──────┬────┬──────┬────┬──────┬────┐   
│　ＫＥＹ　　│コード　│　ＫＥＹ　　│コード　│　ＫＥＹ　　│コード　│   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ1 　　│  8001  │　　取消　　│  8011  │　ＰＦ13　  │  8021  │   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ2 　　│  8002  │　　実行　　│  8012  │　ＰＦ14  　│  8022  │   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ3 　　│  8003  │　漢字辞書　│  8013  │　ＰＦ15　  │  8023  │   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ4 　　│  8004  │　単語抹消　│  8014  │　ＰＦ16  　│  8024  │   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ5 　　│  8005  │　単語登録　│  8015  │　ＰＦ17　  │  8025  │   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ6 　　│  8006  │　　前行　　│  8016  │　ＰＦ18　  │  8026  │   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ7 　　│  8007  │　　次行　　│  8017  │　ＰＦ19　  │  8027  │   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ8 　　│  8008  │半角/全角　 │  8018  │　ＰＦ20　  │  8028  │   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ9 　　│  8009  │　　　　　　│　　　　│　　　　　　│　　　　│   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ10  　│  800A  │　かな漢字　│  801C  │　　　　　　│　　　　│   
├──────┼────┼──────┼────┼──────┼────┤   
│　ＰＦ11  　│  800B  │　ＰＦ12　  │  801D  │　　　　　　│　　　　│   
├──────┼────┼──────┼────┼──────┼────┤   
│　　　　　　│　　　　│　変換　　　│  801E  │　　　　　　│　　　　│   
├──────┼────┼──────┼────┼──────┼────┤   
│　　　　　　│　　　　│　無変換　　│  801F  │　　　　　　│　　　　│   
└──────┴────┴──────┴────┴──────┴────┘   
                                                                             
B.7　キーボード　キーアドレス/文字コード　対応表                             
                                                                             
(1)　ＪＩＳキーボード                                                        
(注)空白欄は、コードが未定義であることを表します。                           
                                                                             
　■英小文字モード                                                           
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│　 3│　　　　 4│　 5│　 6│　 7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　64│　6D│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　71│　66│　2C│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　31│　77│　67│　2E│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　32│　65│　68│　2F│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　33│　72│　6A│　22│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　34│　74│　6B│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　35│　79│　6C│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　36│　75│　3B│　2F│　　　　2E│801F│　　│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　37│　69│　3A│　2B│　　　　12│801E│　　│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　38│　6F│　5D│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　39│　70│　7A│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　30│　40│　78│　38│　　　　7F│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　2D│　5B│　63│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　5E│　0D│　76│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　5C│　61│　62│　34│　　　　0B│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　73│　6E│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■英小文字＋ＳＨＩＦＴモード                                               
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│　 3│　　　　 4│　 5│　 6│　 7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　44│　4D│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　51│　46│　3C│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　21│　57│　47│　3E│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　22│　45│　48│　3F│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　23│　52│　4A│　5F│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　24│　54│　4B│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　25│　59│　4C│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　26│　55│　2B│　2F│　　　　2E│801F│　　│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　27│　49│　2A│　2B│　　　　11│801E│　　│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　28│　4F│　7D│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　29│　50│　5A│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　　│　60│　58│　38│　　　　05│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　3D│　7B│　43│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　7E│　0D│　56│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　7C│　41│　42│　34│　　　　0C│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　53│　4E│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■英大文字モード                                                           
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│　 3│　　　　 4│　 5│　 6│　 7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　44│　4D│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　51│　46│　2C│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　31│　57│　47│　2E│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　32│　45│　48│　2F│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　33│　52│　4A│　22│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　34│　54│　4B│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　35│　59│　4C│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　36│　55│　3B│　2F│　　　　2E│801F│　　│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　37│　49│　3A│　2B│　　　　12│801E│　　│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　38│　4F│　5D│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　39│　50│　5A│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　30│　40│　58│　38│　　　　7F│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　2D│　5B│　43│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　5E│　0D│　56│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　5C│　41│　42│　34│　　　　0B│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　53│　4E│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■英大文字＋ＳＨＩＦＴモード                                               
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│　 3│　　　　 4│　 5│　 6│　 7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　64│　6D│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　71│　66│　3C│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　21│　77│　67│　3E│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　22│　65│　68│　3F│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　23│　72│　6A│　5F│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　24│　74│　6B│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　25│　79│　6C│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　26│　75│　2B│　2F│　　　　2E│801F│　　│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　27│　69│　2A│　2B│　　　　11│801E│　　│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　28│　6F│　7D│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　29│　70│　7A│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　　│　60│　78│　38│　　　　05│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　3D│　7B│　63│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　7E│　0D│　76│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　7C│　61│　62│　34│　　　　0C│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　73│　6E│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■かなモード                                                               
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│ 　0│ 　1│ 　2│ 　3│　　　　 4│　 5│　 6│　 7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　BC│　D3│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　C0│　CA│　C8│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　C7│　C3│　B7│　D9│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　CC│　B2│　B8│　D2│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　B1│　BD│　CF│　DB│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　B3│　B6│　C9│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　B4│　DD│　D8│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　B5│　C5│　DA│　2F│　　　　2E│801F│　　│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　D4│　C6│　B9│　2B│　　　　12│801E│　　│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　D5│　D7│　D1│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　D6│　BE│　C2│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　DC│　DE│　BB│　38│　　　　7F│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　CE│　DF│　BF│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　CD│　0D│　CB│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　B0│　C1│　BA│　34│　　　　0B│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　C4│　D0│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■かな＋ＳＨＩＦＴモード                                                   
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│　 3│　　　　 4│　 5│ 　6│ 　7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　　│　　│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　　│　　│　A4│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　　│　　│　　│　A1│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　　│　A8│　　│　A5│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　A7│　　│　　│　　│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　A9│　　│　　│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　AA│　　│　　│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　AB│　　│　　│　2F│　　　　2E│801F│　　│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　AC│　　│　　│　2B│　　　　11│801E│　　│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　AD│　　│　A3│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　AE│　　│　AF│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　A6│　　│　　│　38│　　　　05│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　　│　A2│　　│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　　│　0D│　　│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　　│　　│　　│　34│　　　　0C│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　　│　　│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■ＣＴＲＬモード                                                           
                                                                             
┌───┬───────────────────────┐                   
│　　　│　　　　　　　　　上　　　位　　　　　　　　　│                   
│　　　├──┬──┬──┬──┬──┬──┬──┬──┤                   
│　　　│　 0│　 1│ 　2│ 　3│ 　4│ 　5│ 　6│ 　7│                   
├─┬─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 0│　　│　　│　04│　0D│　　│　1F│8004│8017│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 1│　　│　11│　06│　　│　　│　1C│8005│8018│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 2│　　│　17│　07│　　│　　│　　│8006│8011│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 3│　　│　05│　08│　　│　　│　　│8007│8012│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 4│　　│　12│　0A│　1F│　　│　　│8008│8021│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 5│　　│　14│　0B│　　│　　│　　│8009│8022│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 6│　　│　19│　0C│　　│　　│　　│800A│8023│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│下│ 7│　　│　15│　　│　　│　　│801F│　　│8024│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│位│ 8│　　│　09│　　│　　│　12│801E│　　│8025│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 9│　　│　0F│　1D│　　│　　│801C│800B│8026│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ A│　　│　10│　1A│　　│　　│　　│　　│8027│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ B│　　│　00│　18│　　│　7F│801D│8013│8028│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ C│　　│　1B│　03│　　│　　│　　│8014│　　│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ D│　1E│　　│　16│　　│　1E│8001│8015│　　│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ E│　1C│　01│　02│　　│　0B│8002│8016│　　│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ F│　　│　13│　0E│　　│　1D│8003│　　│　　│                   
└─┴─┴──┴──┴──┴──┴──┴──┴──┴──┘                   
                                                                             
(2)　親指シフトキーボード                                                    
(注)空白欄は、コードが未定義であることを表します。                           
                                                                             
　■英小文字モード                                                           
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│ 　2│ 　3│　　　　 4│　 5│　 6│　 7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　64│　6D│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　71│　66│　2C│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　31│　77│　67│　2E│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　32│　65│　68│　2F│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　33│　72│　6A│　60│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　34│　74│　6B│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　35│　79│　6C│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　36│　75│　3B│　2F│　　　　2E│801F│　20│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　37│　69│　3A│　2B│　　　　12│801E│　20│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　38│　6F│　5D│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　39│　70│　7A│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　30│　　│　78│　38│　　　　7F│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　2D│　5B│　63│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　5E│　0D│　76│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　5C│　61│　62│　34│　　　　0B│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　73│　6E│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■英小文字＋ＳＨＩＦＴモード                                               
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│ 　3│　　　　 4│　 5│　 6│ 　7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　44│　4D│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　51│　46│　3C│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　21│　57│　47│　3E│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　22│　45│　48│　3F│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　23│　52│　4A│　5F│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　24│　54│　4B│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　25│　59│　4C│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　26│　55│　2B│　2F│　　　　2E│801F│　20│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　27│　49│　2A│　2B│　　　　11│801E│　20│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　28│　4F│　7D│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　29│　50│　5A│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　40│　　│　58│　38│　　　　05│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　3D│　7B│　43│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　7E│　0D│　56│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　7C│　41│　42│　34│　　　　0C│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　53│　4E│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■英大文字モード                                                           
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│　 3│　　　　 4│　 5│　 6│　 7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　44│　4D│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　51│　46│　2C│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　31│　57│　47│　2E│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　32│　45│　48│　2F│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　33│　52│　4A│　60│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　34│　54│　4B│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　35│　59│　4C│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　36│　55│　3B│　2F│　　　　2E│801F│　20│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　37│　49│　3A│　2B│　　　　12│801E│　20│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　38│　4F│　5D│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　39│　50│　5A│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　30│　　│　58│　38│　　　　7F│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　2D│　5B│　43│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　5E│　0D│　56│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　5C│　41│　42│　34│　　　　0B│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　53│　4E│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■英大文字＋ＳＨＩＦＴモード                                               
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│ 　3│　　　　 4│ 　5│ 　6│ 　7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　64│　6D│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　71│　66│　3C│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　21│　77│　67│　3E│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　22│　65│　68│　3F│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　23│　72│　6A│　5F│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　24│　74│　6B│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　25│　79│　6C│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　26│　75│　2B│　2F│　　　　2E│801F│　20│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　27│　69│　2A│　2B│　　　　11│801E│　20│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　28│　6F│　7D│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　29│　70│　7A│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　40│　　│　78│　38│　　　　05│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　3D│　7B│　63│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　7E│　0D│　76│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　7C│　61│　62│　34│　　　　0C│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　73│　6E│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■かなモード(単独)                                                         
                                                                             
┌───┬──────────────────────────┐             
│　　　│　　　　　　　　　　上　　　位　　　　　　　　　　　│             
│　　　├──┬──┬──┬──┬─────┬──┬──┬──┤             
│　　　│　 0│　 1│　 2│ 　3│　　　　 4│　 5│　 6│　 7│             
├─┬─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 0│　　│　09│　C3│　BF│　　　　36│　1F│8004│8017│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 1│　1B│　A1│　B9│　C8│　　　　　│　1C│8005│8018│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 2│　31│　B6│　BE│　CE│　　　　31│　　│8006│8011│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 3│　32│　C0│　CA│　A5│　　　　32│　　│8007│8012│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 4│　33│　BA│　C4│　22│　　　　33│　　│8008│8021│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 5│　34│　BB│　B7│　20│　　　　0D│　　│8009│8022│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 6│　35│　D7│　B2│　2A│　　　　30│　　│800A│8023│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│下│ 7│　36│　C1│　DD│　2F│　　　　2E│801F│　　│8024│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│位│ 8│　37│　B8│　A4│　2B│　　　　12│801E│　　│8025│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ 9│　38│　C2│　　│　2D│　　30＋30│801C│800B│8026│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ A│　39│　2C│　2E│　37│30＋30＋30│　　│　　│8027│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ B│　30│　　│　CB│　38│　　　　7F│801D│8013│8028│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ C│　2D│　60│　BD│　39│　　　　　│　　│8014│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ D│　7C│　0D│　CC│　3D│　　　　1E│8001│8015│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ E│　　│　B3│　CD│　34│　　　　0B│8002│8016│　　│             
│　├─┼──┼──┼──┼──┼─────┼──┼──┼──┤             
│　│ F│　08│　BC│　D2│　35│　　　　1D│8003│　　│　　│             
└─┴─┴──┴──┴──┴──┴─────┴──┴──┴──┘             
                                                                             
　■かなモード(右側親指シフトキー　同時押下)                                 
                                                                             
┌───┬─────────────────────────────┐       
│　　　│　　　　　　　　　　　　上　　　位　　　　　　　　　　　　│       
│　　　├──┬───┬───┬───┬─────┬──┬──┬──┤       
│　　　│　 0│　　 1│　　 2│　　 3│　　　　 4│　 5│　 6│　 7│       
├─┬─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 0│　　│　　09│C3＋DE│　　D5│　　　　36│　1F│8004│8017│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 1│　1B│　　　│B9＋DE│　　D1│　　　　　│　1C│8005│8018│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 2│　3F│B6＋DE│BE＋DE│　　DC│　　　　31│　　│8006│8011│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 3│　2F│C0＋DE│　　D0│　　AB│　　　　32│　　│8007│8012│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 4│　BC│BA＋DE│　　B5│　　DE│　　　　33│　　│8008│8021│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 5│　A2│BB＋DE│　　C9│　　20│　　　　0D│　　│8009│8022│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 6│　A3│　　D6│　　AE│　　2A│　　　　30│　　│800A│8023│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│下│ 7│　5B│　　C6│　　AF│　　2F│　　　　2E│801F│　　│8024│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│位│ 8│　5D│　　D9│　　B0│　　2B│　　　　12│801E│　　│8025│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 9│　28│　　CF│　　　│　　2D│　　30＋30│801C│800B│8026│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ A│　29│　　AA│　　　│　　37│30＋30＋30│　　│　　│8027│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ B│　A2│　　　│CB＋DE│　　38│　　　　7F│801D│8013│8028│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ C│　A3│　　DF│BD＋DE│　　39│　　　　　│　　│8014│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ D│　5C│　　0D│CC＋DE│　　3D│　　　　1E│8001│8015│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ E│　　│B3＋DE│CD＋DE│　　34│　　　　0B│8002│8016│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ F│　08│BC＋DE│　　C7│　　35│　　　　1D│8003│　　│　　│       
└─┴─┴──┴───┴───┴───┴─────┴──┴──┴──┘       
                                                                             
　■かなモード(左側親指シフトキー　同時押下)                                 
                                                                             
┌───┬─────────────────────────────┐       
│　　　│　　　　　　　　　　　　上　　　位　　　　　　　　　　　　│       
│　　　├──┬───┬───┬───┬─────┬──┬──┬──┤       
│　　　│　 0│　　 1│　　 2│　 　3│　　　　 4│　 5│　 6│　 7│       
├─┬─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 0│　　│　　09│　　C5│BF＋DE│　　　　36│　1F│8004│8017│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 1│　1B│　　A7│　　AD│　　　│　　　　　│　1C│8005│8018│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 2│　3F│　　B4│　　D3│CE＋DE│　　　　31│　　│8006│8011│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 3│　2F│　　D8│CA＋DE│　　　│　　　　32│　　│8007│8012│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 4│　B0│　　AC│C4＋DE│　　　│　　　　33│　　│8008│8021│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 5│　A2│　　DA│B7＋DE│　　20│　　　　0D│　　│8009│8022│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 6│　A3│　　　│　　　│　　2A│　　　　30│　　│800A│8023│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│下│ 7│　5B│C1＋DE│　　　│　　2F│　　　　2E│801F│　　│8024│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│位│ 8│　5D│B8＋DE│　　　│　　2B│　　　　12│801E│　　│8025│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 9│　28│C2＋DE│　　　│　　2D│　　30＋30│801C│800B│8026│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ A│　29│　　　│　　A9│　　37│30＋30＋30│　　│　　│8027│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ B│　A2│　　　│　　B0│　　38│　　　　7F│801D│8013│8028│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ C│　A3│　　　│　　DB│　　39│　　　　　│　　│8014│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ D│　5C│　　0D│　　D4│　　3D│　　　　1E│8001│8015│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ E│　　│　　A6│　　A8│　　34│　　　　0B│8002│8016│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ F│　08│　　B1│　　　│　　35│　　　　1D│8003│　　│　　│       
└─┴─┴──┴───┴───┴───┴─────┴──┴──┴──┘       
                                                                             
　■かな＋ＳＨＩＦＴ(半濁音)モード                                           
                                                                             
┌───┬─────────────────────────────┐       
│　　　│　　　　　　　　　　　　上　　　位　　　　　　　　　　　　│       
│　　　├──┬───┬───┬───┬─────┬──┬──┬──┤       
│　　　│　 0│　　 1│　 　2│　 　3│　　　　 4│　 5│　 6│　 7│       
├─┬─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 0│　　│　　09│　　C3│　　BF│　　　　36│　1F│8004│8017│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 1│　1B│　　A1│　　B9│　　C8│　　　　　│　1C│8005│8018│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 2│　31│　　B6│　　BE│CE＋DF│　　　　31│　　│8006│8011│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 3│　32│　　C0│CA＋DF│　　A5│　　　　32│　　│8007│8012│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 4│　33│　　BA│　　C4│　　22│　　　　33│　　│8008│8021│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 5│　34│　　BB│　　B7│　　20│　　　　0D│　　│8009│8022│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 6│　35│　　D7│　　B2│　　2A│　　　　30│　　│800A│8023│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│下│ 7│　36│　　C1│　　DD│　　2F│　　　　2E│801F│　　│8024│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│位│ 8│　37│　　B8│　　A4│　　2B│　　　　11│801E│　　│8025│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ 9│　38│　　C2│　　　│　　2D│　　30＋30│801C│800B│8026│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ A│　39│　　2C│　　2E│　　37│30＋30＋30│　　│　　│8027│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ B│　30│　　　│CB＋DF│　　38│　　　　05│801D│8013│8028│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ C│　2D│　　60│　　BD│　　39│　　　　　│　　│8014│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ D│　7C│　　0D│CC＋DF│　　3D│　　　　1E│8001│8015│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ E│　　│　　B3│CD＋DF│　　34│　　　　0C│8002│8016│　　│       
│　├─┼──┼───┼───┼───┼─────┼──┼──┼──┤       
│　│ F│　08│　　BC│　　D2│　　35│　　　　1D│8003│　　│　　│       
└─┴─┴──┴───┴───┴───┴─────┴──┴──┴──┘       
                                                                             
　■ＣＴＲＬモード                                                           
                                                                             
┌───┬───────────────────────┐                   
│　　　│　　　　　　　　　上　　　位　　　　　　　　　│                   
│　　　├──┬──┬──┬──┬──┬──┬──┬──┤                   
│　　　│　 0│　 1│　 2│ 　3│ 　4│ 　5│　 6│ 　7│                   
├─┬─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 0│　　│　　│　04│　0D│　　│　1F│8004│8017│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 1│　　│　11│　06│　　│　　│　1C│8005│8018│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 2│　　│　17│　07│　　│　　│　　│8006│8011│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 3│　　│　05│　08│　　│　　│　　│8007│8012│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 4│　　│　12│　0A│　1F│　　│　　│8008│8021│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 5│　　│　14│　0B│　　│　　│　　│8009│8022│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 6│　　│　19│　0C│　　│　　│　　│800A│8023│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│下│ 7│　　│　15│　　│　　│　　│801F│　　│8024│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│位│ 8│　　│　09│　　│　　│　12│801E│　　│8025│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ 9│　　│　0F│　1D│　　│　　│801C│800B│8026│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ A│　　│　10│　1A│　　│　　│　　│　　│8027│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ B│　00│　　│　18│　　│　7F│801D│8013│8028│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ C│　　│　1B│　03│　　│　　│　　│8014│　　│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ D│　1E│　　│　16│　　│　1E│8001│8015│　　│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ E│　1C│　01│　02│　　│　0B│8002│8016│　　│                   
│　├─┼──┼──┼──┼──┼──┼──┼──┼──┤                   
│　│ F│　　│　13│　0E│　　│　1D│8003│　　│　　│                   
└─┴─┴──┴──┴──┴──┴──┴──┴──┴──┘                   
                                                                             
B.8　キーボード　ＪＩＳコード配列図                                          
                                                                             
- 注意 -                                                                     
空白キーは、コードが未定義であることを表します。                             
                                                                             
図CL21R-071                                                                  
                                                                             
図CL21R-072                                                                  
                                                                             
図CL21R-073                                                                  
                                                                             
図CL21R-074                                                                  
                                                                             
図CL21R-075                                                                  
                                                                             
図CL21R-076                                                                  
                                                                             
図CL21R-077                                                                  
                                                                             
図CL21R-078                                                                  
                                                                             
図CL21R-079                                                                  
                                                                             
図CL21R-080                                                                  
                                                                             
図CL21R-081                                                                  
                                                                             
図CL21R-082                                                                  
                                                                             
図CL21R-083                                                                  
                                                                             
図CL21R-084                                                                  
                                                                             
図CL21R-085                                                                  
                                                                             
図CL21R-086                                                                  
                                                                             
