100 SCREEN@2:CLS:COLOR 7,0:'256êF 640x480
110 DIM COL2R%(160), COL2G%(160), COL2B%(160)
120 FOR I=0 TO 160
130 COL2R%(I) = 0:COL2G%(I) = 0:COL2B%(I) = 0:
140 IF NOT(I <= 31) THEN 160
150 COL2B%(I) = I
160 IF NOT((I > 32) AND (I <= 63)) THEN 190
170 COL2B%(I) = (63 - I)
180 COL2R%(I) = (I - 33)
190 IF NOT(I = 64) THEN 210 
200 COL2R%(I) = (I - 33)
210 IF NOT((I > 64) AND (I <= 95)) THEN 240
220 COL2R%(I) = (95 - I)
230 COL2G%(I) = (I - 65)
240 IF NOT(I = 96) THEN 260
250 COL2G%(I) = (I - 65)
260 IF NOT((I > 96) AND (I <= 127)) THEN 290
270 COL2G%(I) = ((127 - I) + (I - 97))
280 COL2B%(I) = (I - 97)
290 IF NOT(I = 128) THEN 320
300 COL2G%(I) = (I - 97)
310 COL2B%(I) = (I - 97)
320 IF NOT((I > 128) AND (I <= 159)) THEN 360
330 COL2G%(I) = ((159 - I) + (I - 129))
340 COL2B%(I) = ((159 - I) + (I - 129))
350 COL2R%(I) = (I - 129)
360 IF NOT(I >= 160) THEN 400
370 COL2G%(I) = 31
380 COL2B%(I) = 31
390 COL2R%(I) = 31
400 NEXT I
410 FOR I=0 TO 160
420 PALETTE I,[COL2G%(I)*8, COL2R%(I)*8, COL2B%(I)*8],0
430 NEXT I
500 DIM D(160)
510 FOR I = 1 TO 159
520 D(I)=100
530 NEXT I
540 XMAX=640:YMAX=480
550 DR=3.14!/180
560 FOR Y1=-1800 TO 1800 STEP 10:Y=Y1/10
570 FOR X1=-1800 TO 1800 STEP 2:X=X1/10
580 R=DR*SQR(X*X+Y*Y)
590 Z=100*COS(R)-30*COS(3*R)
600 SX=(80+X/3-Y/6):SXI=INT(SX)
610 SY=(40-Y/6-Z/4)
620 IF (SXI<0) + (SXI>=160) THEN 700
630 IF D(SXI) < SY THEN 700
640 ZZ%=INT((Z+100)*.035! / 7! * 160!)+1
650 IF ZZ% > 160 THEN ZZ% = 160
670 PX%=SX*2*XMAX/320:PY%=SY*2*YMAX/200 
680 LINE(PX%, PY%)-(PX%,PY%), PSET, %ZZ%, BF
690 D(SXI)=SY
700 NEXT X1
710 NEXT Y1
720 IF INKEY$="" THEN 720
