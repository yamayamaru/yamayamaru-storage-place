10  TIME = 0
100 SCREEN 5:COLOR 15,1,1:CLS
110 FOR I%=0 TO 7:COLOR=(I%+1,(I% AND 2)/2*7, (I% AND 4)/4*7, (I% AND 1)*7):NEXT I%
112 T1 = TIME
115 LINE(0,0)-(255,212),1,BF
120 DIM D%(160)
130 FOR I% = 1 TO 159
140 D%(I%)=100
150 NEXT
160 DR=3.14/180:XW%=256:XH%=212
170 FOR Y%=-180 TO 180 STEP 6
180 FOR X%=-180 TO 180 STEP 4
190 R=DR*SQR(X%*X%+Y%*Y%)
200 Z=100*COS(R)-30*COS(3*R)
210 SX%=INT(80+X%/3-Y%/6)
220 SY%=INT(40-Y%/6-Z/4)
230 IF (SX%<0) + (SX%>=160) THEN 320
240 IF D%(SX%) <= SY% THEN 320
250 ZZ%=INT((Z+100)*.035)+1
260 C% = 0:F%=0
270 IF (ZZ%=1)+(ZZ%=3)+(ZZ%=5)+(ZZ%=7) THEN C% = C%+1:F%=1
280 IF (ZZ%=2)+(ZZ%=3)+(ZZ%>=6) THEN C% = C%+2:F%=1
290 IF ZZ%>=4 THEN C% = C%+4:F%=1
300 IF F%=1 THEN PSET(SX%*2*XW%/320,SY%*2*XH%/200), C%+1
310 D%(SX%)=SY%
320 NEXT X%
330 NEXT Y%
340 T2 = TIME
350 IF INKEY$="" THEN 350
360 SCREEN 0
370 PRINT "time = ",(T2-T1)/60
380 END
